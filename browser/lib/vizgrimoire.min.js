<<<<<<< HEAD
/* 
 * VizGrimoire.js - https://github.com/VizGrimoire/VizGrimoireJS
 * Copyright (C) 2012 Bitergia
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 *
 * Authors:
 *   Alvaro del Castillo San Felix <acs@bitergia.com>
 * 
 * Underscore.js 1.1.7 (c) 2011 Jeremy Ashkenas, DocumentCloud Inc. MIT license
 * bean.js - copyright Jacob Thornton 2011, MIT license
 * Flotr2 (c) 2012 Carl Sutherland, MIT license
 * Bonzo: DOM Utility (c) Dustin Diaz 2011, MIT license
 * Envision.js (c) 2012 Carl Sutherland, Humble Software, MIT license
 * gridster.js Copyright (c) 2012 ducksboard; Licensed MIT
 * d3.js: Copyright (c) 2012, Michael Bostocks
 * 
 */function resizedw(){Report.convertGlobal(),Report.convertStudiesGlobal(),Report.convertStudies(),Convert.activateHelp()}function DataSource(e,t){function n(e,t){if(e instanceof Array)return e;var n={};return $.each(e,function(e,r){var i=e,s=e.split("_");isNaN(s[s.length-1])===!1&&(i=s.slice(0,s.length-1).join("_"));var o=t.getName()+"_"+i,u=t.getName()+"_"+e;t.getMetrics()[o]===undefined?n[e]=r:n[u]=r}),n}this.top_data_file=this.data_dir+"/"+this.name+"-top.json",this.getTopDataFile=function(){return this.top_data_file},this.getMetrics=function(){return this.basic_metrics},this.setMetrics=function(e){this.basic_metrics=e},this.setMetricsDefinition=function(e){if(e===undefined)return;this.setMetrics(e)},this.data_file=this.data_dir+"/"+this.name+"-evolutionary.json",this.getDataFile=function(){return this.data_file},this.setDataFile=function(e){this.data_file=e},this.data=null,this.getData=function(){return this.data},this.setData=function(e,t){t===undefined&&(t=this),t.data=n(e,t)},this.demographics_aging_file=this.data_dir+"/"+this.name+"-demographics-aging.json",this.demographics_birth_file=this.data_dir+"/"+this.name+"-demographics-birth.json",this.getDemographicsAgingFile=function(){return this.demographics_aging_file},this.getDemographicsBirthFile=function(){return this.demographics_birth_file},this.demographics_data={},this.getDemographicsData=function(){return this.demographics_data},this.setDemographicsAgingData=function(e,t){t===undefined&&(t=this),t.demographics_data.aging=e},this.setDemographicsBirthData=function(e,t){t===undefined&&(t=this),t.demographics_data.birth=e},this.data_dir="data/json",this.getDataDir=function(){return this.data_dir},this.setDataDir=function(e){this.data_dir=e,this.data_file=e+"/"+this.name+"-evolutionary.json",this.demographics_aging_file=e+"/"+this.name+"-demographics-aging.json",this.demographics_birth_file=e+"/"+this.name+"-demographics-birth.json",this.global_data_file=e+"/"+this.name+"-static.json",this.top_data_file=e+"/"+this.name+"-top.json",this.companies_data_file=e+"/"+this.name+"-companies.json",this.repos_data_file=e+"/"+this.name+"-repos.json",this.countries_data_file=e+"/"+this.name+"-countries.json",this.domains_data_file=e+"/"+this.name+"-domains.json",this.projects_data_file=e+"/"+this.name+"-projects.json",this.time_to_fix_data_file=e+"/"+this.name+"-quantiles-month-time_to_fix_hour.json"},this.global_data_file=this.data_dir+"/"+this.name+"-static.json",this.getGlobalDataFile=function(){return this.global_data_file},this.global_data=null,this.getGlobalData=function(){return this.global_data},this.setGlobalData=function(e,t){t===undefined&&(t=this),t.global_data=n(e,t)},this.global_top_data=null,this.getGlobalTopData=function(){return this.global_top_data},this.setGlobalTopData=function(e,t){t===undefined&&(t=this),t.global_top_data=e},this.name=e,this.getName=function(){return this.name},this.people_data_file=this.data_dir+"/"+this.name+"-people.json",this.getPeopleDataFile=function(){return this.people_data_file},this.people=null,this.getPeopleData=function(){return this.people},this.setPeopleData=function(e,t){t===undefined&&(t=this),t.people=e},this.time_to_fix_data_file=this.data_dir+"/"+this.name+"-quantiles-month-time_to_fix_hour.json",this.getTimeToFixDataFile=function(){return this.time_to_fix_data_file},this.time_to_fix_data=null,this.getTimeToFixData=function(){return this.time_to_fix_data},this.setTimeToFixData=function(e,t){t===undefined&&(t=this),t.time_to_fix_data=e},this.time_to_attention_data_file=this.data_dir+"/"+this.name+"-quantiles-month-time_to_attention_hour.json",this.getTimeToAttentionDataFile=function(){return this.time_to_attention_data_file},this.time_to_attention_data=null,this.getTimeToAttentionData=function(){return this.time_to_attention_data},this.setTimeToAttentionData=function(e,t){t===undefined&&(t=this),t.time_to_attention_data=e},this.project=null,this.getProject=function(){return this.project},this.setProject=function(e){this.project=e},this.markov_table_data_file=this.data_dir+"/"+this.name+"-markov.json",this.getMarkovTableDataFile=function(){return this.markov_table_data_file},this.markov_table_data=null,this.getMarkovTableData=function(){return this.markov_table_data},this.setMarkovTableData=function(e,t){t===undefined&&(t=this),t.markov_table_data=e},this.companies_data_file=this.data_dir+"/"+this.name+"-companies.json",this.getCompaniesDataFile=function(){return this.companies_data_file},this.companies=null,this.getCompaniesDataFull=function(){return this.companies},this.getCompaniesData=function(){var e=this.companies;return e instanceof Array==0&&this.companies!==null&&(e=this.companies.name),e},this.setCompaniesData=function(e,t){e===null&&(e=[]),t===undefined&&(t=this),t.companies=e},this.companies_metrics_data={},this.addCompanyMetricsData=function(e,t,r){r===undefined&&(r=this),r.companies_metrics_data[e]=n(t,r)},this.getCompaniesMetricsData=function(){return this.companies_metrics_data},this.companies_global_data={},this.addCompanyGlobalData=function(e,t,r){r===undefined&&(r=this),r.companies_global_data[e]=n(t,r)},this.getCompaniesGlobalData=function(){return this.companies_global_data},this.companies_top_data={},this.addCompanyTopData=function(e,t,n){n===undefined&&(n=this),n.companies_top_data[e]===undefined&&(n.companies_top_data[e]={}),n.companies_top_data[e]=t},this.getCompaniesTopData=function(){return this.companies_top_data},this.setCompaniesTopData=function(e,t){t===undefined&&(t=this),t.companies_top_data=e},this.repos_data_file=this.data_dir+"/"+this.name+"-repos.json",this.getReposDataFile=function(){return this.repos_data_file},this.repos=null,this.getReposDataFull=function(){return this.repos},this.getReposData=function(){var e=this.repos;return e instanceof Array==0&&this.repos!==null&&(e=this.repos.name),e},this.setReposData=function(e,t){t===undefined&&(t=this),t.repos=e;if(t.getName()!=="its")return;repos_names=[],e instanceof Array==1&&(t.repos={},t.repos.name=e);var n=[];for(var r=0;r<t.repos.name.length;r++)n.push(t.repos.name[r].replace(/\//g,"_"));t.repos.name=n},this.repos_metrics_data={},this.addRepoMetricsData=function(e,t,r){r===undefined&&(r=this),r.repos_metrics_data[e]=n(t,r)},this.getReposMetricsData=function(){return this.repos_metrics_data},this.repos_global_data={},this.addRepoGlobalData=function(e,t,r){r===undefined&&(r=this),r.repos_global_data[e]=n(t,r)},this.getReposGlobalData=function(){return this.repos_global_data},this.repositories_top_data={},this.addRepositoryTopData=function(e,t,n){n===undefined&&(n=this),n.repositories_top_data[e]===undefined&&(n.repositories_top_data[e]={}),n.repositories_top_data[e]=t},this.getRepositoriesTopData=function(){return this.repositories_top_data},this.setRepositoriesTopData=function(e,t){t===undefined&&(t=this),t.repositories_top_data=e},this.countries_data_file=this.data_dir+"/"+this.name+"-countries.json",this.getCountriesDataFile=function(){return this.countries_data_file},this.countries=null,this.getCountriesData=function(){return this.countries},this.setCountriesData=function(e,t){t===undefined&&(t=this),t.countries=e},this.countries_metrics_data={},this.addCountryMetricsData=function(e,t,r){r===undefined&&(r=this),r.countries_metrics_data[e]=n(t,r)},this.getCountriesMetricsData=function(){return this.countries_metrics_data},this.countries_global_data={},this.addCountryGlobalData=function(e,t,r){r===undefined&&(r=this),r.countries_global_data[e]=n(t,r)},this.getCountriesGlobalData=function(){return this.countries_global_data},this.domains_data_file=this.data_dir+"/"+this.name+"-domains.json",this.getDomainsDataFile=function(){return this.domains_data_file},this.domains=null,this.getDomainsDataFull=function(){return this.domains},this.getDomainsData=function(){var e=this.domains;return e instanceof Array==0&&this.domains!==null&&(e=this.domains.name),e},this.setDomainsData=function(e,t){e===null&&(e=[]),t===undefined&&(t=this),t.domains=e},this.domains_metrics_data={},this.addDomainMetricsData=function(e,t,r){r===undefined&&(r=this),r.domains_metrics_data[e]=n(t,r)},this.getDomainsMetricsData=function(){return this.domains_metrics_data},this.domains_global_data={},this.addDomainGlobalData=function(e,t,r){r===undefined&&(r=this),r.domains_global_data[e]=n(t,r)},this.getDomainsGlobalData=function(){return this.domains_global_data},this.projects_data_file=this.data_dir+"/"+this.name+"-projects.json",this.getProjectsDataFile=function(){return this.projects_data_file},this.projects=null,this.getProjectsData=function(){return this.projects},this.setProjectsData=function(e,t){e===null&&(e=[]),e instanceof Array||(e=[e]),t===undefined&&(t=this),t.projects=e},this.projects_metrics_data={},this.addProjectMetricsData=function(e,t,r){r===undefined&&(r=this),r.projects_metrics_data[e]=n(t,r)},this.getProjectsMetricsData=function(){return this.projects_metrics_data},this.projects_global_data={},this.addProjectGlobalData=function(e,t,r){r===undefined&&(r=this),r.projects_global_data[e]=n(t,r)},this.getProjectsGlobalData=function(){return this.projects_global_data},this.people_metrics_data={},this.addPeopleMetricsData=function(e,t,r){r===undefined&&(r=this),r.people_metrics_data[e]=n(t,r)},this.getPeopleMetricsData=function(){return this.people_metrics_data},this.people_global_data={},this.addPeopleGlobalData=function(e,t,r){r===undefined&&(r=this),r.people_global_data[e]=n(t,r)},this.getPeopleGlobalData=function(){return this.people_global_data},this.getCompanyQuery=function(){var e=null,t=window.location.search.substr(1);return t&&t.split("&")[0].split("=")[0]==="company"&&(e=t.split("&")[0].split("=")[1]),e},this.displayMetricCompanies=function(e,t,n,r,i){var s=this.getCompaniesMetricsData();Viz.displayMetricCompanies(e,s,t,n,r,i)},this.displayMetricMyCompanies=function(e,t,n,r,i,s){var o={},u=this;$.each(e,function(e,t){o[t]=u.getCompaniesMetricsData()[t]}),Viz.displayMetricCompanies(t,o,n,r,i,s)},this.displayMetricRepos=function(e,t,n,r,i){var s=this.getReposMetricsData();Viz.displayMetricRepos(e,s,t,n,r,i)},this.displayBasicMetricMyRepos=function(e,t,n,r,i,s){var o={},u=Report.getReposMap(),a=this;$.each(e,function(e,t){var n=a.getReposMetricsData()[t];n||(u[t]instanceof Object?t=u[t][a.getName()]:t=u[t],n=a.getReposMetricsData()[t]),o[t]=n}),Viz.displayMetricRepos(t,o,n,r,i,s)},this.displayMetricDomains=function(e,t,n,r,i){var s=this.getDomainsMetricsData();Viz.displayMetricDomains(e,s,t,n,r,i)},this.displayMetricProjects=function(e,t,n,r,i){var s=this.getProjectsMetricsData();Viz.displayMetricProjects(e,s,t,n,r,i)},this.displayMetricCompaniesStatic=function(e,t,n,r,i){this.displayMetricSubReportStatic("companies",e,t,n,r,i)},this.displayMetricReposStatic=function(e,t,n,r,i){this.displayMetricSubReportStatic("repos",e,t,n,r,i)},this.displayMetricCountriesStatic=function(e,t,n,r,i){this.displayMetricSubReportStatic("countries",e,t,n,r,i)},this.displayMetricDomainsStatic=function(e,t,n,r,i){this.displayMetricSubReportStatic("domains",e,t,n,r,i)},this.displayMetricProjectsStatic=function(e,t,n,r,i){this.displayMetricSubReportStatic("projects",e,t,n,r,i)},this.displayMetricSubReportStatic=function(e,t,n,r,i,s){i===undefined&&(i=t);var o=null;if(e=="companies")o=this.getCompaniesGlobalData();else if(e=="repos")o=this.getReposGlobalData();else if(e=="countries")o=this.getCountriesGlobalData();else if(e=="domains")o=this.getDomainsGlobalData();else{if(e!="projects")return;o=this.getProjectsGlobalData()}if($.isEmptyObject(o))return;var u=DataProcess.sortGlobal(this,i,e);u instanceof Array==0&&(u=u.name),data_page=DataProcess.paginate(u,Report.getCurrentPage()),Viz.displayMetricSubReportStatic(t,o,data_page,n,r)},this.displayMetricsCompany=function(e,t,n,r){var i=this.getCompaniesMetricsData()[e];if(i===undefined){$("#"+n).hide();return}Viz.displayMetricsCompany(this,e,t,i,n,r)},this.displayMetricsRepo=function(e,t,n,r){var i=this.getReposMetricsData()[e];if(i===undefined){$("#"+n).hide();return}Viz.displayMetricsRepo(this,e,t,i,n,r)},this.displayMetricsCountry=function(e,t,n,r){var i=this.getCountriesMetricsData()[e];if(i===undefined){$("#"+n).hide();return}Viz.displayMetricsCountry(this,e,t,i,n,r)},this.displayMetricsDomain=function(e,t,n,r){var i=this.getDomainsMetricsData()[e];if(i===undefined)return;Viz.displayMetricsDomain(this,e,t,i,n,r)},this.displayMetricsProject=function(e,t,n,r){var i=this.getProjectsMetricsData()[e];if(i===undefined)return;Viz.displayMetricsProject(this,e,t,i,n,r)},this.displayMetricsPeople=function(e,t,n,r,i){var s=this.getPeopleMetricsData()[e];if(s===undefined||s instanceof Array){$("#"+r).hide();return}Viz.displayMetricsPeople(this,t,n,s,r,i)},this.displayMetricsEvol=function(e,t,n,r,i){var s;i&&$.inArray(i,this.getReposData())>=0?s=this.getReposMetricsData()[i]:s=this.getData(),r&&(s=DataProcess.convert(s,r,e)),Viz.displayMetricsEvol(this,e,s,t,n,i)},this.isPageDisplayed=function(e,t,n,r){var i=Math.floor((r-3)/2),s=e-i,o=e+i;return t===1||t===n||t==e?!0:t>=s&&t<e?!0:t<=o&&t>e?!0:!1},this.displayItemsNav=function(e,t,n,r){var i=parseInt(n,null);isNaN(i)&&(i=1);var s=null,o="",u=0,a=5;if(t==="companies")s=this.getCompaniesData(),o="List of companies";else if(t==="repos")s=this.getReposData(),r&&(s=DataProcess.sortGlobal(this,r,t));else if(t==="countries")s=this.getCountriesData();else if(t==="domains")s=this.getDomainsData();else{if(t!=="projects")return;s=this.getProjectsData()}u=s.length;var f="",l=Report.getPageSize();if(i){f+="<div class='pagination'>";var c=Math.ceil(u/l),h=(i-1)*l+1,p=i*l;p>u&&(p=u),f+="<ul class='pagination'>",i>1?f+="<li><a href='?page="+(i-1)+"'>&laquo;</a></li>":f+="<li class='disabled'><a href='?page="+i+"'>&laquo;</a></li>";for(var d=0;d*Report.getPageSize()<u;d++)if(this.isPageDisplayed(i,d+1,c,a)===!0)i===d+1?f+="<li class='active'><a href='?page="+(d+1)+"'>"+(d+1)+"</a></li>":f+="<li><a href='?page="+(d+1)+"'>"+(d+1)+"</a></li>";else if(d+1+1===c||d+1-1===1)f+="<li class='disabled'><a href='#'> .. </a></li>";i*Report.getPageSize()<s.length&&(f+="<li><a href='?page="+(parseInt(i,null)+1)+"'>",f+="&raquo;</a></li>"),f+="</ul>",f+="<span class='pagination-text'> ("+h+" - "+p+"/"+u+")</span>",f+="</div>"}Report.getPageSize()>10&&$.each(s,function(e,t){var n=Report.cleanLabel(t);f+="<a href='#"+t+"-nav'>"+n+"</a> "}),$("#"+e).append(f)},this.displayCompaniesLinks=function(e,t,n){var r=DataProcess.sortGlobal(this,n,"companies"),i="",s=0;$.each(r,function(e,n){i+='<a href="company.html?company='+n,Report.addDataDir()&&(i+="&"+Report.addDataDir()),i+='">'+n+"</a>| ";if(s++>=t-1)return!1}),$("#"+e).append(i)},this.displayCompaniesList=function(e,t,n,r,i,s,o,u,a){this.displaySubReportList("companies",e,t,n,r,i,s,o,u,a)},this.displayReposList=function(e,t,n,r,i,s,o,u,a){this.displaySubReportList("repos",e,t,n,r,i,s,o,u,a)},this.displayCountriesList=function(e,t,n,r,i,s,o,u,a){this.displaySubReportList("countries",e,t,n,r,i,s,o,u,a)},this.displayDomainsList=function(e,t,n,r,i,s,o,u,a){this.displaySubReportList("domains",e,t,n,r,i,s,o,u,a)},this.displayProjectsList=function(e,t,n,r,i,s,o,u,a){this.displaySubReportList("projects",e,t,n,r,i,s,o,u,a)},this.displaySubReportList=function(e,t,n,r,i,s,o,u,a,f){var l=parseInt(s,null);isNaN(l)&&(l=1);var c="",h=(l-1)*Report.getPageSize()+1,p=this,d=null,v=null;o===undefined&&(o=!0);if(e==="companies")d=this.getCompaniesMetricsData(),v=DataProcess.sortGlobal(this,i,e);else if(e==="repos")d=this.getReposMetricsData(),v=DataProcess.sortGlobal(this,i,e);else if(e==="countries")d=this.getCountriesMetricsData(),v=DataProcess.sortGlobal(this,i,e);else if(e==="domains")d=this.getDomainsMetricsData(),v=DataProcess.sortGlobal(this,i,e);else{if(e!=="projects")return;d=this.getProjectsMetricsData(),v=DataProcess.sortGlobal(this,i,e)}v=DataProcess.paginate(v,l),c+='<table class="table table-hover table-repositories">',c+="<tr><th></th>",$.each(t,function(e,t){p.getMetrics()[t]?(title=p.getMetrics()[t].name,c+="<th>"+title+"</th>"):c+="<th>"+t+"</th>"}),c+="</tr>",$.each(v,function(n,r){c+="<tr><td class='col-md-2 repository-name'>",c+="#"+h+"&nbsp;",h++;var i=null;Report.addDataDir()&&(i=Report.addDataDir()),o&&(e==="companies"?(c+="<a href='company.html?company="+r,i&&(c+="&"+i),c+="'>"):e==="repos"?(c+="<a href='",c+="repository.html",c+="?repository="+encodeURIComponent(r),i&&(c+="&"+i),c+="'>"):e==="countries"?(c+="<a href='country.html?country="+r,i&&(c+="&"+i),c+="'>"):e==="domains"?(c+="<a href='domain.html?domain="+r,i&&(c+="&"+i),c+="'>"):e==="projects"&&(c+="<a href='project.html?project="+r,i&&(c+="&"+i),c+="'>")),c+="<strong>",c+=Report.cleanLabel(r),c+="</strong>",o&&(c+="</a>"),c+="</td>",$.each(t,function(t,n){c+="<td class='col-md-5'>",c+="<div id='"+e+"-"+r+"-"+n+"'",c+=" class='subreport-list-item'>"}),c+="</td></tr>"}),c+="</table>",$("#"+n).append(c);var m=null,g=null,y=null;u&&(typeof u=="number"?m=[u.toString()]:m=u.split(",")),a&&(typeof a=="number"?g=[a.toString()]:g=a.split(",")),f&&(y=f.split(",")),$.each(v,function(n,i){var s=0;$.each(t,function(t,n){var o=null,u=null,a=null;m&&(m.length==1?o=m[0]:o=m[s]),g&&(g.length==1?u=g[0]:u=g[s]),y&&(a=y[s]);if(i in d==0)return;var f=d[i];if(f[n]===undefined)return;var l=e+"-"+i+"-"+n,c={};c[i]=f;var h="";Viz.displayMetricSubReportLines(l,n,c,h,r,o,u,a),s++})})},this.displayGlobalSummary=function(e){this.displaySummary(null,e,null,this)},this.displayCompanySummary=function(e,t,n){this.displaySummary("companies",e,t,n)},this.displayRepoSummary=function(e,t,n){this.displaySummary("repositories",e,t,n)},this.displayCountrySummary=function(e,t,n){this.displaySummary("countries",e,t,n)},this.displayDomainSummary=function(e,t,n){this.displaySummary("domains",e,t,n)},this.displayProjectSummary=function(e,t,n){this.displaySummary("projects",e,t,n)},this.displayPeopleSummary=function(e,t,n,r){var i=r.getPeopleGlobalData()[t];if(i===undefined||i instanceof Array)return;html="<h6>"+r.getTitle()+"</h6>",html+="<table class='table-condensed table-hover'>",html+="<tr><td>",html+="Start</td><td>"+i.first_date,html+="</td></tr><tr><td>",html+="End</td><td>"+i.last_date,html+="</td></tr><tr><td>",r.getName()=="scm"?html+="Commits</td><td>"+i.scm_commits:r.getName()=="its"?html+="Closed</td><td>"+i.its_closed:r.getName()=="mls"?html+="Sent</td><td>"+i.mls_sent:r.getName()=="irc"?html+="Sent</td><td>"+i.irc_sent:r.getName()=="scr"&&(html+="Closed</td><td>"+i.scr_closed),html+="</td></tr>",html+="</table>",$("#"+e).append(html)},this.displayCompaniesSummary=function(e,t){var n="",r=t.getGlobalData();n+="Total companies: "+r.companies+"<br>",r.companies_2006&&(n+="Companies in 2006: "+r.companies_2006+"<br>"),r.companies_2009&&(n+="Companies in 2009: "+r.companies_2009+"<br>"),r.companies_2012&&(n+="Companies in 2012: "+r.companies_2012+"<br>"),$("#"+e).append(n)},this.getSummaryLabels=function(){},this.getLabelForRepository=function(){return"repository"},this.getLabelForRepositories=function(){return"repositories"},this.displaySummary=function(e,t,n,r){n||(n="");var i="<h6>"+r.getTitle()+"</h6>",s=this.getSummaryLabels(),o=null;e==="companies"?o=r.getCompaniesGlobalData()[n]:e==="countries"?o=r.getCountriesGlobalData()[n]:e==="repositories"?o=r.getReposGlobalData()[n]:e==="domains"?o=r.getDomainsGlobalData()[n]:e==="projects"?o=r.getProjectsGlobalData()[n]:o=r.getGlobalData();if(!o)return;var u=this;i+="<table class='table-condensed table-hover'>";var a="<tr><td>",f="</td></tr>";$.each(o,function(e,t){u.getMetrics()[e]?i+=a+u.getMetrics()[e].name+"</td><td>"+Report.formatValue(t)+f:s[e]&&(i+=a+s[e]+"</td><td>"+Report.formatValue(t)+f)}),i+="</table>",$("#"+t).append(i)},this.displayReposSummary=function(e,t){var n="",r=t.getGlobalData();n+="Total repositories: "+r[t.getName()+"_repositories"]+"<br>",$("#"+e).append(n)},this.displayCountriesSummary=function(e,t){var n="",r=t.getGlobalData();n+="Total countries: "+r[t.getName()+"_countries"]+"<br>",$("#"+e).append(n)},this.displayDomainsSummary=function(e,t){var n="",r=t.getGlobalData();n+="Total domains: "+r.domains+"<br>",$("#"+e).append(n)},this.displayProjectsSummary=function(e,t){var n="",r=t.getGlobalData();n+="Total projects: "+r.projects+"<br>",$("#"+e).append(n)},this.displayDemographics=function(e,t){var n=this.getDemographicsData();Viz.displayDemographicsChart(e,this,n,t)},this.displayTimeToAttention=function(e,t,n,r){n=!0,r="Time to Attention "+t;var i=this.getTimeToAttentionData();if(i instanceof Array)return;Viz.displayTimeToAttention(e,i,t,n,r)},this.displayTimeToFix=function(e,t,n,r){n=!0,r="Time to Fix "+t;var i=this.getTimeToFixData();if(i instanceof Array)return;Viz.displayTimeToFix(e,this.getTimeToFixData(),t,n,r)},this.displayMarkovTable=function(e,t){var n=this.getMarkovTableData();if(n===undefined){Report.log("No Markov data available");return}Viz.displayMarkovTable(e,n,t)},this.displayTop=function(e,t,n,r,i,s,o,u,a,f){t===undefined&&(t=!0);var l=null;Viz.displayTop(e,this,t,n,r,i,null,null,o,u,a,f)},this.displayTopCompany=function(e,t,n,r,i){var s=this.getCompaniesTopData()[e];if(s===undefined)return;var o=this.getMetrics()[n];Viz.displayTopCompany(e,s,t,o,r,i)},this.displayTopGlobal=function(e,t,n,r){Viz.displayTopGlobal(e,this,t,n,r)},this.envisionEvo=function(e,t,n,r,i){config=Report.getVizConfig();var s=Viz.getEnvisionOptions(e,t,this.getName(),Report.getVizConfig()[this.getName()+"_hide"],i);s.legend_show=r,n&&DataProcess.addRelativeValues(s.data,this.getMainMetric()),new envision.templates.Envision_Report(s,[this])},this.displayEnvision=function(e,t,n,r){var i=Report.getProjectsDataSources();this.envisionEvo(e,i,t,n,r)}}function IRC(){var e=this;this.basic_metrics={irc_sent:{divid:"irc_sent",column:"sent",name:"Sent",desc:"Messages sent"},irc_senders:{divid:"irc_senders",column:"senders",name:"Senders",desc:"Messages senders",action:"sent"},irc_repositories:{divid:"irc_repositories",column:"repositories",name:"Repositories",desc:"Number of active repositories"}},this.getMainMetric=function(){return"irc_sent"},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End"};return e},this.getLabelForRepository=function(){return"channel"},this.getLabelForRepositories=function(){return"channels"},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .irc_info").hide();return}var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().irc_url,this.global_data.type&&$(t+" #irc_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #irc_url").attr("href",r),$(t+" #irc_name").text("IRC "+this.global_data.type)):($(t+" #irc_url").attr("href",Report.getProjectData().irc_url),$(t+" #irc_name").text(Report.getProjectData().irc_name),$(t+" #irc_type").text(Report.getProjectData().irc_type));var i=this.getGlobalData();$(t+" #ircFirst").text(i.first_date),$(t+" #ircLast").text(i.last_date),$(t+" #ircSent").text(i.irc_sent),$(t+" #ircRepositories").text(i.irc_repositories),i.repositories===1&&$(t+" #ircRepositories").hide()},this.displayBubbles=function(e,t){},this.getTitle=function(){return"IRC Messages"}}function ITS(){this.basic_metrics={its_opened:{divid:"its_opened",column:"opened",name:"Opened",desc:"Number of opened tickets",envision:{y_labels:!0,show_markers:!0}},its_openers:{divid:"its_openers",column:"openers",name:"Openers",desc:"Unique identities opening tickets",action:"opened",envision:{gtype:"whiskers"}},its_closed:{divid:"its_closed",column:"closed",name:"Closed",desc:"Number of closed tickets"},its_closers:{divid:"its_closers",column:"closers",name:"Closers",desc:"Number of identities closing tickets",action:"closed",envision:{gtype:"whiskers"}},its_changed:{divid:"its_changed",column:"changed",name:"Changed",desc:"Number of changes to the state of tickets"},its_changers:{divid:"its_changers",column:"changers",name:"Changers",desc:"Number of identities changing the state of tickets",action:"changed",envision:{gtype:"whiskers"}},its_companies:{divid:"its_companies",column:"companies",name:"Companies",desc:"Number of active companies"},its_countries:{divid:"its_countries",column:"countries",name:"Countries",desc:"Number of active countries"},its_repositories:{divid:"its_repositories",column:"repositories",name:"Respositories",desc:"Number of active respositories"},its_domains:{divid:"its_domains",column:"domains",name:"Domains",desc:"Number of active domains"}},this.getMainMetric=function(){return"its_opened"},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End",tickets:"Tickets",trackers:"Trackers"};return e},this.getLabelForRepository=function(){return"tracker"},this.getLabelForRepositories=function(){return"trackers"},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .its-info").hide();return}$(t+" #its_type").text(this.global_data.type);var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().its_url,r===undefined&&(r=""),this.global_data.type==="allura"?r=r.replace("rest/",""):this.global_data.type==="github"&&(r=r.replace("api.",""),r=r.replace("repos/","")),$(t+" #its_url").attr("href",r);var i=this.global_data.type.charAt(0).toUpperCase()+this.global_data.type.slice(1);$(t+" #its_name").text(i+" Tickets");var s=this.getGlobalData();$(t+" #itsFirst").text(s.first_date),$(t+" #itsLast").text(s.last_date),$(t+" #itsTickets").text(s.its_opened),$(t+" #itsOpeners").text(s.its_openers),$(t+" #itsRepositories").text(s.its_repositories),s.repositories===1&&$(t+" #itsRepositories").hide()},this.getTitle=function(){return"Tickets"},this.displayBubbles=function(e,t){Viz.displayBubbles(e,"its_opened","its_openers",t)}}function MediaWiki(){var e=this;this.basic_metrics={mediawiki_reviews:{divid:"mediawiki_reviews",column:"reviews",name:"Editions",desc:"Wiki page editions"},mediawiki_authors:{divid:"mediawiki_authors",column:"authors",name:"Editors",desc:"Editors doing editions",action:"reviews"},mediawiki_pages:{divid:"mediawiki_pages",column:"pages",name:"Pages",desc:"Wiki pages"}},this.getMainMetric=function(){return"mediawiki_reviews"},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End"};return e},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .mediawiki_info").hide();return}var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().mediawiki_url,this.global_data.type&&$(t+" #mediawiki_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #mediawiki_url").attr("href",r),$(t+" #mediawiki_name").text("MediaWiki "+this.global_data.type)):($(t+" #mediawiki_url").attr("href",Report.getProjectData().mediawiki_url),$(t+" #mediawiki_name").text(Report.getProjectData().mediawiki_name),$(t+" #mediawiki_type").text(Report.getProjectData().mediawiki_type));var i=this.getGlobalData();$(t+" #mediawikiFirst").text(i.first_date),$(t+" #mediawikiLast").text(i.last_date),$(t+" #mediawikiSent").text(i.mediawiki_reviews)},this.displayBubbles=function(e,t){},this.getTitle=function(){return"MediaWiki Reviews"}}function MLS(){function t(){var e=document.getElementById("form_mls_selector"),t=[];for(var n=0;n<e.elements.length;n++)e.elements[n].checked&&t.push(e.elements[n].value);return localStorage&&localStorage.setItem(i(),JSON.stringify(t)),t}function n(e,t,n,r){var i=Viz.checkBasicConfig(r);for(var s in basic_metrics){var o=basic_metrics[s],u="";i.show_title&&(u=o.name);if($.inArray(o.column,Report.getConfig().mls_hide)>-1)continue;var a="<div class='info-pill m0-box-div flotr2-"+o.column+"'>";a+="<h4>"+o.name+" "+MLS.displayMLSListName(t)+"</h4>",a+="<div id='"+o.divid+"_"+t+"' class='m0-box flotr2-"+o.column+"'></div>",i.show_desc&&(a+="<p>"+o.desc+"</p>"),a+="</div>",$("#"+e).append(a),Viz.displayBasicLinesFile(o.divid+"_"+t,n,o.column,i.show_labels,u)}}function r(){var e=Report.getProjectData();return e.date+"_"+e.project_name}function i(){return r()+"_mls_lists"}function s(){localStorage&&localStorage.length&&localStorage.getItem(i())&&localStorage.removeItem(i())}function o(e){return typeof e.id=="number"&&$.each(e,function(e,t){t=[t]}),e}var e=this;this.basic_metrics={mls_responses:{divid:"mls_responses",column:"responses",name:"Responses",desc:"Number of messages that are responses"},mls_sent:{divid:"mls_sent",column:"sent",name:"Sent",desc:"Number of messages"},mls_senders:{divid:"mls_senders",column:"senders",name:"Senders",desc:"Number of unique message senders",action:"sent"},mls_threads:{divid:"mls_threads",column:"threads",name:"Threads",desc:"Number of messages threads"},mls_companies:{divid:"mls_companies",column:"companies",name:"Companies",desc:"Number of active companies"},mls_countries:{divid:"mls_countries",column:"countries",name:"Countries",desc:"Number of active countries"},mls_repositories:{divid:"mls_repositories",column:"repositories",name:"Respositories",desc:"Number of active respositories"},mls_domains:{divid:"mls_domains",column:"domains",name:"Domains",desc:"Number of active domains"}},this.data_lists_file=this.data_dir+"/mls-lists.json",this.getListsFile=function(){return this.data_lists_file},this.data_lists=null,this.getListsData=function(){return this.data_lists},this.setListsData=function(e,t){t===undefined&&(t=this),t.data_lists=e},this.setDataDir=function(e){this.data_dir=e,this.data_lists_file=this.data_dir+"/mls-lists.json",MLS.prototype.setDataDir.call(this,e)},this.getMainMetric=function(){return"mls_sent"},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End"};return e},this.getLabelForRepository=function(){return"mailing list"},this.getLabelForRepositories=function(){return"mailing lists"},this.displayData=function(e){var t="#"+e,n=this.global_data.url;(!n||n.length===0)&&$(t+" .mls_info").hide();var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().mls_url,this.global_data.type&&$(t+" #mls_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #mls_url").attr("href",r),$(t+" #mls_name").text("MLS "+this.global_data.type)):($(t+" #mls_url").attr("href",Report.getProjectData().mls_url),$(t+" #mls_name").text(Report.getProjectData().mls_name),$(t+" #mls_type").text(Report.getProjectData().mls_type));var i=this.getGlobalData();$(t+" #mlsFirst").text(i.first_date),$(t+" #mlsLast").text(i.last_date),$(t+" #mlsMessages").text(i.mls_sent),$(t+" #mlsSenders").text(i.mls_senders),$(t+" #mlsRepositories").text(i.mls_repositories),i.repositories===1&&$(t+" #mlsRepositories").hide()},this.displayBubbles=function(e,t){Viz.displayBubbles(e,"mls_sent","mls_senders",t)},MLS.displayMLSListName=function(e){var t=e.split("_"),n="";return t.length>1?(n=t[t.length-1],n===""&&(n=t[t.length-2])):(n=e.replace("<",""),n=n.replace(">",""),t=n.split("."),n=t[0]),n},this.displayBasicUserAll=function(e,t){var n=document.getElementById("form_mls_selector");for(var r=0;r<n.elements.length;r++)n.elements[r].type=="checkbox"&&(n.elements[r].checked=t);this.displayBasicUser(e)},this.displayBasicUser=function(e){$("#"+e).empty(),lists=t();for(var r=0;r<lists.length;r++){var i=lists[r];file_messages=this.getDataDir()+"/mls-",file_messages+=i,file_messages+="-evolutionary.json",n(e,i,file_messages)}},this.displayBasic=function(e,t){var r=this.getListsData
();lists_hide=Report.getConfig().mls_hide_lists,r=r.mailing_list;if(r===undefined)return null;var s=!1;typeof r=="string"&&(r=[r]),localStorage&&localStorage.length&&localStorage.getItem(i())&&(r=JSON.parse(localStorage.getItem(i())),s=!0);for(var o=0;o<r.length;o++){var u=r[o];if(!s&&$.inArray(u,lists_hide)>-1)continue;file_messages=this.getDataDir()+"/mls-",file_messages+=u,file_messages+="-evolutionary.json",n(e,u,file_messages,t)}},this.getTitle=function(){return"Mailing Lists"},this.displayEvoListsMain=function(e){if(localStorage&&localStorage.length&&localStorage.getItem(i()))return lists=JSON.parse(localStorage.getItem(i())),this.displayEvoLists(e,lists);history=this.getListsData(),lists=history.mailing_list;if(lists===undefined)return;var t=Report.getConfig();lists_hide=t.mls_hide_lists,typeof lists=="string"&&(lists=[lists]);var n=[];for(var r=0;r<lists.length;r++)$.inArray(lists[r],lists_hide)==-1&&n.push(lists[r]);localStorage&&(localStorage.getItem(i())||localStorage.setItem(i(),JSON.stringify(n))),this.displayEvoLists(e,n)},this.getDefaultLists=function(){var e=[],t=Report.getConfig().mls_hide_lists;return $.each(this.getListsData().mailing_list,function(n,r){$.inArray(r,t)===-1&&e.push(r)}),e},this.displaySelectorCheckDefault=function(){var e=this.getDefaultLists(),t=document.getElementById("form_mls_selector");for(var n=0;n<t.elements.length;n++)if(t.elements[n].type=="checkbox"){var r=t.elements[n].id;l=r.split("_check")[0],$.inArray(l,e)>-1?t.elements[n].checked=!0:t.elements[n].checked=!1}},this.displayBasicDefault=function(t){var n=e;this instanceof MLS&&(n=this),s(),n.displaySelectorCheckDefault(),$("#"+t).empty(),n.displayBasic(t)},this.displayEvoDefault=function(t){var n=e;this instanceof MLS&&(n=this),s(),document.getElementById("form_mls_selector")&&n.displaySelectorCheckDefault(),$("#"+t).empty(),n.displayEvoLists(t,n.getDefaultLists())},this.displayEvoUserAll=function(e,t){var n=document.getElementById("form_mls_selector");for(var r=0;r<n.elements.length;r++)n.elements[r].type=="checkbox"&&(n.elements[r].checked=t);this.displayEvoUser(e)},this.displayEvoUser=function(n){$("#"+n).empty();var r=e;this instanceof MLS&&(r=this),r.displayEvoLists(n,t())},this.displayEvoListSelector=function(e,t){this.displayEvoBasicListSelector(e,t,null)},this.displayBasicListSelector=function(e,t){this.displayEvoBasicListSelector(e,null,t)},this.displayEvoBasicListSelector=function(e,t,n){var r=this.getListsData(),s=r.mailing_list,o=[];if(s===undefined)return;localStorage&&localStorage.length&&localStorage.getItem(i())&&(o=JSON.parse(localStorage.getItem(i()))),Report.displayBasicUser=this.displayBasicUser,Report.displayBasicUserAll=this.displayBasicUserAll,Report.displayBasicDefault=this.displayBasicDefault,Report.displayEvoDefault=this.displayEvoDefault,Report.displayEvoUser=this.displayEvoUser,Report.displayEvoUserAll=this.displayEvoUserAll;var u="Mailing list selector:";u+="<form id='form_mls_selector'>",typeof s=="string"&&(s=[s]);for(var a=0;a<s.length;a++){var f=s[a];u+='<input type=checkbox name="check_list" value="'+f+'" ',u+='onClick="',t&&(u+="Report.displayEvoUser('"+t+"');"),n&&(u+="Report.displayBasicUser('"+n+"')\";"),u+='" ',u+='id="'+f+'_check" ',$.inArray(f,o)>-1&&(u+="checked "),u+=">",u+=MLS.displayMLSListName(f),u+="<br>"}u+='<input type=button value="All" ',u+='onClick="',t&&(u+="Report.displayEvoUserAll('"+t+"',true);"),n&&(u+="Report.displayBasicUserAll('"+n+"',true);"),u+='">',u+='<input type=button value="None" ',u+='onClick="',t&&(u+="Report.displayEvoUserAll('"+t+"',false);"),n&&(u+="Report.displayBasicUserAll('"+n+"',false);"),u+='">',u+='<input type=button value="Default" ',u+='onClick="',t&&(u+="Report.displayEvoDefault('"+t+"');"),n&&(u+="Report.displayBasicDefault('"+n+"')"),u+='">',u+="</form>",$("#"+e).html(u),Report.getProjectsList().length>1&&($("#"+e).append("Not supported in multiproject"),$("#"+e+" :input").attr("disabled",!0))},this.displayEvoLists=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];file_messages=this.getDataDir()+"/mls-",file_messages+=r,file_messages+="-evolutionary.json",this.displayEvoList(MLS.displayMLSListName(r),e,file_messages)}},this.displayEvoList=function(e,t,n){var r=this;$.getJSON(n,function(n){r.envisionEvoList(e,t,n)})},this.envisionEvoList=function(e,t,n){var r=Report.getConfig(),i=Viz.getEnvisionOptionsMin(t,n,r.mls_hide);i.data.list_label=MLS.displayMLSListName(e),new envision.templates.Envision_Report(i,[this])}}function SCM(){this.basic_metrics={scm_commits:{divid:"scm_commits",column:"commits",name:"Commits",desc:"Evolution of the number of commits (aggregating branches)",envision:{y_labels:!0,show_markers:!0}},scm_committers:{divid:"scm_committers",column:"committers",name:"Committers",desc:"Unique committers making changes to the source code",action:"commits",envision:{gtype:"whiskers"}},scm_authors:{divid:"scm_authors",column:"authors",name:"Authors",desc:"Unique authors making changes to the source code",action:"commits",envision:{gtype:"whiskers"}},scm_branches:{divid:"scm_branches",column:"branches",name:"Branches",desc:"Evolution of the number of branches"},scm_files:{divid:"scm_files",column:"files",name:"Files",desc:"Evolution of the number of unique files handled by the community"},scm_added_lines:{divid:"scm_added_lines",column:"added_lines",name:"Lines Added",desc:"Evolution of the source code lines added"},scm_removed_lines:{divid:"scm_removed_lines",column:"removed_lines",name:"Lines Removed",desc:"Evolution of the source code lines removed"},scm_repositories:{divid:"scm_repositories",column:"repositories",name:"Repositories",desc:"Evolution of the number of repositories",envision:{gtype:"whiskers"}},scm_companies:{divid:"scm_companies",column:"companies",name:"Companies",desc:"Number of active companies"},scm_countries:{divid:"scm_countries",column:"countries",name:"Countries",desc:"Number of active countries"},scm_domains:{divid:"scm_domains",column:"domains",name:"Domains",desc:"Number of active domains"}},this.getMainMetric=function(){return"scm_commits"},this.setITS=function(e){this.its=e},this.getITS=function(e){return this.its},this.getTitle=function(){return"Source Code Management"},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End"};return e},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .scm-info").hide();return}var r=this.global_data.type.charAt(0).toUpperCase()+this.global_data.type.slice(1);$(t+" #scm_type").text(r);var i="";this.global_data.repositories===1?i=this.global_data.url:i=Report.getProjectData().scm_url,this.global_data.type==="git"&&i&&(i=i.replace("git://","http://")),$(t+" #scm_url").attr("href",i),$(t+" #scm_name").text(r);var s=this.getGlobalData();$(t+" #scmFirst").text(s.first_date),$(t+" #scmLast").text(s.last_date),$(t+" #scmCommits").text(s.scm_commits),$(t+" #scmAuthors").text(s.scm_authors),s.reviewers&&$(t+" #scmReviewers").text(s.scm_reviewers),$(t+" #scmCommitters").text(s.scm_committers),$(t+" #scmRepositories").text(s.scm_repositories),s.repositories===1&&$(t+" #scmRepositories").hide()},this.displayBubbles=function(e,t){Viz.displayBubbles(e,"scm_commits","scm_committers",t)}}function SCR(){var e=this;this.basic_metrics={scr_opened:{divid:"scr_opened",column:"opened",name:"Reviews opened",desc:"Reviews in status new or inprogress"},scr_closed:{divid:"scr_closed",column:"closed",name:"Reviews closed",desc:"Reviews merged or abandoned"},scr_merged:{divid:"scr_merged",column:"merged",name:"Reviews merged",desc:"Reviews merged"},scr_mergers:{divid:"scr_mergers",column:"mergers",name:"Reviews mergers",action:"merged",desc:"People merging reviews"},scr_new:{divid:"scr_new",column:"new",name:"Reviews new",desc:"Reviews in status new"},scr_abandoned:{divid:"scr_abandoned",column:"abandoned",name:"Reviews abandoned",desc:"Reviews abandoned"},scr_pending:{divid:"scr_pending",column:"pending",name:"Reviews pending",desc:"Reviews pending to be attended"},scr_review_time_days_avg:{divid:"scr_review_time_days_avg",column:"review_time_days_avg",name:"Average review time",desc:"Average review time in days"},scr_verified:{divid:"scr_verified",column:"verified",name:"Patches verified",desc:"Patches verified"},scr_approved:{divid:"scr_approved",column:"approved",name:"Patches approved",desc:"Patches approved"},scr_codereview:{divid:"scr_codereview",column:"codereview",name:"Patches codereview",desc:"Patches in code review process"},scr_WaitingForReviewer:{divid:"scr_WaitingForReviewer",column:"WaitingForReviewer",name:"Patches waiting reviewer",desc:"Patches waiting for reviewer"},scr_WaitingForSubmitter:{divid:"scr_WaitingForSubmitter",column:"WaitingForSubmitter",name:"Patches waiting submitter",desc:"Patches waiting for a new version"},scr_submitted:{divid:"scr_submitted",column:"submitted",name:"Reviews submitted",desc:"Reviews submitted"},scr_submitters:{divid:"scr_submitters",column:"submitters",name:"Reviews submitters",desc:"Number of people submitting review processes."},scr_sent:{divid:"scr_sent",column:"sent",name:"Patches Sent",desc:"Patches sent"},scr_companies:{divid:"scr_companies",column:"companies",name:"Companies",desc:"Number of active companies"},scr_countries:{divid:"scr_countries",column:"countries",name:"Countries",desc:"Number of active countries"},scr_repositories:{divid:"scr_repositories",column:"repositories",name:"Respositories",desc:"Number of active respositories"},scr_closers:{divid:"scr_closers",column:"closers",name:"Closers",desc:"Reviews closers",action:"closed"},scr_openers:{divid:"scr_openers",column:"openers",name:"Openers",desc:"Reviews openers",action:"opened"},scr_reviewers:{divid:"scr_reviewers",column:"reviewers",name:"Reviewers",desc:"Number of people reviewing contributions"}},this.getMainMetric=function(){return"scr_merged"},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End",review_time_pending_ReviewsWaitingForReviewer_days_avg:"Review Time for reviewers (days, avg)",review_time_pending_ReviewsWaitingForReviewer_days_median:"Review Time for reviewers (days, median)",review_time_pending_update_ReviewsWaitingForReviewer_days_avg:"Update time for reviewers (days, avg)",review_time_pending_update_ReviewsWaitingForReviewer_days_median:"Update time for reviewers (days, avg)",review_time_pending_days_avg:"Review time (days, avg)",review_time_pending_days_median:"Review time (days, median)",review_time_pending_update_days_avg:"Update time (days, avg)",review_time_pending_update_days_median:"Update time (days, median)"};return e},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .scr_info").hide();return}var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().scr_url,this.global_data.type&&$(t+" #scr_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #scr_url").attr("href",r),$(t+" #scr_name").text("SCR "+this.global_data.type)):($(t+" #scr_url").attr("href",Report.getProjectData().mls_url),$(t+" #scr_name").text(Report.getProjectData().scr_name),$(t+" #scr_type").text(Report.getProjectData().scr_type));var i=this.getCompanyQuery(),s=this.getGlobalData();i&&(s=this.getCompaniesGlobalData()[i]),$(t+" #scrFirst").text(s.first_date),$(t+" #scrLast").text(s.last_date),$(t+" #scrReviews").text(s.scr_opened)},this.displayBubbles=function(e,t){},SCR.displaySCRListName=function(e){var t=e.split("_"),n="";return t.length>1?(n=t[t.length-1],n===""&&(n=t[t.length-2])):(n=e.replace("<",""),n=n.replace(">",""),t=n.split("."),n=t[0]),n},this.getTitle=function(){return"Source Code Review"}}function People(){this.basic_metrics={people_members:{column:"members",name:"Members",desc:"Community Members"}},this.getMainMetric=function(){return"people_members"},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .mediawiki_info").hide();return}var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().mediawiki_url,this.global_data.type&&$(t+" #mediawiki_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #mediawiki_url").attr("href",r),$(t+" #mediawiki_name").text("MediaWiki "+this.global_data.type)):($(t+" #mediawiki_url").attr("href",Report.getProjectData().mediawiki_url),$(t+" #mediawiki_name").text(Report.getProjectData().mediawiki_name),$(t+" #mediawiki_type").text(Report.getProjectData().mediawiki_type));var i=this.getGlobalData();$(t+" #mediawikiFirst").text(i.first_date),$(t+" #mediawikiLast").text(i.last_date),$(t+" #mediawikiSent").text(i.mediawiki_reviews)},this.displayBubbles=function(e,t){},this.getTitle=function(){return"Community Members"}}function Downloads(){var e=this;this.basic_metrics={downloads_downloads:{name:"Total downloads",column:"downloads"},downloads_packages:{divid:"",column:"packages",name:"Packages downloaded",desc:"",action:"downloads"},downloads_ips:{divid:"",column:"ips",name:"IP addresses",desc:"",action:"downloads"}},this.getMainMetric=function(){return"downloads_downloads"},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .irc_info").hide();return}var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().irc_url,this.global_data.type&&$(t+" #irc_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #irc_url").attr("href",r),$(t+" #irc_name").text("IRC "+this.global_data.type)):($(t+" #irc_url").attr("href",Report.getProjectData().irc_url),$(t+" #irc_name").text(Report.getProjectData().irc_name),$(t+" #irc_type").text(Report.getProjectData().irc_type));var i=this.getGlobalData();$(t+" #ircFirst").text(i.first_date),$(t+" #ircLast").text(i.last_date),$(t+" #ircSent").text(i.irc_sent),$(t+" #ircRepositories").text(i.irc_repositories),i.repositories===1&&$(t+" #ircRepositories").hide()},this.displayBubbles=function(e,t){},this.getTitle=function(){return"Downloads"}}function QAForums(){var e=this;this.basic_metrics={qaforums_sent:{name:"Messages posted",desc:"Number of messages posted to Q&A forums(s)",column:"sent"},qaforums_qsent:{name:"Questions posted",desc:"Number of questions posted to Q&A forums(s)",column:"qsent"},qaforums_asent:{name:"Answers posted",desc:"Number of answers posted to Q&A forums(s)",column:"asent"},qaforums_senders:{name:"Persons posting messages",desc:"Number of persons posting messages to Q&A forums(s)",column:"senders"},qaforums_asenders:{name:"Persons posting answers",desc:"Number of persons answering in Q&A forums(s)",column:"asenders"},qaforums_qsenders:{divid:"qaforums_qsenders",name:"Persons posting questions",desc:"Number of persons asking questions in Q&A forums(s)",column:"qsenders"},qaforums_participants:{name:"Participants",desc:"Number of persons posting messages",column:"participants"}},this.getMainMetric=function(){return"qaforums_qsent"},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .irc_info").hide();return}var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().irc_url,this.global_data.type&&$(t+" #irc_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #irc_url").attr("href",r),$(t+" #irc_name").text("IRC "+this.global_data.type)):($(t+" #irc_url").attr("href",Report.getProjectData().irc_url),$(t+" #irc_name").text(Report.getProjectData().irc_name),$(t+" #irc_type").text(Report.getProjectData().irc_type));var i=this.getGlobalData();$(t+" #ircFirst").text(i.first_date),$(t+" #ircLast").text(i.last_date),$(t+" #ircSent").text(i.irc_sent),$(t+" #ircRepositories").text(i.irc_repositories),i.repositories===1&&$(t+" #ircRepositories").hide()},this.displayBubbles=function(e,t){},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End",sent:"Messages posted",qsent:"Questions posted",asent:"Answers posted",senders:"Persons posting messages",asenders:"Persons posting answers",qsenders:"Persons posting questions"};return e},this.getTitle=function(){return"QAForums"}}function Releases(){var e=this;this.basic_metrics={releases_modules:{name:"Modules created",desc:"Number of modules created on the forge",column:"modules"}},this.getMainMetric=function(){return"releases_modules"},this.displayData=function(e){var t="#"+e,n=this.global_data.url;if(!n||n.length===0){$(t+" .irc_info").hide();return}var r="";this.global_data.repositories===1?r=this.global_data.url:r=Report.getProjectData().irc_url,this.global_data.type&&$(t+" #irc_type").text(this.global_data.type),this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined?($(t+" #irc_url").attr("href",r),$(t+" #irc_name").text("IRC "+this.global_data.type)):($(t+" #irc_url").attr("href",Report.getProjectData().irc_url),$(t+" #irc_name").text(Report.getProjectData().irc_name),$(t+" #irc_type").text(Report.getProjectData().irc_type));var i=this.getGlobalData();$(t+" #ircFirst").text(i.first_date),$(t+" #ircLast").text(i.last_date),$(t+" #ircSent").text(i.irc_sent),$(t+" #ircRepositories").text(i.irc_repositories),i.repositories===1&&$(t+" #ircRepositories").hide()},this.displayBubbles=function(e,t){},this.getSummaryLabels=function(){var e={first_date:"Start",last_date:"End",modules:"Modules created",releases:"Module releases created",authors:"Persons creating/updating modules"};return e},this.getTitle=function(){return"Releases"}}(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.slice,u=r.unshift,a=i.toString,f=i.hasOwnProperty,l=r.forEach,c=r.map,h=r.reduce,p=r.reduceRight,d=r.filter,v=r.every,m=r.some,g=r.indexOf,y=r.lastIndexOf,b=Array.isArray,w=Object.keys,E=s.bind,S=function(e){return new k(e)};typeof module!="undefined"&&module.exports?(module.exports=S,S._=S):e._=S,S.VERSION="1.1.7";var x=S.each=S.forEach=function(e,t,r){if(e==null)return;if(l&&e.forEach===l)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&t.call(r,e[i],i,e)===n)return}else for(var o in e)if(f.call(e,o)&&t.call(r,e[o],o,e)===n)return};S.map=function(e,t,n){var r=[];return e==null?r:c&&e.map===c?e.map(t,n):(x(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},S.reduce=S.foldl=S.inject=function(e,t,n,r){var i=n!==void 0;e==null&&(e=[]);if(h&&e.reduce===h)return r&&(t=S.bind(t,r)),i?e.reduce(t,n):e.reduce(t);x(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},S.reduceRight=S.foldr=function(e,t,n,r){e==null&&(e=[]);if(p&&e.reduceRight===p)return r&&(t=S.bind(t,r)),n!==void 0?e.reduceRight(t,n):e.reduceRight(t);var i=(S.isArray(e)?e.slice():S.toArray(e)).reverse();return S.reduce(i,t,n,r)},S.find=S.detect=function(e,t,n){var r;return T(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},S.filter=S.select=function(e,t,n){var r=[];return e==null?r:d&&e.filter===d?e.filter(t,n):(x(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},S.reject=function(e,t,n){var r=[];return e==null?r:(x(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},S.every=S.all=function(e,t,r){var i=!0;return e==null?i:v&&e.every===v?e.every(t,r):(x(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),i)};var T=S.some=S.any=function(e,t,r){t=t||S.identity;var i=!1;return e==null?i:m&&e.some===m?e.some(t,r):(x(e,function(e,s,o){if(i|=t.call(r,e,s,o))return n}),!!i)};S.include=S.contains=function(e,t){var n=!1;return e==null?n:g&&e.indexOf===g?e.indexOf(t)!=-1:(T(e,function(e){if(n=e===t)return!0}),n)},S.invoke=function(e,t){var n=o.call(arguments,2);return S.map(e,function(e){return(t.call?t||e:e[t]).apply(e,n)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.max=function(e,t,n){if(!t&&S.isArray(e))return Math.max.apply(Math,e);var r={computed:-Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},S.min=function(e,t,n){if(!t&&S.isArray(e))return Math.min.apply(Math,e);var r={computed:Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},S.sortBy=function(e,t,n){return S.pluck(S.map(e,function(e,r,i){return{value:e,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}),"value")},S.groupBy=function(e,t){var n={};return x(e,function(e,r){var i=t(e,r);(n[i]||(n[i]=[])).push(e)}),n},S.sortedIndex=function(e,t,n){n||(n=S.identity);var r=0,i=e.length;while(r<i){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r},S.toArray=function(e){return e?e.toArray?e.toArray():S.isArray(e)?o.call(e):S.isArguments(e)?o.call(e):S.values(e):[]},S.size=function(e){return S.toArray(e).length},S.first=S.head=function(e,t,n){return t!=null&&!n?o.call(e,0,t):e[0]},S.rest=S.tail=function(e,t,n){return o.call(e,t==null||n?1:t)},S.last=function(e){return e[e.length-1]},S.compact=function(e){return S.filter(e,function(e){return!!e})},S.flatten=function(e){return S.reduce(e,function(e,t){return S.isArray(t)?e.concat(S.flatten(t)):(e[e.length]=t,e)},[])},S.without=function(e){return S.difference(e,o.call(arguments,1))},S.uniq=S.unique=function(e,t){return S.reduce(e,function(e,n,r){if(0==r||(t===!0?S.last(e)!=n:!S.include(e,n)))e[e.length]=n;return e},[])},S.union=function(){return S.uniq(S.flatten(arguments))},S.intersection=S.intersect=function(e){var t=o.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e,t){return S.filter(e,function(e){return!S.include(t,e)})},S.zip=function(){var e=o.call(arguments),t=S.max(S.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=S.pluck(e,""+r);return n},S.indexOf=function(e,t,n){if(e==null)return-1;var r,i;if(n)return r=S.sortedIndex(e,t),e[r]===t?r:-1;if(g&&e.indexOf===g)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},S.lastIndexOf=function(e,t){if(e==null)return-1;if(y&&e.lastIndexOf===y)return e.lastIndexOf(t);var n=e.length;while(n--)if(e[n]===t)return n;return-1},S.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s},S.bind=function(e,t){if(e.bind===E&&E)return E.apply(e,o.call(arguments,1));var n=o.call(arguments,2);return function(){return e.apply(t,n.concat(o.call(arguments)))}},S.bindAll=function(e){var t=o.call(arguments,1);return t.length==0&&(t=S.functions(e)),x(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var n={};return t||(t=S.identity),function(){var r=t.apply(this,arguments);return f.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}},S.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(e,n)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(o.call(arguments,1)))};var N=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,e.apply(i,s)};n&&clearTimeout(r);if(n||!r)r=setTimeout(o,t)}};S.throttle=function(e,t){return N(e,t,!1)},S.debounce=function(e,t){return N(e,t,!0)},S.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments))}},S.wrap=function(e,t){return function(){var n=[e].concat(o.call(arguments));return t.apply(this,n)}},S.compose=function(){var e=o.call(arguments);return function(){var t=o.call(arguments);for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},S.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},S.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)f.call(e,n)&&(t[t.length]=n);return t},S.values=function(e){return S.map(e,S.identity)},S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()},S.extend=function(e){return x(o.call(arguments,1),function(t){for(var n in t)t[n]!==void 0&&(e[n]=t[n])}),e},S.defaults=function(e){return x(o.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},S.clone=function(e){return S.isArray(e)?e.slice():S.extend({},e)},S.tap=function(e,t){return t(e),e},S.isEqual=function(e,t){if(e===t)return!0;var n=typeof e,r=typeof t;if(n!=r)return!1;if(e==t)return!0;if(!e&&t||e&&!t)return!1;e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual)return e.isEqual(t);if(t.isEqual)return t.isEqual(e);if(S.isDate(e)&&S.isDate(t))return e.getTime()===t.getTime();if(S.isNaN(e)&&S.isNaN(t))return!1;if(S.isRegExp(e)&&S.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline;if(n!=="object")return!1;if(e.length&&e.length!==t.length)return!1;var i=S.keys(e),s=S.keys(t);if(i.length!=s.length)return!1;for(var o in e)if(!(o in t)||!S.isEqual(e[o],t[o]))return!1;return!0},S.isEmpty=function(e){if(S.isArray(e)||S.isString(e))return e.length===0;for(var t in e)if(f.call(e,t))return!1;return!0},S.isElement=function(e){return!!e&&e.nodeType==1},S.isArray=b||function(e){return a.call(e)==="[object Array]"},S.isObject=function(e){return e===Object(e)},S.isArguments=function(e){return!!e&&!!f.call(e,"callee")},S.isFunction=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},S.isString=function(e){return!!(e===""||e&&e.charCodeAt&&e.substr)},S.isNumber=function(e){return!!(e===0||e&&e.toExponential&&e.toFixed)},S.isNaN=function(e){return e!==e},S.isBoolean=function(e){return e===!0||e===!1},S.isDate=function(e){return!!(e&&e.getTimezoneOffset&&e.setUTCFullYear)},S.isRegExp=function(e){return!(!(e&&e.test&&e.exec)||!e.ignoreCase&&e.ignoreCase!==!1)},S.isNull=function(e){return e===null},S.isUndefined=function(e){return e===void 0},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},S.mixin=function(e){x(S.functions(e),function(t){A(t,S[t]=e[t])})};var C=0;S.uniqueId=function(e){var t=C++;return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},S.template=function(e,t){var n=S.templateSettings,r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(n.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=new Function("obj",r);return t?i(t):i};var k=function(e){this._wrapped=e};S.prototype=k.prototype;var L=function(e,t){return t?S(e).chain():e},A=function(e,t){k.prototype[e]=function(){var e=o.call(arguments);return u.call(e,this._wrapped),L(t.apply(S,e),this._chain)}};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];k.prototype[e]=function(){return t.apply(this._wrapped,arguments),L(this._wrapped,this._chain)}}),x(["concat","join","slice"],function(e){var t=r[e];k.prototype[e]=function(){return L(t.apply(this._wrapped,arguments),this._chain)}}),k.prototype.chain=function(){return this._chain=!0,this},k.prototype.value=function(){return this._wrapped}})(),!function(e,t,n){typeof module!="undefined"?module.exports=n(e,t):typeof define=="function"&&typeof define.amd=="object"?define(n):t[e]=n(e,t)}("bean",this,function(e,t){var n=window,r=t[e],i=/over|out/,s=/[^\.]*(?=\..*)\.|.*/,o=/\..*/,u="addEventListener",a="attachEvent",f="removeEventListener",l="detachEvent",c=document||{},h=c.documentElement||{},p=h[u],d=p?u:a,v=Array.prototype.slice,m=/click|mouse|menu|drag|drop/i,g=/^touch|^gesture/i,y={one:1},b=function(e,t,n){for(n=0;n<t.length;n++)e[t[n]]=1;return e}({},("click dblclick mouseup mousedown contextmenu mousewheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange focus blur change reset select submit load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll "+(p?"show input invalid touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend message readystatechange pageshow pagehide popstate hashchange offline online afterprint beforeprint dragstart dragenter dragover dragleave drag drop dragend loadstart progress suspend emptied stalled loadmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange volumechange cuechange checking noupdate downloading cached updateready obsolete ":"")).split(" ")),w=function(){function e(e,t){while((t=t.parentNode)!==null)if(t===e)return!0;return!1}function t(t){var n=t.relatedTarget;return n?n!==this&&n.prefix!=="xul"&&!/document/.test(this.toString())&&!e(this,n):n===null}return{mouseenter:{base:"mouseover",condition:t},mouseleave:{base:"mouseout",condition:t},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}}(),E=function(){var e="altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which".split(" "),t=e.concat("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" ")),n=e.concat("char charCode key keyCode".split(" ")),r=e.concat("touches targetTouches changedTouches scale rotation".split(" ")),s="preventDefault",o=function(e){return function(){e[s]?e[s]():e.returnValue=!1}},u="stopPropagation",a=function(e){return function(){e[u]?e[u]():e.cancelBubble=!0}},f=function(e){return function(){e[s](),e[u](),e.stopped=!0}},l=function(e,t,n){var r,i;for(r=n.length;r--;)i=n[r],!(i in t)&&i in e&&(t[i]=e[i])};return function(p,d){var v={originalEvent:p,isNative:d};if(!p)return v;var y,b=p.type,w=p.target||p.srcElement;v[s]=o(p),v[u]=a(p),v.stop=f(v),v.target=w&&w.nodeType===3?w.parentNode:w;if(d){if(b.indexOf("key")!==-1)y=n,v.keyCode=p.which||p.keyCode;else if(m.test(b)){y=t,v.rightClick=p.which===3||p.button===2,v.pos={x:0,y:0};if(p.pageX||p.pageY)v.clientX=p.pageX,v.clientY=p.pageY;else if(p.clientX||p.clientY)v.clientX=p.clientX+c.body.scrollLeft+h.scrollLeft,v.clientY=p.clientY+c.body.scrollTop+h.scrollTop;i.test(b)&&(v.relatedTarget=p.relatedTarget||p[(b==="mouseover"?"from":"to")+"Element"])}else g.test(b)&&(y=r);l(p,v,y||e)}return v}}(),S=function(e,t){return!p&&!t&&(e===c||e===n)?h:e},x=function(){function e(e,t,n,r,i){this.element=e,this.type=t,this.handler=n,this.original=r,this.namespaces=i,this.custom=w[t],this.isNative=b[t]&&e[d],this.eventType=p||this.isNative?t:"propertychange",this.customType=!p&&!this.isNative&&t,this.target=S(e,this.isNative),this.eventSupport=this.target[d]}return e.prototype={inNamespaces:function(e){var t,n;if(!e)return!0;if(!this.namespaces)return!1;for(t=e.length;t--;)for(n=this.namespaces.length;n--;)if(e[t]===this.namespaces[n])return!0;return!1},matches:function(e,t,n){return this.element===e&&(!t||this.original===t)&&(!n||this.handler===n)}},e}(),T=function(){var e={},t=function(n,r,i,s,o){if(!r||r==="*")for(var u in e)u.charAt(0)==="$"&&t(n,u.substr(1),i,s,o);else{var a=0,f,l=e["$"+r],c=n==="*";if(!l)return;for(f=l.length;a<f;a++)if(c||l[a].matches(n,i,s))if(!o(l[a],l,a,r))return}},n=function(t,n,r){var i,s=e["$"+n];if(s)for(i=s.length;i--;)if(s[i].matches(t,r,null))return!0;return!1},r=function(e,n,r){var i=[];return t(e,n,r,null,function(e){return i.push(e)}),i},i=function(t){return(e["$"+t.type]||(e["$"+t.type]=[])).push(t),t},s=function(n){t(n.element,n.type,null,n.handler,function(t,n,r){return n.splice(r,1),n.length===0&&delete e["$"+t.type],!1})},o=function(){var t,n=[];for(t in e)t.charAt(0)==="$"&&(n=n.concat(e[t]));return n};return{has:n,get:r,put:i,del:s,entries:o}}(),N=p?function(e,t,n,r){e[r?u:f](t,n,!1)}:function(e,t,n,r,i){i&&r&&e["_on"+i]===null&&(e["_on"+i]=0),e[r?a:l]("on"+t,n)},C=function(e,t,r){return function(i){return i=E(i||((this.ownerDocument||this.document||this).parentWindow||n).event,!0),t.apply(e,[i].concat(r))}},k=function(e,t,r,i,s,o){return function(u){if(i?i.apply(this,arguments):p?!0:u&&u.propertyName==="_on"+r||!u)u&&(u=E(u||((this.ownerDocument||this.document||this).parentWindow||n).event,o)),t.apply(e,u&&(!s||s.length===0)?arguments:v.call(arguments,u?0:1).concat(s))}},L=function(e,t,n,r,i){return function(){e(t,n,i),r.apply(this,arguments)}},A=function(e,t,n,r){var i,s,u,a=t&&t.replace(o,""),f=T.get(e,a,n);for(i=0,s=f.length;i<s;i++)f[i].inNamespaces(r)&&((u=f[i]).eventSupport&&N(
u.target,u.eventType,u.handler,!1,u.type),T.del(u))},O=function(e,t,n,r,i){var u,a=t.replace(o,""),f=t.replace(s,"").split(".");if(T.has(e,a,n))return e;a==="unload"&&(n=L(A,e,a,n,r)),w[a]&&(w[a].condition&&(n=k(e,n,a,w[a].condition,!0)),a=w[a].base||a),u=T.put(new x(e,a,n,r,f[0]&&f)),u.handler=u.isNative?C(e,u.handler,i):k(e,u.handler,a,!1,i,!1),u.eventSupport&&N(u.target,u.eventType,u.handler,!0,u.customType)},M=function(e,t,n){return function(r){var i,s,o=typeof e=="string"?n(e,this):e;for(i=r.target;i&&i!==this;i=i.parentNode)for(s=o.length;s--;)if(o[s]===i)return t.apply(i,arguments)}},_=function(e,t,n){var r,i,u,a,f,l=A,c=t&&typeof t=="string";if(c&&t.indexOf(" ")>0){t=t.split(" ");for(f=t.length;f--;)_(e,t[f],n);return e}u=c&&t.replace(o,""),u&&w[u]&&(u=w[u].type);if(!t||c){if(a=c&&t.replace(s,""))a=a.split(".");l(e,u,n,a)}else if(typeof t=="function")l(e,null,t);else for(r in t)t.hasOwnProperty(r)&&_(e,r,t[r]);return e},D=function(e,t,n,r,i){var s,o,u,a,f=n,l=n&&typeof n=="string";if(t&&!n&&typeof t=="object")for(s in t)t.hasOwnProperty(s)&&D.apply(this,[e,s,t[s]]);else{a=arguments.length>3?v.call(arguments,3):[],o=(l?n:t).split(" "),l&&(n=M(t,f=r,i))&&(a=v.call(a,1)),this===y&&(n=L(_,e,t,n,f));for(u=o.length;u--;)O(e,o[u],n,f,a)}return e},P=function(){return D.apply(y,arguments)},H=p?function(e,t,r){var i=c.createEvent(e?"HTMLEvents":"UIEvents");i[e?"initEvent":"initUIEvent"](t,!0,!0,n,1),r.dispatchEvent(i)}:function(e,t,n){n=S(n,e),e?n.fireEvent("on"+t,c.createEventObject()):n["_on"+t]++},B=function(e,t,n){var r,i,u,a,f,l=t.split(" ");for(r=l.length;r--;){t=l[r].replace(o,"");if(a=l[r].replace(s,""))a=a.split(".");if(!a&&!n&&e[d])H(b[t],t,e);else{f=T.get(e,t),n=[!1].concat(n);for(i=0,u=f.length;i<u;i++)f[i].inNamespaces(a)&&f[i].handler.apply(e,n)}}return e},j=function(e,t,n){var r=0,i=T.get(t,n),s=i.length;for(;r<s;r++)i[r].original&&D(e,i[r].type,i[r].original);return e},F={add:D,one:P,remove:_,clone:j,fire:B,noConflict:function(){return t[e]=r,this}};if(n[a]){var I=function(){var e,t=T.entries();for(e in t)t[e].type&&t[e].type!=="unload"&&_(t[e].element,t[e].type);n[l]("onunload",I),n.CollectGarbage&&n.CollectGarbage()};n[a]("onunload",I)}return F}),function(){var e=this,t=this.Flotr,n;n={_:_,bean:bean,isIphone:/iphone/i.test(navigator.userAgent),isIE:navigator.appVersion.indexOf("MSIE")!=-1?parseFloat(navigator.appVersion.split("MSIE")[1]):!1,graphTypes:{},plugins:{},addType:function(e,t){n.graphTypes[e]=t,n.defaultOptions[e]=t.options||{},n.defaultOptions.defaultType=n.defaultOptions.defaultType||e},addPlugin:function(e,t){n.plugins[e]=t,n.defaultOptions[e]=t.options||{}},draw:function(e,t,r,i){return i=i||n.Graph,new i(e,t,r)},merge:function(e,t){var r,i,s=t||{};for(r in e)i=e[r],i&&typeof i=="object"?i.constructor===Array?s[r]=this._.clone(i):i.constructor!==RegExp&&!this._.isElement(i)&&!i.jquery?s[r]=n.merge(i,t?t[r]:undefined):s[r]=i:s[r]=i;return s},clone:function(e){return n.merge(e,{})},getTickSize:function(e,t,r,i){var s=(r-t)/e,o=n.getMagnitude(s),u=10,a=s/o;return a<1.5?u=1:a<2.25?u=2:a<3?u=i===0?2:2.5:a<7.5&&(u=5),u*o},defaultTickFormatter:function(e,t){return e+""},defaultTrackFormatter:function(e){return"("+e.x+", "+e.y+")"},engineeringNotation:function(e,t,n){var r=["Y","Z","E","P","T","G","M","k",""],i=["y","z","a","f","p","n","","m",""],s=r.length;n=n||1e3,t=Math.pow(10,t||2);if(e===0)return 0;if(e>1)while(s--&&e>=n)e/=n;else{r=i,s=r.length;while(s--&&e<1)e*=n}return Math.round(e*t)/t+r[s]},getMagnitude:function(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))},toPixel:function(e){return Math.floor(e)+.5},toRad:function(e){return-e*(Math.PI/180)},floorInBase:function(e,t){return t*Math.floor(e/t)},drawText:function(e,t,r,i,s){if(!e.fillText){e.drawText(t,r,i,s);return}s=this._.extend({size:n.defaultOptions.fontSize,color:"#000000",textAlign:"left",textBaseline:"bottom",weight:1,angle:0},s),e.save(),e.translate(r,i),e.rotate(s.angle),e.fillStyle=s.color,e.font=(s.weight>1?"bold ":"")+s.size*1.3+"px sans-serif",e.textAlign=s.textAlign,e.textBaseline=s.textBaseline,e.fillText(t,0,0),e.restore()},getBestTextAlign:function(e,t){return t=t||{textAlign:"center",textBaseline:"middle"},e+=n.getTextAngleFromAlign(t),Math.abs(Math.cos(e))>.01&&(t.textAlign=Math.cos(e)>0?"right":"left"),Math.abs(Math.sin(e))>.01&&(t.textBaseline=Math.sin(e)>0?"top":"bottom"),t},alignTable:{"right middle":0,"right top":Math.PI/4,"center top":Math.PI/2,"left top":3*(Math.PI/4),"left middle":Math.PI,"left bottom":-3*(Math.PI/4),"center bottom":-Math.PI/2,"right bottom":-Math.PI/4,"center middle":0},getTextAngleFromAlign:function(e){return n.alignTable[e.textAlign+" "+e.textBaseline]||0},noConflict:function(){return e.Flotr=t,this}},e.Flotr=n}(),Flotr.defaultOptions={colors:["#00A8F0","#C0D800","#CB4B4B","#4DA74D","#9440ED"],ieBackgroundColor:"#FFFFFF",title:null,subtitle:null,shadowSize:4,defaultType:null,HtmlText:!0,fontColor:"#545454",fontSize:7.5,resolution:1,parseFloat:!0,preventDefault:!0,xaxis:{ticks:null,minorTicks:null,showLabels:!0,showMinorLabels:!1,labelsAngle:0,title:null,titleAngle:0,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:!1,autoscaleMargin:0,color:null,mode:"normal",timeFormat:null,timeMode:"UTC",timeUnit:"millisecond",scaling:"linear",base:Math.E,titleAlign:"center",margin:!0},x2axis:{},yaxis:{ticks:null,minorTicks:null,showLabels:!0,showMinorLabels:!1,labelsAngle:0,title:null,titleAngle:90,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:!1,autoscaleMargin:0,color:null,scaling:"linear",base:Math.E,titleAlign:"center",margin:!0},y2axis:{titleAngle:270},grid:{color:"#545454",backgroundColor:null,backgroundImage:null,watermarkAlpha:.4,tickColor:"#DDDDDD",labelMargin:3,verticalLines:!0,minorVerticalLines:null,horizontalLines:!0,minorHorizontalLines:null,outlineWidth:1,outline:"nsew",circular:!1},mouse:{track:!1,trackAll:!1,position:"se",relative:!1,trackFormatter:Flotr.defaultTrackFormatter,margin:5,lineColor:"#FF3F19",trackDecimals:1,sensibility:2,trackY:!0,radius:3,fillColor:null,fillOpacity:.4}},function(){function t(e,t,n,r){this.rgba=["r","g","b","a"];var i=4;while(-1<--i)this[this.rgba[i]]=arguments[i]||(i==3?1:0);this.normalize()}var e=Flotr._,n={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]};t.prototype={scale:function(t,n,r,i){var s=4;while(-1<--s)e.isUndefined(arguments[s])||(this[this.rgba[s]]*=arguments[s]);return this.normalize()},alpha:function(t){return!e.isUndefined(t)&&!e.isNull(t)&&(this.a=t),this.normalize()},clone:function(){return new t(this.r,this.b,this.g,this.a)},limit:function(e,t,n){return Math.max(Math.min(e,n),t)},normalize:function(){var e=this.limit;return this.r=e(parseInt(this.r,10),0,255),this.g=e(parseInt(this.g,10),0,255),this.b=e(parseInt(this.b,10),0,255),this.a=e(this.a,0,1),this},distance:function(e){if(!e)return;e=new t.parse(e);var n=0,r=3;while(-1<--r)n+=Math.abs(this[this.rgba[r]]-e[this.rgba[r]]);return n},toString:function(){return this.a>=1?"rgb("+[this.r,this.g,this.b].join(",")+")":"rgba("+[this.r,this.g,this.b,this.a].join(",")+")"},contrast:function(){var e=1-(.299*this.r+.587*this.g+.114*this.b)/255;return e<.5?"#000000":"#ffffff"}},e.extend(t,{parse:function(e){if(e instanceof t)return e;var r;if(r=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return new t(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16));if(r=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return new t(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10));if(r=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return new t(parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16));if(r=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return new t(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),parseFloat(r[4]));if(r=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return new t(parseFloat(r[1])*2.55,parseFloat(r[2])*2.55,parseFloat(r[3])*2.55);if(r=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return new t(parseFloat(r[1])*2.55,parseFloat(r[2])*2.55,parseFloat(r[3])*2.55,parseFloat(r[4]));var i=(e+"").replace(/^\s*([\S\s]*?)\s*$/,"$1").toLowerCase();return i=="transparent"?new t(255,255,255,0):(r=n[i])?new t(r[0],r[1],r[2]):new t(0,0,0,0)},processColor:function(n,r){var i=r.opacity;if(!n)return"rgba(0, 0, 0, 0)";if(n instanceof t)return n.alpha(i).toString();if(e.isString(n))return t.parse(n).alpha(i).toString();var s=n.colors?n:{colors:n};if(!r.ctx)return e.isArray(s.colors)?t.parse(e.isArray(s.colors[0])?s.colors[0][1]:s.colors[0]).alpha(i).toString():"rgba(0, 0, 0, 0)";s=e.extend({start:"top",end:"bottom"},s),/top/i.test(s.start)&&(r.x1=0),/left/i.test(s.start)&&(r.y1=0),/bottom/i.test(s.end)&&(r.x2=0),/right/i.test(s.end)&&(r.y2=0);var o,u,a,f=r.ctx.createLinearGradient(r.x1,r.y1,r.x2,r.y2);for(o=0;o<s.colors.length;o++)u=s.colors[o],e.isArray(u)?(a=u[0],u=u[1]):a=o/(s.colors.length-1),f.addColorStop(a,t.parse(u).alpha(i));return f}}),Flotr.Color=t}(),Flotr.Date={set:function(e,t,n,r){n=n||"UTC",t="set"+(n==="UTC"?"UTC":"")+t,e[t](r)},get:function(e,t,n){return n=n||"UTC",t="get"+(n==="UTC"?"UTC":"")+t,e[t]()},format:function(e,t,n){function s(e){return e+="",e.length==1?"0"+e:e}if(!e)return;var r=this.get,i={h:r(e,"Hours",n).toString(),H:s(r(e,"Hours",n)),M:s(r(e,"Minutes",n)),S:s(r(e,"Seconds",n)),s:r(e,"Milliseconds",n),d:r(e,"Date",n).toString(),m:(r(e,"Month",n)+1).toString(),y:r(e,"FullYear",n).toString(),b:Flotr.Date.monthNames[r(e,"Month",n)]},o=[],u,a=!1;for(var f=0;f<t.length;++f)u=t.charAt(f),a?(o.push(i[u]||u),a=!1):u=="%"?a=!0:o.push(u);return o.join("")},getFormat:function(e,t){var n=Flotr.Date.timeUnits;return e<n.second?"%h:%M:%S.%s":e<n.minute?"%h:%M:%S":e<n.day?t<2*n.day?"%h:%M":"%b %d %h:%M":e<n.month?"%b %d":e<n.year?t<n.year?"%b":"%b %y":"%y"},formatter:function(e,t){var n=t.options,r=Flotr.Date.timeUnits[n.timeUnit],i=new Date(e*r);if(t.options.timeFormat)return Flotr.Date.format(i,n.timeFormat,n.timeMode);var s=(t.max-t.min)*r,o=t.tickSize*Flotr.Date.timeUnits[t.tickUnit];return Flotr.Date.format(i,Flotr.Date.getFormat(o,s),n.timeMode)},generator:function(e){function y(e){t(m,e,o,Flotr.floorInBase(n(m,e,o),h))}var t=this.set,n=this.get,r=this.timeUnits,i=this.spec,s=e.options,o=s.timeMode,u=r[s.timeUnit],a=e.min*u,f=e.max*u,l=(f-a)/s.noTicks,c=[],h=e.tickSize,p,d,v;d=s.tickFormatter===Flotr.defaultTickFormatter?this.formatter:s.tickFormatter;for(v=0;v<i.length-1;++v){var m=i[v][0]*r[i[v][1]];if(l<(m+i[v+1][0]*r[i[v+1][1]])/2&&m>=h)break}h=i[v][0],p=i[v][1],p=="year"&&(h=Flotr.getTickSize(s.noTicks*r.year,a,f,0),h==.5&&(p="month",h=6)),e.tickUnit=p,e.tickSize=h;var g=h*r[p];m=new Date(a);switch(p){case"millisecond":y("Milliseconds");break;case"second":y("Seconds");break;case"minute":y("Minutes");break;case"hour":y("Hours");break;case"month":y("Month");break;case"year":y("FullYear")}g>=r.second&&t(m,"Milliseconds",o,0),g>=r.minute&&t(m,"Seconds",o,0),g>=r.hour&&t(m,"Minutes",o,0),g>=r.day&&t(m,"Hours",o,0),g>=r.day*4&&t(m,"Date",o,1),g>=r.year&&t(m,"Month",o,0);var b=0,w=NaN,E;do{E=w,w=m.getTime(),c.push({v:w/u,label:d(w/u,e)});if(p=="month")if(h<1){t(m,"Date",o,1);var S=m.getTime();t(m,"Month",o,n(m,"Month",o)+1);var x=m.getTime();m.setTime(w+b*r.hour+(x-S)*h),b=n(m,"Hours",o),t(m,"Hours",o,0)}else t(m,"Month",o,n(m,"Month",o)+h);else p=="year"?t(m,"FullYear",o,n(m,"FullYear",o)+h):m.setTime(w+g)}while(w<f&&w!=E);return c},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:31556952e3},spec:[[1,"millisecond"],[20,"millisecond"],[50,"millisecond"],[100,"millisecond"],[200,"millisecond"],[500,"millisecond"],[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},function(){function t(e){return e&&e.jquery?e[0]:e}var e=Flotr._;Flotr.DOM={addClass:function(n,r){n=t(n);var i=n.className?n.className:"";if(e.include(i.split(/\s+/g),r))return;n.className=(i?i+" ":"")+r},create:function(e){return document.createElement(e)},node:function(e){var t=Flotr.DOM.create("div"),n;return t.innerHTML=e,n=t.children[0],t.innerHTML="",n},empty:function(e){e=t(e),e.innerHTML=""},remove:function(e){e=t(e),e.parentNode.removeChild(e)},hide:function(e){e=t(e),Flotr.DOM.setStyles(e,{display:"none"})},insert:function(n,r){n=t(n),e.isString(r)?n.innerHTML+=r:e.isElement(r)&&n.appendChild(r)},opacity:function(e,n){e=t(e),e.style.opacity=n},position:function(e,n){return e=t(e),e.offsetParent?(n=this.position(e.offsetParent),n.left+=e.offsetLeft,n.top+=e.offsetTop,n):{left:e.offsetLeft||0,top:e.offsetTop||0}},removeClass:function(n,r){var i=n.className?n.className:"";n=t(n),n.className=e.filter(i.split(/\s+/g),function(e){if(e!=r)return!0}).join(" ")},setStyles:function(n,r){n=t(n),e.each(r,function(e,t){n.style[t]=e})},show:function(e){e=t(e),Flotr.DOM.setStyles(e,{display:""})},size:function(e){return e=t(e),{height:e.offsetHeight,width:e.offsetWidth}}}}(),function(){var e=Flotr,t=e.bean;e.EventAdapter={observe:function(e,n,r){return t.add(e,n,r),this},fire:function(e,n,r){return t.fire(e,n,r),typeof Prototype!="undefined"&&Event.fire(e,n,r),this},stopObserving:function(e,n,r){return t.remove(e,n,r),this},eventPointer:function(t){if(!e._.isUndefined(t.touches)&&t.touches.length>0)return{x:t.touches[0].pageX,y:t.touches[0].pageY};if(!e._.isUndefined(t.changedTouches)&&t.changedTouches.length>0)return{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY};if(t.pageX||t.pageY)return{x:t.pageX,y:t.pageY};if(t.clientX||t.clientY){var n=document,r=n.body,i=n.documentElement;return{x:t.clientX+r.scrollLeft+i.scrollLeft,y:t.clientY+r.scrollTop+i.scrollTop}}}}}(),function(){function i(e,n,r){return t.observe.apply(this,arguments),this._handles.push(arguments),this}var e=Flotr.DOM,t=Flotr.EventAdapter,n=Flotr._,r=Flotr;Graph=function(e,i,s){this._setEl(e),this._initMembers(),this._initPlugins(),t.fire(this.el,"flotr:beforeinit",[this]),this.data=i,this.series=r.Series.getSeries(i),this._initOptions(s),this._initGraphTypes(),this._initCanvas(),this._text=new r.Text({element:this.el,ctx:this.ctx,html:this.options.HtmlText,textEnabled:this.textEnabled}),t.fire(this.el,"flotr:afterconstruct",[this]),this._initEvents(),this.findDataRanges(),this.calculateSpacing(),this.draw(n.bind(function(){t.fire(this.el,"flotr:afterinit",[this])},this))},Graph.prototype={destroy:function(){t.fire(this.el,"flotr:destroy"),n.each(this._handles,function(e){t.stopObserving.apply(this,e)}),this._handles=[],this.el.graph=null},observe:i,_observe:i,processColor:function(e,t){var i={x1:0,y1:0,x2:this.plotWidth,y2:this.plotHeight,opacity:1,ctx:this.ctx};return n.extend(i,t),r.Color.processColor(e,i)},findDataRanges:function(){var e=this.axes,t,i,s;n.each(this.series,function(e){s=e.getRange(),s&&(t=e.xaxis,i=e.yaxis,t.datamin=Math.min(s.xmin,t.datamin),t.datamax=Math.max(s.xmax,t.datamax),i.datamin=Math.min(s.ymin,i.datamin),i.datamax=Math.max(s.ymax,i.datamax),t.used=t.used||s.xused,i.used=i.used||s.yused)},this),!e.x.used&&!e.x2.used&&(e.x.used=!0),!e.y.used&&!e.y2.used&&(e.y.used=!0),n.each(e,function(e){e.calculateRange()});var o=n.keys(r.graphTypes),u=!1;n.each(this.series,function(e){if(e.hide)return;n.each(o,function(t){e[t]&&e[t].show&&(this.extendRange(t,e),u=!0)},this),u||this.extendRange(this.options.defaultType,e)},this)},extendRange:function(e,t){this[e].extendRange&&this[e].extendRange(t,t.data,t[e],this[e]),this[e].extendYRange&&this[e].extendYRange(t.yaxis,t.data,t[e],this[e]),this[e].extendXRange&&this[e].extendXRange(t.xaxis,t.data,t[e],this[e])},calculateSpacing:function(){var e=this.axes,t=this.options,r=this.series,i=t.grid.labelMargin,s=this._text,o=e.x,u=e.x2,a=e.y,f=e.y2,l=t.grid.outlineWidth,c,h,p,d;n.each(e,function(e){e.calculateTicks(),e.calculateTextDimensions(s,t)}),d=s.dimensions(t.title,{size:t.fontSize*1.5},"font-size:1em;font-weight:bold;","flotr-title"),this.titleHeight=d.height,d=s.dimensions(t.subtitle,{size:t.fontSize},"font-size:smaller;","flotr-subtitle"),this.subtitleHeight=d.height;for(h=0;h<t.length;++h)r[h].points.show&&(l=Math.max(l,r[h].points.radius+r[h].points.lineWidth/2));var v=this.plotOffset;o.options.margin===!1?(v.bottom=0,v.top=0):o.options.margin===!0?(v.bottom+=(t.grid.circular?0:o.used&&o.options.showLabels?o.maxLabel.height+i:0)+(o.used&&o.options.title?o.titleSize.height+i:0)+l,v.top+=(t.grid.circular?0:u.used&&u.options.showLabels?u.maxLabel.height+i:0)+(u.used&&u.options.title?u.titleSize.height+i:0)+this.subtitleHeight+this.titleHeight+l):(v.bottom=o.options.margin,v.top=o.options.margin),a.options.margin===!1?(v.left=0,v.right=0):a.options.margin===!0?(v.left+=(t.grid.circular?0:a.used&&a.options.showLabels?a.maxLabel.width+i:0)+(a.used&&a.options.title?a.titleSize.width+i:0)+l,v.right+=(t.grid.circular?0:f.used&&f.options.showLabels?f.maxLabel.width+i:0)+(f.used&&f.options.title?f.titleSize.width+i:0)+l):(v.left=a.options.margin,v.right=a.options.margin),v.top=Math.floor(v.top),this.plotWidth=this.canvasWidth-v.left-v.right,this.plotHeight=this.canvasHeight-v.bottom-v.top,o.length=u.length=this.plotWidth,a.length=f.length=this.plotHeight,a.offset=f.offset=this.plotHeight,o.setScale(),u.setScale(),a.setScale(),f.setScale()},draw:function(e){var n=this.ctx,r;t.fire(this.el,"flotr:beforedraw",[this.series,this]);if(this.series.length){n.save(),n.translate(this.plotOffset.left,this.plotOffset.top);for(r=0;r<this.series.length;r++)this.series[r].hide||this.drawSeries(this.series[r]);n.restore(),this.clip()}t.fire(this.el,"flotr:afterdraw",[this.series,this]),e&&e()},drawSeries:function(e){function t(e,t){var n=this.getOptions(e,t);this[t].draw(n)}var i=!1;e=e||this.series,n.each(r.graphTypes,function(n,r){e[r]&&e[r].show&&this[r]&&(i=!0,t.call(this,e,r))},this),i||t.call(this,e,this.options.defaultType)},getOptions:function(e,t){var n=e[t],i=this[t],s=e.xaxis,o=e.yaxis,u={context:this.ctx,width:this.plotWidth,height:this.plotHeight,fontSize:this.options.fontSize,fontColor:this.options.fontColor,textEnabled:this.textEnabled,htmlText:this.options.HtmlText,text:this._text,element:this.el,data:e.data,color:e.color,shadowSize:e.shadowSize,xScale:s.d2p,yScale:o.d2p,xInverse:s.p2d,yInverse:o.p2d};return u=r.merge(n,u),u.fillStyle=this.processColor(n.fillColor||e.color,{opacity:n.fillOpacity}),u},getEventPosition:function(n){var r=document,i=r.body,s=r.documentElement,o=this.axes,u=this.plotOffset,a=this.lastMousePos,f=t.eventPointer(n),l=f.x-a.pageX,c=f.y-a.pageY,h,p,d;return"ontouchstart"in this.el?(h=e.position(this.overlay),p=f.x-h.left-u.left,d=f.y-h.top-u.top):(h=this.overlay.getBoundingClientRect(),p=n.clientX-h.left-u.left-i.scrollLeft-s.scrollLeft,d=n.clientY-h.top-u.top-i.scrollTop-s.scrollTop),{x:o.x.p2d(p),x2:o.x2.p2d(p),y:o.y.p2d(d),y2:o.y2.p2d(d),relX:p,relY:d,dX:l,dY:c,absX:f.x,absY:f.y,pageX:f.x,pageY:f.y}},clickHandler:function(e){if(this.ignoreClick)return this.ignoreClick=!1,this.ignoreClick;t.fire(this.el,"flotr:click",[this.getEventPosition(e),this])},mouseMoveHandler:function(e){if(this.mouseDownMoveHandler)return;var n=this.getEventPosition(e);t.fire(this.el,"flotr:mousemove",[e,n,this]),this.lastMousePos=n},mouseDownHandler:function(e){if(this.mouseUpHandler)return;this.mouseUpHandler=n.bind(function(e){t.stopObserving(document,"mouseup",this.mouseUpHandler),t.stopObserving(document,"mousemove",this.mouseDownMoveHandler),this.mouseDownMoveHandler=null,this.mouseUpHandler=null,t.fire(this.el,"flotr:mouseup",[e,this])},this),this.mouseDownMoveHandler=n.bind(function(n){var r=this.getEventPosition(n);t.fire(this.el,"flotr:mousemove",[e,r,this]),this.lastMousePos=r},this),t.observe(document,"mouseup",this.mouseUpHandler),t.observe(document,"mousemove",this.mouseDownMoveHandler),t.fire(this.el,"flotr:mousedown",[e,this]),this.ignoreClick=!1},drawTooltip:function(t,n,r,i){var s=this.getMouseTrack(),o="opacity:0.7;background-color:#000;color:#fff;display:none;position:absolute;padding:2px 8px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;",u=i.position,a=i.margin,f=this.plotOffset;n!==null&&r!==null?(i.relative?(u.charAt(0)=="n"?o+="bottom:"+(a-f.top-r+this.canvasHeight)+"px;top:auto;":u.charAt(0)=="s"&&(o+="top:"+(a+f.top+r)+"px;bottom:auto;"),u.charAt(1)=="e"?o+="left:"+(a+f.left+n)+"px;right:auto;":u.charAt(1)=="w"&&(o+="right:"+(a-f.left-n+this.canvasWidth)+"px;left:auto;")):(u.charAt(0)=="n"?o+="top:"+(a+f.top)+"px;bottom:auto;":u.charAt(0)=="s"&&(o+="bottom:"+(a+f.bottom)+"px;top:auto;"),u.charAt(1)=="e"?o+="right:"+(a+f.right)+"px;left:auto;":u.charAt(1)=="w"&&(o+="left:"+(a+f.left)+"px;right:auto;")),s.style.cssText=o,e.empty(s),e.insert(s,t),e.show(s)):e.hide(s)},clip:function(e){var t=this.plotOffset,n=this.canvasWidth,i=this.canvasHeight;e=e||this.ctx;if(r.isIE&&r.isIE<9&&!r.isFlashCanvas){if(e===this.octx)return;e.save(),e.fillStyle=this.processColor(this.options.ieBackgroundColor),e.fillRect(0,0,n,t.top),e.fillRect(0,0,t.left,i),e.fillRect(0,i-t.bottom,n,t.bottom),e.fillRect(n-t.right,0,t.right,i),e.restore()}else e.clearRect(0,0,n,t.top),e.clearRect(0,0,t.left,i),e.clearRect(0,i-t.bottom,n,t.bottom),e.clearRect(n-t.right,0,t.right,i)},_initMembers:function(){this._handles=[],this.lastMousePos={pageX:null,pageY:null},this.plotOffset={left:0,right:0,top:0,bottom:0},this.ignoreClick=!0,this.prevHit=null},_initGraphTypes:function(){n.each(r.graphTypes,function(e,t){this[t]=r.clone(e)},this)},_initEvents:function(){var e=this.el,r,i,s;"ontouchstart"in e?(r=n.bind(function(n){s=!0,t.stopObserving(document,"touchend",r),t.fire(e,"flotr:mouseup",[event,this]),this.multitouches=null,i||this.clickHandler(n)},this),this.observe(this.overlay,"touchstart",n.bind(function(n){i=!1,s=!1,this.ignoreClick=!1,n.touches&&n.touches.length>1&&(this.multitouches=n.touches),t.fire(e,"flotr:mousedown",[event,this]),this.observe(document,"touchend",r)},this)),this.observe(this.overlay,"touchmove",n.bind(function(n){var r=this.getEventPosition(n);this.options.preventDefault&&n.preventDefault(),i=!0,this.multitouches||n.touches&&n.touches.length>1?this.multitouches=n.touches:s||t.fire(e,"flotr:mousemove",[event,r,this]),this.lastMousePos=r},this))):this.observe(this.overlay,"mousedown",n.bind(this.mouseDownHandler,this)).observe(e,"mousemove",n.bind(this.mouseMoveHandler,this)).observe(this.overlay,"click",n.bind(this.clickHandler,this)).observe(e,"mouseout",function(n){t.fire(e,"flotr:mouseout",n)})},_initCanvas:function(){function l(i,s){return i||(i=e.create("canvas"),typeof FlashCanvas!="undefined"&&typeof i.getContext=="function"&&(FlashCanvas.initElement(i),this.isFlashCanvas=!0),i.className="flotr-"+s,i.style.cssText="position:absolute;left:0px;top:0px;",e.insert(t,i)),n.each(a,function(t,n){e.show(i);if(s=="canvas"&&i.getAttribute(n)===t)return;i.setAttribute(n,t*r.resolution),i.style[n]=t+"px"}),i.context_=null,i}function c(e){window.G_vmlCanvasManager&&window.G_vmlCanvasManager.initElement(e);var t=e.getContext("2d");return window.G_vmlCanvasManager||t.scale(r.resolution,r.resolution),t}var t=this.el,r=this.options,i=t.children,s=[],o,u,a,f;for(u=i.length;u--;)o=i[u],!this.canvas&&o.className==="flotr-canvas"?this.canvas=o:!this.overlay&&o.className==="flotr-overlay"?this.overlay=o:s.push(o);for(u=s.length;u--;)t.removeChild(s[u]);e.setStyles(t,{position:"relative"}),a={},a.width=t.clientWidth,a.height=t.clientHeight;if(a.width<=0||a.height<=0||r.resolution<=0)throw"Invalid dimensions for plot, width = "+a.width+", height = "+a.height+", resolution = "+r.resolution;this.canvas=l(this.canvas,"canvas"),this.overlay=l(this.overlay,"overlay"),this.ctx=c(this.canvas),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.octx=c(this.overlay),this.octx.clearRect(0,0,this.overlay.width,this.overlay.height),this.canvasHeight=a.height,this.canvasWidth=a.width,this.textEnabled=!!this.ctx.drawText||!!this.ctx.fillText},_initPlugins:function(){n.each(r.plugins,function(e,t){n.each(e.callbacks,function(e,t){this.observe(this.el,t,n.bind(e,this))},this),this[t]=r.clone(e),n.each(this[t],function(e,r){n.isFunction(e)&&(this[t][r]=n.bind(e,this))},this)},this)},_initOptions:function(e){var i=r.clone(r.defaultOptions);i.x2axis=n.extend(n.clone(i.xaxis),i.x2axis),i.y2axis=n.extend(n.clone(i.yaxis),i.y2axis),this.options=r.merge(e||{},i),this.options.grid.minorVerticalLines===null&&this.options.xaxis.scaling==="logarithmic"&&(this.options.grid.minorVerticalLines=!0),this.options.grid.minorHorizontalLines===null&&this.options.yaxis.scaling==="logarithmic"&&(this.options.grid.minorHorizontalLines=!0),t.fire(this.el,"flotr:afterinitoptions",[this]),this.axes=r.Axis.getAxes(this.options);var s=[],o=[],u=this.series.length,a=this.series.length,f=this.options.colors,l=[],c=0,h,p,d,v;for(p=a-1;p>-1;--p)h=this.series[p].color,h&&(--a,n.isNumber(h)?s.push(h):l.push(r.Color.parse(h)));for(p=s.length-1;p>-1;--p)a=Math.max(a,s[p]+1);for(p=0;o.length<a;){h=f.length==p?new r.Color(100,100,100):r.Color.parse(f[p]);var m=c%2==1?-1:1,g=1+m*Math.ceil(c/2)*.2;h.scale(g,g,g),o.push(h),++p>=f.length&&(p=0,++c)}for(p=0,d=0;p<u;++p){v=this.series[p],v.color?n.isNumber(v.color)&&(v.color=o[v.color].toString()):v.color=o[d++].toString(),v.xaxis||(v.xaxis=this.axes.x),v.xaxis==1?v.xaxis=this.axes.x:v.xaxis==2&&(v.xaxis=this.axes.x2),v.yaxis||(v.yaxis=this.axes.y),v.yaxis==1?v.yaxis=this.axes.y:v.yaxis==2&&(v.yaxis=this.axes.y2);for(var y in r.graphTypes)v[y]=n.extend(n.clone(this.options[y]),v[y]);v.mouse=n.extend(n.clone(this.options.mouse),v.mouse),n.isUndefined(v.shadowSize)&&(v.shadowSize=this.options.shadowSize)}},_setEl:function(e){if(!e)throw"The target container doesn't exist";if(e.graph instanceof Graph)e.graph.destroy();else if(!e.clientWidth)throw"The target container must be visible";e.graph=this,this.el=e}},Flotr.Graph=Graph}(),function(){function n(t){this.orientation=1,this.offset=0,this.datamin=Number.MAX_VALUE,this.datamax=-Number.MAX_VALUE,e.extend(this,t)}function r(e,t){return e=Math.log(Math.max(e,Number.MIN_VALUE)),t!==Math.E&&(e/=Math.log(t)),e}function s(e,t){return t===Math.E?Math.exp(e):Math.pow(t,e)}var e=Flotr._,t="logarithmic";n.prototype={setScale:function(){var e=this.length,n=this.max,i=this.min,o=this.offset,u=this.orientation,a=this.options,f=a.scaling===t,l;f?l=e/(r(n,a.base)-r(i,a.base)):l=e/(n-i),this.scale=l,f?(this.d2p=function(e){return o+u*(r(e,a.base)-r(i,a.base))*l},this.p2d=function(e){return s((o+u*e)/l+r(i,a.base),a.base)}):(this.d2p=function(e){return o+u*(e-i)*l},this.p2d=function(e){return(o+u*e)/l+i})},calculateTicks:function(){var t=this.options;this.ticks=[],this.minorTicks=[],t.ticks?(this._cleanUserTicks(t.ticks,this.ticks),this._cleanUserTicks(t.minorTicks||[],this.minorTicks)):t.mode=="time"?this._calculateTimeTicks():t.scaling==="logarithmic"?this._calculateLogTicks():this._calculateTicks(),e.each(this.ticks,function(e){e.label+=""}),e.each(this.minorTicks,function(e){e.label+=""})},calculateRange:function(){if(!this.used)return;var e=this,t=e.options,n=t.min!==null?t.min:e.datamin,r=t.max!==null?t.max:e.datamax,i=t.autoscaleMargin;t.scaling=="logarithmic"&&(n<=0&&(n=e.datamin),r<=0&&(r=n));if(r==n){var s=r?.01:1;t.min===null&&(n-=s),t.max===null&&(r+=s)}if(t.scaling==="logarithmic"){n<0&&(n=r/t.base);var o=Math.log(r);t.base!=Math.E&&(o/=Math.log(t.base)),o=Math.ceil(o);var u=Math.log(n);t.base!=Math.E&&(u/=Math.log(t.base)),u=Math.ceil(u),e.tickSize=Flotr.getTickSize(t.noTicks,u,o,t.tickDecimals===null?0:t.tickDecimals),t.minorTickFreq===null&&(o-u>10?t.minorTickFreq=0:o-u>5?t.minorTickFreq=2:t.minorTickFreq=5)}else e.tickSize=Flotr.getTickSize(t.noTicks,n,r,t.tickDecimals);e.min=n,e.max=r,t.min===null&&t.autoscale&&(e.min-=e.tickSize*i,e.min<0&&e.datamin>=0&&(e.min=0),e.min=e.tickSize*Math.floor(e.min/e.tickSize)),t.max===null&&t.autoscale&&(e.max+=e.tickSize*i,e.max>0&&e.datamax<=0&&e.datamax!=e.datamin&&(e.max=0),e.max=e.tickSize*Math.ceil(e.max/e.tickSize)),e.min==e.max&&(e.max=e.min+1)},calculateTextDimensions:function(e,t){var n="",r,i;if(this.options.showLabels)for(i=0;i<this.ticks.length;++i)r=this.ticks[i].label.length,r>n.length&&(n=this.ticks[i].label);this.maxLabel=e.dimensions(n,{size:t.fontSize,angle:Flotr.toRad(this.options.labelsAngle)},"font-size:smaller;","flotr-grid-label"),this.titleSize=e.dimensions(this.options.title,{size:t.fontSize*1.2,angle:Flotr.toRad(this.options.titleAngle)},"font-weight:bold;","flotr-axis-title")},_cleanUserTicks:function(t,n){var r=this,i=this.options,s,o,u,a;e.isFunction(t)&&(t=t({min:r.min,max:r.max}));for(o=0;o<t.length;++o)a=t[o],typeof a=="object"?(s=a[0],u=a.length>1?a[1]:i.tickFormatter(s,{min:r.min,max:r.max})):(s=a,u=i.tickFormatter(s,{min:this.min,max:this.max})),n[o]={v:s,label:u}},_calculateTimeTicks:function(){this.ticks=Flotr.Date.generator(this)},_calculateLogTicks:function(){var e=this,t=e.options,n,r,s=Math.log(e.max);t.base!=Math.E&&(s/=Math.log(t.base)),s=Math.ceil(s);var o=Math.log(e.min);t.base!=Math.E&&(o/=Math.log(t.base)),o=Math.ceil(o);for(i=o;i<s;i+=e.tickSize){r=t.base==Math.E?Math.exp(i):Math.pow(t.base,i);var u=r*(t.base==Math.E?Math.exp(e.tickSize):Math.pow(t.base,e.tickSize)),a=(u-r)/t.minorTickFreq;e.ticks.push({v:r,label:t.tickFormatter(r,{min:e.min,max:e.max})});for(n=r+a;n<u;n+=a)e.minorTicks.push({v:n,label:t.tickFormatter(n,{min:e.min,max:e.max})})}r=t.base==Math.E?Math.exp(i):Math.pow(t.base,i),e.ticks.push({v:r,label:t.tickFormatter(r,{min:e.min,max:e.max})})},_calculateTicks:function(){var e=this,t=e.options,n=e.tickSize,r=e.min,i=e.max,s=n*Math.ceil(r/n),o,u,a,f,l,c;t.minorTickFreq&&(u=n/t.minorTickFreq);for(l=0;(a=f=s+l*n)<=i;++l){o=t.tickDecimals,o===null&&(o=1-Math.floor(Math.log(n)/Math.LN10)),o<0&&(o=0),a=a.toFixed(o),e.ticks.push({v:a,label:t.tickFormatter(a,{min:e.min,max:e.max})});if(t.minorTickFreq)for(c=0;c<t.minorTickFreq&&l*n+c*u<i;++c)a=f+c*u,e.minorTicks.push({v:a,label:t.tickFormatter(a,{min:e.min,max:e.max})})}}},e.extend(n,{getAxes:function(e){return{x:new n({options:e.xaxis,n:1,length:this.plotWidth}),x2:new n({options:e.x2axis,n:2,length:this.plotWidth}),y:new n({options:e.yaxis,n:1,length:this.plotHeight,offset:this.plotHeight,orientation:-1}),y2:new n({options:e.y2axis,n:2,length:this.plotHeight,offset:this.plotHeight,orientation:-1})}}}),Flotr.Axis=n}(),function(){function t(t){e.extend(this,t)}var e=Flotr._;t.prototype={getRange:function(){var e=this.data,t=e.length,n=Number.MAX_VALUE,r=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=-Number.MAX_VALUE,o=!1,u=!1,a,f,l;if(t<0||this.hide)return!1;for(l=0;l<t;l++)a=e[l][0],f=e[l][1],a!==null&&(a<n&&(n=a,o=!0),a>i&&(i=a,o=!0)),f!==null&&(f<r&&(r=f,u=!0),f>s&&(s=f,u=!0));return{xmin:n,xmax:i,ymin:r,ymax:s,xused:o,yused:u}}},e.extend(t,{getSeries:function(n){return e.map(n,function(n){var r;return n.data?(r=new t,e.extend(r,n)):r=new t({data:n}),r})}}),Flotr.Series=t}(),function(){var e=Flotr,t=e.DOM,n=e._,r=function(e){this.o=e};r.prototype={dimensions:function(e,t,n,r){return e?this.o.html?this.html(e,this.o.element,n,r):this.canvas(e,t):{width:0,height:0}},canvas:function(t,n){if(!this.o.textEnabled)return;n=n||{};var r=this.measureText(t,n),i=r.width,s=n.size||e.defaultOptions.fontSize,o=n.angle||0,u=Math.cos(o),a=Math.sin(o),f=2,l=6,c;return c={width:Math.abs(u*i)+Math.abs(a*s)+f,height:Math.abs(a*i)+Math.abs(u*s)+l},c},html:function(e,n,r,i){var s=t.create("div");return t.setStyles(s,{position:"absolute",top:"-100000px"
}),t.insert(s,'<div style="'+r+'" class="'+i+' flotr-dummy-div">'+e+"</div>"),t.insert(this.o.element,s),t.size(s)},measureText:function(t,r){var i=this.o.ctx,s;return!i.fillText||e.isIphone&&i.measure?{width:i.measure(t,r)}:(r=n.extend({size:e.defaultOptions.fontSize,weight:1,angle:0},r),i.save(),i.font=(r.weight>1?"bold ":"")+r.size*1.3+"px sans-serif",s=i.measureText(t),i.restore(),s)}},Flotr.Text=r}(),Flotr.addType("lines",{options:{show:!1,lineWidth:2,fill:!1,fillBorder:!1,fillColor:null,fillOpacity:.4,steps:!1,stacked:!1},stack:{values:[]},draw:function(e){var t=e.context,n=e.lineWidth,r=e.shadowSize,i;t.save(),t.lineJoin="round",r&&!1&&(t.lineWidth=r/2,i=n/2+t.lineWidth/2,t.strokeStyle="rgba(0,0,0,0.1)",this.plot(e,i+r/2,!1),t.strokeStyle="rgba(0,0,0,0.2)",this.plot(e,i,!1)),t.lineWidth=n,t.strokeStyle=e.color,this.plot(e,0,!0),t.restore()},plot:function(e,t,n){function T(t){var n=null;for(n=l-1;n>=0;--n){if(!e.fill)return;if(!t[n])return;t[n][1]===null&&(t[n][1]=0),x=o(t[n][0]),y=u(t[n][1]),y<0&&(y=0);if(y>s||x>i||y<0||x<0)return;r.lineTo(x,y),r.stroke()}}function N(e){var t=[],n=a[0][0];for(S=0;S<e.length;++S)t.push([S+n,e[S]]);return t}function C(){if(!t&&e.fill&&d){e.fillBorder&&r.stroke(),v=o(d[0]),r.fillStyle=e.fillStyle;if(!f||f.values.length===0)r.lineTo(m,p),r.lineTo(v,p),r.lineTo(v,u(d[1]));else{var n=N(f.values);stack_x1=o(n[0][0]),stack_y2=u(n[n.length-1][1]),r.lineTo(m,stack_y2),T(n),r.lineTo(stack_x1,u(a[0][1]))}r.fill()}}var r=e.context,i=e.width,s=e.height,o=e.xScale,u=e.yScale,a=e.data,f=e.stacked?this.stack:!1,l=a.length-1,c=null,h=null,p=u(0),d=null,v,m,g,b,w,E,S;if(l<1)return;r.beginPath();for(S=0;S<l;++S){if(a[S][1]===null||a[S+1][1]===null){e.fill&&S>0&&a[S][1]&&(r.stroke(),C(),d=null,r.closePath(),r.beginPath());continue}v=o(a[S][0]),m=o(a[S+1][0]),d===null&&(d=a[S]),f?(w=f.values[S]||0,E=f.values[S+1]||0,g=u(a[S][1]+w),b=u(a[S+1][1]+E)):(g=u(a[S][1]),b=u(a[S+1][1]));if(g>s&&b>s||g<0&&b<0||v<0&&m<0||v>i&&m>i)continue;(c!=v||h!=g+t)&&r.moveTo(v,g+t),c=m,h=b+t,e.steps?(r.lineTo(c+t/2,g+t),r.lineTo(c+t/2,h)):r.lineTo(c,h)}(!e.fill||e.fill&&!e.fillBorder)&&r.stroke(),C();if(f)for(S=0;S<l;++S)w=f.values[S]||0,E=f.values[S+1]||0,n&&(f.values[S]=a[S][1]+w,S==l-1&&(f.values[S+1]=a[S+1][1]+E))},extendYRange:function(e,t,n,r){var i=e.options;if(n.stacked&&(!i.max&&i.max!==0||!i.min&&i.min!==0)){var s=e.max,o=e.min,u=r.positiveSums||{},a=r.negativeSums||{},f,l;for(l=0;l<t.length;l++)f=t[l][0]+"",t[l][1]>0?(u[f]=(u[f]||0)+t[l][1],s=Math.max(s,u[f])):(a[f]=(a[f]||0)+t[l][1],o=Math.min(o,a[f]));r.negativeSums=a,r.positiveSums=u,e.max=s,e.min=o}n.steps&&(this.hit=function(e){var t=e.data,n=e.args,r=e.yScale,i=n[0],s=t.length,o=n[1],u=e.xInverse(i.relX),a=i.relY,f;for(f=0;f<s-1;f++)if(u>=t[f][0]&&u<=t[f+1][0]){Math.abs(r(t[f][1])-a)<8&&(o.x=t[f][0],o.y=t[f][1],o.index=f,o.seriesIndex=e.index);break}},this.drawHit=function(e){var t=e.context,n=e.args,r=e.data,i=e.xScale,s=n.index,o=i(n.x),u=e.yScale(n.y),a;r.length-1>s&&(a=e.xScale(r[s+1][0]),t.save(),t.strokeStyle=e.color,t.lineWidth=e.lineWidth,t.beginPath(),t.moveTo(o,u),t.lineTo(a,u),t.stroke(),t.closePath(),t.restore())},this.clearHit=function(e){var t=e.context,n=e.args,r=e.data,i=e.xScale,s=e.lineWidth,o=n.index,u=i(n.x),a=e.yScale(n.y),f;r.length-1>o&&(f=e.xScale(r[o+1][0]),t.clearRect(u-s,a-s,f-u+2*s,2*s))})}}),Flotr.addType("bars",{options:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,fillOpacity:.4,horizontal:!1,stacked:!1,centered:!0,topPadding:.1,grouped:!1},stack:{positive:[],negative:[],_positive:[],_negative:[]},draw:function(e){var t=e.context;this.current+=1,t.save(),t.lineJoin="miter",t.lineWidth=e.lineWidth,t.strokeStyle=e.color,e.fill&&(t.fillStyle=e.fillStyle),this.plot(e),t.restore()},plot:function(e){var t=e.data,n=e.context,r=e.shadowSize,i,s,o,u,a,f;if(t.length<1)return;this.translate(n,e.horizontal);for(i=0;i<t.length;i++){s=this.getBarGeometry(t[i][0],t[i][1],e);if(s===null)continue;o=s.left,u=s.top,a=s.width,f=s.height,e.fill&&n.fillRect(o,u,a,f),r&&(n.save(),n.fillStyle="rgba(0,0,0,0.05)",n.fillRect(o+r,u+r,a,f),n.restore()),e.lineWidth&&n.strokeRect(o,u,a,f)}},translate:function(e,t){t&&(e.rotate(-Math.PI/2),e.scale(-1,1))},getBarGeometry:function(e,t,n){var r=n.horizontal,i=n.barWidth,s=n.centered,o=n.stacked?this.stack:!1,u=n.lineWidth,a=s?i/2:0,f=r?n.yScale:n.xScale,l=r?n.xScale:n.yScale,c=r?t:e,h=r?e:t,p=0,d,v,m,g,y;return n.grouped&&(this.current/this.groups,c-=a,i/=this.groups,a=i/2,c=c+i*this.current-a),o&&(d=h>0?o.positive:o.negative,p=d[c]||p,d[c]=p+h),v=f(c-a),m=f(c+i-a),g=l(h+p),y=l(p),y<0&&(y=0),e===null||t===null?null:{x:c,y:h,xScale:f,yScale:l,top:g,left:Math.min(v,m)-u/2,width:Math.abs(m-v)-u,height:y-g}},hit:function(e){var t=e.data,n=e.args,r=n[0],i=n[1],s=e.xInverse(r.relX),o=e.yInverse(r.relY),u=this.getBarGeometry(s,o,e),a=u.width/2,f=u.left,l=u.y,c,h;for(h=t.length;h--;)c=this.getBarGeometry(t[h][0],t[h][1],e),(l>0&&l<c.y||l<0&&l>c.y)&&Math.abs(f-c.left)<a&&(i.x=t[h][0],i.y=t[h][1],i.index=h,i.seriesIndex=e.index)},drawHit:function(e){var t=e.context,n=e.args,r=this.getBarGeometry(n.x,n.y,e),i=r.left,s=r.top,o=r.width,u=r.height;t.save(),t.strokeStyle=e.color,t.lineWidth=e.lineWidth,this.translate(t,e.horizontal),t.beginPath(),t.moveTo(i,s+u),t.lineTo(i,s),t.lineTo(i+o,s),t.lineTo(i+o,s+u),e.fill&&(t.fillStyle=e.fillStyle,t.fill()),t.stroke(),t.closePath(),t.restore()},clearHit:function(e){var t=e.context,n=e.args,r=this.getBarGeometry(n.x,n.y,e),i=r.left,s=r.width,o=r.top,u=r.height,a=2*e.lineWidth;t.save(),this.translate(t,e.horizontal),t.clearRect(i-a,Math.min(o,o+u)-a,s+2*a,Math.abs(u)+2*a),t.restore()},extendXRange:function(e,t,n,r){this._extendRange(e,t,n,r),this.groups=this.groups+1||1,this.current=0},extendYRange:function(e,t,n,r){this._extendRange(e,t,n,r)},_extendRange:function(e,t,n,r){var i=e.options.max;if(_.isNumber(i)||_.isString(i))return;var s=e.min,o=e.max,u=n.horizontal,a=e.orientation,f=this.positiveSums||{},l=this.negativeSums||{},c,h,p,d;(a==1&&!u||a==-1&&u)&&n.centered&&(o=Math.max(e.datamax+n.barWidth,o),s=Math.min(e.datamin-n.barWidth,s));if(n.stacked&&(a==1&&u||a==-1&&!u))for(d=t.length;d--;)c=t[d][a==1?1:0]+"",h=t[d][a==1?0:1],h>0?(f[c]=(f[c]||0)+h,o=Math.max(o,f[c])):(l[c]=(l[c]||0)+h,s=Math.min(s,l[c]));(a==1&&u||a==-1&&!u)&&n.topPadding&&(e.max===e.datamax||n.stacked&&this.stackMax!==o)&&(o+=n.topPadding*(o-s)),this.stackMin=s,this.stackMax=o,this.negativeSums=l,this.positiveSums=f,e.max=o,e.min=s}}),Flotr.addType("bubbles",{options:{show:!1,lineWidth:2,fill:!0,fillOpacity:.4,baseRadius:2},draw:function(e){var t=e.context,n=e.shadowSize;t.save(),t.lineWidth=e.lineWidth,t.fillStyle="rgba(0,0,0,0.05)",t.strokeStyle="rgba(0,0,0,0.05)",this.plot(e,n/2),t.strokeStyle="rgba(0,0,0,0.1)",this.plot(e,n/4),t.strokeStyle=e.color,t.fillStyle=e.fillStyle,this.plot(e),t.restore()},plot:function(e,t){var n=e.data,r=e.context,i,s,o,u,a;t=t||0;for(s=0;s<n.length;++s)i=this.getGeometry(n[s],e),r.beginPath(),r.arc(i.x+t,i.y+t,i.z,0,2*Math.PI,!0),r.stroke(),e.fill&&r.fill(),r.closePath()},getGeometry:function(e,t){return{x:t.xScale(e[0]),y:t.yScale(e[1]),z:e[2]*t.baseRadius}},hit:function(e){var t=e.data,n=e.args,r=n[0],s=n[1],o=r.relX,u=r.relY,a,f,l,c;s.best=s.best||Number.MAX_VALUE;for(i=t.length;i--;)f=this.getGeometry(t[i],e),l=f.x-o,c=f.y-u,a=Math.sqrt(l*l+c*c),a<f.z&&f.z<s.best&&(s.x=t[i][0],s.y=t[i][1],s.index=i,s.seriesIndex=e.index,s.best=f.z)},drawHit:function(e){var t=e.context,n=this.getGeometry(e.data[e.args.index],e);t.save(),t.lineWidth=e.lineWidth,t.fillStyle=e.fillStyle,t.strokeStyle=e.color,t.beginPath(),t.arc(n.x,n.y,n.z,0,2*Math.PI,!0),t.fill(),t.stroke(),t.closePath(),t.restore()},clearHit:function(e){var t=e.context,n=this.getGeometry(e.data[e.args.index],e),r=n.z+e.lineWidth;t.save(),t.clearRect(n.x-r,n.y-r,2*r,2*r),t.restore()}}),function(){function e(e){return typeof e=="object"&&e.constructor&&(Image?!0:e.constructor===Image)}Flotr.defaultMarkerFormatter=function(e){return Math.round(e.y*100)/100+""},Flotr.addType("markers",{options:{show:!1,lineWidth:1,color:"#000000",fill:!1,fillColor:"#FFFFFF",fillOpacity:.4,stroke:!1,position:"ct",verticalMargin:0,labelFormatter:Flotr.defaultMarkerFormatter,fontSize:Flotr.defaultOptions.fontSize,stacked:!1,stackingType:"b",horizontal:!1},stack:{positive:[],negative:[],values:[]},draw:function(e){function h(e,t){return o=r.negative[e]||0,s=r.positive[e]||0,t>0?(r.positive[e]=o+t,o+t):(r.negative[e]=s+t,s+t)}var t=e.data,n=e.context,r=e.stacked?e.stack:!1,i=e.stackingType,s,o,u,a,f,l,c;n.save(),n.lineJoin="round",n.lineWidth=e.lineWidth,n.strokeStyle="rgba(0,0,0,0.5)",n.fillStyle=e.fillStyle;for(a=0;a<t.length;++a)f=t[a][0],l=t[a][1],r&&(i=="b"?e.horizontal?l=h(l,f):f=h(f,l):i=="a"&&(u=r.values[f]||0,r.values[f]=u+l,l=u+l)),c=e.labelFormatter({x:f,y:l,index:a,data:t}),this.plot(e.xScale(f),e.yScale(l),c,e);n.restore()},plot:function(t,n,r,i){var s=i.context;if(e(r)&&!r.complete)throw"Marker image not loaded.";this._plot(t,n,r,i)},_plot:function(t,n,r,i){var s=i.context,o=2,u=t,a=n,f;e(r)?f={height:r.height,width:r.width}:f=i.text.canvas(r),f.width=Math.floor(f.width+o*2),f.height=Math.floor(f.height+o*2),i.position.indexOf("c")!=-1?u-=f.width/2+o:i.position.indexOf("l")!=-1&&(u-=f.width),i.position.indexOf("m")!=-1?a-=f.height/2+o:i.position.indexOf("t")!=-1?a-=f.height+i.verticalMargin:a+=i.verticalMargin,u=Math.floor(u)+.5,a=Math.floor(a)+.5,i.fill&&s.fillRect(u,a,f.width,f.height),i.stroke&&s.strokeRect(u,a,f.width,f.height),e(r)?s.drawImage(r,parseInt(u+o,10),parseInt(a+o,10)):Flotr.drawText(s,r,u+o,a+o,{textBaseline:"top",textAlign:"left",size:i.fontSize,color:i.color})}})}(),function(){var e=Flotr._;Flotr.defaultPieLabelFormatter=function(e,t){return(100*t/e).toFixed(2)+"%"},Flotr.addType("pie",{options:{show:!1,lineWidth:1,fill:!0,fillColor:null,fillOpacity:.6,explode:6,sizeRatio:.6,startAngle:Math.PI/4,labelFormatter:Flotr.defaultPieLabelFormatter,pie3D:!1,pie3DviewAngle:Math.PI/2*.8,pie3DspliceThickness:20,epsilon:.1},draw:function(e){var t=e.data,n=e.context,r=n.canvas,i=e.lineWidth,s=e.shadowSize,o=e.sizeRatio,u=e.height,a=e.width,f=e.explode,l=e.color,c=e.fill,h=e.fillStyle,p=Math.min(r.width,r.height)*o/2,d=t[0][1],v=[],m=1,g=Math.PI*2*d/this.total,y=this.startAngle||2*Math.PI*e.startAngle,b=y+g,w=y+g/2,E=e.labelFormatter(this.total,d),S=f+p+4,x=Math.cos(w)*S,T=Math.sin(w)*S,N=x<0?"right":"left",C=T>0?"top":"bottom",k,L,A;n.save(),n.translate(a/2,u/2),n.scale(1,m),L=Math.cos(w)*f,A=Math.sin(w)*f,s>0&&(this.plotSlice(L+s,A+s,p,y,b,n),c&&(n.fillStyle="rgba(0,0,0,0.1)",n.fill())),this.plotSlice(L,A,p,y,b,n),c&&(n.fillStyle=h,n.fill()),n.lineWidth=i,n.strokeStyle=l,n.stroke(),k={size:e.fontSize*1.2,color:e.fontColor,weight:1.5},E&&(e.htmlText||!e.textEnabled?(divStyle="position:absolute;"+C+":"+(u/2+(C==="top"?T:-T))+"px;",divStyle+=N+":"+(a/2+(N==="right"?-x:x))+"px;",v.push('<div style="',divStyle,'" class="flotr-grid-label">',E,"</div>")):(k.textAlign=N,k.textBaseline=C,Flotr.drawText(n,E,x,T,k)));if(e.htmlText||!e.textEnabled){var O=Flotr.DOM.node('<div style="color:'+e.fontColor+'" class="flotr-labels"></div>');Flotr.DOM.insert(O,v.join("")),Flotr.DOM.insert(e.element,O)}n.restore(),this.startAngle=b,this.slices=this.slices||[],this.slices.push({radius:Math.min(r.width,r.height)*o/2,x:L,y:A,explode:f,start:y,end:b})},plotSlice:function(e,t,n,r,i,s){s.beginPath(),s.moveTo(e,t),s.arc(e,t,n,r,i,!1),s.lineTo(e,t),s.closePath()},hit:function(e){var t=e.data[0],n=e.args,r=e.index,i=n[0],s=n[1],o=this.slices[r],u=i.relX-e.width/2,a=i.relY-e.height/2,f=Math.sqrt(u*u+a*a),l=Math.atan(a/u),c=Math.PI*2,h=o.explode||e.explode,p=o.start%c,d=o.end%c,v=e.epsilon;u<0?l+=Math.PI:u>0&&a<0&&(l+=c),f<o.radius+h&&f>h&&(l>p&&l<d||p>d&&(l<d||l>p)||p===d&&(o.start===o.end&&Math.abs(l-p)<v||o.start!==o.end&&Math.abs(l-p)>v))&&(s.x=t[0],s.y=t[1],s.sAngle=p,s.eAngle=d,s.index=0,s.seriesIndex=r,s.fraction=t[1]/this.total)},drawHit:function(e){var t=e.context,n=this.slices[e.args.seriesIndex];t.save(),t.translate(e.width/2,e.height/2),this.plotSlice(n.x,n.y,n.radius,n.start,n.end,t),t.stroke(),t.restore()},clearHit:function(e){var t=e.context,n=this.slices[e.args.seriesIndex],r=2*e.lineWidth,i=n.radius+r;t.save(),t.translate(e.width/2,e.height/2),t.clearRect(n.x-i,n.y-i,2*i+r,2*i+r),t.restore()},extendYRange:function(e,t){this.total=(this.total||0)+t[0][1]}})}(),Flotr.addType("points",{options:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#FFFFFF",fillOpacity:1,hitRadius:null},draw:function(e){var t=e.context,n=e.lineWidth,r=e.shadowSize;t.save(),r>0&&(t.lineWidth=r/2,t.strokeStyle="rgba(0,0,0,0.1)",this.plot(e,r/2+t.lineWidth/2),t.strokeStyle="rgba(0,0,0,0.2)",this.plot(e,t.lineWidth/2)),t.lineWidth=e.lineWidth,t.strokeStyle=e.color,e.fill&&(t.fillStyle=e.fillStyle),this.plot(e),t.restore()},plot:function(e,t){var n=e.data,r=e.context,i=e.xScale,s=e.yScale,o,u,a;for(o=n.length-1;o>-1;--o){a=n[o][1];if(a===null)continue;u=i(n[o][0]),a=s(a);if(u<0||u>e.width||a<0||a>e.height)continue;r.beginPath(),t?r.arc(u,a+t,e.radius,0,Math.PI,!1):(r.arc(u,a,e.radius,0,2*Math.PI,!0),e.fill&&r.fill()),r.stroke(),r.closePath()}}}),Flotr.addType("radar",{options:{show:!1,lineWidth:2,fill:!0,fillOpacity:.4,radiusRatio:.9,sensibility:2},draw:function(e){var t=e.context,n=e.shadowSize;t.save(),t.translate(e.width/2,e.height/2),t.lineWidth=e.lineWidth,t.fillStyle="rgba(0,0,0,0.05)",t.strokeStyle="rgba(0,0,0,0.05)",this.plot(e,n/2),t.strokeStyle="rgba(0,0,0,0.1)",this.plot(e,n/4),t.strokeStyle=e.color,t.fillStyle=e.fillStyle,this.plot(e),t.restore()},plot:function(e,t){var n=e.data,r=e.context,i=Math.min(e.height,e.width)*e.radiusRatio/2,s=2*Math.PI/n.length,o=-Math.PI/2,u,a;t=t||0,r.beginPath();for(u=0;u<n.length;++u)a=n[u][1]/this.max,r[u===0?"moveTo":"lineTo"](Math.cos(u*s+o)*i*a+t,Math.sin(u*s+o)*i*a+t);r.closePath(),e.fill&&r.fill(),r.stroke()},getGeometry:function(e,t){var n=Math.min(t.height,t.width)*t.radiusRatio/2,r=2*Math.PI/t.data.length,i=-Math.PI/2,s=e[1]/this.max;return{x:Math.cos(e[0]*r+i)*n*s+t.width/2,y:Math.sin(e[0]*r+i)*n*s+t.height/2}},hit:function(e){var t=e.args,n=t[0],r=t[1],i=n.relX,s=n.relY,o,u,a,f;for(var l=0;l<r.series.length;l++){var c=r.series[l],h=c.data;for(var p=h.length;p--;){u=this.getGeometry(h[p],e),a=u.x-i,f=u.y-s,o=Math.sqrt(a*a+f*f);if(o<e.sensibility*2)return r.x=h[p][0],r.y=h[p][1],r.index=p,r.seriesIndex=l,r}}},drawHit:function(e){var t=2*Math.PI/e.data.length,n=-Math.PI/2,r=Math.min(e.height,e.width)*e.radiusRatio/2,i=e.args.series,s=i.points.hitRadius||i.points.radius||i.mouse.radius,o=e.context;o.translate(e.width/2,e.height/2);var u=e.args.index,a=e.data[u][1]/this.max,f=Math.cos(u*t+n)*r*a,l=Math.sin(u*t+n)*r*a;o.beginPath(),o.arc(f,l,s,0,2*Math.PI,!0),o.closePath(),o.stroke()},clearHit:function(e){var t=2*Math.PI/e.data.length,n=-Math.PI/2,r=Math.min(e.height,e.width)*e.radiusRatio/2,i=e.context,s=e.args.series,o=s.points?s.points.lineWidth:1;offset=(s.points.hitRadius||s.points.radius||s.mouse.radius)+o,i.translate(e.width/2,e.height/2);var u=e.args.index,a=e.data[u][1]/this.max,f=Math.cos(u*t+n)*r*a,l=Math.sin(u*t+n)*r*a;i.clearRect(f-offset,l-offset,offset*2,offset*2)},extendYRange:function(e,t){this.max=Math.max(e.max,this.max||-Number.MAX_VALUE)}}),function(){function e(e,t){return e.which?e.which===1:e.button===0||e.button===1}function t(e,t){return Math.min(Math.max(0,e),t.plotWidth-1)}function n(e,t){return Math.min(Math.max(0,e),t.plotHeight)}var r=Flotr.DOM,i=Flotr.EventAdapter,s=Flotr._;Flotr.addPlugin("selection",{options:{pinchOnly:null,mode:null,color:"#B6D9FF",fps:20},callbacks:{"flotr:mouseup":function(e){var t=this.options.selection,n=this.selection,r=this.getEventPosition(e);if(!t||!t.mode)return;n.interval&&clearInterval(n.interval),this.multitouches?n.updateSelection():t.pinchOnly||n.setSelectionPos(n.selection.second,r),n.clearSelection(),n.selecting&&n.selectionIsSane()&&(n.drawSelection(),n.fireSelectEvent(),this.ignoreClick=!0)},"flotr:mousedown":function(t){var n=this.options.selection,r=this.selection,i=this.getEventPosition(t);if(!n||!n.mode)return;if(!n.mode||!e(t)&&s.isUndefined(t.touches))return;n.pinchOnly||r.setSelectionPos(r.selection.first,i),r.interval&&clearInterval(r.interval),this.lastMousePos.pageX=null,r.selecting=!1,r.interval=setInterval(s.bind(r.updateSelection,this),1e3/n.fps)},"flotr:destroy":function(e){clearInterval(this.selection.interval)}},getArea:function(){var e=this.selection.selection,t=this.axes,n=e.first,r=e.second,i,s,o,u;return i=t.x.p2d(e.first.x),s=t.x.p2d(e.second.x),o=t.y.p2d(e.first.y),u=t.y.p2d(e.second.y),{x1:Math.min(i,s),y1:Math.min(o,u),x2:Math.max(i,s),y2:Math.max(o,u),xfirst:i,xsecond:s,yfirst:o,ysecond:u}},selection:{first:{x:-1,y:-1},second:{x:-1,y:-1}},prevSelection:null,interval:null,fireSelectEvent:function(e){var t=this.selection.getArea();e=e||"select",t.selection=this.selection.selection,i.fire(this.el,"flotr:"+e,[t,this])},setSelection:function(e,r){var i=this.options,s=this.axes.x,o=this.axes.y,u=o.scale,a=s.scale,f=i.selection.mode.indexOf("x")!=-1,l=i.selection.mode.indexOf("y")!=-1,c=this.selection.selection;this.selection.clearSelection(),c.first.y=n(f&&!l?0:(o.max-e.y1)*u,this),c.second.y=n(f&&!l?this.plotHeight-1:(o.max-e.y2)*u,this),c.first.x=t(l&&!f?0:(e.x1-s.min)*a,this),c.second.x=t(l&&!f?this.plotWidth:(e.x2-s.min)*a,this),this.selection.drawSelection(),r||this.selection.fireSelectEvent()},setSelectionPos:function(e,r){var i=this.options.selection.mode,s=this.selection.selection;i.indexOf("x")==-1?e.x=e==s.first?0:this.plotWidth:e.x=t(r.relX,this),i.indexOf("y")==-1?e.y=e==s.first?0:this.plotHeight-1:e.y=n(r.relY,this)},drawSelection:function(){this.selection.fireSelectEvent("selecting");var e=this.selection.selection,t=this.octx,n=this.options,r=this.plotOffset,i=this.selection.prevSelection;if(i&&e.first.x==i.first.x&&e.first.y==i.first.y&&e.second.x==i.second.x&&e.second.y==i.second.y)return;t.save(),t.strokeStyle=this.processColor(n.selection.color,{opacity:.8}),t.lineWidth=1,t.lineJoin="miter",t.fillStyle=this.processColor(n.selection.color,{opacity:.4}),this.selection.prevSelection={first:{x:e.first.x,y:e.first.y},second:{x:e.second.x,y:e.second.y}};var s=Math.min(e.first.x,e.second.x),o=Math.min(e.first.y,e.second.y),u=Math.abs(e.second.x-e.first.x),a=Math.abs(e.second.y-e.first.y);t.fillRect(s+r.left+.5,o+r.top+.5,u,a),t.strokeRect(s+r.left+.5,o+r.top+.5,u,a),t.restore()},updateSelection:function(){if(!this.lastMousePos.pageX)return;this.selection.selecting=!0;if(this.multitouches)this.selection.setSelectionPos(this.selection.selection.first,this.getEventPosition(this.multitouches[0])),this.selection.setSelectionPos(this.selection.selection.second,this.getEventPosition(this.multitouches[1]));else{if(this.options.selection.pinchOnly)return;this.selection.setSelectionPos(this.selection.selection.second,this.lastMousePos)}this.selection.clearSelection(),this.selection.selectionIsSane()&&this.selection.drawSelection()},clearSelection:function(){if(!this.selection.prevSelection)return;var e=this.selection.prevSelection,t=1,n=this.plotOffset,r=Math.min(e.first.x,e.second.x),i=Math.min(e.first.y,e.second.y),s=Math.abs(e.second.x-e.first.x),o=Math.abs(e.second.y-e.first.y);this.octx.clearRect(r+n.left-t+.5,i+n.top-t,s+2*t+.5,o+2*t+.5),this.selection.prevSelection=null},selectionIsSane:function(){var e=this.selection.selection;return Math.abs(e.second.x-e.first.x)>=5||Math.abs(e.second.y-e.first.y)>=5}})}(),function(){var e=Flotr.DOM,t=Flotr._;Flotr.addPlugin("legend",{options:{show:!0,noColumns:1,labelFormatter:function(e){return e},labelBoxBorderColor:"#CCCCCC",labelBoxWidth:14,labelBoxHeight:10,labelBoxMargin:5,container:null,position:"nw",margin:5,backgroundColor:"#F0F0F0",backgroundOpacity:.85},callbacks:{"flotr:afterinit":function(){this.legend.insertLegend()},"flotr:destroy":function(){var t=this.legend.markup;t&&(this.legend.markup=null,e.remove(t))}},insertLegend:function(){if(!this.options.legend.show)return;var n=this.series,r=this.plotOffset,i=this.options,s=i.legend,o=[],u=!1,a=this.ctx,f=t.filter(n,function(e){return e.label&&!e.hide}).length,l=s.position,c=s.margin,h=s.backgroundOpacity,p,d,v;if(f){var m=s.labelBoxWidth,g=s.labelBoxHeight,y=s.labelBoxMargin,b=r.left+c,w=r.top+c,E=0,S={size:i.fontSize*1.1,color:i.grid.color};for(p=n.length-1;p>-1;--p){if(!n[p].label||n[p].hide)continue;d=s.labelFormatter(n[p].label),E=Math.max(E,this._text.measureText(d,S).width)}var x=Math.round(m+y*3+E),T=Math.round(f*(y+g)+y);!h&&h!==0&&(h=.1);if(!i.HtmlText&&this.textEnabled&&!s.container){l.charAt(0)=="s"&&(w=r.top+this.plotHeight-(c+T)),l.charAt(0)=="c"&&(w=r.top+this.plotHeight/2-(c+T/2)),l.charAt(1)=="e"&&(b=r.left+this.plotWidth-(c+x)),v=this.processColor(s.backgroundColor,{opacity:h}),a.fillStyle=v,a.fillRect(b,w,x,T),a.strokeStyle=s.labelBoxBorderColor,a.strokeRect(Flotr.toPixel(b),Flotr.toPixel(w),x,T);var N=b+y,C=w+y;for(p=0;p<n.length;p++){if(!n[p].label||n[p].hide)continue;d=s.labelFormatter(n[p].label),a.fillStyle=n[p].color,a.fillRect(N,C,m-1,g-1),a.strokeStyle=s.labelBoxBorderColor,a.lineWidth=1,a.strokeRect(Math.ceil(N)-1.5,Math.ceil(C)-1.5,m+2,g+2),Flotr.drawText(a,d,N+m+y,C+g,S),C+=g+y}}else{for(p=0;p<n.length;++p){if(!n[p].label||n[p].hide)continue;p%s.noColumns===0&&(o.push(u?"</tr><tr>":"<tr>"),u=!0);var k=n[p],L=s.labelBoxWidth,A=s.labelBoxHeight;d=s.labelFormatter(k.label),v="background-color:"+(k.bars&&k.bars.show&&k.bars.fillColor&&k.bars.fill?k.bars.fillColor:k.color)+";",o.push('<td class="flotr-legend-color-box">','<div style="border:1px solid ',s.labelBoxBorderColor,';padding:1px">','<div style="width:',L-1,"px;height:",A-1,"px;border:1px solid ",n[p].color,'">','<div style="width:',L,"px;height:",A,"px;",v,'"></div>',"</div>","</div>","</td>",'<td class="flotr-legend-label">',d,"</td>")}u&&o.push("</tr>");if(o.length>0){var O='<table style="font-size:smaller;color:'+i.grid.color+'">'+o.join("")+"</table>";if(s.container)O=e.node(O),this.legend.markup=O,e.insert(s.container,O);else{var M={position:"absolute",zIndex:"2",border:"1px solid "+s.labelBoxBorderColor};l.charAt(0)=="n"?(M.top=c+r.top+"px",M.bottom="auto"):l.charAt(0)=="c"?(M.top=c+(this.plotHeight-T)/2+"px",M.bottom="auto"):l.charAt(0)=="s"&&(M.bottom=c+r.bottom+"px",M.top="auto"),l.charAt(1)=="e"?(M.right=c+r.right+"px",M.left="auto"):l.charAt(1)=="w"&&(M.left=c+r.left+"px",M.right="auto");var P=e.create("div"),H;P.className="flotr-legend",e.setStyles(P,M),e.insert(P,O),e.insert(this.el,P);if(!h)return;var B=s.backgroundColor||i.grid.backgroundColor||"#ffffff";t.extend(M,e.size(P),{backgroundColor:B,zIndex:"",border:""}),M.width+="px",M.height+="px",P=e.create("div"),P.className="flotr-legend-bg",e.setStyles(P,M),e.opacity(P,h),e.insert(P," "),e.insert(this.el,P)}}}}}})}(),function(){var e=Flotr.DOM,t=Flotr._,n=Flotr,r="opacity:0.7;background-color:#000;color:#fff;position:absolute;padding:2px 8px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;";Flotr.addPlugin("hit",{callbacks:{"flotr:mousemove":function(e,t){this.hit.track(t)},"flotr:click":function(e){var n=this.hit.track(e);n&&!t.isUndefined(n.index)&&(e.hit=n)},"flotr:mouseout":function(e){e.relatedTarget!==this.mouseTrack&&this.hit.clearHit()},"flotr:destroy":function(){this.options.mouse.container&&e.remove(this.mouseTrack),this.mouseTrack=null}},track:function(e){if(this.options.mouse.track||t.any(this.series,function(e){return e.mouse&&e.mouse.track}))return this.hit.hit(e)},executeOnType:function(e,r,i){function u(e,u){t.each(t.keys(n.graphTypes),function(t){e[t]&&e[t].show&&this[t][r]&&(o=this.getOptions(e,t),o.fill=!!e.mouse.fillColor,o.fillStyle=this.processColor(e.mouse.fillColor||"#ffffff",{opacity:e.mouse.fillOpacity}),o.color=e.mouse.lineColor,o.context=this.octx,o.index=u,i&&(o.args=i),this[t][r].call(this[t],o),s=!0)},this)}var s=!1,o;return t.isArray(e)||(e=[e]),t.each(e,u,this),s},drawHit:function(e){var t=this.octx,n=e.series;if(n.mouse.lineColor){t.save(),t.lineWidth=n.points?n.points.lineWidth:1,t.strokeStyle=n.mouse.lineColor,t.fillStyle=this.processColor(n.mouse.fillColor||"#ffffff",{opacity:n.mouse.fillOpacity}),t.translate(this.plotOffset.left,this.plotOffset.top);if(!this.hit.executeOnType(n,"drawHit",e)){var r=e.xaxis,i=e.yaxis;t.beginPath(),t.arc(r.d2p(e.x),i.d2p(e.y),n.points.hitRadius||n.points.radius||n.mouse.radius,0,2*Math.PI,!0),t.fill(),t.stroke(),t.closePath()}t.restore(),this.clip(t)}this.prevHit=e},clearHit:function(){var t=this.prevHit,n=this.octx,r=this.plotOffset;n.save(),n.translate(r.left,r.top);if(t){if(!this.hit.executeOnType(t.series,"clearHit",this.prevHit)){var i=t.series,s=i.points?i.points.lineWidth:1;offset=(i.points.hitRadius||i.points.radius||i.mouse.radius)+s,n.clearRect(t.xaxis.d2p(t.x)-offset,t.yaxis.d2p(t.y)-offset,offset*2,offset*2)}e.hide(this.mouseTrack),this.prevHit=null}n.restore()},hit:function(e){var n=this.options,r=this.prevHit,i,s,o,u,a,f,l,c,h;if(this.series.length===0)return;h={relX:e.relX,relY:e.relY,absX:e.absX,absY:e.absY,series:this.series};if(n.mouse.trackY&&!n.mouse.trackAll&&this.hit.executeOnType(this.series,"hit",[e,h])&&!t.isUndefined(h.seriesIndex))a=this.series[h.seriesIndex],h.series=a,h.mouse=a.mouse,h.xaxis=a.xaxis,h.yaxis=a.yaxis;else{i=this.hit.closest(e);if(i){i=n.mouse.trackY?i.point:i.x,u=i.seriesIndex,a=this.series[u],l=a.xaxis,c=a.yaxis,s=2*a.mouse.sensibility;if(n.mouse.trackAll||i.distanceX<s/l.scale&&(!n.mouse.trackY||i.distanceY<s/c.scale))h.series=a,h.xaxis=a.xaxis,h.yaxis=a.yaxis,h.mouse=a.mouse,h.x=i.x,h.y=i.y,h.dist=i.distance,h.index=i.dataIndex,h.seriesIndex=u}}if(!r||r.index!==h.index||r.seriesIndex!==h.seriesIndex)this.hit.clearHit(),h.series&&h.mouse&&h.mouse.track&&(this.hit.drawMouseTrack(h),this.hit.drawHit(h),Flotr.EventAdapter.fire(this.el,"flotr:hit",[h,this]));return h},closest:function(e){function E(e){e.distance=h,e.distanceX=p,e.distanceY=d,e.seriesIndex=b,e.dataIndex=w,e.x=g,e.y=y,f=!0}var t=this.series,n=this.options,r=e.relX,i=e.relY,s=Number.MAX_VALUE,o=Number.MAX_VALUE,u={},a={},f=!1,l,c,h,p,d,v,m,g,y,b,w;for(b=0;b<t.length;b++){l=t[b],c=l.data,v=l.xaxis.p2d(r),m=l.yaxis.p2d(i);for(w=c.length;w--;){g=c[w][0],y=c[w][1];if(g===null||y===null)continue;if(g<l.xaxis.min||g>l.xaxis.max)continue;p=Math.abs(g-v),d=Math.abs(y-m),h=p*p+d*d,h<s&&(s=h,E(u)),p<o&&(o=p,E(a))}}return f?{point:u,x:a}:!1},drawMouseTrack:function(n){var i="",s=n.series,o=n.mouse.position,u=n.mouse.margin,a=n.x,f=n.y,l=r,c=this.mouseTrack,h=this.plotOffset,p=h.left,d=h.right,v=h.bottom,m=h.top,g=n.mouse.trackDecimals,y=this.options,b=y.mouse.container,w=0,E=0,S,x,T;c||(c=e.node('<div class="flotr-mouse-value" style="'+l+'"></div>'),this.mouseTrack=c,e.insert(b||this.el,c));if(!g||g<0)g=0;a&&a.toFixed&&(a=a.toFixed(g)),f&&f.toFixed&&(f=f.toFixed(g)),T=n.mouse.trackFormatter({x:a,y:f,series:n.series,index:n.index,nearest:n,fraction:n.fraction});if(t.isNull(T)||t.isUndefined(T)){e.hide(c);return}c.innerHTML=T,e.show(c);if(b)return;x=e.size(c),b&&(S=e.position(this.el),w=S.top,E=S.left);if(!n.mouse.relative)i+="top:",o.charAt(0)=="n"?i+=w+u+m:o.charAt(0)=="s"&&(i+=w-u+m+this.plotHeight-x.height),i+="px;bottom:auto;left:",o.charAt(1)=="e"?i+=E-u+p+this.plotWidth-x.width:o.charAt(1)=="w"&&(i+=E+u+p),i+="px;right:auto;";else if(s.pie&&s.pie.show){var N={x:this.plotWidth/2,y:this.plotHeight/2},C=Math.min(this.canvasWidth,this.canvasHeight)*s.pie.sizeRatio/2,k=n.sAngle<n.eAngle?(n.sAngle+n.eAngle)/2:(n.sAngle+n.eAngle+2*Math.PI)/2;i+="bottom:"+(u-m-N.y-Math.sin(k)*C/2+this.canvasHeight)+"px;top:auto;",i+="left:"+(u+p+N.x+Math.cos(k)*C/2)+"px;right:auto;"}else i+="top:",/n/.test(o)?i+=w-u+m+n.yaxis.d2p(n.y)-x.height:i+=w+u+m+n.yaxis.d2p(n.y),i+="px;bottom:auto;left:",/w/.test(o)?i+=E-u+p+n.xaxis.d2p(n.x)-x.width:i+=E+u+p+n.xaxis.d2p(n.x),i+="px;right:auto;";c.style.cssText=l+i,n.mouse.relative&&(/[ew]/.test(o)?/[ns]/.test(o)||(c.style.top=w+m+n.yaxis.d2p(n.y)-e.size(c).height/2+"px"):c.style.left=E+p+n.xaxis.d2p(n.x)-e.size(c).width/2+"px")}})}(),function(){var e=Flotr.DOM;Flotr.addPlugin("labels",{callbacks:{"flotr:afterdraw":function(){this.labels.draw()}},draw:function(){function b(e,t,r){var i=r?t.minorTicks:t.ticks,s=t.orientation===1,u=t.n===1,l,h;l={color:t.options.color||d.grid.color,angle:Flotr.toRad(t.options.labelsAngle),textBaseline:"middle"};for(c=0;c<i.length&&(r?t.options.showMinorLabels:t.options.showLabels);++c){n=i[c],n.label+="";if(!n.label||!n.label.length)continue;x=Math.cos(c*a+f)*o,y=Math.sin(c*a+f)*o,l.textAlign=s?Math.abs(x)<.1?"center":x<0?"right":"left":"left",Flotr.drawText(v,n.label,s?x:3,s?y:-(t.ticks[c].v/t.max)*(o-d.fontSize),l)}}function w(e,t,r,i){function f(e){return e.options.showLabels&&e.used}function l(e,t,n,r){return e.plotOffset.left+(t?r:n?-d.grid.labelMargin:d.grid.labelMargin+e.plotWidth)}function h(e,t,n,r){return e.plotOffset.top+(t?d.grid.labelMargin:r)+(t&&n?e.plotHeight:0)}var s=t.orientation===1,o=t.n===1,u,a;u={color:t.options.color||d.grid.color,textAlign:r,textBaseline:i,angle:Flotr.toRad(t.options.labelsAngle)},u=Flotr.getBestTextAlign(u.angle,u);for(c=0;c<t.ticks.length&&f(t);++c){n=t.ticks[c];if(!n.label||!n.label.length)continue;a=t.d2p(n.v);if(a<0||a>(s?e.plotWidth:e.plotHeight))continue;Flotr.drawText(v,n.label,l(e,s,o,a),h(e,s,o,a),u),!s&&!o&&(v.save(),v.strokeStyle=u.color,v.beginPath(),v.moveTo(e.plotOffset.left+e.plotWidth-8,e.plotOffset.top+t.d2p(n.v)),v.lineTo(e.plotOffset.left+e.plotWidth,e.plotOffset.top+t.d2p(n.v)),v.stroke(),v.restore())}}function E(e,t){var r=t.orientation===1,i=t.n===1,o="",u,a,f,l=e.plotOffset;!r&&!i&&(v.save(),v.strokeStyle=t.options.color||d.grid.color,v.beginPath());if(t.options.showLabels&&(i?!0:t.used))for(c=0;c<t.ticks.length;++c){n=t.ticks[c];if(!n.label||!n.label.length||(r?l.left:l.top)+t.d2p(n.v)<0||(r?l.left:l.top)+t.d2p(n.v)>(r?e.canvasWidth:e.canvasHeight))continue;f=l.top+(r?(i?1:-1)*(e.plotHeight+d.grid.labelMargin):t.d2p(n.v)-t.maxLabel.height/2),u=r?l.left+t.d2p(n.v)-s/2:0,o="",c===0?o=" first":c===t.ticks.length-1&&(o=" last"),o+=r?" flotr-grid-label-x":" flotr-grid-label-y",h+=['<div style="position:absolute; text-align:'+(r?"center":"right")+"; ","top:"+f+"px; ",(!r&&!i?"right:":"left:")+u+"px; ","width:"+(r?s:(i?l.left:l.right)-d.grid.labelMargin)+"px; ",t.options.color?"color:"+t.options.color+"; ":" ",'" class="flotr-grid-label'+o+'">'+n.label+"</div>"].join(" "),!r&&!i&&(v.moveTo(l.left+e.plotWidth-8,l.top+t.d2p(n.v)),v.lineTo(l.left+e.plotWidth,l.top+t.d2p(n.v)))}}var t,n,r,i,s,o,u,a,f,l,c,h="",p=0,d=this.options,v=this.ctx,m=this.axes,g={size:d.fontSize};for(c=0;c<m.x.ticks.length;++c)m.x.ticks[c].label&&++p;s=this.plotWidth/p,d.grid.circular&&(v.save(),v.translate(this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+this.plotHeight/2),o=this.plotHeight*d.radar.radiusRatio/2+d.fontSize,u=this.axes.x.ticks.length,a=2*(Math.PI/u),f=-Math.PI/2,b(this,m.x,!1),b(this,m.x,!0),b(this,m.y,!1),b(this,m.y,!0),v.restore()),!d.HtmlText&&this.textEnabled?(w(this,m.x,"center","top"),w(this,m.x2,"center","bottom"),w(this,m.y,"right","middle"),w(this,m.y2,"left","middle")):(m.x.options.showLabels||m.x2.options.showLabels||m.y.options.showLabels||m.y2.options.showLabels)&&!d.grid.circular&&(h="",E(this,m.x),E(this,m.x2),E(this,m.y),E(this,m.y2),v.stroke(),v.restore(),l=e.create("div"),e.setStyles(l,{fontSize:"smaller",color:d.grid.color}),l.className="flotr-labels",e.insert(this.el,l),e.insert(l,h))}})}(),function(){var e=Flotr.DOM,t=Flotr._;Flotr.addPlugin("legend",{options:{show:!0,noColumns:1,labelFormatter:function(e){return e},labelBoxBorderColor:"#CCCCCC",labelBoxWidth:14,labelBoxHeight:10,labelBoxMargin:5,container:null,position:"nw",margin:5,backgroundColor:"#F0F0F0",backgroundOpacity:.85},callbacks:{"flotr:afterinit":function(){this.legend.insertLegend()},"flotr:destroy":function(){var t=this.legend.markup;t&&(this.legend.markup=null,e.remove(t))}},insertLegend:function(){if(!this.options.legend.show)return;var n=this.series,r=this.plotOffset,i=this.options,s=i.legend,o=[],u=!1,a=this.ctx,f=t.filter(n,function(e){return e.label&&!e.hide}).length,l=s.position,c=s.margin,h=s.backgroundOpacity,p,d,v;if(f){var m=s.labelBoxWidth,g=s.labelBoxHeight,y=s.labelBoxMargin,b=r.left+c,w=r.top+c,E=0,S={size:i.fontSize*1.1,color:i.grid.color};for(p=n.length-1;p>-1;--p){if(!n[p].label||n[p].hide)continue;d=s.labelFormatter(n[p].label),E=Math.max(E,this._text.measureText(d,S).width)}var x=Math.round(m+y*3+E),T=Math.round(f*(y+g)+y);!h&&h!==0&&(h=.1);if(!i.HtmlText&&this.textEnabled&&!s.container){l.charAt(0)=="s"&&(w=r.top+this.plotHeight-(c+T)),l.charAt(0)=="c"&&(w=r.top+this.plotHeight/2-(c+T/2)),l.charAt(1)=="e"&&(b=r.left+this.plotWidth-(c+x)),v=this.processColor(s.backgroundColor,{opacity:h}),a.fillStyle=v,a.fillRect
(b,w,x,T),a.strokeStyle=s.labelBoxBorderColor,a.strokeRect(Flotr.toPixel(b),Flotr.toPixel(w),x,T);var N=b+y,C=w+y;for(p=0;p<n.length;p++){if(!n[p].label||n[p].hide)continue;d=s.labelFormatter(n[p].label),a.fillStyle=n[p].color,a.fillRect(N,C,m-1,g-1),a.strokeStyle=s.labelBoxBorderColor,a.lineWidth=1,a.strokeRect(Math.ceil(N)-1.5,Math.ceil(C)-1.5,m+2,g+2),Flotr.drawText(a,d,N+m+y,C+g,S),C+=g+y}}else{for(p=0;p<n.length;++p){if(!n[p].label||n[p].hide)continue;p%s.noColumns===0&&(o.push(u?"</tr><tr>":"<tr>"),u=!0);var k=n[p],L=s.labelBoxWidth,A=s.labelBoxHeight;d=s.labelFormatter(k.label),v="background-color:"+(k.bars&&k.bars.show&&k.bars.fillColor&&k.bars.fill?k.bars.fillColor:k.color)+";",o.push('<td class="flotr-legend-color-box">','<div style="border:1px solid ',s.labelBoxBorderColor,';padding:1px">','<div style="width:',L-1,"px;height:",A-1,"px;border:1px solid ",n[p].color,'">','<div style="width:',L,"px;height:",A,"px;",v,'"></div>',"</div>","</div>","</td>",'<td class="flotr-legend-label">',d,"</td>")}u&&o.push("</tr>");if(o.length>0){var O='<table style="font-size:smaller;color:'+i.grid.color+'">'+o.join("")+"</table>";if(s.container)O=e.node(O),this.legend.markup=O,e.insert(s.container,O);else{var M={position:"absolute",zIndex:"2",border:"1px solid "+s.labelBoxBorderColor};l.charAt(0)=="n"?(M.top=c+r.top+"px",M.bottom="auto"):l.charAt(0)=="c"?(M.top=c+(this.plotHeight-T)/2+"px",M.bottom="auto"):l.charAt(0)=="s"&&(M.bottom=c+r.bottom+"px",M.top="auto"),l.charAt(1)=="e"?(M.right=c+r.right+"px",M.left="auto"):l.charAt(1)=="w"&&(M.left=c+r.left+"px",M.right="auto");var P=e.create("div"),H;P.className="flotr-legend",e.setStyles(P,M),e.insert(P,O),e.insert(this.el,P);if(!h)return;var B=s.backgroundColor||i.grid.backgroundColor||"#ffffff";t.extend(M,e.size(P),{backgroundColor:B,zIndex:"",border:""}),M.width+="px",M.height+="px",P=e.create("div"),P.className="flotr-legend-bg",e.setStyles(P,M),e.opacity(P,h),e.insert(P," "),e.insert(this.el,P)}}}}}})}(),function(){var e=Flotr.DOM;Flotr.addPlugin("titles",{callbacks:{"flotr:afterdraw":function(){this.titles.drawTitles()}},drawTitles:function(){var t,n=this.options,r=n.grid.labelMargin,i=this.ctx,s=this.axes;if(!n.HtmlText&&this.textEnabled){var o={size:n.fontSize,color:n.grid.color,textAlign:"center"};n.subtitle&&Flotr.drawText(i,n.subtitle,this.plotOffset.left+this.plotWidth/2,this.titleHeight+this.subtitleHeight-2,o),o.weight=1.5,o.size*=1.5,n.title&&Flotr.drawText(i,n.title,this.plotOffset.left+this.plotWidth/2,this.titleHeight-2,o),o.weight=1.8,o.size*=.8,s.x.options.title&&s.x.used&&(o.textAlign=s.x.options.titleAlign||"center",o.textBaseline="top",o.angle=Flotr.toRad(s.x.options.titleAngle),o=Flotr.getBestTextAlign(o.angle,o),Flotr.drawText(i,s.x.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+s.x.maxLabel.height+this.plotHeight+2*r,o)),s.x2.options.title&&s.x2.used&&(o.textAlign=s.x2.options.titleAlign||"center",o.textBaseline="bottom",o.angle=Flotr.toRad(s.x2.options.titleAngle),o=Flotr.getBestTextAlign(o.angle,o),Flotr.drawText(i,s.x2.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top-s.x2.maxLabel.height-2*r,o)),s.y.options.title&&s.y.used&&(o.textAlign=s.y.options.titleAlign||"right",o.textBaseline="middle",o.angle=Flotr.toRad(s.y.options.titleAngle),o=Flotr.getBestTextAlign(o.angle,o),Flotr.drawText(i,s.y.options.title,this.plotOffset.left-s.y.maxLabel.width-2*r,this.plotOffset.top+this.plotHeight/2,o)),s.y2.options.title&&s.y2.used&&(o.textAlign=s.y2.options.titleAlign||"left",o.textBaseline="middle",o.angle=Flotr.toRad(s.y2.options.titleAngle),o=Flotr.getBestTextAlign(o.angle,o),Flotr.drawText(i,s.y2.options.title,this.plotOffset.left+this.plotWidth+s.y2.maxLabel.width+2*r,this.plotOffset.top+this.plotHeight/2,o))}else{t=[],n.title&&t.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;font-size:1em;font-weight:bold;text-align:center;width:",this.plotWidth,'px;" class="flotr-title">',n.title,"</div>"),n.subtitle&&t.push('<div style="position:absolute;top:',this.titleHeight,"px;left:",this.plotOffset.left,"px;font-size:smaller;text-align:center;width:",this.plotWidth,'px;" class="flotr-subtitle">',n.subtitle,"</div>"),t.push("</div>"),t.push('<div class="flotr-axis-title" style="font-weight:bold;">'),s.x.options.title&&s.x.used&&t.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight+n.grid.labelMargin+s.x.titleSize.height,"px;left:",this.plotOffset.left,"px;width:",this.plotWidth,"px;text-align:",s.x.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-x1">',s.x.options.title,"</div>"),s.x2.options.title&&s.x2.used&&t.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;width:",this.plotWidth,"px;text-align:",s.x2.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-x2">',s.x2.options.title,"</div>"),s.y.options.title&&s.y.used&&t.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-s.y.titleSize.height/2,"px;left:0;text-align:",s.y.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-y1">',s.y.options.title,"</div>"),s.y2.options.title&&s.y2.used&&t.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-s.y.titleSize.height/2,"px;right:0;text-align:",s.y2.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-y2">',s.y2.options.title,"</div>"),t=t.join("");var u=e.create("div");e.setStyles({color:n.grid.color}),u.className="flotr-titles",e.insert(this.el,u),e.insert(u,t)}}})}(),function(){function t(){var t=this.options,n=this.handles,r=this.el,i,s,o,u;if(!t.selection.mode||!t.handles.show||"ontouchstart"in r)return;n.initialized=!0,u=e.node('<div class="flotr-handles"></div>'),t=t.handles,t.drag&&(o=e.node('<div class="flotr-handles-handle flotr-handles-drag flotr-handles-right"></div>'),s=e.node('<div class="flotr-handles-handle flotr-handles-drag flotr-handles-left"></div>'),e.insert(u,o),e.insert(u,s),e.hide(s),e.hide(o),n.left=s,n.right=o,this.observe(s,"mousedown",function(){n.moveHandler=a}),this.observe(o,"mousedown",function(){n.moveHandler=f})),t.scroll&&(i=e.node('<div class="flotr-handles-handle flotr-handles-scroll"></div>'),e.insert(u,i),e.hide(i),n.scroll=i,this.observe(i,"mousedown",function(){n.moveHandler=l})),this.observe(document,"mouseup",function(){n.moveHandler=null}),e.insert(r,u)}function n(e){if(!this.handles.initialized)return;var t=this.handles,n=this.options.handles,s=t.left,o=t.right,u=t.scroll;n&&(n.drag&&(r(this,s,e.x1),r(this,o,e.x2)),n.scroll&&i(this,u,e.x1,e.x2))}function r(t,n,r){e.show(n);var i=e.size(n),s=Math.round(t.axes.x.d2p(r)-i.width/2),o=(t.plotHeight-i.height)/2;e.setStyles(n,{left:s+"px",top:o+"px"})}function i(t,n,r,i){e.show(n);var s=e.size(n),o=Math.round(t.axes.x.d2p(r)),u=t.plotHeight-s.height/2,a=t.axes.x.d2p(i)-t.axes.x.d2p(r);e.setStyles(n,{left:o+"px",top:u+"px",width:a+"px"})}function s(){if(!this.handles.initialized)return;var t=this.handles;t&&(e.hide(t.left),e.hide(t.right),e.hide(t.scroll))}function o(e,t){if(!this.handles.initialized)return;if(!this.handles.moveHandler)return;var n=t.x-this.lastMousePos.x,r=this.selection.selection,i=this.selection.getArea(),s=this.handles;s.moveHandler(i,n),u(i,s),this.selection.setSelection(i)}function u(e,t){var n=t.moveHandler;e.x1>e.x2&&(n==a?n=f:n==f&&(n=a),t.moveHandler=n)}function a(e,t){e.x1+=t}function f(e,t){e.x2+=t}function l(e,t){e.x1+=t,e.x2+=t}var e=Flotr.DOM;Flotr.addPlugin("handles",{options:{show:!1,drag:!0,scroll:!0},callbacks:{"flotr:afterinit":t,"flotr:select":n,"flotr:mousedown":s,"flotr:mousemove":o}})}(),function(){var e=Flotr.EventAdapter,t=Flotr._;Flotr.addPlugin("graphGrid",{callbacks:{"flotr:beforedraw":function(){this.graphGrid.drawGrid()},"flotr:afterdraw":function(){this.graphGrid.drawOutline()}},drawGrid:function(){function v(e){for(p=0;p<e.length;++p){var t=e[p].v/c.max;for(d=0;d<=w;++d)n[d===0?"moveTo":"lineTo"](Math.cos(d*S+x)*b*t,Math.sin(d*S+x)*b*t)}}function m(e,r){t.each(t.pluck(e,"v"),function(e){if(e<=c.min||e>=c.max||(e==c.min||e==c.max)&&i.outlineWidth)return;r(Math.floor(c.d2p(e))+n.lineWidth/2)})}function g(e){n.moveTo(e,0),n.lineTo(e,f)}function y(e){n.moveTo(0,e),n.lineTo(l,e)}var n=this.ctx,r=this.options,i=r.grid,s=i.verticalLines,o=i.horizontalLines,u=i.minorVerticalLines,a=i.minorHorizontalLines,f=this.plotHeight,l=this.plotWidth,c,h,p,d;(s||u||o||a)&&e.fire(this.el,"flotr:beforegrid",[this.axes.x,this.axes.y,r,this]),n.save(),n.lineWidth=1,n.strokeStyle=i.tickColor;if(i.circular){n.translate(this.plotOffset.left+l/2,this.plotOffset.top+f/2);var b=Math.min(f,l)*r.radar.radiusRatio/2,w=this.axes.x.ticks.length,S=2*(Math.PI/w),x=-Math.PI/2;n.beginPath(),c=this.axes.y,o&&v(c.ticks),a&&v(c.minorTicks),s&&t.times(w,function(e){n.moveTo(0,0),n.lineTo(Math.cos(e*S+x)*b,Math.sin(e*S+x)*b)}),n.stroke()}else n.translate(this.plotOffset.left,this.plotOffset.top),i.backgroundColor&&(n.fillStyle=this.processColor(i.backgroundColor,{x1:0,y1:0,x2:l,y2:f}),n.fillRect(0,0,l,f)),n.beginPath(),c=this.axes.x,s&&m(c.ticks,g),u&&m(c.minorTicks,g),c=this.axes.y,o&&m(c.ticks,y),a&&m(c.minorTicks,y),n.stroke();n.restore(),(s||u||o||a)&&e.fire(this.el,"flotr:aftergrid",[this.axes.x,this.axes.y,r,this])},drawOutline:function(){var e=this,t=e.options,n=t.grid,r=n.outline,s=e.ctx,o=n.backgroundImage,u=e.plotOffset,a=u.left,f=u.top,l=e.plotWidth,c=e.plotHeight,h,p,d,v,m,g;if(!n.outlineWidth)return;s.save();if(n.circular){s.translate(a+l/2,f+c/2);var y=Math.min(c,l)*t.radar.radiusRatio/2,b=this.axes.x.ticks.length,w=2*(Math.PI/b),E=-Math.PI/2;s.beginPath(),s.lineWidth=n.outlineWidth,s.strokeStyle=n.color,s.lineJoin="round";for(i=0;i<=b;++i)s[i===0?"moveTo":"lineTo"](Math.cos(i*w+E)*y,Math.sin(i*w+E)*y);s.stroke()}else{s.translate(a,f);var S=n.outlineWidth,x=.5-S+(S+1)%2/2,T="lineTo",N="moveTo";s.lineWidth=S,s.strokeStyle=n.color,s.lineJoin="miter",s.beginPath(),s.moveTo(x,x),l-=S/2%1,c+=S/2,s[r.indexOf("n")!==-1?T:N](l,x),s[r.indexOf("e")!==-1?T:N](l,c),s[r.indexOf("s")!==-1?T:N](x,c),s[r.indexOf("w")!==-1?T:N](x,x),s.stroke(),s.closePath()}s.restore(),o&&(d=o.src||o,v=(parseInt(o.left,10)||0)+u.left,m=(parseInt(o.top,10)||0)+u.top,p=new Image,p.onload=function(){s.save(),o.alpha&&(s.globalAlpha=o.alpha),s.globalCompositeOperation="destination-over",s.drawImage(p,0,0,p.width,p.height,v,m,l,c),s.restore()},p.src=d)}})}(),!function(e,t){typeof define=="function"?define(t):typeof module!="undefined"?module.exports=t():this[e]=t()}("bonzo",function(){function e(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}function t(e,t,n){for(var r=0,i=e.length;r<i;r++)t.call(n||e[r],e[r],r,e);return e}function n(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function r(e){return e&&e.nodeName&&e.nodeType==1}function i(e,t,n,r){for(r=0,j=e.length;r<j;++r)if(t.call(n,e[r],r,e))return!0;return!1}function s(e,n,r){var i=0,s=n||this,o=[],u=E&&typeof e=="string"&&e.charAt(0)!="<"?function(t){return(t=E(e))&&(t.selected=1)&&t}():e;return t(c(u),function(e){t(s,function(t){var n=!t[w]||t[w]&&!t[w][w]?function(){var e=t.cloneNode(!0);return s.$&&s.cloneEvents&&s.$(e).cloneEvents(t),e}():t;r(e,n),o[i]=n,i++})},this),t(o,function(e,t){s[t]=e}),s.length=i,s}function o(e,t,n){var r=v(e),i=r.css("position"),s=r.offset(),o="relative",u=i==o,a=[parseInt(r.css("left"),10),parseInt(r.css("top"),10)];i=="static"&&(r.css("position",o),i=o),isNaN(a[0])&&(a[0]=u?0:e.offsetLeft),isNaN(a[1])&&(a[1]=u?0:e.offsetTop),t!=null&&(e.style.left=t-s.left+a[0]+M),n!=null&&(e.style.top=n-s.top+a[1]+M)}function u(t,n){return e(n).test(t.className)}function a(e,t){e.className=F(e.className+" "+t)}function f(t,n){t.className=F(t.className.replace(e(n)," "))}function l(e){this.length=0;if(e){e=typeof e!="string"&&!e.nodeType&&typeof e.length!="undefined"?e:[e],this.length=e.length;for(var t=0;t<e.length;t++)this[t]=e[t]}}function c(e){return typeof e=="string"?v.create(e):r(e)?[e]:e}function h(e,t,n){var r=this[0];return e==null&&t==null?(p(r)?d():{x:r.scrollLeft,y:r.scrollTop})[n]:(p(r)?g.scrollTo(e,t):(e!=null&&(r.scrollLeft=e),t!=null&&(r.scrollTop=t)),this)}function p(e){return e===g||/^(?:body|html)$/i.test(e.tagName)}function d(){return{x:g.pageXOffset||b.scrollLeft,y:g.pageYOffset||b.scrollTop}}function v(e,t){return new l(e,t)}var m=this,g=window,y=g.document,b=y.documentElement,w="parentNode",E=null,S=/^checked|value|selected$/,x=/select|fieldset|table|tbody|tfoot|td|tr|colgroup/i,T="table",N={thead:T,tbody:T,tfoot:T,tr:"tbody",th:"tr",td:"tr",fieldset:"form",option:"select"},C=/^checked|selected$/,k=/msie/i.test(navigator.userAgent),L=[],A=0,O=/^-?[\d\.]+$/,M="px",_="setAttribute",D="getAttribute",P=/(^\s*|\s*$)/g,H={lineHeight:1,zoom:1,zIndex:1,opacity:1},B=function(){var e=["webkitTransform","MozTransform","OTransform","msTransform","Transform"],t;for(t=0;t<e.length;t++)if(e[t]in y.createElement("a").style)return e[t]}(),F=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(P,"")},I=y.defaultView&&y.defaultView.getComputedStyle?function(e,t){t=t=="transform"?B:t,t=t=="transform-origin"?B+"Origin":t;var r=null;t=="float"&&(t="cssFloat");var i=y.defaultView.getComputedStyle(e,"");return i&&(r=i[n(t)]),e.style[t]||r}:k&&b.currentStyle?function(e,t){t=n(t),t=t=="float"?"styleFloat":t;if(t=="opacity"){var r=100;try{r=e.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(i){try{r=e.filters("alpha").opacity}catch(s){}}return r/100}var o=e.currentStyle?e.currentStyle[t]:null;return e.style[t]||o}:function(e,t){return e.style[n(t)]};l.prototype={get:function(e){return this[e]},each:function(e,n){return t(this,e,n)},map:function(e,t){var n=[],r,i;for(i=0;i<this.length;i++)r=e.call(this,this[i],i),t?t(r)&&n.push(r):n.push(r);return n},first:function(){return v(this[0])},last:function(){return v(this[this.length-1])},html:function(e,n){function r(n){while(n.firstChild)n.removeChild(n.firstChild);t(c(e),function(e){n.appendChild(e)})}var i=n?b.textContent===null?"innerText":"textContent":"innerHTML",s;return typeof e!="undefined"?this.each(function(t){(s=t.tagName.match(x))?r(t,s[0]):t[i]=e}):this[0]?this[0][i]:""},text:function(e){return this.html(e,1)},addClass:function(e){return this.each(function(t){u(t,e)||a(t,e)})},removeClass:function(e){return this.each(function(t){u(t,e)&&f(t,e)})},hasClass:function(e){return i(this,function(t){return u(t,e)})},toggleClass:function(e,t){return this.each(function(n){typeof t!="undefined"?t?a(n,e):f(n,e):u(n,e)?f(n,e):a(n,e)})},show:function(e){return this.each(function(t){t.style.display=e||""})},hide:function(e){return this.each(function(e){e.style.display="none"})},append:function(e){return this.each(function(n){t(c(e),function(e){n.appendChild(e)})})},prepend:function(e){return this.each(function(n){var r=n.firstChild;t(c(e),function(e){n.insertBefore(e,r)})})},appendTo:function(e,t){return s.call(this,e,t,function(e,t){e.appendChild(t)})},prependTo:function(e,t){return s.call(this,e,t,function(e,t){e.insertBefore(t,e.firstChild)})},next:function(){return this.related("nextSibling")},previous:function(){return this.related("previousSibling")},related:function(e){return this.map(function(t){t=t[e];while(t&&t.nodeType!==1)t=t[e];return t||0},function(e){return e})},before:function(e){return this.each(function(n){t(v.create(e),function(e){n[w].insertBefore(e,n)})})},after:function(e){return this.each(function(n){t(v.create(e),function(e){n[w].insertBefore(e,n.nextSibling)})})},insertBefore:function(e,t){return s.call(this,e,t,function(e,t){e[w].insertBefore(t,e)})},insertAfter:function(e,t){return s.call(this,e,t,function(e,t){var n=e.nextSibling;n?e[w].insertBefore(t,n):e[w].appendChild(t)})},css:function(e,t,r){function i(e,t,r){for(var i in s)s.hasOwnProperty(i)&&(r=s[i],(t=n(i))&&O.test(r)&&!(t in H)&&(r+=M),t=t=="transform"?B:t,t=t=="transformOrigin"?B+"Origin":t,e.style[t]=r)}if(t===undefined&&typeof e=="string")return t=this[0],t?t==y||t==g?(r=t==y?v.doc():v.viewport(),e=="width"?r.width:e=="height"?r.height:""):I(t,e):null;var s=e;typeof e=="string"&&(s={},s[e]=t),k&&s.opacity&&(s.filter="alpha(opacity="+s.opacity*100+")",s.zoom=e.zoom||1,delete s.opacity);if(t=s["float"])k?s.styleFloat=t:s.cssFloat=t,delete s["float"];return this.each(i)},offset:function(e,t){if(typeof e=="number"||typeof t=="number")return this.each(function(n){o(n,e,t)});var n=this[0],r=n.offsetWidth,i=n.offsetHeight,s=n.offsetTop,u=n.offsetLeft;while(n=n.offsetParent)s+=n.offsetTop,u+=n.offsetLeft;return{top:s,left:u,height:i,width:r}},attr:function(e,t){var n=this[0];if(typeof e=="string"||e instanceof String)return typeof t=="undefined"?S.test(e)?C.test(e)&&typeof n[e]=="string"?!0:n[e]:n[D](e):this.each(function(n){S.test(e)?n[e]=t:n[_](e,t)});for(var r in e)e.hasOwnProperty(r)&&this.attr(r,e[r]);return this},val:function(e){return typeof e=="string"?this.attr("value",e):this[0].value},removeAttr:function(e){return this.each(function(t){C.test(e)?t[e]=!1:t.removeAttribute(e)})},data:function(e,t){var n=this[0];if(typeof t=="undefined"){n[D]("data-node-uid")||n[_]("data-node-uid",++A);var r=n[D]("data-node-uid");return L[r]||(L[r]={}),L[r][e]}return this.each(function(n){n[D]("data-node-uid")||n[_]("data-node-uid",++A);var r=n[D]("data-node-uid"),i=L[r]||(L[r]={});i[e]=t})},remove:function(){return this.each(function(e){e[w]&&e[w].removeChild(e)})},empty:function(){return this.each(function(e){while(e.firstChild)e.removeChild(e.firstChild)})},detach:function(){return this.map(function(e){return e[w].removeChild(e)})},scrollTop:function(e){return h.call(this,null,e,"y")},scrollLeft:function(e){return h.call(this,e,null,"x")},toggle:function(e){return this.each(function(e){e.style.display=e.offsetWidth||e.offsetHeight?"none":"block"}),e&&e(),this}},v.setQueryEngine=function(e){E=e,delete v.setQueryEngine},v.aug=function(e,t){for(var n in e)e.hasOwnProperty(n)&&((t||l.prototype)[n]=e[n])},v.create=function(e){return typeof e=="string"?function(){var t=/^<([^\s>]+)/.exec(e),n=y.createElement(t&&N[t[1].toLowerCase()]||"div"),r=[];n.innerHTML=e;var i=n.childNodes;n=n.firstChild,r.push(n);while(n=n.nextSibling)n.nodeType==1&&r.push(n);return r}():r(e)?[e.cloneNode(!0)]:[]},v.doc=function(){var e=this.viewport();return{width:Math.max(y.body.scrollWidth,b.scrollWidth,e.width),height:Math.max(y.body.scrollHeight,b.scrollHeight,e.height)}},v.firstChild=function(e){for(var t=e.childNodes,n=0,r=t&&t.length||0,i;n<r;n++)t[n].nodeType===1&&(i=t[r=n]);return i},v.viewport=function(){return{width:k?b.clientWidth:self.innerWidth,height:k?b.clientHeight:self.innerHeight}},v.isAncestor="compareDocumentPosition"in b?function(e,t){return(e.compareDocumentPosition(t)&16)==16}:"contains"in b?function(e,t){return e!==t&&e.contains(t)}:function(e,t){while(t=t[w])if(t===e)return!0;return!1};var q=m.bonzo;return v.noConflict=function(){return m.bonzo=q,this},v});var envision={_:Flotr._,bean:Flotr.bean,bonzo:bonzo,noConflict:function(e){var t=e.envision;return function(){return e.envision=t,this}}(this)};(function(){function r(e){this.options=e||{},this.components=[],this.node=null,this.rendered=!1}var e="envision-first",t="envision-last",n='<div class="envision-visualization"></div>';T_COMPONENT_CONTAINER='<div class="envision-component-container"></div>',r.prototype={render:function(e){var t=this.options;e=e||t.element;if(!e)throw"No element to render within.";return this.node=bonzo.create(n)[0],bonzo(this.node).addClass(t.name||""),this.container=e,bonzo(e).append(this.node),bonzo(e).data("envision",this),_.each(this.components,function(e){this._renderComponent(e)},this),this._updateClasses(),this.rendered=!0,this},add:function(e){return this.components.push(e),this.rendered&&(this._renderComponent(e),this._updateClasses()),this},remove:function(e){var t=this.components,n=this.indexOf(e);return n!==-1&&(t.splice(n,1),bonzo(e.container).remove(),this._updateClasses()),this},setPosition:function(e,t){var n=this.components;return t>=0&&t<n.length&&this.remove(e)&&(this.rendered&&(t===n.length?this.node.appendChild(e.container):this.node.insertBefore(e.container,n[t].container)),n.splice(t,0,e),this._updateClasses()),this},indexOf:function(e){return _.indexOf(this.components,e)},getComponent:function(e){var t=this.components;if(e<t.length)return t[e]},isFirst:function(e){return this.indexOf(e)===0?!0:!1},isLast:function(e){return this.indexOf(e)===this.components.length-1?!0:!1},destroy:function(){_.each(this.components,function(e){e.destroy()}),bonzo(this.container).empty()},_renderComponent:function(e){var t=bonzo.create(T_COMPONENT_CONTAINER)[0];bonzo(this.node).append(t),e.render(t)},_updateClasses:function(){var n=this.components,r=0,i=n.length-1,s;_.each(n,function(n,o){s=bonzo(n.container),o===r?s.addClass(e):s.removeClass(e),o===i?s.addClass(t):s.removeClass(t)})}},envision.Visualization=r})(),function(){function r(t){t=t||{};var r=bonzo.create(n)[0];this.options=t,this.node=r,t.adapter?this.api=t.adapter:t.adapterConstructor?this.api=new t.adapterConstructor(t.config):t.adapterCallback?this.api=t.adapterCallback.call(null,t.config):t.config&&(this.api=new e.adapters.flotr.Child(t.config||{})),this.preprocessors=[]}var e=envision,t="envision-component",n='<div class="'+t+'"></div>';r.prototype={render:function(e){var t=this.node,n=this.options;e=e||n.element;if(!e)throw"No element to render within.";bonzo(e).addClass(n.name||"").append(this.node),this._setDimension("width"),this._setDimension("height"),this.container=e,this.draw(n.data,n.config)},draw:function(t,n){var r=this.api,i=this.options,s=this.preprocessors,o;o=t=t||i.data,n=n||i.config,!i.skipPreprocess&&t&&(o=[],_.each(r.getDataArray(t),function(u,a){var f=s[a]||new e.Preprocessor,l=_.isArray(u),c=_.isFunction(u),h=l?u:c?u:u.data,p=i.processData,d=r.range(n),v=d.min,m=d.max,g=this.node.clientWidth,y=u,b,w;!c&&!l&&(y=u.data,w=_.extend({},u)),c?b=t(v,m,g):(y!==f.data?f.setData(y):f.reset(),p?(p.apply(this,[{preprocessor:f,min:v,max:m,resolution:g}]),b=f.getData()):b=f.bound(v,m).subsampleMinMax(g).getData()),r.transformData&&(b=r.transformData(b)),w?(w.data=b,o.push(w)):o.push(b)},this)),r&&r.draw(o,n,this.node)},trigger:function(){this.api.trigger.apply(this.api,Array.prototype.concat.apply([this],arguments))},attach:function(){this.api.attach.apply(this.api,Array.prototype.concat.apply([this],arguments))},detach:function(){this.api.detach.apply(this.api,Array.prototype.concat.apply([this],arguments))},destroy:function(){this.api&&this.api.destroy&&this.api.destroy(),bonzo(this.container).empty()},_setDimension:function(e){var t=this.node,n=this.options;n[e]?bonzo(t).css(e,n[e]):n[e]=t.clientWidth,this[e]=n[e]}},e.Component=r}(),function(){function t(e){this.options=e=e||{},this.actions=[],this.actionOptions=[],this.followers=[],this.leaders=[],this.prevent={},e.leader&&this.leader(e.leader)}var e=envision;t.prototype={leader:function(e){return this.leaders.push(e),_.each(this.actions,function(t,n){this._bindLeader(e,t,this.actionOptions[n])},this),this},follower:function(e){return this.followers.push(e),this},group:function(e){return _.isArray(e)||(e=[e]),_.each(e,function(e){this.leader(e),this.follower(e)},this),this},add:function(e,t){return this.actions.push(e),this.actionOptions.push(t),_.each(this.leaders,function(n){this._bindLeader(n,e,t)},this),this},_bindLeader:function(e,t,n){_.each(t.events,function(t){var r=t.handler||t,i=t.consumer||t;e.attach(r,_.bind(function(e,t){if(this.prevent[name])return;n&&n.callback&&n.callback.call(this,t),this.prevent[name]=!0;try{_.each(this.followers,function(n){if(e===n)return;n.trigger(i,t)},this)}catch(r){throw this.prevent[name]=!1,r}this.prevent[name]=!1},this))},this)}},e.Interaction=t}(),function(){function e(e){e=e||{},this.getData=function(){return this.bounded&&r(this),this.processing},this.reset=function(){return this.processing=this.data,this},this.setData=function(e){var t,n;if(!_.isArray(e))throw new Error("Array expected.");if(e.length<2)throw new Error("Data must contain at least two dimensions.");n=e[0].length;for(t=e.length;t--;){if(!_.isArray(e[t]))throw new Error("Data dimensions must be arrays.");if(e[t].length!==n)throw new Error("Data dimensions must contain the same number of points.")}return this.processing=e,this.data=e,this},e.data&&this.setData(e.data)}function t(e,t){var n=_.sortedIndex(e,t);return e[n]>t&&n>0&&n--,n}function n(e,t){return _.sortedIndex(e,t)}function r(e){delete e.bounded;var r=e.processing,i=e.length(),s=r[0],o=r[1],u=e.min||0,a=e.max||i,f=t(s,u),l=n(s,a);e.processing=[s.slice(f,l+1),o.slice(f,l+1)],e.start=f,e.end=l}function i(e,t,n,r,i,s,o,u,a){var f=(e-r)/(s-r),l=1-f,c=(1+2*f)*l*l,h=f*l*l,p=f*f*(3-2*f),d=f*f*(f-1),v=(o-i)/(2*(s-r))+(typeof n=="undefined"?0:(i-n)/(2*(r-t))),m=(typeof a=="undefined"?0:(a-o)/(2*(u-s)))+(o-i)/(2*(s-r)),g=c*i+h*(s-r)*v+p*o+d*(s-r)*m;return g}e.prototype={length:function(){return this.getData()[0].length},bound:function(e,t){return!_.isNumber(e)||!_.isNumber(t)?this:(this.min=e,this.max=t,this.bounded=!0,this)},subsampleMinMax:function(e){var r=this.bounded;delete this.bounded;var i=this.processing,s=this.length(),o=i[0],u=i[1],a=r?t(o,this.min):0,f=r?n(o,this.max):s-1,l=(e-2)/2,c=[],h=[],p=Number.MAX_VALUE,d=-Number.MAX_VALUE,v=1,m=1,g=(f-a)/l,y,b,w,E;if(f-a+1>e){c.push(o[a]),h.push(u[a]),y=a+g;for(w=a;w<f;w++)w===Math.round(y)?(y+=g,E=Math.min(m,v),c.push(o[E]),h.push(u[E]),E=Math.max(m,v),c.push(o[E]),h.push(u[E]),v=w,p=u[v],m=w,d=u[m]):(u[w]>d&&(d=u[w],m=w),u[w]<p&&(p=u[w],v=w));w<y&&(c.push(o[v]),h.push(p),c.push(o[m]),h.push(d)),c.push(o[f]),h.push(u[f]),this.processing=[c,h],this.start=a,this.end=f}else this.bounded=r;return this},subsample:function(e){var r=this.bounded;delete this.bounded;var i=this.processing,s=this.length(),o=i[0],u=i[1],a=r?t(o,this.min):0,f=r?n(o,this.max):s-1,l=(f-a+1)/e,c=[],h=[],p,d;if(f-a+1>e){c.push(o[a]),h.push(u[a]);for(p=1;p<e;p++){if(p*l>=f-l)break;d=Math.round(p*l)+a,c.push(o[d]),h.push(u[d])}c.push(o[f]),h.push(u[f]),this.processing=[c,h],this.start=a,this.end=f}else this.bounded=r;return this},interpolate:function(e){var r=this.bounded;delete this.bounded;var s=this.processing,o=this.length(),u=s[0],a=s[1],f=r?t(u,this.min):0,l=r?n(u,this.max):o-1,c=(u[l]-u[f])/e,h=[],p=[],d,v,m;h.push(u[f]),p.push(a[f]);if(l-f+1<e){for(d=f;d<l;d++){m=u[d+1]-u[d],h.push(u[d]),p.push(a[d]);for(v=u[d+0]+c;v<u[d+1];v+=c)h.push(v),p.push(i(v,u[d-1],a[d-1],u[d+0],a[d+0],u[d+1],a[d+1],u[d+2],a[d+2]))}this.processing=[h,p],this.start=f,this.end=l}return this}},envision.Preprocessor=e}(),envision.actions=envision.actions||{},envision.actions.hit={events:["hit","mouseout"]},envision.actions.selection={events:[{handler:"select",consumer:"zoom"},{handler:"click",consumer:"reset"}]},envision.actions.zoom={events:[{handler:"select",consumer:"zoom"},"zoom","reset"]},envision.adapters=envision.adapters||{},envision.adapters.flotr={},envision.adapters.defaultOptions={grid:{outlineWidth:0,labelMargin:0,horizontalLines:!1,verticalLines:!1},bars:{show:!1,barWidth:.5,fill:!0,lineWidth:1,fillOpacity:1},lines:{lineWidth:1},xaxis:{margin:!1,tickDecimals:0,showLabels:!1},yaxis:{margin:!1,showLabels:!1},shadowSize:!1},function(){function i(e){this.options=e||{},this.flotr=null,this._flotrDefaultOptions()}function s(e,t){var n=e.options.config.selection.mode,r=e.api.flotr.axes,i,s,o,u,a;return n.indexOf("x")!==-1&&(i={},i.min=t.x1,i.max=t.x2,o={},o.min=r.x.d2p(t.x1),o.max=r.x.d2p(t.x2)),n.indexOf("y")!==-1&&(s={},s.min=t.y1,s.max=t.y2,u={},u.min=r.y.d2p(t.y1),u.max=r.y.d2p(t.y2)),a={data:{x:i,y:s},x:o,y:u},a}var e=envision,t=envision.adapters,n=Flotr.EventAdapter,r=t.defaultOptions;i.prototype={destroy:function(){this.flotr.destroy()},draw:function(e,t,n){var r=this.options;e=this.getDataArray(e||r.data),t?t=Flotr.merge(t,Flotr.clone(r)):t=r,r.data=e;if(!t)throw"No graph submitted.";this.flotr=Flotr.draw(n,e,t)},range:function(e){var t=e.xaxis;return{min:t.min,max:t.max}},transformData:function(e){var t=e[0].length,n=e.length,r=[],i,s,o;for(s=0;s<t;s++){i=[];for(o=0;o<n;o++)i.push(e[o][s]);r.push(i)}return r},getDataArray:function(e){return e[0]&&(!_.isArray(e[0])||!e[0].length||e[0][0]&&_.isArray(e[0][0]))?e:[e]},_flotrDefaultOptions:function(e){var t=e||this.options,n;for(n in r)r.hasOwnProperty(n)&&(_.isUndefined(t[n])?t[n]=r[n]:_.defaults(t[n],r[n]))},attach:function(e,t,r){var i=this.events[t]||{},s=i.handler||!1;return t=i.name||!1,s?n.observe(e.node,t,function(){var t=[e].concat(Array.prototype.slice.call(arguments)),n=s.apply(this,t);return r.apply(null,[e,n])}):!1},detach:function(e,t,r){return n.stopObserve(e.node,t,handler)},trigger:function(e,t,n){var r=this.events[t],i=r.consumer||!1;return i?i.apply(this,[e,n]):!1},events:{hit:{name:"flotr:hit",handler:function(e,t){var n=t.x,r=t.y,i=e.api.flotr,s;return s={data:{index:t.index,x:n,y:r},x:i.axes.x.d2p(n),y:i.axes.y.d2p(r)},s},consumer:function(e,t){var n=e.api.flotr,r;r={x:t.data.x,y:t.data.y||1,relX:t.x,relY:t.y||1},n.hit.hit(r)}},select:{name:"flotr:selecting",handler:s,consumer:function(e,t){var n=e.api.flotr,r=n.axes,i=t.data||{},s={},o=t.x,u=t.y;!o&&i.x?(o=i.x,s.x1=o.min,s.x2=o.max):o&&(s.x1=r.x.p2d(o.min),s.x2=r.x.p2d(o.max)),!u&&i.y?(u=i.y,s.y1=u.min,s.y2=u.max):u&&(s.y1=r.y.d2p(u.min),s.y2=r.y.d2p(u.max)),n.selection.setSelection(s)}},zoom:{name:"flotr:select",handler:function(e,t){var n=s(e,t);return e.trigger("zoom",n),n},consumer:function(e,t){var n=t.data.x,r=t.data.y,i={};n&&(i.xaxis={min:n.min,max:n.max}),r&&(i.yaxis={min:r.min,max:r.max}),e.draw(null,i)}},mouseout:{name:"flotr:mouseout",handler:function(e){},consumer:function(e){e.api.flotr.hit.clearHit()}},reset:{name:"flotr:click",handler:function(e){e.draw()},consumer:function(e){e.draw()}},click:{name:"flotr:click",handler:function(e){var t=e.api.flotr.axes.x.min,n=e.api.flotr.axes.x.max;return{data:{x:{min:t,max:n}},x:{min:e.api.flotr.axes.x.d2p(t),max:e.api.flotr.axes.x.d2p(n)}}},consumer:function(e,t){var n=t.data.x,r=t.data.y,i={};n&&(i.xaxis={min:n.min,max:n.max}),r&&(i.yaxis={min:r.min,max:r.max}),e.draw(null,i)}}}},t.flotr.Child=i}(),Flotr.addType("lite-lines",{options:{show:!1,lineWidth:2,fill:!1,fillBorder:!1,fillColor:null,fillOpacity:.4},draw:function(e){var t=e.context,n=e.lineWidth,r=e.shadowSize,i;t.save(),t.lineCap="butt",t.lineWidth=n,t.strokeStyle=e.color,this.plot(e),t.restore()},plot:function(e){var t=e.context,n=e.xScale,r=e.yScale,s=e.data,o=s.length-1,u=r(0),a,f;if(o<1)return;a=n(s[0][0]),f=r(s[0][1]),t.beginPath(),t.moveTo(a,f);for(i=0;i<o;++i)t.lineTo(n(s[i+1][0]),r(s[i+1][1]));(!e.fill||e.fill&&!e.fillBorder)&&t.stroke(),e.fill&&(a=n(s[0][0]),t.fillStyle=e.fillStyle,t.lineTo(n(s[o][0]),u),t.lineTo(a,u),t.lineTo(a,r(s[0][1])),t.fill(),e.fillBorder&&t.stroke())},extendYRange:function(e,t,n,r){var i=e.options;if(!i.max&&i.max!==0||!i.min&&i.min!==0)e.max+=n.lineWidth*.01,e.min-=n.lineWidth*.01}}),Flotr.addType("whiskers",{options:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,fillOpacity:.4,horizontal:!1,stacked:!1,centered:!0},stack:{positive:[],negative:[],_positive:[],_negative:[]},draw:function(e){var t=e.context;t.save(),t.lineJoin="miter",t.lineCap="butt",t.lineWidth=e.lineWidth,t.strokeStyle=e.color,e.fill&&(t.fillStyle=e.fillStyle),this.plot(e),t.restore()},plot:function(e){var t=e.data,n=e.context,r=e.shadowSize,i=e.xScale,s=e.yScale,o=s(0),u,a;if(t.length<1)return;n.translate(-e.lineWidth,0),n.beginPath();for(u=0;u<t.length;u++)a=i(t[u][0]),n.moveTo(a,o),n.lineTo(a,s(t[u][1]));n.closePath(),n.stroke()},drawHit:function(e){var t=e.args,n=e.context,r=e.shadowSize,i=e.xScale,s=e.yScale,o=s(0),u=i(t.x),a=s(t.y);n.save(),n.translate(-e.lineWidth,0),n.beginPath(),n.moveTo(u,o),n.lineTo(u,a),n.closePath(),n.stroke(),n.restore()},clearHit:function(e){var t=e.args,n=e.context,r=e.shadowSize,i=e.xScale,s=e.yScale,o=e.lineWidth,u=s(0),a=i(t.x),f=s(t.y);n.save(),n.clearRect(a-2*o,f-o,4*o,u-f+o),n.restore()}}),envision.components=envision.components||{},function(){function e(e){this.options=e||{}}e.prototype={height:null,width:null,rendered:!1,render:function(e){var t=document.createElement("canvas"),n=bonzo(e).offset();this.height=n.height,this.width=n.width,bonzo(t).attr("height",n.height).attr("width",n.width).css({position:"absolute",top:"0px",left:"0px"}),e.appendChild(t),bonzo(e).css({position:"relative"}),typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(t),this.context=t.getContext("2d"),this.rendered=!0},draw:function(e,t,n){this.rendered||this.render(n);var r=this.context,i=this.height,s=this.width,o=Math.round(i/2)-.5,u,a;t=t||{min:s/2,max:s/2},u=t.min+.5,a=t.max+.5,r.clearRect(0,0,s,i);if(u||a)r.save(),r.strokeStyle=this.options.strokeStyle||"#B6D9FF",r.fillStyle=this.options.fillStyle||"rgba(182, 217, 255, .4)"
,r.beginPath(),u<=1?(r.moveTo(0,i),r.lineTo(0,-0.5)):(r.moveTo(u,i),r.quadraticCurveTo(u,o,Math.max(u-o,u/2),o),r.lineTo(Math.min(o,u/2),o),r.quadraticCurveTo(0,o,.5,-0.5)),r.lineTo(s-.5,-0.5),a>=s-1?r.lineTo(a,i):(r.quadraticCurveTo(s,o,Math.max(s-o,s-(s-a)/2),o),r.lineTo(Math.min(a+o,s-(s-a)/2),o),r.quadraticCurveTo(a,o,a,i)),r.stroke(),r.closePath(),r.fill(),r.restore()},trigger:function(e,t,n){t==="zoom"?this.zoom(e,n):t==="reset"&&this.reset(e)},zoom:function(e,t){var n=t.x||{},r=n.min,i=n.max,s=e.api;e.draw(null,{min:r,max:i})},reset:function(e){e.draw(null,{min:e.width/2,max:e.width/2})}},envision.components.QuadraticDrawing=e}(),envision.templates=envision.templates||{},function(){function t(e){var t=e.resolution;e.preprocessor.bound(e.min,e.max).subsampleMinMax(t+Math.round(t/3))}function n(){return{price:{name:"envision-finance-price",config:{"lite-lines":{lineWidth:1,show:!0,fill:!0,fillOpacity:.2},mouse:{track:!0,trackY:!1,trackAll:!0,sensibility:1,trackDecimals:4,position:"ne"},yaxis:{autoscale:!0,autoscaleMargin:.05,noTicks:4,showLabels:!0,min:0}},processData:t},volume:{name:"envision-finance-volume",config:{whiskers:{show:!0,lineWidth:2},mouse:{track:!0,trackY:!1,trackAll:!0},yaxis:{autoscale:!0,autoscaleMargin:.5}},processData:t},summary:{name:"envision-finance-summary",config:{"lite-lines":{show:!0,lineWidth:1,fill:!0,fillOpacity:.2,fillBorder:!0},xaxis:{noTicks:5,showLabels:!0},yaxis:{autoscale:!0,autoscaleMargin:.1},handles:{show:!0},selection:{mode:"x"},grid:{verticalLines:!1}}},connection:{name:"envision-finance-connection",adapterConstructor:e.components.QuadraticDrawing}}}function r(t){var r=t.data,i=n(),s=new e.Visualization({name:"envision-finance"}),o=new e.Interaction,u=new e.Interaction,a,f,l,c;t.defaults&&(i=Flotr.merge(t.defaults,i)),i.price.data=r.price,i.volume.data=r.volume,i.summary.data=r.summary,i.price.config.mouse.trackFormatter=t.trackFormatter||function(e){var t=e.index,n;return a.api.preprocessor&&(t+=a.api.preprocessor.start),n="Price: $"+r.price[1][t]+", Vol: "+r.volume[1][t],n},t.xTickFormatter&&(i.summary.config.xaxis.tickFormatter=t.xTickFormatter),i.price.config.yaxis.tickFormatter=t.yTickFormatter||function(e){return"$"+e},a=new e.Component(i.price),f=new e.Component(i.volume),l=new e.Component(i.connection),c=new e.Component(i.summary),s.add(a).add(f).add(l).add(c).render(t.container),o.follower(a).follower(f).follower(l).leader(c).add(e.actions.selection,t.selectionCallback?{callback:t.selectionCallback}:null),u.group([a,f]).add(e.actions.hit),t.selection&&c.trigger("select",t.selection),this.vis=s,this.selection=o,this.hit=u,this.price=a,this.volume=f,this.summary=c}var e=envision;e.templates.Finance=r}(),function(){function t(){return{detail:{name:"envision-timeseries-detail",config:{"lite-lines":{lineWidth:1,show:!0}}},summary:{name:"envision-timeseries-summary",config:{"lite-lines":{lineWidth:1,show:!0},handles:{show:!0},selection:{mode:"x"},yaxis:{autoscale:!0,autoscaleMargin:.1}}},connection:{name:"envision-timeseries-connection",adapterConstructor:e.components.QuadraticDrawing}}}function n(n){var r=n.data,i=t(),s=new e.Visualization({name:"envision-timeseries"}),o=new e.Interaction,u,a,f;n.defaults&&(i=Flotr.merge(n.defaults,i)),i.detail.data=r.detail,i.summary.data=r.summary,u=new e.Component(i.detail),f=new e.Component(i.connection),a=new e.Component(i.summary),s.add(u).add(f).add(a).render(n.container),o.follower(u).follower(f).leader(a).add(e.actions.selection,n.selectionCallback?{callback:n.selectionCallback}:null),n.selection&&a.trigger("select",n.selection),this.vis=s,this.selection=o,this.detail=u,this.summary=a}var e=envision;e.templates.TimeSeries=n}(),function(){function n(){return{name:"zoom"}}function r(){return{name:"summary",config:{handles:{show:!0},selection:{mode:"x"}}}}function i(e,t){var n=_.defaults(e,t);return n.flotr=_.defaults(n.flotr,t.flotr),n}var e=envision,t;t=function(t){var s=new e.Visualization,o=new e.Component(i(t.zoom||{},n())),u=new e.Component(i(t.summary||{},r())),a=new e.Interaction({leader:u});s.add(o).add(u),a.add(e.actions.selection),a.follower(o),this.vis=s,this.interaction=a,t.container&&this.render(t.container)},t.prototype={render:function(e){this.vis.render(e)}},e.templates.Zoom=t}(),function(){function e(e){return e.target}function t(e){return e.source}function n(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function r(e){var t=-1,n=e.length,r=[];while(++t<n)r.push(e[t]);return r}function i(e){return Array.prototype.slice.call(e)}function s(){}function o(e){return e}function u(){return!0}function a(e){return typeof e=="function"?e:function(){return e}}function f(e,t,n){return function(){var r=n.apply(t,arguments);return arguments.length?e:r}}function l(e){return e!=null&&!isNaN(e)}function c(e){return e.length}function h(e){return e.trim().replace(/\s+/g," ")}function p(e){var t=1;while(e*t%1)t*=10;return t}function d(e){return e.length===1?function(t,n){e(t==null?n:null)}:e}function v(e){return e.responseText}function m(e){return JSON.parse(e.responseText)}function g(e){var t=document.createRange();return t.selectNode(document.body),t.createContextualFragment(e.responseText)}function y(e){return e.responseXML}function b(){}function w(e){function t(){var t=n,r=-1,i=t.length,s;while(++r<i)(s=t[r].on)&&s.apply(this,arguments);return e}var n=[],r=new s;return t.on=function(t,i){var s=r.get(t),o;return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),r.remove(t)),i&&n.push(r.set(t,{on:i})),e)},t}function E(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function S(e){return e+""}function x(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function T(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function N(e){return function(t){return 1-e(1-t)}}function C(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function k(e){return e*e}function L(e){return e*e*e}function A(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function O(e){return function(t){return Math.pow(t,e)}}function M(e){return 1-Math.cos(e*cr/2)}function _(e){return Math.pow(2,10*(e-1))}function D(e){return 1-Math.sqrt(1-e*e)}function P(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/(2*cr)*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin((r-n)*2*cr/t)}}function H(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function B(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function j(){d3.event.stopPropagation(),d3.event.preventDefault()}function F(){var e=d3.event,t;while(t=e.sourceEvent)e=t;return e}function I(e){var t=new b,n=0,r=arguments.length;while(++n<r)t[arguments[n]]=w(t);return t.of=function(n,r){return function(i){try{var s=i.sourceEvent=d3.event;i.target=e,d3.event=i,t[i.type].apply(n,r)}finally{d3.event=s}}},t}function q(e){var t=[e.a,e.b],n=[e.c,e.d],r=U(t),i=R(t,n),s=U(z(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*dr,this.translate=[e.e,e.f],this.scale=[r,s],this.skew=s?Math.atan2(i,s)*dr:0}function R(e,t){return e[0]*t[0]+e[1]*t[1]}function U(e){var t=Math.sqrt(R(e,e));return t&&(e[0]/=t,e[1]/=t),t}function z(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function W(e){return e=="transform"?d3.interpolateTransform:d3.interpolate}function X(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function V(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function $(){}function J(e,t,n){return new K(e,t,n)}function K(e,t,n){this.r=e,this.g=t,this.b=n}function Q(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function G(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(tt(u[0]),tt(u[1]),tt(u[2]))}}return(a=Pr.get(e))?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function Y(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,nt(o,u,a)}function Z(e,t,n){e=et(e),t=et(t),n=et(n);var r=pt((.4124564*e+.3575761*t+.1804375*n)/Fr),i=pt((.2126729*e+.7151522*t+.072175*n)/Ir),s=pt((.0193339*e+.119192*t+.9503041*n)/qr);return at(116*i-16,500*(r-i),200*(i-s))}function et(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function tt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function nt(e,t,n){return new rt(e,t,n)}function rt(e,t,n){this.h=e,this.s=t,this.l=n}function it(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?s+(o-s)*e/60:e<180?o:e<240?s+(o-s)*(240-e)/60:s}function i(e){return Math.round(r(e)*255)}var s,o;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,o=n<=.5?n*(1+t):n+t-n*t,s=2*n-o,J(i(e+120),i(e),i(e-120))}function st(e,t,n){return new ot(e,t,n)}function ot(e,t,n){this.h=e,this.c=t,this.l=n}function ut(e,t,n){return at(n,Math.cos(e*=pr)*t,Math.sin(e)*t)}function at(e,t,n){return new ft(e,t,n)}function ft(e,t,n){this.l=e,this.a=t,this.b=n}function lt(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=ht(i)*Fr,r=ht(r)*Ir,s=ht(s)*qr,J(dt(3.2404542*i-1.5371385*r-.4985314*s),dt(-0.969266*i+1.8760108*r+.041556*s),dt(.0556434*i-.2040259*r+1.0572252*s))}function ct(e,t,n){return st(Math.atan2(n,t)/cr*180,Math.sqrt(t*t+n*n),e)}function ht(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function pt(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function dt(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function vt(e){return gr(e,$r),e}function mt(e){return function(){return Ur(e,this)}}function gt(e){return function(){return zr(e,this)}}function yt(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function s(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}function u(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=d3.ns.qualify(e),t==null?e.local?r:n:typeof t=="function"?e.local?u:o:e.local?s:i}function bt(e){return new RegExp("(?:^|\\s+)"+d3.requote(e)+"(?:\\s+|$)","g")}function wt(e,t){function n(){var n=-1;while(++n<i)e[n](this,t)}function r(){var n=-1,r=t.apply(this,arguments);while(++n<i)e[n](this,r)}e=e.trim().split(/\s+/).map(Et);var i=e.length;return typeof t=="function"?r:n}function Et(e){var t=bt(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.className,s=i.baseVal!=null,o=s?i.baseVal:i;r?(t.lastIndex=0,t.test(o)||(o=h(o+" "+e),s?i.baseVal=o:n.className=o)):o&&(o=h(o.replace(t," ")),s?i.baseVal=o:n.className=o)}}function St(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return t==null?r:typeof t=="function"?s:i}function xt(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return t==null?n:typeof t=="function"?i:r}function Tt(e){return{__data__:e}}function Nt(e){return function(){return Vr(this,e)}}function Ct(e){return arguments.length||(e=d3.ascending),function(t,n){return e(t&&t.__data__,n&&n.__data__)}}function kt(e,t,n){function r(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function i(){function i(e){var n=d3.event;d3.event=e,u[0]=o.__data__;try{t.apply(o,u)}finally{d3.event=n}}var o=this,u=vr(arguments);r.call(this),this.addEventListener(e,this[s]=i,i.$=n),i._=t}var s="__on"+e,o=e.indexOf(".");return o>0&&(e=e.substring(0,o)),t?i:r}function Lt(e,t){for(var n=0,r=e.length;n<r;n++)for(var i=e[n],s=0,o=i.length,u;s<o;s++)(u=i[s])&&t(u,s,n);return e}function At(e){return gr(e,Kr),e}function Ot(e,t){return gr(e,Qr),e.id=t,e}function Mt(e,t,n,r){var i=e.__transition__||(e.__transition__={active:0,count:0}),o=i[n];if(!o){var u=r.time;return o=i[n]={tween:new s,event:d3.dispatch("start","end"),time:u,ease:r.ease,delay:r.delay,duration:r.duration},++i.count,d3.timer(function(r){function s(r){return i.active>n?f():(i.active=n,h.start.call(e,l,t),o.tween.forEach(function(n,r){(r=r.call(e,l,t))&&v.push(r)}),a(r)||d3.timer(a,0,u),1)}function a(r){if(i.active!==n)return f();var s=(r-p)/d,o=c(s),u=v.length;while(u>0)v[--u].call(e,o);if(s>=1)return f(),h.end.call(e,l,t),1}function f(){return--i.count?delete i[n]:delete e.__transition__,1}var l=e.__data__,c=o.ease,h=o.event,p=o.delay,d=o.duration,v=[];return p<=r?s(r):d3.timer(s,p,u),1},0,u),o}}function _t(e){return e==null&&(e=""),function(){this.textContent=e}}function Dt(e,t,n,r){var i=e.id;return Lt(e,typeof n=="function"?function(e,s,o){e.__transition__[i].tween.set(t,r(n.call(e,e.__data__,s,o)))}:(n=r(n),function(e){e.__transition__[i].tween.set(t,n)}))}function Pt(){var e,t=Date.now(),n=ni;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var r=Ht()-t;r>24?(isFinite(r)&&(clearTimeout(ii),ii=setTimeout(Pt,r)),ri=0):(ri=1,si(Pt))}function Ht(){var e=null,t=ni,n=Infinity;while(t)t.flush?(delete ti[t.callback.id],t=e?e.next=t.next:ni=t.next):(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function Bt(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(oi<0&&(window.scrollX||window.scrollY)){n=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var i=n[0][0].getScreenCTM();oi=!i.f&&!i.e,n.remove()}return oi?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function jt(){}function Ft(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function It(e){return e.rangeExtent?e.rangeExtent():Ft(e.range())}function qt(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(t=t(s-i))e[n]=t.floor(i),e[r]=t.ceil(s);return e}function Rt(){return Math}function Ut(e,t,n,r){function i(){var i=Math.min(e.length,t.length)>2?Kt:Jt,a=r?V:X;return o=i(e,t,a,n),u=i(t,e,a,d3.interpolate),s}function s(e){return o(e)}var o,u;return s.invert=function(e){return u(e)},s.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.rangeRound=function(e){return s.range(e).interpolate(d3.interpolateRound)},s.clamp=function(e){return arguments.length?(r=e,i()):r},s.interpolate=function(e){return arguments.length?(n=e,i()):n},s.ticks=function(t){return Vt(e,t)},s.tickFormat=function(t){return $t(e,t)},s.nice=function(){return qt(e,Wt),i()},s.copy=function(){return Ut(e,t,n,r)},i()}function zt(e,t){return d3.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Wt(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function Xt(e,t){var n=Ft(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=.15?i*=10:s<=.35?i*=5:s<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*.5,n[2]=i,n}function Vt(e,t){return d3.range.apply(d3,Xt(e,t))}function $t(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(Xt(e,t)[2])/Math.LN10+.01))+"f")}function Jt(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function Kt(e,t,n,r){var i=[],s=[],o=0,u=Math.min(e.length,t.length)-1;e[u]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++o<=u)i.push(n(e[o-1],e[o])),s.push(r(t[o-1],t[o]));return function(t){var n=d3.bisect(e,t,1,u)-1;return s[n](i[n](t))}}function Qt(e,t){function n(n){return e(t(n))}var r=t.pow;return n.invert=function(t){return r(e.invert(t))},n.domain=function(i){return arguments.length?(t=i[0]<0?Yt:Gt,r=t.pow,e.domain(i.map(t)),n):e.domain().map(r)},n.nice=function(){return e.domain(qt(e.domain(),Rt)),n},n.ticks=function(){var n=Ft(e.domain()),i=[];if(n.every(isFinite)){var s=Math.floor(n[0]),o=Math.ceil(n[1]),u=r(n[0]),a=r(n[1]);if(t===Yt){i.push(r(s));for(;s++<o;)for(var f=9;f>0;f--)i.push(r(s)*f)}else{for(;s<o;s++)for(var f=1;f<10;f++)i.push(r(s)*f);i.push(r(s))}for(s=0;i[s]<u;s++);for(o=i.length;i[o-1]>a;o--);i=i.slice(s,o)}return i},n.tickFormat=function(e,i){arguments.length<2&&(i=ui);if(!arguments.length)return i;var s=Math.max(.1,e/n.ticks().length),o=t===Yt?(u=-1e-12,Math.floor):(u=1e-12,Math.ceil),u;return function(e){return e/r(o(t(e)+u))<=s?i(e):""}},n.copy=function(){return Qt(e.copy(),t)},zt(n,e)}function Gt(e){return Math.log(e<0?0:e)/Math.LN10}function Yt(e){return-Math.log(e>0?0:-e)/Math.LN10}function Zt(e,t){function n(t){return e(r(t))}var r=en(t),i=en(1/t);return n.invert=function(t){return i(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t.map(r)),n):e.domain().map(i)},n.ticks=function(e){return Vt(n.domain(),e)},n.tickFormat=function(e){return $t(n.domain(),e)},n.nice=function(){return n.domain(qt(n.domain(),Wt))},n.exponent=function(e){if(!arguments.length)return t;var s=n.domain();return r=en(t=e),i=en(1/t),n.domain(s)},n.copy=function(){return Zt(e.copy(),t)},zt(n,e)}function en(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function tn(e,t){function n(t){return o[((i.get(t)||i.set(t,e.push(t)))-1)%o.length]}function r(t,n){return d3.range(e.length).map(function(e){return t+n*e})}var i,o,u;return n.domain=function(r){if(!arguments.length)return e;e=[],i=new s;var o=-1,u=r.length,a;while(++o<u)i.has(a=r[o])||i.set(a,e.push(a));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(o=e,u=0,t={t:"range",a:arguments},n):o},n.rangePoints=function(i,s){arguments.length<2&&(s=0);var a=i[0],f=i[1],l=(f-a)/(Math.max(1,e.length-1)+s);return o=r(e.length<2?(a+f)/2:a+l*s/2,l),u=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(i,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=i[1]<i[0],l=i[f-0],c=i[1-f],h=(c-l)/(e.length-s+2*a);return o=r(l+h*a,h),f&&o.reverse(),u=h*(1-s),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=i[1]<i[0],l=i[f-0],c=i[1-f],h=Math.floor((c-l)/(e.length-s+2*a)),p=c-l-(e.length-s)*h;return o=r(l+Math.round(p/2),h),f&&o.reverse(),u=Math.round(h*(1-s)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return u},n.rangeExtent=function(){return Ft(t.a[0])},n.copy=function(){return tn(e,t)},n.domain(e)}function nn(e,t){function n(){var n=0,s=t.length;i=[];while(++n<s)i[n-1]=d3.quantile(e,n/s);return r}function r(e){return isNaN(e=+e)?NaN:t[d3.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.filter(function(e){return!isNaN(e)}).sort(d3.ascending),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.copy=function(){return nn(e,t)},n()}function rn(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(s*(t-e))))]}function i(){return s=n.length/(t-e),o=n.length-1,r}var s,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.copy=function(){return rn(e,t,n)},i()}function sn(e,t){function n(n){return t[d3.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return sn(e,t)},n}function on(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return Vt(e,t)},t.tickFormat=function(t){return $t(e,t)},t.copy=function(){return on(e)},t}function un(e){var t=e.source,n=e.target,r=fn(t,n),i=[t];while(t!==r)t=t.parent,i.push(t);var s=i.length;while(n!==r)i.splice(s,0,n),n=n.parent;return i}function an(e){var t=[],n=e.parent;while(n!=null)t.push(e),e=n,n=n.parent;return t.push(e),t}function fn(e,t){if(e===t)return e;var n=an(e),r=an(t),i=n.pop(),s=r.pop(),o=null;while(i===s)o=i,i=n.pop(),s=r.pop();return o}function ln(e){e.fixed|=2}function cn(e){e.fixed&=1}function hn(e){e.fixed|=4,e.px=e.x,e.py=e.y}function pn(e){e.fixed&=3}function dn(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null)continue;dn(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function vn(){return 20}function mn(){return 1}function gn(e){return e.x}function yn(e){return e.y}function bn(e,t,n){e.y0=t,e.y=n}function wn(e){return d3.range(e.length)}function En(e){var t=-1,n=e[0].length,r=[];while(++t<n)r[t]=0;return r}function Sn(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t)(i=e[t][1])>r&&(n=t,r=i);return n}function xn(e){return e.reduce(Tn,0)}function Tn(e,t){return e+t[1]}function Nn(e,t){return Cn(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Cn(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t)s[n]=i*n+r;return s}function kn(e){return[d3.min(e),d3.max(e)]}function Ln(e,t){return d3.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=_n,e}function An(e){return e.children}function On(e){return e.value}function Mn(e,t){return t.value-e.value}function _n(e){return d3.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function Dn(e,t){return e.value-t.value}function Pn(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function Hn(e,t){e._pack_next=t,t._pack_prev=e}function Bn(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>.001}function jn(e){function t(e){r=Math.min(e.x-e.r,r),i=Math.max(e.x+e.r,i),s=Math.min(e.y-e.r,s),o=Math.max(e.y+e.r,o)}if(!(n=e.children)||!(p=n.length))return;var n,r=Infinity,i=-Infinity,s=Infinity,o=-Infinity,u,a,f,l,c,h,p;n.forEach(Fn),u=n[0],u.x=-u.r,u.y=0,t(u);if(p>1){a=n[1],a.x=a.r,a.y=0,t(a);if(p>2){f=n[2],Rn(u,a,f),t(f),Pn(u,f),u._pack_prev=f,Pn(f,a),a=u._pack_next;for(l=3;l<p;l++){Rn(u,a,f=n[l]);var d=0,v=1,m=1;for(c=a._pack_next;c!==a;c=c._pack_next,v++)if(Bn(c,f)){d=1;break}if(d==1)for(h=u._pack_prev;h!==c._pack_prev;h=h._pack_prev,m++)if(Bn(h,f))break;d?(v<m||v==m&&a.r<u.r?Hn(u,a=c):Hn(u=h,a),l--):(Pn(u,f),a=f,t(f))}}}var g=(r+i)/2,y=(s+o)/2,b=0;for(l=0;l<p;l++)f=n[l],f.x-=g,f.y-=y,b=Math.max(b,f.r+Math.sqrt(f.x*f.x+f.y*f.y));e.r=b,n.forEach(In)}function Fn(e){e._pack_next=e._pack_prev=e}function In(e){delete e._pack_next,delete e._pack_prev}function qn(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o)qn(i[s],t,n,r)}}function Rn(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else n.x=e.x+r,n.y=e.y}function Un(e){return 1+d3.max(e,function(e){return e.y})}function zn(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Wn(e){var t=e.children;return t&&t.length?Wn(t[0]):e}function Xn(e){var t=e.children,n;return t&&(n=t.length)?Xn(t[n-1]):e}function Vn(e,t){return e.parent==t.parent?1:2}function $n(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function Jn(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function Kn(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i)t(r=Kn(n[s],t),e)>0&&(e=r)}return e}function Qn(e,t){return e.x-t.x}function Gn(e,t){return t.x-e.x}function Yn(e,t){return e.depth-t.depth}function Zn(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a)s=i[u],n(s,o),o=s}t(e,r)}n(e,null)}function er(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0)s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}function tr(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function nr(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function rr(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function ir(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}var sr=".",or=",",ur=[3,3];Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(ar){var fr=CSSStyleDeclaration.prototype,lr=fr.setProperty;fr.setProperty=function(e,t,n){lr.call(this,e,t+"",n)}}d3={version:"3.0.2"};var cr=Math.PI,hr=1e-6,pr=cr/180,dr=180/cr,vr=i;try{vr(document.documentElement.childNodes)[0].nodeType}catch(mr){vr=r}var gr=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};d3.map=function(e){var t=new s;for(var n in e)t.set(n,e[n]);return t},n(s,{has:function(e){return yr+e in this},get:function(e){return this[yr+e]},set:function(e,t){return this[yr+e]=t},remove:function(e){return e=yr+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===br&&e.call(this,t.substring(1),this[t])}});var yr="\0",br=yr.charCodeAt(0);d3.functor=a,d3.rebind=function(e,t){var n=1,r=arguments.length,i;while(++n<r)e[i=arguments[n]]=f(e,t,t[i]);return e},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var n=e.length,r,i=0,s=-1,o=0;if(arguments.length===1)while(++s<n)l(r=e[s])&&(i+=(r-i)/++o);else while(++s<n)l(r=t.call(e,e[s],s))&&(i+=(r-i)/++o);return o?i:undefined},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(l),e.length?d3.quantile(e.sort(d3.ascending),.5):undefined},d3.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&i>s&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}return i},d3.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&s>i&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}return i},d3.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i))i=o=undefined;while(++n<r)(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}return[i,o]},d3.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(e,t){var n=arguments.length;n<2&&(t=1),n<1&&(e=0);var r=d3.random.normal();return function(){return Math.exp(e+t*r())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},d3.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1)while(++s<r)isNaN(i=+e[s])||(n+=i);else while(++s<r)isNaN(i=+t.call(e,e[s],s))||(n+=i);return n},d3.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=+e[r-1],s=n-r;return s?i+s*(e[r]-i):i},d3.shuffle=function(e){var t=e.length,n,r;while(t)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e},d3.transpose=function(e){return d3.zip.apply(d3,e)},d3.zip=function(){if(!(i=arguments.length))return[];for(var e=-1,t=d3.min(arguments,c),n=new Array(t);++e<t;)for(var r=-1,i,s=n[e]=new Array(i);++r<i;)s[r]=arguments[r][e];return n},d3.bisector=function(e){return{left:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var wr=d3.bisector(function(e){return e});d3.bisectLeft=wr.left,d3.bisect=d3.bisectRight=wr.right,d3.nest=function(){function e(t,i){if(i>=r.length)return u?u.call(n,t):o?t.sort(o):t;var a=-1,f=t.length,l=r[i++],c,h,p=new s,d,v={};while(++a<f)(d=p.get(c=l(h=t[a])))?d.push(h):p.set(c,[h]);return p.forEach(function(t,n){v[t]=e(n,i)}),v}function t(e,n){if(n>=r.length)return e;var s=[],o=i[n++],u;for(u in e)s.push({key:u,values:t(e[u],n)});return o&&s.sort(function(e,t){return o(e.key,t.key)}),s}var n={},r=[],i=[],o,u;return n.map=function(t){return e(t,0)},n.entries=function(n){return t(e(n,0),0)},n.key=function(e){return r.push(e),n},n.sortKeys=function(e){return i[r.length-1]=e,n},n.sortValues=function(e){return o=e,n},n.rollup=function(e){return u=e,n},n},d3.keys=function(e){var t=[];for(var n in e)t.push(n);return t},d3.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},d3.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},d3.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i)n[r]=e[t[r]];return n},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n===Infinity)throw new Error("infinite range");var r=[],i=p(Math.abs(n)),s=-1,o;e*=i,t*=i,n*=i;if(n<0)while((o=e+n*++s)>t)r.push(o/i);else while((o=e+n*++s)<t)r.push(o/i);return r},d3.requote=function(e){return e.replace(Er,"\\$&")};var Er=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},d3.xhr=function(e,t,n){function r(){var e=f.status;!e&&f.responseText||e>=200&&e<300||e===304?s.load.call(i,a.call(i,f)):s.error.call(i,f)}var i={},s=d3.dispatch("progress","load","error"),u={},a=o,f=new(window.XDomainRequest&&/^(http(s)?:)?\/\//.test(e)?XDomainRequest:XMLHttpRequest);return"onload"in f?f.onload=f.onerror=r:f.onreadystatechange=function(){f.readyState>3&&r()},f.onprogress=function(e){var t=d3.event;d3.event=e;try{s.progress.call(i,f)}finally{d3.event=t}},i.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?u[e]:(t==null?delete u[e]:u[e]=t+"",i)},i.mimeType=function(e){return arguments.length?(t=e==null?null:e+"",i):t},i.response=function(e){return a=e,i},["get","post"].forEach(function(e){i[e]=function(){return i.send.apply(i,[e].concat(vr(arguments)))}}),i.send=function(n,r,s){arguments.length===2&&typeof r=="function"&&(s=r,r=null),f.open(n,e,!0),t!=null&&!("accept"in u)&&(u.accept=t+",*/*");if(f.setRequestHeader)for(var o in u)f.setRequestHeader(o,u[o]);return t!=null&&f.overrideMimeType&&f.overrideMimeType(t),s!=null&&i.on("error",s).on("load",function(e){s(null,e)}),f.send(r==null?null:r),i},i.abort=function(){return f.abort(),i},d3.rebind(i,s,"on"),arguments.length===2&&typeof t=="function"&&(n=t,t=null),n==null?i:i.get(d(n))},d3.text=function(){return d3.xhr.apply(d3,arguments).response(v)},d3.json=function(e,t){return d3.xhr(e,"application/json",t).response(m)},d3.html=function(e,t){return d3.xhr(e,"text/html",t).response(g)},d3.xml=function(){return d3.xhr.apply(d3,arguments).response(y)};var Sr={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:Sr,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),Sr.hasOwnProperty(n)?{space:Sr[n],local:e}:e}},d3.dispatch=function(){var e=new b,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=w(e);return e},b.prototype.on=function(e,t){var n=e.indexOf("."),r="";return n>0&&(r=e.substring(n+1),e=e.substring(0,n)),arguments.length<2?this[e].on(r):this[e].on(r,t)},d3.format=function(e){
var t=xr.exec(e),n=t[1]||" ",r=t[2]||">",i=t[3]||"",s=t[4]||"",o=t[5],u=+t[6],a=t[7],f=t[8],l=t[9],c=1,h="",p=!1;f&&(f=+f.substring(1));if(o||n==="0"&&r==="=")o=n="0",r="=",a&&(u-=Math.floor((u-1)/4));switch(l){case"n":a=!0,l="g";break;case"%":c=100,h="%",l="f";break;case"p":c=100,h="%",l="r";break;case"b":case"o":case"x":case"X":s&&(s="0"+l.toLowerCase());case"c":case"d":p=!0,f=0;break;case"s":c=-1,l="r"}s==="#"&&(s=""),l=="r"&&!f&&(l="g"),l=Tr.get(l)||S;var d=o&&a;return function(e){if(p&&e%1)return"";var t=e<0||e===0&&1/e<0?(e=-e,"-"):i;if(c<0){var v=d3.formatPrefix(e,f);e=v.scale(e),h=v.symbol}else e*=c;e=l(e,f),!o&&a&&(e=Nr(e));var m=s.length+e.length+(d?0:t.length),g=m<u?(new Array(m=u-m+1)).join(n):"";return d&&(e=Nr(g+e)),sr&&e.replace(".",sr),t+=s,(r==="<"?t+e+g:r===">"?g+t+e:r==="^"?g.substring(0,m>>=1)+t+e+g.substring(m):t+(d?e:g+e))+h}};var xr=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,Tr=d3.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=E(e,t)).toFixed(Math.max(0,Math.min(20,t)))}}),Nr=o;if(ur){var Cr=ur.length;Nr=function(e){var t=e.lastIndexOf("."),n=t>=0?"."+e.substring(t+1):(t=e.length,""),r=[],i=0,s=ur[0];while(t>0&&s>0)r.push(e.substring(t-=s,t+s)),s=ur[i=(i+1)%Cr];return r.reverse().join(or||"")+n}}var kr=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(x);d3.formatPrefix=function(e,t){var n=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,E(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,Math.floor((n<=0?n+1:n-1)/3)*3))),kr[8+n/3]};var Lr=function(){return o},Ar=d3.map({linear:Lr,poly:O,quad:function(){return k},cubic:function(){return L},sin:function(){return M},exp:function(){return _},circle:function(){return D},elastic:P,back:H,bounce:function(){return B}}),Or=d3.map({"in":o,out:N,"in-out":C,"out-in":function(e){return C(N(e))}});d3.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=Ar.get(n)||Lr,r=Or.get(r)||o,T(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(e){var t=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new q(n?n.matrix:Mr)})(e)},q.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Mr={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(e,t){var n=d3.interpolators.length,r;while(--n>=0&&!(r=d3.interpolators[n](e,t)));return r},d3.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},d3.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},d3.interpolateString=function(e,t){var n,r,i,s=0,o=0,u=[],a=[],f,l;_r.lastIndex=0;for(r=0;n=_r.exec(t);++r)n.index&&u.push(t.substring(s,o=n.index)),a.push({i:u.length,x:n[0]}),u.push(null),s=_r.lastIndex;s<t.length&&u.push(t.substring(s));for(r=0,f=a.length;(n=_r.exec(e))&&r<f;++r){l=a[r];if(l.x==n[0]){if(l.i)if(u[l.i+1]==null){u[l.i-1]+=l.x,u.splice(l.i,1);for(i=r+1;i<f;++i)a[i].i--}else{u[l.i-1]+=l.x+u[l.i+1],u.splice(l.i,2);for(i=r+1;i<f;++i)a[i].i-=2}else if(u[l.i+1]==null)u[l.i]=l.x;else{u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1);for(i=r+1;i<f;++i)a[i].i--}a.splice(r,1),f--,r--}else l.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(l.x))}while(r<f)l=a.pop(),u[l.i+1]==null?u[l.i]=l.x:(u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1)),f--;return u.length===1?u[0]==null?a[0].x:function(){return t}:function(e){for(r=0;r<f;++r)u[(l=a[r]).i]=l.x(e);return u.join("")}},d3.interpolateTransform=function(e,t){var n=[],r=[],i,s=d3.transform(e),o=d3.transform(t),u=s.translate,a=o.translate,f=s.rotate,l=o.rotate,c=s.skew,h=o.skew,p=s.scale,d=o.scale;return u[0]!=a[0]||u[1]!=a[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:d3.interpolateNumber(u[0],a[0])},{i:3,x:d3.interpolateNumber(u[1],a[1])})):a[0]||a[1]?n.push("translate("+a+")"):n.push(""),f!=l?(f-l>180?l+=360:l-f>180&&(f+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(f,l)})):l&&n.push(n.pop()+"rotate("+l+")"),c!=h?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(c,h)}):h&&n.push(n.pop()+"skewX("+h+")"),p[0]!=d[0]||p[1]!=d[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:d3.interpolateNumber(p[0],d[0])},{i:i-2,x:d3.interpolateNumber(p[1],d[1])})):(d[0]!=1||d[1]!=1)&&n.push(n.pop()+"scale("+d+")"),i=r.length,function(e){var t=-1,s;while(++t<i)n[(s=r[t]).i]=s.x(e);return n.join("")}},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+Q(Math.round(n+s*e))+Q(Math.round(r+o*e))+Q(Math.round(i+u*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var n=e.h,r=e.s,i=e.l,s=t.h-n,o=t.s-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return it(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateLab=function(e,t){e=d3.lab(e),t=d3.lab(t);var n=e.l,r=e.a,i=e.b,s=t.l-n,o=t.a-r,u=t.b-i;return function(e){return lt(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateHcl=function(e,t){e=d3.hcl(e),t=d3.hcl(t);var n=e.h,r=e.c,i=e.l,s=t.h-n,o=t.c-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return ut(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateArray=function(e,t){var n=[],r=[],i=e.length,s=t.length,o=Math.min(e.length,t.length),u;for(u=0;u<o;++u)n.push(d3.interpolate(e[u],t[u]));for(;u<i;++u)r[u]=e[u];for(;u<s;++u)r[u]=t[u];return function(e){for(u=0;u<o;++u)r[u]=n[u](e);return r}},d3.interpolateObject=function(e,t){var n={},r={},i;for(i in e)i in t?n[i]=W(i)(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}};var _r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return(typeof e=="string"||typeof t=="string")&&d3.interpolateString(e+"",t+"")},function(e,t){return(typeof t=="string"?Pr.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof $)&&d3.interpolateRgb(e,t)},function(e,t){return!isNaN(e=+e)&&!isNaN(t=+t)&&d3.interpolateNumber(e,t)}],$.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(e,t,n){return arguments.length===1?e instanceof K?J(e.r,e.g,e.b):G(""+e,J,it):J(~~e,~~t,~~n)};var Dr=K.prototype=new $;Dr.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return!t&&!n&&!r?J(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),J(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},Dr.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),J(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},Dr.hsl=function(){return Y(this.r,this.g,this.b)},Dr.toString=function(){return"#"+Q(this.r)+Q(this.g)+Q(this.b)};var Pr=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});Pr.forEach(function(e,t){Pr.set(e,G(t,J,it))}),d3.hsl=function(e,t,n){return arguments.length===1?e instanceof rt?nt(e.h,e.s,e.l):G(""+e,Y,nt):nt(+e,+t,+n)};var Hr=rt.prototype=new $;Hr.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),nt(this.h,this.s,this.l/e)},Hr.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),nt(this.h,this.s,e*this.l)},Hr.rgb=function(){return it(this.h,this.s,this.l)},d3.hcl=function(e,t,n){return arguments.length===1?e instanceof ot?st(e.h,e.c,e.l):e instanceof ft?ct(e.l,e.a,e.b):ct((e=Z((e=d3.rgb(e)).r,e.g,e.b)).l,e.a,e.b):st(+e,+t,+n)};var Br=ot.prototype=new $;Br.brighter=function(e){return st(this.h,this.c,Math.min(100,this.l+jr*(arguments.length?e:1)))},Br.darker=function(e){return st(this.h,this.c,Math.max(0,this.l-jr*(arguments.length?e:1)))},Br.rgb=function(){return ut(this.h,this.c,this.l).rgb()},d3.lab=function(e,t,n){return arguments.length===1?e instanceof ft?at(e.l,e.a,e.b):e instanceof ot?ut(e.l,e.c,e.h):Z((e=d3.rgb(e)).r,e.g,e.b):at(+e,+t,+n)};var jr=18,Fr=.95047,Ir=1,qr=1.08883,Rr=ft.prototype=new $;Rr.brighter=function(e){return at(Math.min(100,this.l+jr*(arguments.length?e:1)),this.a,this.b)},Rr.darker=function(e){return at(Math.max(0,this.l-jr*(arguments.length?e:1)),this.a,this.b)},Rr.rgb=function(){return lt(this.l,this.a,this.b)};var Ur=function(e,t){return t.querySelector(e)},zr=function(e,t){return t.querySelectorAll(e)},Wr=document.documentElement,Xr=Wr.matchesSelector||Wr.webkitMatchesSelector||Wr.mozMatchesSelector||Wr.msMatchesSelector||Wr.oMatchesSelector,Vr=function(e,t){return Xr.call(e,t)};typeof Sizzle=="function"&&(Ur=function(e,t){return Sizzle(e,t)[0]||null},zr=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},Vr=Sizzle.matchesSelector);var $r=[];d3.selection=function(){return Jr},d3.selection.prototype=$r,$r.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=mt(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;)(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__"in s&&(r.__data__=s.__data__)):n.push(null)}return vt(t)},$r.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=gt(e));for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)if(r=o[u])t.push(n=vr(e.call(r,r.__data__,u))),n.parentNode=r;return vt(t)},$r.attr=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node();return e=d3.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(yt(t,e[t]));return this}return this.each(yt(e,t))},$r.classed=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){while(++i<r)if(!t.contains(e[i]))return!1}else{t=n.className,t.baseVal!=null&&(t=t.baseVal);while(++i<r)if(!bt(e[i]).test(t))return!1}return!0}for(t in e)this.each(wt(t,e[t]));return this}return this.each(wt(e,t))},$r.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.each(St(n,e[n],t));return this}if(r<2)return getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(St(e,t,n))},$r.property=function(e,t){if(arguments.length<2){if(typeof e=="string")return this.node()[e];for(t in e)this.each(xt(t,e[t]));return this}return this.each(xt(e,t))},$r.text=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},$r.html=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},$r.append=function(e){function t(){return this.appendChild(document.createElementNS(this.namespaceURI,e))}function n(){return this.appendChild(document.createElementNS(e.space,e.local))}return e=d3.ns.qualify(e),this.select(e.local?n:t)},$r.insert=function(e,t){function n(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),Ur(t,this))}function r(){return this.insertBefore(document.createElementNS(e.space,e.local),Ur(t,this))}return e=d3.ns.qualify(e),this.select(e.local?r:n)},$r.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},$r.data=function(e,t){function n(e,n){var r,i=e.length,o=n.length,u=Math.min(i,o),c=Math.max(i,o),h=[],p=[],d=[],v,m;if(t){var g=new s,y=[],b,w=n.length;for(r=-1;++r<i;)b=t.call(v=e[r],v.__data__,r),g.has(b)?d[w++]=v:g.set(b,v),y.push(b);for(r=-1;++r<o;)b=t.call(n,m=n[r],r),g.has(b)?(h[r]=v=g.get(b),v.__data__=m,p[r]=d[r]=null):(p[r]=Tt(m),h[r]=d[r]=null),g.remove(b);for(r=-1;++r<i;)g.has(y[r])&&(d[r]=e[r])}else{for(r=-1;++r<u;)v=e[r],m=n[r],v?(v.__data__=m,h[r]=v,p[r]=d[r]=null):(p[r]=Tt(m),h[r]=d[r]=null);for(;r<o;++r)p[r]=Tt(n[r]),h[r]=d[r]=null;for(;r<c;++r)d[r]=e[r],p[r]=h[r]=null}p.update=h,p.parentNode=h.parentNode=d.parentNode=e.parentNode,a.push(p),f.push(h),l.push(d)}var r=-1,i=this.length,o,u;if(!arguments.length){e=new Array(i=(o=this[0]).length);while(++r<i)if(u=o[r])e[r]=u.__data__;return e}var a=At([]),f=vt([]),l=vt([]);if(typeof e=="function")while(++r<i)n(o=this[r],e.call(o,o.parentNode.__data__,r));else while(++r<i)n(o=this[r],e);return f.enter=function(){return a},f.exit=function(){return l},f},$r.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},$r.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=Nt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return vt(t)},$r.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n=this[e],r=n.length-1,i=n[r],s;--r>=0;)if(s=n[r])i&&i!==s.nextSibling&&i.parentNode.insertBefore(s,i),i=s;return this},$r.sort=function(e){e=Ct.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},$r.on=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t=!1);for(n in e)this.each(kt(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(kt(e,t,n))},$r.each=function(e){return Lt(this,function(t,n,r){e.call(t,t.__data__,n,r)})},$r.call=function(e){var t=vr(arguments);return e.apply(t[0]=this,t),this},$r.empty=function(){return!this.node()},$r.node=function(){for(var e=0,t=this.length;e<t;e++)for(var n=this[e],r=0,i=n.length;r<i;r++){var s=n[r];if(s)return s}return null},$r.transition=function(){var e=Yr||++Gr,t=[],n,r,i=Object.create(Zr);i.time=Date.now();for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(r=u[a])&&Mt(r,a,e,i),n.push(r)}return Ot(t,e)};var Jr=vt([[document]]);Jr[0].parentNode=Wr,d3.select=function(e){return typeof e=="string"?Jr.select(e):vt([[e]])},d3.selectAll=function(e){return typeof e=="string"?Jr.selectAll(e):vt([vr(e)])};var Kr=[];d3.selection.enter=At,d3.selection.enter.prototype=Kr,Kr.append=$r.append,Kr.insert=$r.insert,Kr.empty=$r.empty,Kr.node=$r.node,Kr.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;)(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}return vt(t)};var Qr=[],Gr=0,Yr,Zr={ease:A,delay:0,duration:250};Qr.call=$r.call,Qr.empty=$r.empty,Qr.node=$r.node,d3.transition=function(e){return arguments.length?Yr?e.transition():e:Jr.transition()},d3.transition.prototype=Qr,Qr.select=function(e){var t=this.id,n=[],r,i,s;typeof e!="function"&&(e=mt(e));for(var o=-1,u=this.length;++o<u;){n.push(r=[]);for(var a=this[o],f=-1,l=a.length;++f<l;)(s=a[f])&&(i=e.call(s,s.__data__,f))?("__data__"in s&&(i.__data__=s.__data__),Mt(i,f,t,s.__transition__[t]),r.push(i)):r.push(null)}return Ot(n,t)},Qr.selectAll=function(e){var t=this.id,n=[],r,i,s,o,u;typeof e!="function"&&(e=gt(e));for(var a=-1,f=this.length;++a<f;)for(var l=this[a],c=-1,h=l.length;++c<h;)if(s=l[c]){u=s.__transition__[t],i=e.call(s,s.__data__,c),n.push(r=[]);for(var p=-1,d=i.length;++p<d;)Mt(o=i[p],p,t,u),r.push(o)}return Ot(n,t)},Qr.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=Nt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]);for(var r=this[s],u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return Ot(t,this.id,this.time).ease(this.ease())},Qr.attr=function(e,t){function n(){this.removeAttribute(s)}function r(){this.removeAttributeNS(s.space,s.local)}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var i=W(e),s=d3.ns.qualify(e);return Dt(this,"attr."+e,t,function(e){function t(){var t=this.getAttribute(s),n;return t!==e&&(n=i(t,e),function(e){this.setAttribute(s,n(e))})}function o(){var t=this.getAttributeNS(s.space,s.local),n;return t!==e&&(n=i(t,e),function(e){this.setAttributeNS(s.space,s.local,n(e))})}return e==null?s.local?r:n:(e+="",s.local?o:t)})},Qr.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=d3.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},Qr.style=function(e,t,n){function r(){this.style.removeProperty(e)}var i=arguments.length;if(i<3){if(typeof e!="string"){i<2&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}var s=W(e);return Dt(this,"style."+e,t,function(t){function i(){var r=getComputedStyle(this,null).getPropertyValue(e),i;return r!==t&&(i=s(r,t),function(t){this.style.setProperty(e,i(t),n)})}return t==null?r:(t+="",i)})},Qr.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,function(r,i){var s=t.call(this,r,i,getComputedStyle(this,null).getPropertyValue(e));return s&&function(t){this.style.setProperty(e,s(t),n)}})},Qr.text=function(e){return Dt(this,"text",e,_t)},Qr.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},Qr.ease=function(e){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:(typeof e!="function"&&(e=d3.ease.apply(d3,arguments)),Lt(this,function(n){n.__transition__[t].ease=e}))},Qr.delay=function(e){var t=this.id;return Lt(this,typeof e=="function"?function(n,r,i){n.__transition__[t].delay=e.call(n,n.__data__,r,i)|0}:(e|=0,function(n){n.__transition__[t].delay=e}))},Qr.duration=function(e){var t=this.id;return Lt(this,typeof e=="function"?function(n,r,i){n.__transition__[t].duration=Math.max(1,e.call(n,n.__data__,r,i)|0)}:(e=Math.max(1,e|0),function(n){n.__transition__[t].duration=e}))},Qr.each=function(e,t){var n=this.id;if(arguments.length<2){var r=Zr,i=Yr;Yr=n,Lt(this,function(t,r,i){Zr=t.__transition__[n],e.call(t,t.__data__,r,i)}),Zr=r,Yr=i}else Lt(this,function(r){r.__transition__[n].event.on(e,t)});return this},Qr.transition=function(){var e=this.id,t=++Gr,n=[],r,i,s,o;for(var u=0,a=this.length;u<a;u++){n.push(r=[]);for(var i=this[u],f=0,l=i.length;f<l;f++){if(s=i[f])o=Object.create(s.__transition__[e]),o.delay+=o.duration,Mt(s,f,t,o);r.push(s)}}return Ot(n,t)},Qr.tween=function(e,t){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(e):Lt(this,t==null?function(t){t.__transition__[n].tween.remove(e)}:function(r){r.__transition__[n].tween.set(e,t)})};var ei=0,ti={},ni=null,ri,ii;d3.timer=function(e,t,n){if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}var r=ti[e.id];r&&r.callback===e?(r.then=n,r.delay=t):ti[e.id=++ei]=ni={callback:e,then:n,delay:t,next:ni},ri||(ii=clearTimeout(ii),ri=1,si(Pt))},d3.timer.flush=function(){var e,t=Date.now(),n=ni;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;Ht()};var si=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.mouse=function(e){return Bt(e,F())};var oi=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(e,t){return arguments.length<2&&(t=F().touches),t?vr(t).map(function(t){var n=Bt(e,t);return n.identifier=t.identifier,n}):[]},d3.scale={},d3.scale.linear=function(){return Ut([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Qt(d3.scale.linear(),Gt)};var ui=d3.format(".0e");Gt.pow=function(e){return Math.pow(10,e)},Yt.pow=function(e){return-Math.pow(10,-e)},d3.scale.pow=function(){return Zt(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return tn([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(ai)},d3.scale.category20=function(){return d3.scale.ordinal().range(fi)},d3.scale.category20b=function(){return d3.scale.ordinal().range(li)},d3.scale.category20c=function(){return d3.scale.ordinal().range(ci)};var ai=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],fi=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],li=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],ci=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return nn([],[])},d3.scale.quantize=function(){return rn(0,1,[0,1])},d3.scale.threshold=function(){return sn([.5],[0,1])},d3.scale.identity=function(){return on([0,1])},d3.layout={},d3.layout.bundle=function(){return function(e){var t=[],n=-1,r=e.length;while(++n<r)t.push(un(e[n]));return t}},d3.layout.chord=function(){function e(){var e={},n=[],c=d3.range(o),h=[],p,d,v,m,g;r=[],i=[],p=0,m=-1;while(++m<o){d=0,g=-1;while(++g<o)d+=s[m][g];n.push(d),h.push(d3.range(o)),p+=d}a&&c.sort(function(e,t){return a(n[e],n[t])}),f&&h.forEach(function(e,t){e.sort(function(e,n){return f(s[t][e],s[t][n])})}),p=(2*cr-u*o)/p,d=0,m=-1;while(++m<o){v=d,g=-1;while(++g<o){var y=c[m],b=h[y][g],w=s[y][b],E=d,S=d+=w*p;e[y+"-"+b]={index:y,subindex:b,startAngle:E,endAngle:S,value:w}}i[y]={index:y,startAngle:v,endAngle:d,value:(d-v)/p},d+=u}m=-1;while(++m<o){g=m-1;while(++g<o){var x=e[m+"-"+g],T=e[g+"-"+m];(x.value||T.value)&&r.push(x.value<T.value?{source:T,target:x}:{source:x,target:T})}}l&&t()}function t(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n={},r,i,s,o,u=0,a,f,l;return n.matrix=function(e){return arguments.length?(o=(s=e)&&s.length,r=i=null,n):s},n.padding=function(e){return arguments.length?(u=e,r=i=null,n):u},n.sortGroups=function(e){return arguments.length?(a=e,r=i=null,n):a},n.sortSubgroups=function(e){return arguments.length?(f=e,r=null,n):f},n.sortChords=function(e){return arguments.length?(l=e,r&&t(),n):l},n.chords=function(){return r||e(),r},n.groups=function(){return i||e(),i},n},d3.layout.force=function(){function e(e){return function(t,n,r,i){if(t.point!==e){var s=t.cx-e.x,o=t.cy-e.y,u=1/Math.sqrt(s*s+o*o);if((i-n)*u<d){var a=t.charge*u*u;return e.px-=s*a,e.py-=o*a,!0}if(t.point&&isFinite(u)){var a=t.pointCharge*u*u;e.px-=s*a,e.py-=o*a}}return!t.charge}}function t(e){e.px=d3.event.x,e.py=d3.event.y,n.resume()}var n={},r=d3.dispatch("start","tick","end"),i=[1,1],s,u,f=.9,l=vn,c=mn,h=-30,p=.1,d=.8,v=[],m=[],g,y,b;return n.tick=function(){if((u*=.99)<.005)return r.end({type:"end",alpha:u=0}),!0;var t=v.length,n=m.length,s,o,a,l,c,d,w,E,S;for(o=0;o<n;++o){a=m[o],l=a.source,c=a.target,E=c.x-l.x,S=c.y-l.y;if(d=E*E+S*S)d=u*y[o]*((d=Math.sqrt(d))-g[o])/d,E*=d,S*=d,c.x-=E*(w=l.weight/(c.weight+l.weight)),c.y-=S*w,l.x+=E*(w=1-w),l.y+=S*w}if(w=u*p){E=i[0]/2,S=i[1]/2,o=-1;if(w)while(++o<t)a=v[o],a.x+=(E-a.x)*w,a.y+=(S-a.y)*w}if(h){dn(s=d3.geom.quadtree(v),u,b),o=-1;while(++o<t)(a=v[o]).fixed||s.visit(e(a))}o=-1;while(++o<t)a=v[o],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*f,a.y-=(a.py-(a.py=a.y))*f);r.tick({type:"tick",alpha:u})},n.nodes=function(e){return arguments.length?(v=e,n):v},n.links=function(e){return arguments.length?(m=e,n):m},n.size=function(e){return arguments.length?(i=e,n):i},n.linkDistance=function(e){return arguments.length?(l=a(e),n):l},n.distance=n.linkDistance,n.linkStrength=function(e){return arguments.length?(c=a(e),n):c},n.friction=function(e){return arguments.length?(f=e,n):f},n.charge=function(e){return arguments.length?(h=typeof e=="function"?e:+e,n):h},n.gravity=function(e){return arguments.length?(p=e,n):p},n.theta=function(e){return arguments.length?(d=e,n):d},n.alpha=function(e){return arguments.length?(u?e>0?u=e:u=0:e>0&&(r.start({type:"start",alpha:u=e}),d3.timer(n.tick)),n):u},n.start=function(){function e(e,n){var i=t(r),s=-1,o=i.length,u;while(++s<o)if(!isNaN(u=i[s][e]))return u;return Math.random()*n}function t(){if(!p){p=[];for(s=0;s<o;++s)p[s]=[];for(s=0;s<u;++s){var e=m[s];p[e.source.index].push(e.target),p[e.target.index].push(e.source)}}return p[r]}var r,s,o=v.length,u=m.length,a=i[0],f=i[1],p,d;for(r=0;r<o;++r)(d=v[r]).index=r,d.weight=0;g=[],y=[];for(r=0;r<u;++r)d=m[r],typeof d.source=="number"&&(d.source=v[d.source]),typeof d.target=="number"&&(d.target=v[d.target]),g[r]=l.call(this,d,r),y[r]=c.call(this,d,r),++d.source.weight,++d.target.weight;for(r=0;r<o;++r)d=v[r],isNaN(d.x)&&(d.x=e("x",a)),isNaN(d.y)&&(d.y=e("y",f)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);b=[];if(typeof h=="function")for(r=0;r<o;++r)b[r]=+h.call(this,v[r],r);else for(r=0;r<o;++r)b[r]=h;return n.resume()},n.resume=function(){return n.alpha(.1)},n.stop=function(){return n.alpha(0)},n.drag=function(){s||(s=d3.behavior.drag().origin(o).on("dragstart",ln).on("drag",t).on("dragend",cn)),this.on("mouseover.force",hn).on("mouseout.force",pn).call(s)},d3.rebind(n,r,"on")},d3.layout.partition=function(){function e(t,n,r,i){var s=t.children;t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;r=t.value?r/t.value:0;while(++o<u)e(a=s[o],n,f=a.value*r,i),n+=f}}function t(e){var n=e.children,r=0;if(n&&(s=n.length)){var i=-1,s;while(++i<s)r=Math.max(r,t(n[i]))}return 1+r}function n(n,s){var o=r.call(this,n,s);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=d3.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},Ln(n,r)},d3.layout.pie=function(){function e(s){var o=s.map(function(n,r){return+t.call(e,n,r)}),u=+(typeof r=="function"?r.apply(this,arguments):r),a=((typeof i=="function"?i.apply(this,arguments):i)-r)/d3.sum(o),f=d3.range(s.length);n!=null&&f.sort(n===hi?function(e,t){return o[t]-o[e]}:function(e,t){return n(s[e],s[t])});var l=[];return f.forEach(function(e){var t;l[e]={data:s[e],value:t=o[e],startAngle:u,endAngle:u+=t*a}}),l}var t=Number,n=hi,r=0,i=2*cr;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var hi={};d3.layout.stack=function(){function e(o,a){var f=o.map(function(n,r){return t.call(e,n,r)}),l=f.map(function(t){return t.map(function(t,n){return[s.call(e,t,n),u.call(e,t,n)]})}),c=n.call(e,l,a);f=d3.permute(f,c),l=d3.permute(l,c);var h=r.call(e,l,a),p=f.length,d=f[0].length,v,m,g;for(m=0;m<d;++m){i.call(e,f[0][m],g=h[m],l[0][m][1]);for(v=1;v<p;++v)i.call(e,f[v][m],g+=l[v-1][m][1],l[v][m][1])}return o}var t=o,n=wn,r=En,i=bn,s=gn,u=yn;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n=typeof t=="function"?t:pi.get(t)||wn,e):n},e.offset=function(t){return arguments.length?(r=typeof t=="function"?t:di.get(t)||En,e):r},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(u=t,e):u},e.out=function(t){return arguments.length?(i=t,e):i},e};var pi=d3.map({"inside-out":function(e){var t=e.length,n,r,i=e.map(Sn),s=e.map(xn),o=d3.range(t).sort(function(e,t){return i[e]-i[t]}),u=0,a=0,f=[],l=[];for(n=0;n<t;++n)r=o[n],u<a?(u+=s[r],f.push(r)):(a+=s[r],l.push(r));return l.reverse().concat(f)},reverse:function(e){return d3.range(e.length).reverse()},"default":wn}),di=d3.map({silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++)u+=e[s][o][1];u>i&&(i=u),r.push(u)}for(o=0;o<n;++o)a[o]=(i-r[o])/2;return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i,s,o,u,a,f,l,c,h,p=[];p[0]=c=h=0;for(s=1;s<r;++s){for(i=0,u=0;i<t;++i)u+=e[i][s][1];for(i=0,a=0,l=n[s][0]-n[s-1][0];i<t;++i){for(o=0,f=(e[i][s][1]-e[i][s-1][1])/(2*l);o<i;++o)f+=(e[o][s][1]-e[o][s-1][1])/l;a+=f*e[i][s][1]}p[s]=c-=u?a/u*l:0,c<h&&(h=c)}for(s=0;s<r;++s)p[s]-=h;return p},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++)o+=e[i][s][1];if(o)for(i=0;i<t;i++)e[i][s][1]/=o;else for(i=0;i<t;i++)e[i][s][1]=r}for(s=0;s<n;++s)u[s]=0;return u},zero:En});d3.layout.histogram=function(){function e(e,s){var o=[],u=e.map(n,this),a=r.call(this,u,s),f=i.call(this,a,u,s),l,s=-1,c=u.length,h=f.length-1,p=t?1:1/c,d;while(++s<h)l=o[s]=[],l.dx=f[s+1]-(l.x=f[s]),l.y=0;if(h>0){s=-1;while(++s<c)d=u[s],d>=a[0]&&d<=a[1]&&(l=o[d3.bisect(f,d,1,h)-1],l.y+=p,l.push(e[s]))}return o}var t=!0,n=Number,r=kn,i=Nn;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=a(t),e):r},e.bins=function(t){return arguments.length?(i=typeof t=="number"?function(e){return Cn(e,t)}:a(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},d3.layout.hierarchy=function(){function e(t,o,u){var a=i.call(n,t,o);t.depth=o,u.push(t);if(a&&(l=a.length)){var f=-1,l,c=t.children=[],h=0,p=o+1,d;while(++f<l)d=e(a[f],p,u),d.parent=t,c.push(d),h+=d.value;r&&c.sort(r),s&&(t.value=h)}else s&&(t.value=+s.call(n,t,o)||0);return t}function t(e,r){var i=e.children,o=0;if(i&&(a=i.length)){var u=-1,a,f=r+1;while(++u<a)o+=t(i[u],f)}else s&&(o=+s.call(n,e,r)||0);return s&&(e.value=o),o}function n(t){var n=[];return e(t,0,n),n}var r=Mn,i=An,s=On;return n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(e){return arguments
.length?(i=e,n):i},n.value=function(e){return arguments.length?(s=e,n):s},n.revalue=function(e){return t(e,0),e},n},d3.layout.pack=function(){function e(e,i){var s=t.call(this,e,i),o=s[0];o.x=0,o.y=0,Zn(o,function(e){e.r=Math.sqrt(e.value)}),Zn(o,jn);var u=r[0],a=r[1],f=Math.max(2*o.r/u,2*o.r/a);if(n>0){var l=n*f/2;Zn(o,function(e){e.r+=l}),Zn(o,jn),Zn(o,function(e){e.r-=l}),f=Math.max(2*o.r/u,2*o.r/a)}return qn(o,u/2,a/2,1/f),s}var t=d3.layout.hierarchy().sort(Dn),n=0,r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},e.padding=function(t){return arguments.length?(n=+t,e):n},Ln(e,t)},d3.layout.cluster=function(){function e(e,i){var s=t.call(this,e,i),o=s[0],u,a=0;Zn(o,function(e){var t=e.children;t&&t.length?(e.x=zn(t),e.y=Un(t)):(e.x=u?a+=n(e,u):0,e.y=0,u=e)});var f=Wn(o),l=Xn(o),c=f.x-n(f,l)/2,h=l.x+n(l,f)/2;return Zn(o,function(e){e.x=(e.x-c)/(h-c)*r[0],e.y=(1-(o.y?e.y/o.y:1))*r[1]}),s}var t=d3.layout.hierarchy().sort(null).value(null),n=Vn,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},Ln(e,t)},d3.layout.tree=function(){function e(e,i){function s(e,t){var r=e.children,i=e._tree;if(r&&(o=r.length)){var o,a=r[0],f,l=a,c,h=-1;while(++h<o)c=r[h],s(c,f),l=u(c,f,l),f=c;er(e);var p=.5*(a._tree.prelim+c._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else t&&(i.prelim=t._tree.prelim+n(e,t))}function o(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i)o(n[r],t)}}function u(e,t,r){if(t){var i=e,s=e,o=t,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=Jn(o),i=$n(i),o&&i)u=$n(u),s=Jn(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+n(o,i),h>0&&(tr(nr(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod;o&&!Jn(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!$n(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var a=t.call(this,e,i),f=a[0];Zn(f,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),s(f),o(f,-f._tree.prelim);var l=Kn(f,Gn),c=Kn(f,Qn),h=Kn(f,Yn),p=l.x-n(l,c)/2,d=c.x+n(c,l)/2,v=h.depth||1;return Zn(f,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1],delete e._tree}),a}var t=d3.layout.hierarchy().sort(null).value(null),n=Vn,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},Ln(e,t)},d3.layout.treemap=function(){function e(e,t){var n=-1,r=e.length,i,s;while(++n<r)s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}function t(n){var s=n.children;if(s&&s.length){var o=l(n),u=[],a=s.slice(),f,c=Infinity,h,d=p==="slice"?o.dx:p==="dice"?o.dy:p==="slice-dice"?n.depth&1?o.dy:o.dx:Math.min(o.dx,o.dy),v;e(a,o.dx*o.dy/n.value),u.area=0;while((v=a.length)>0)u.push(f=a[v-1]),u.area+=f.area,p!=="squarify"||(h=r(u,d))<=c?(a.pop(),c=h):(u.area-=u.pop().area,i(u,d,o,!1),d=Math.min(o.dx,o.dy),u.length=u.area=0,c=Infinity);u.length&&(i(u,d,o,!0),u.length=u.area=0),s.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var s=l(t),o=r.slice(),u,a=[];e(o,s.dx*s.dy/t.value),a.area=0;while(u=o.pop())a.push(u),a.area+=u.area,u.z!=null&&(i(a,u.z?s.dx:s.dy,s,!o.length),a.length=a.area=0);r.forEach(n)}}function r(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area))continue;r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*d/n,n/(t*s*d)):Infinity}function i(e,t,n,r){var i=-1,s=e.length,o=n.x,a=n.y,f=t?u(e.area/t):0,l;if(t==n.dx){if(r||f>n.dy)f=n.dy;while(++i<s)l=e[i],l.x=o,l.y=a,l.dy=f,o+=l.dx=Math.min(n.x+n.dx-o,f?u(l.area/f):0);l.z=!0,l.dx+=n.x+n.dx-o,n.y+=f,n.dy-=f}else{if(r||f>n.dx)f=n.dx;while(++i<s)l=e[i],l.x=o,l.y=a,l.dx=f,a+=l.dy=Math.min(n.y+n.dy-a,f?u(l.area/f):0);l.z=!1,l.dy+=n.y+n.dy-a,n.x+=f,n.dx-=f}}function s(r){var i=h||o(r),s=i[0];return s.x=0,s.y=0,s.dx=a[0],s.dy=a[1],h&&o.revalue(s),e([s],s.dx*s.dy/s.value),(h?n:t)(s),c&&(h=i),i}var o=d3.layout.hierarchy(),u=Math.round,a=[1,1],f=null,l=rr,c=!1,h,p="squarify",d=.5*(1+Math.sqrt(5));return s.size=function(e){return arguments.length?(a=e,s):a},s.padding=function(e){function t(t){var n=e.call(s,t,t.depth);return n==null?rr(t):ir(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return ir(t,e)}if(!arguments.length)return f;var r;return l=(f=e)==null?rr:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,s},s.round=function(e){return arguments.length?(u=e?Math.round:Number,s):u!=Number},s.sticky=function(e){return arguments.length?(c=e,h=null,s):c},s.ratio=function(e){return arguments.length?(d=e,s):d},s.mode=function(e){return arguments.length?(p=e+"",s):p},Ln(s,o)}}(),function(e,t,n,r){function i(t){return t[0]&&e.isPlainObject(t[0])?this.data=t[0]:this.el=t,this.isCoords=!0,this.coords={},this.init(),this}var s=i.prototype;s.init=function(){this.set(),this.original_coords=this.get()},s.set=function(e,t){var n=this.el;n&&!e&&(this.data=n.offset(),this.data.width=n.width(),this.data.height=n.height());if(n&&e&&!t){var r=n.offset();this.data.top=r.top,this.data.left=r.left}var i=this.data;return this.coords.x1=i.left,this.coords.y1=i.top,this.coords.x2=i.left+i.width,this.coords.y2=i.top+i.height,this.coords.cx=i.left+i.width/2,this.coords.cy=i.top+i.height/2,this.coords.width=i.width,this.coords.height=i.height,this.coords.el=n||!1,this},s.update=function(t){if(!t&&!this.el)return this;if(t){var n=e.extend({},this.data,t);return this.data=n,this.set(!0,!0)}return this.set(!0),this},s.get=function(){return this.coords},e.fn.coords=function(){if(this.data("coords"))return this.data("coords");var e=new i(this,arguments[0]);return this.data("coords",e),e}}(jQuery,window,document),function(e,t,n,r){function s(t,n,r){this.options=e.extend(i,r),this.$element=t,this.last_colliders=[],this.last_colliders_coords=[],typeof n=="string"||n instanceof jQuery?this.$colliders=e(n,this.options.colliders_context).not(this.$element):this.colliders=e(n),this.init()}var i={colliders_context:n.body},o=s.prototype;o.init=function(){this.find_collisions()},o.overlaps=function(e,t){var n=!1,r=!1;if(t.x1>=e.x1&&t.x1<=e.x2||t.x2>=e.x1&&t.x2<=e.x2||e.x1>=t.x1&&e.x2<=t.x2)n=!0;if(t.y1>=e.y1&&t.y1<=e.y2||t.y2>=e.y1&&t.y2<=e.y2||e.y1>=t.y1&&e.y2<=t.y2)r=!0;return n&&r},o.detect_overlapping_region=function(e,t){var n="",r="";return e.y1>t.cy&&e.y1<t.y2&&(n="N"),e.y2>t.y1&&e.y2<t.cy&&(n="S"),e.x1>t.cx&&e.x1<t.x2&&(r="W"),e.x2>t.x1&&e.x2<t.cx&&(r="E"),n+r||"C"},o.calculate_overlapped_area_coords=function(t,n){var r=Math.max(t.x1,n.x1),i=Math.max(t.y1,n.y1),s=Math.min(t.x2,n.x2),o=Math.min(t.y2,n.y2);return e({left:r,top:i,width:s-r,height:o-i}).coords().get()},o.calculate_overlapped_area=function(e){return e.width*e.height},o.manage_colliders_start_stop=function(t,n,r){var i=this.last_colliders_coords;for(var s=0,o=i.length;s<o;s++)e.inArray(i[s],t)===-1&&n.call(this,i[s]);for(var u=0,a=t.length;u<a;u++)e.inArray(t[u],i)===-1&&r.call(this,t[u])},o.find_collisions=function(t){var n=this,r=[],i=[],s=this.colliders||this.$colliders,o=s.length,u=n.$element.coords().update(t||!1).get();while(o--){var a=n.$colliders?e(s[o]):s[o],f=a.isCoords?a:a.coords(),l=f.get(),c=n.overlaps(u,l);if(!c)continue;var h=n.detect_overlapping_region(u,l);if(h==="C"){var p=n.calculate_overlapped_area_coords(u,l),d=n.calculate_overlapped_area(p),v={area:d,area_coords:p,region:h,coords:l,player_coords:u,el:a};n.options.on_overlap&&n.options.on_overlap.call(this,v),r.push(f),i.push(v)}}return(n.options.on_overlap_stop||n.options.on_overlap_start)&&this.manage_colliders_start_stop(r,n.options.on_overlap_stop,n.options.on_overlap_start),this.last_colliders_coords=r,i},o.get_closest_colliders=function(e){var t=this.find_collisions(e);return t.sort(function(e,t){return e.region==="C"&&t.region==="C"?e.coords.y1<t.coords.y1||e.coords.x1<t.coords.x1?-1:1:e.area<t.area?1:1}),t},e.fn.collision=function(e,t){return new s(this,e,t)}}(jQuery,window,document),function(e,t){e.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)};n&&!r&&e.apply(i,s),clearTimeout(r),r=setTimeout(o,t)}},e.throttle=function(e,t){var n,r,i,s,o,u,a=debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&e.apply(n,r),a()};return i||(i=setTimeout(f,t)),s?o=!0:u=e.apply(n,r),a(),s=!0,u}}}(window),function(e,t,n,r){function a(t,r){this.options=e.extend({},i,r),this.$body=e(n.body),this.$container=e(t),this.$dragitems=e(this.options.items,this.$container),this.is_dragging=!1,this.player_min_left=0+this.options.offset_left,this.init()}var i={items:".gs_w",distance:1,limit:!0,offset_left:0,autoscroll:!0,ignore_dragging:["INPUT","TEXTAREA","SELECT","BUTTON"],handle:null},s=e(t),o="ontouchstart"in t,u={start:o?"touchstart":"mousedown.draggable",move:o?"touchmove":"mousemove.draggable",end:o?"touchend":"mouseup.draggable"},f=a.prototype;f.init=function(){this.calculate_positions(),this.$container.css("position","relative"),this.disabled=!1,this.events(),e(t).bind("resize",throttle(e.proxy(this.calculate_positions,this),200))},f.events=function(){this.$container.on("selectstart",e.proxy(this.on_select_start,this)),this.$container.on(u.start,this.options.items,e.proxy(this.drag_handler,this)),this.$body.on(u.end,e.proxy(function(e){this.is_dragging=!1;if(this.disabled)return;this.$body.off(u.move),this.drag_start&&this.on_dragstop(e)},this))},f.get_actual_pos=function(e){var t=e.position();return t},f.get_mouse_pos=function(e){if(o){var t=e.originalEvent;e=t.touches.length?t.touches[0]:t.changedTouches[0]}return{left:e.clientX,top:e.clientY}},f.get_offset=function(e){e.preventDefault();var t=this.get_mouse_pos(e),n=Math.round(t.left-this.mouse_init_pos.left),r=Math.round(t.top-this.mouse_init_pos.top),i=Math.round(this.el_init_offset.left+n-this.baseX),s=Math.round(this.el_init_offset.top+r-this.baseY+this.scrollOffset);return this.options.limit&&(i>this.player_max_left?i=this.player_max_left:i<this.player_min_left&&(i=this.player_min_left)),{left:i,top:s,mouse_left:t.left,mouse_top:t.top}},f.manage_scroll=function(e){var t,n=s.scrollTop(),r=n,i=r+this.window_height,o=i-50,u=r+50,a=e.mouse_left,f=r+e.mouse_top,l=this.doc_height-this.window_height+this.player_height;f>=o&&(t=n+30,t<l&&(s.scrollTop(t),this.scrollOffset=this.scrollOffset+30)),f<=u&&(t=n-30,t>0&&(s.scrollTop(t),this.scrollOffset=this.scrollOffset-30))},f.calculate_positions=function(e){this.window_height=s.height()},f.drag_handler=function(t){var n=t.target.nodeName;if(this.disabled||t.which!==1&&!o)return;if(this.ignore_drag(t))return;var r=this,i=!0;return this.$player=e(t.currentTarget),this.el_init_pos=this.get_actual_pos(this.$player),this.mouse_init_pos=this.get_mouse_pos(t),this.offsetY=this.mouse_init_pos.top-this.el_init_pos.top,this.$body.on(u.move,function(e){var t=r.get_mouse_pos(e),n=Math.abs(t.left-r.mouse_init_pos.left),s=Math.abs(t.top-r.mouse_init_pos.top);return n>r.options.distance||s>r.options.distance?i?(i=!1,r.on_dragstart.call(r,e),!1):(r.is_dragging===!0&&r.on_dragmove.call(r,e),!1):!1}),!1},f.on_dragstart=function(t){t.preventDefault(),this.drag_start=!0,this.is_dragging=!0;var r=this.$container.offset();return this.baseX=Math.round(r.left),this.baseY=Math.round(r.top),this.doc_height=e(n).height(),this.options.helper==="clone"?(this.$helper=this.$player.clone().appendTo(this.$container).addClass("helper"),this.helper=!0):this.helper=!1,this.scrollOffset=0,this.el_init_offset=this.$player.offset(),this.player_width=this.$player.width(),this.player_height=this.$player.height(),this.player_max_left=this.$container.width()-this.player_width+this.options.offset_left,this.options.start&&this.options.start.call(this.$player,t,{helper:this.helper?this.$helper:this.$player}),!1},f.on_dragmove=function(e){var t=this.get_offset(e);this.options.autoscroll&&this.manage_scroll(t),(this.helper?this.$helper:this.$player).css({position:"absolute",left:t.left,top:t.top});var n={position:{left:t.left,top:t.top}};return this.options.drag&&this.options.drag.call(this.$player,e,n),!1},f.on_dragstop=function(e){var t=this.get_offset(e);this.drag_start=!1;var n={position:{left:t.left,top:t.top}};return this.options.stop&&this.options.stop.call(this.$player,e,n),this.helper&&this.$helper.remove(),!1},f.on_select_start=function(e){if(this.disabled)return;if(this.ignore_drag(e))return;return!1},f.enable=function(){this.disabled=!1},f.disable=function(){this.disabled=!0},f.destroy=function(){this.disable(),e.removeData(this.$container,"drag")},f.ignore_drag=function(t){return this.options.handle?!e(t.target).is(this.options.handle):e.inArray(t.target.nodeName,this.options.ignore_dragging)>=0},e.fn.drag=function(t){return this.each(function(){e.data(this,"drag")||e.data(this,"drag",new a(this,t))})}}(jQuery,window,document),function(e,t,n,r){function s(t,n){this.options=e.extend(!0,i,n),this.$el=e(t),this.$wrapper=this.$el.parent(),this.$widgets=this.$el.children(this.options.widget_selector).addClass("gs_w"),this.widgets=[],this.$changed=e([]),this.wrapper_width=this.$wrapper.width(),this.min_widget_width=this.options.widget_margins[0]*2+this.options.widget_base_dimensions[0],this.min_widget_height=this.options.widget_margins[1]*2+this.options.widget_base_dimensions[1],this.init()}var i={namespace:"",widget_selector:"li",widget_margins:[10,10],widget_base_dimensions:[400,225],extra_rows:0,extra_cols:0,min_cols:1,min_rows:15,max_size_x:6,autogenerate_stylesheet:!0,avoid_overlapped_widgets:!0,serialize_params:function(e,t){return{col:t.col,row:t.row,size_x:t.size_x,size_y:t.size_y}},collision:{},draggable:{distance:4}};s.generated_stylesheets=[];var o=s.prototype;o.init=function(){this.generate_grid_and_stylesheet(),this.get_widgets_from_DOM(),this.set_dom_grid_height(),this.$wrapper.addClass("ready"),this.draggable(),e(t).bind("resize",throttle(e.proxy(this.recalculate_faux_grid,this),200))},o.disable=function(){return this.$wrapper.find(".player-revert").removeClass("player-revert"),this.drag_api.disable(),this},o.enable=function(){return this.drag_api.enable(),this},o.add_widget=function(t,n,r,i,s){var o;n||(n=1),r||(r=1),!i&!s?o=this.next_position(n,r):(o={col:i,row:s},this.empty_cells(i,s,n,r));var u=e(t).attr({"data-col":o.col,"data-row":o.row,"data-sizex":n,"data-sizey":r}).addClass("gs_w").appendTo(this.$el).hide();return this.$widgets=this.$widgets.add(u),this.register_widget(u),this.add_faux_rows(o.size_y),this.set_dom_grid_height(),u.fadeIn()},o.resize_widget=function(t,n,r){var i=t.coords().grid;n||(n=i.size_x),r||(r=i.size_y),n>this.cols&&(n=this.cols);var s=this.get_cells_occupied(i),o=i.size_x,u=i.size_y,a=i.col,f=a,l=n>o,c=r>u;if(a+n-1>this.cols){var h=a+(n-1)-this.cols,p=a-h;f=Math.max(1,p)}var d={col:f,row:i.row,size_x:n,size_y:r},v=this.get_cells_occupied(d),m=[];e.each(s.cols,function(t,n){e.inArray(n,v.cols)===-1&&m.push(n)});var g=[];e.each(v.cols,function(t,n){e.inArray(n,s.cols)===-1&&g.push(n)});var y=[];e.each(s.rows,function(t,n){e.inArray(n,v.rows)===-1&&y.push(n)});var b=[];e.each(v.rows,function(t,n){e.inArray(n,s.rows)===-1&&b.push(n)}),this.remove_from_gridmap(i);if(g.length){var w=[f,i.row,n,Math.min(u,r),t];this.empty_cells.apply(this,w)}if(b.length){var E=[f,i.row,n,r,t];this.empty_cells.apply(this,E)}i.col=f,i.size_x=n,i.size_y=r,this.add_to_gridmap(d,t),t.data("coords").update({width:n*this.options.widget_base_dimensions[0]+(n-1)*this.options.widget_margins[0]*2,height:r*this.options.widget_base_dimensions[1]+(r-1)*this.options.widget_margins[1]*2}),r>u&&this.add_faux_rows(r-u),n>o&&this.add_faux_cols(n-o),t.attr({"data-col":f,"data-sizex":n,"data-sizey":r});if(m.length){var S=[m[0],i.row,m.length,Math.min(u,r),t];this.remove_empty_cells.apply(this,S)}if(y.length){var x=[f,i.row,n,r,t];this.remove_empty_cells.apply(this,x)}return t},o.empty_cells=function(t,n,r,i,s){var o=this.widgets_below({col:t,row:n-i,size_x:r,size_y:i});return o.not(s).each(e.proxy(function(t,r){var s=e(r).coords().grid;if(!(s.row<=n+i-1))return;var o=n+i-s.row;this.move_widget_down(e(r),o)},this)),this.set_dom_grid_height(),this},o.remove_empty_cells=function(t,n,r,i,s){var o=this.widgets_below({col:t,row:n,size_x:r,size_y:i});return o.not(s).each(e.proxy(function(t,n){this.move_widget_up(e(n),i)},this)),this.set_dom_grid_height(),this},o.next_position=function(e,t){e||(e=1),t||(t=1);var n=this.gridmap,r=n.length,i=[],s;for(var o=1;o<r;o++){s=n[o].length;for(var u=1;u<=s;u++){var a=this.can_move_to({size_x:e,size_y:t},o,u);a&&i.push({col:o,row:u,size_y:t,size_x:e})}}return i.length?this.sort_by_row_and_col_asc(i)[0]:!1},o.remove_widget=function(t,n,r){var i=t instanceof jQuery?t:e(t),s=i.coords().grid;e.isFunction(n)&&(r=n,n=!1),this.cells_occupied_by_placeholder={},this.$widgets=this.$widgets.not(i);var o=this.widgets_below(i);this.remove_from_gridmap(s),i.fadeOut(e.proxy(function(){i.remove(),n||o.each(e.proxy(function(t,n){this.move_widget_up(e(n),s.size_y)},this)),this.set_dom_grid_height(),r&&r.call(this,t)},this))},o.remove_all_widgets=function(t){return this.$widgets.each(e.proxy(function(e,n){this.remove_widget(n,!0,t)},this)),this},o.serialize=function(t){t||(t=this.$widgets);var n=[];return t.each(e.proxy(function(t,r){n.push(this.options.serialize_params(e(r),e(r).coords().grid))},this)),n},o.serialize_changed=function(){return this.serialize(this.$changed)},o.register_widget=function(e){var t={col:parseInt(e.attr("data-col"),10),row:parseInt(e.attr("data-row"),10),size_x:parseInt(e.attr("data-sizex"),10),size_y:parseInt(e.attr("data-sizey"),10),el:e};return this.options.avoid_overlapped_widgets&&!this.can_move_to({size_x:t.size_x,size_y:t.size_y},t.col,t.row)&&(t=this.next_position(t.size_x,t.size_y),t.el=e,e.attr({"data-col":t.col,"data-row":t.row,"data-sizex":t.size_x,"data-sizey":t.size_y})),e.data("coords",e.coords()),e.data("coords").grid=t,this.add_to_gridmap(t,e),this},o.update_widget_position=function(e,t){return this.for_each_cell_occupied(e,function(e,n){if(!this.gridmap[e])return this;this.gridmap[e][n]=t}),this},o.remove_from_gridmap=function(e){return this.update_widget_position(e,!1)},o.add_to_gridmap=function(t,n){this.update_widget_position(t,n||t.el);if(t.el){var r=this.widgets_below(t.el);r.each(e.proxy(function(t,n){this.move_widget_up(e(n))},this))}},o.draggable=function(){var t=this,n=e.extend(!0,{},this.options.draggable,{offset_left:this.options.widget_margins[0],start:function(n,r){t.$widgets.filter(".player-revert").removeClass("player-revert"),t.$player=e(this),t.$helper=t.options.draggable.helper==="clone"?e(r.helper):t.$player,t.helper=!t.$helper.is(t.$player),t.on_start_drag.call(t,n,r),t.$el.trigger("gridster:dragstart")},stop:function(e,n){t.on_stop_drag.call(t,e,n),t.$el.trigger("gridster:dragstop")},drag:throttle(function(e,n){t.on_drag.call(t,e,n),t.$el.trigger("gridster:drag")},60)});return this.drag_api=this.$el.drag(n).data("drag"),this},o.on_start_drag=function(t,n){this.$helper.add(this.$player).add(this.$wrapper).addClass("dragging"),this.$player.addClass("player"),this.player_grid_data=this.$player.coords().grid,this.placeholder_grid_data=e.extend({},this.player_grid_data),this.$el.css("height",this.$el.height()+this.player_grid_data.size_y*this.min_widget_height);var r=this.faux_grid,i=this.$player.data("coords").coords;this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data),this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.last_cols=[],this.last_rows=[],this.collision_api=this.$helper.collision(r,this.options.collision),this.$preview_holder=e("<li />",{"class":"preview-holder","data-row":this.$player.attr("data-row"),"data-col":this.$player.attr("data-col"),css:{width:i.width,height:i.height}}).appendTo(this.$el),this.options.draggable.start&&this.options.draggable.start.call(this,t,n)},o.on_drag=function(e,t){if(this.$player===null)return!1;var n={left:t.position.left+this.baseX,top:t.position.top+this.baseY};this.colliders_data=this.collision_api.get_closest_colliders(n),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.helper&&this.$player&&this.$player.css({left:t.position.left,top:t.position.top}),this.options.draggable.drag&&this.options.draggable.drag.call(this,e,t)},o.on_stop_drag=function(e,t){this.$helper.add(this.$player).add(this.$wrapper).removeClass("dragging"),t.position.left=t.position.left+this.baseX,t.position.top=t.position.top+this.baseY,this.colliders_data=this.collision_api.get_closest_colliders(t.position),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.$player.addClass("player-revert").removeClass("player").attr({"data-col":this.placeholder_grid_data.col,"data-row":this.placeholder_grid_data.row}).css({left:"",top:""}),this.$changed=this.$changed.add(this.$player),this.cells_occupied_by_player=this.get_cells_occupied(this.placeholder_grid_data),this.set_cells_player_occupies(this.placeholder_grid_data.col,this.placeholder_grid_data.row),this.$player.coords().grid.row=this.placeholder_grid_data.row,this.$player.coords().grid.col=this.placeholder_grid_data.col,this.options.draggable.stop&&this.options.draggable.stop.call(this,e,t),this.$preview_holder.remove(),this.$player=null,this.$helper=null,this.placeholder_grid_data={},this.player_grid_data={},this.cells_occupied_by_placeholder={},this.cells_occupied_by_player={},this.set_dom_grid_height()},o.on_overlapped_column_change=function(t,n){if(!this.colliders_data.length)return;var r=this.get_targeted_columns(this.colliders_data[0].el.data.col),i=this.last_cols.length,s=r.length,o;for(o=0;o<s;o++)e.inArray(r[o],this.last_cols)===-1&&(t||e.noop).call(this,r[o]);for(o=0;o<i;o++)e.inArray(this.last_cols[o],r)===-1&&(n||e.noop).call(this,this.last_cols[o]);return this.last_cols=r,this},o.on_overlapped_row_change=function(t,n){if(!this.colliders_data.length)return;var r=this.get_targeted_rows(this.colliders_data[0].el.data.row),i=this.last_rows.length,s=r.length,o;for(o=0;o<s;o++)e.inArray(r[o],this.last_rows)===-1&&(t||e.noop).call(this,r[o]);for(o=0;o<i;o++)e.inArray(this.last_rows[o],r)===-1&&(n||e.noop).call(this,this.last_rows[o]);this.last_rows=r},o.set_player=function(e,t,n){var r=this;n||this.empty_cells_player_occupies();var i=n?{col:e}:r.colliders_data[0].el.data,s=i.col,o=t||i.row;this.player_grid_data={col:s,row:o,size_y:this.player_grid_data.size_y,size_x:this.player_grid_data.size_x},this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data);var u=this.get_widgets_overlapped(this.player_grid_data),a=this.widgets_constraints(u);this.manage_movements(a.can_go_up,s,o),this.manage_movements(a.can_not_go_up,s,o);if(!u.length){var f=this.can_go_player_up(this.player_grid_data);f!==!1&&(o=f),this.set_placeholder(s,o)}return{col:s,row:o}},o.widgets_constraints=function(t){var n=e([]),r,i=[],s=[];return t.each(e.proxy(function(t,r){var o=e(r),u=o.coords().grid;this.can_go_widget_up(u)?(n=n.add(o),i.push(u)):s.push(u)},this)),r=t.not(n),{can_go_up:this.sort_by_row_asc(i),can_not_go_up:this.sort_by_row_desc(s)}},o.sort_by_row_asc=function(t){return t=t.sort(function(t,n){return t.row||(t=e(t).coords().grid,n=e(n).coords().grid),t.row>n.row?1:-1}),t},o.sort_by_row_and_col_asc=function(e){return e=e.sort(function(e,t){return e.row>t.row||e.row===t.row&&e.col>t.col?1:-1}),e},o.sort_by_col_asc=function(e){return e=e.sort(function(e,t){return e.col>t.col?1:-1}),e},o.sort_by_row_desc=function(e){return e=e.sort(function(e,t){return e.row+e.size_y<t.row+t.size_y?1:-1}),e},o.manage_movements=function(t,n,r){return e.each(t,e.proxy(function(e,t){var i=t,s=i.el,o=this.can_go_widget_up(i);if(o)this.move_widget_to(s,o),this.set_placeholder(n,o+i.size_y);else{var u=this.can_go_player_up(this.player_grid_data);if(!u){var a=r+this.player_grid_data.size_y-i.row;this.move_widget_down(s,a),this.set_placeholder(n,r)}}},this)),this},o.is_player=function(e,t){if(t&&!this.gridmap[e])return!1;var n=t?this.gridmap[e][t]:e;return n&&(n.is(this.$player)||n.is(this.$helper))},o.is_player_in=function(t,n){var r=this.cells_occupied_by_player||{};return e.inArray(t,r.cols)>=0&&e.inArray(n,r.rows)>=0},o.is_placeholder_in=function(t,n){var r=this.cells_occupied_by_placeholder||{};return this.is_placeholder_in_col(t)&&e.inArray(n,r.rows)>=0},o.is_placeholder_in_col=function(t){var n=this.cells_occupied_by_placeholder||[];return e.inArray(t,n.cols)>=0},o.is_empty=function(e,t){return typeof this.gridmap[e]!="undefined"&&typeof this.gridmap[e][t]!="undefined"&&this.gridmap[e][t]===!1?!0:!1},o.is_occupied=function(e,t){return this.gridmap[e]?this.gridmap[e][t]?!0:!1:!1},o.is_widget=function(e,t){var n=this.gridmap[e];return n?(n=n[t],n?n:!1):!1},o.is_widget_under_player=function(e,t){return this.is_widget(e,t)?this.is_player_in(e,t):!1},o.get_widgets_under_player=function(t){t||(t=this.cells_occupied_by_player||{cols:[],rows:[]});var n=e([]);return e.each(t.cols,e.proxy(function(r,i){e.each(t.rows,e.proxy(function(e,t){this.is_widget(i,t)&&(n=n.add(this.gridmap[i][t]))},this))},this)),n},o.set_placeholder=function(t,n){var r=e.extend({},this.placeholder_grid_data),i=this.widgets_below({col:r.col,row:r.row,size_y:r.size_y,size_x:r.size_x}),s=t+r.size_x-1;s>this.cols&&(t-=s-t);var o=this.placeholder_grid_data.row<n,u=this.placeholder_grid_data.col!==t;this.placeholder_grid_data.col=t,this.placeholder_grid_data.row=n,this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.$preview_holder.attr({"data-row":n,"data-col":t}),(o||u)&&i.each(e.proxy(function(n,i){this.move_widget_up(e(i),this.placeholder_grid_data.col-t+r.size_y)},this));var a=this.get_widgets_under_player(this.cells_occupied_by_placeholder);a.length&&a.each(e.proxy(function(t,i){var s=e(i);this.move_widget_down(s,n+r.size_y-s.data("coords").grid.row)},this))},o.can_go_player_up=function(e){var t=e.row+e.size_y-1,n=!0,r=[],i=1e4,s=this.get_widgets_under_player();return this.for_each_column_occupied(e,function(e){var o=this.gridmap[e],u=t+1;r[e]=[];while(--u>0){if(!(this.is_empty(e,u)||this.is_player(e,u)||this.is_widget(e,u)&&o[u].is(s)))break;r[e].push(u),i=u<i?u:i}if(r[e].length===0)return n=!1,!0;r[e].sort()}),n?this.get_valid_rows(e,r,i):!1},o.can_go_widget_up=function(e){var t=e.row+e.size_y-1,n=!0,r=[],i=1e4;return this.for_each_column_occupied(e,function(s){var o=this.gridmap[s];r[s]=[];var u=t+1;while(--u>0){if(this.is_widget(s,u)&&!this.is_player_in(s,u)&&!o[u].is(e.el))break;!this.is_player(s,u)&&!this.is_placeholder_in(s,u)&&!this.is_player_in(s,u)&&r[s].push(u),u<i&&(i=u)}if(r[s].length===0)return n=!1,!0;r[s].sort()}),n?this.get_valid_rows(e,r,i):!1},o.get_valid_rows=function(t,n,r){var i=t.row,s=t.row+t.size_y-1,o=t.size_y,u=r-1,a=[];while(++u<=s){var f=!0;e.each(n,function(t,n){e.isArray(n)&&e.inArray(u,n)===-1&&(f=!1)});if(f===!0){a.push(u);if(a.length===o)break}}var l=!1;return o===1?a[0]!==i&&(l=a[0]||!1):a[0]!==i&&(l=this.get_consecutive_numbers_index(a,o)),l},o.get_consecutive_numbers_index=function(e,t){var n=e.length,r=[],i=!0,s=-1;for(var o=0;o<n;o++){if(i||e[o]===s+1){r.push(o);if(r.length===t)break;i=!1}else r=[],i=!0;s=e[o]}return r.length>=t?e[r[0]]:!1},o.get_widgets_overlapped=function(){var t,n=e([]),r=[],i=this.cells_occupied_by_player.rows.slice(0);return i.reverse(),e.each(this.cells_occupied_by_player.cols,e.proxy(function(t,s){e.each(i,e.proxy(function(t,i){if(!this.gridmap[s])return!0;var o=this.gridmap[s][i];this.is_occupied(s,i)&&!this.is_player(o)&&e.inArray(o,r)===-1&&(n=n.add(o),r.push(o))},this))},this)),n},o.on_start_overlapping_column=function(e){this.set_player(e,!1)},o.on_start_overlapping_row=function(e){this.set_player(!1,e)},o.on_stop_overlapping_column=function(e){this.set_player(e,!1);var t=this;this.for_each_widget_below(e,this.cells_occupied_by_player.rows[0],function(e,n){t.move_widget_up(this,t.player_grid_data.size_y)})},o.on_stop_overlapping_row=function(e){this.set_player(!1,e);var t=this,n=this.cells_occupied_by_player.cols;for(var r=0,i=n.length;r<i;r++)this.for_each_widget_below(n[r],e,function(e,n){t.move_widget_up(this,t.player_grid_data.size_y)})},o.move_widget_to=function(t,n){var r=this,i=t.coords().grid,s=n-i.row,o=this.widgets_below(t),u=this.can_move_to(i,i.col,n,t);return u===!1?!1:(this.remove_from_gridmap(i),i.row=n,this.add_to_gridmap(i),t.attr("data-row",n),this.$changed=this.$changed.add(t),o.each(function(t,n){var i=e(n),s=i.coords().grid,o=r.can_go_widget_up(s);o&&o!==s.row&&r.move_widget_to(i,o)}),this)},o.move_widget_up=function(t,n){var r=t.coords().grid,i=r.row,s=[],o=!0;n||(n=1);if(!this.can_go_up(t))return!1;this.for_each_column_occupied(r,function(r){if(e.inArray(t,s)===-1){var o=t.coords().grid,u=i-n;u=this.can_go_up_to_row(o,r,u);if(!u)return!0;var a=this.widgets_below(t);this.remove_from_gridmap(o),o.row=u,this.add_to_gridmap(o),t.attr("data-row",o.row),this.$changed=this.$changed.add(t),s.push(t),a.each(e.proxy(function(t,r){this.move_widget_up(e(r),n)},this))}})},o.move_widget_down=function(t,n){var r=t.coords().grid,i=r.row,s=[],o=n;if(!t)return!1;if(e.inArray(t,s)===-1){var u=t.coords().grid,a=i+n,f=this.widgets_below(t);this.remove_from_gridmap(u),f.each(e.proxy(function(t,n){var r=e(n),i=r.coords().grid,s=this.displacement_diff(i,u,o);s>0&&this.move_widget_down(r,s)},this)),u.row=a,this.update_widget_position(u,t),t.attr("data-row",u.row),this.$changed=this.$changed.add(t),s.push(t)}},o.can_go_up_to_row=function(t,n,r){var i=this.gridmap,s=!0,o=[],u=t.row,a;this.for_each_column_occupied(t,function(e){var t=i[e];o[e]=[],a=u;while(a--){if(!this.is_empty(e,a)||!!this.is_placeholder_in(e,a))break;o[e].push(a)}if(!o[e].length)return s=!1,!0});if(!s)return!1;a=r;for(a=1;a<u;a++){var f=!0;for(var l=0,c=o.length;l<c;l++)o[l]&&e.inArray(a,o[l])===-1&&(f=!1);if(f===!0){s=a;break}}return s},o.displacement_diff=function(e,t,n){var r=e.row,i=[],s=t.row+t.size_y;this.for_each_column_occupied(e,function(e){var t=0;for(var n=s;n<r;n++)this.is_empty(e,n)&&(t+=1);i.push(t)});var o=Math.max.apply(Math,i);return n-=o,n>0?n:0},o.widgets_below=function(t){var n=e.isPlainObject(t)?t:t.coords().grid,r=this,i=this.gridmap,s=n.row+n.size_y-1,o=e([]);return this.for_each_column_occupied(n,function(t){r.for_each_widget_below(t,s,function(t,n){if(!r.is_player(this)&&e.inArray(this,o)===-1)return o=o.add(this),!0})}),this.sort_by_row_asc(o)},o.set_cells_player_occupies=function(e,t){return this.remove_from_gridmap(this.placeholder_grid_data),this.placeholder_grid_data.col=e,this.placeholder_grid_data.row=t,this.add_to_gridmap(this.placeholder_grid_data,this.$player),this},o.empty_cells_player_occupies=function(){return this.remove_from_gridmap(this.placeholder_grid_data),this},o.can_go_up=function(e){var t=e.coords().grid,n=t.row,r=n-1,i=this.gridmap,s=[],o=!0;return n===1?!1:(this.for_each_column_occupied(t,function(e){var t=this.is_widget(e,r);if(this.is_occupied(e,r)||this.is_player(e,r)||this.is_placeholder_in(e,r)||this.is_player_in(e,r))return o=!1,!0}),o)},o.can_move_to=function(e,t,n,r){var i=this.gridmap,s=e.el,o={size_y:e.size_y,size_x:e.size_x,col:t,row:n},u=!0,a=t+e.size_x-1;return a>this.cols?!1:r&&r<n+e.size_y-1?!1:(this.for_each_cell_occupied(o,function(t,n){var r=this.is_widget(t,n);r&&(!e.el||r.is(s))&&(u=!1)}),u)},o.get_targeted_columns=function(e){var t=(e||this.player_grid_data.col)+(this.player_grid_data.size_x-1),n=[];for(var r=e;r<=t;r++)n.push(r);return n},o.get_targeted_rows=function(e){var t=(e||this.player_grid_data.row)+(this.player_grid_data.size_y-1),n=[];for(var r=e;r<=t;r++)n.push(r);return n},o.get_cells_occupied=function(e){var t={cols:[],rows:[]},n;arguments[1]instanceof jQuery&&(e=arguments[1].coords().grid);for(n=0;n<e.size_x;n++){var r=e.col+n;t.cols.push(r)}for(n=0;n<e.size_y;n++){var i=e.row+n;t.rows.push(i)}return t},o.for_each_cell_occupied=function(e,t){return this.for_each_column_occupied(e,function(n){this.for_each_row_occupied(e,function(e){t.call(this,n,e)})}),this},o.for_each_column_occupied=function(e,t){for(var n=0;n<e.size_x;n++){var r=e.col+n;t.call(this,r,e)}},o.for_each_row_occupied=function(e,t){for(var n=0;n<e.size_y;n++){var r=e.row+n;t.call(this,r,e)}},o._traversing_widgets=function(t,n,r,i,s){var o=this.gridmap;if(!o[r])return;var u,a,f=t+"/"+n;if(arguments[2]instanceof jQuery){var l=arguments[2].coords().grid;r=l.col,i=l.row,s=arguments[3]}var c=[],h=i,p={"for_each/above":function(){while(h--)if(h>0&&this.is_widget(r,h)&&e.inArray(o[r][h],c)===-1){u=s.call(o[r
][h],r,h),c.push(o[r][h]);if(u)break}},"for_each/below":function(){for(h=i+1,a=o[r].length;h<a;h++)if(this.is_widget(r,h)&&e.inArray(o[r][h],c)===-1){u=s.call(o[r][h],r,h),c.push(o[r][h]);if(u)break}}};p[f]&&p[f].call(this)},o.for_each_widget_above=function(e,t,n){return this._traversing_widgets("for_each","above",e,t,n),this},o.for_each_widget_below=function(e,t,n){return this._traversing_widgets("for_each","below",e,t,n),this},o.get_highest_occupied_cell=function(){var e,t=this.gridmap,n=[],r=[];for(var i=t.length-1;i>=1;i--)for(e=t[i].length-1;e>=1;e--)if(this.is_widget(i,e)){n.push(e),r[e]=i;break}var s=Math.max.apply(Math,n);return this.highest_occupied_cell={col:r[s],row:s},this.highest_occupied_cell},o.get_widgets_from=function(t,n){var r=this.gridmap,i=e();return t&&(i=i.add(this.$widgets.filter(function(){var n=e(this).attr("data-col");return n===t||n>t}))),n&&(i=i.add(this.$widgets.filter(function(){var t=e(this).attr("data-row");return t===n||t>n}))),i},o.set_dom_grid_height=function(){var e=this.get_highest_occupied_cell().row;return this.$el.css("height",e*this.min_widget_height),this},o.generate_stylesheet=function(t){var n="",r=this.options.max_size_x,i=0,o=0,u,a;t||(t={}),t.cols||(t.cols=this.cols),t.rows||(t.rows=this.rows),t.namespace||(t.namespace=this.options.namespace),t.widget_base_dimensions||(t.widget_base_dimensions=this.options.widget_base_dimensions),t.widget_margins||(t.widget_margins=this.options.widget_margins),t.min_widget_width=t.widget_margins[0]*2+t.widget_base_dimensions[0],t.min_widget_height=t.widget_margins[1]*2+t.widget_base_dimensions[1];var f=e.param(t);if(e.inArray(f,s.generated_stylesheets)>=0)return!1;s.generated_stylesheets.push(f);for(u=t.cols;u>=0;u--)n+=t.namespace+' [data-col="'+(u+1)+'"] { left:'+(u*t.widget_base_dimensions[0]+u*t.widget_margins[0]+(u+1)*t.widget_margins[0])+"px;} ";for(u=t.rows;u>=0;u--)n+=t.namespace+' [data-row="'+(u+1)+'"] { top:'+(u*t.widget_base_dimensions[1]+u*t.widget_margins[1]+(u+1)*t.widget_margins[1])+"px;} ";for(var l=1;l<=t.rows;l++)n+=t.namespace+' [data-sizey="'+l+'"] { height:'+(l*t.widget_base_dimensions[1]+(l-1)*t.widget_margins[1]*2)+"px;}";for(var c=1;c<=r;c++)n+=t.namespace+' [data-sizex="'+c+'"] { width:'+(c*t.widget_base_dimensions[0]+(c-1)*t.widget_margins[0]*2)+"px;}";return this.add_style_tag(n)},o.add_style_tag=function(e){var t=n,r=t.createElement("style");return t.getElementsByTagName("head")[0].appendChild(r),r.setAttribute("type","text/css"),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(n.createTextNode(e)),this},o.generate_faux_grid=function(e,t){this.faux_grid=[],this.gridmap=[];var n,r;for(n=t;n>0;n--){this.gridmap[n]=[];for(r=e;r>0;r--)this.add_faux_cell(r,n)}return this},o.add_faux_cell=function(t,n){var r=e({left:this.baseX+(n-1)*this.min_widget_width,top:this.baseY+(t-1)*this.min_widget_height,width:this.min_widget_width,height:this.min_widget_height,col:n,row:t,original_col:n,original_row:t}).coords();return e.isArray(this.gridmap[n])||(this.gridmap[n]=[]),this.gridmap[n][t]=!1,this.faux_grid.push(r),this},o.add_faux_rows=function(e){var t=this.rows,n=t+(e||1);for(var r=n;r>t;r--)for(var i=this.cols;i>=1;i--)this.add_faux_cell(r,i);return this.rows=n,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},o.add_faux_cols=function(e){var t=this.cols,n=t+(e||1);for(var r=t;r<n;r++)for(var i=this.rows;i>=1;i--)this.add_faux_cell(i,r);return this.cols=n,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},o.recalculate_faux_grid=function(){var n=this.$wrapper.width();return this.baseX=(e(t).width()-n)/2,this.baseY=this.$wrapper.offset().top,e.each(this.faux_grid,e.proxy(function(e,t){this.faux_grid[e]=t.update({left:this.baseX+(t.data.col-1)*this.min_widget_width,top:this.baseY+(t.data.row-1)*this.min_widget_height})},this)),this},o.get_widgets_from_DOM=function(){return this.$widgets.each(e.proxy(function(t,n){this.register_widget(e(n))},this)),this},o.generate_grid_and_stylesheet=function(){var n=this.$wrapper.width(),r=this.$wrapper.height(),i=Math.floor(n/this.min_widget_width)+this.options.extra_cols,s=this.$widgets.map(function(){return e(this).attr("data-col")});s=Array.prototype.slice.call(s,0),s.length||(s=[0]);var o=Math.max.apply(Math,s),u=this.options.extra_rows;return this.$widgets.each(function(t,n){u+=+e(n).attr("data-sizey")}),this.cols=Math.max(o,i,this.options.min_cols),this.rows=Math.max(u,this.options.min_rows),this.baseX=(e(t).width()-n)/2,this.baseY=this.$wrapper.offset().top,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this.generate_faux_grid(this.rows,this.cols)},e.fn.gridster=function(t){return this.each(function(){e(this).data("gridster")||e(this).data("gridster",new s(this,t))})},e.Gridster=o}(jQuery,window,document),function(){function n(e,t,n){var r="";if(!t||t.length===0)return r;for(var i=0;i<t.date.length;i++)t.date[i]==n[e.index]&&(r=t.marks[i]);return r}function r(e,t){var r={name:e,config:{colors:t.colors,grid:{verticalLines:!1,horizontalLines:!1},mouse:{track:!0,trackY:!1,position:"ne"},yaxis:{min:0,autoscale:!0},legend:{show:!1,backgroundColor:"#FFFFFF",backgroundOpacity:0}}};return t.gtype==="whiskers"?r.config.whiskers={show:!0,lineWidth:2}:r.config["lite-lines"]={lineWidth:2,show:!0,fill:!1,fillOpacity:.5},t.y_labels&&(r.config.yaxis={showLabels:!0,min:0}),t.show_markers&&(r.config.markers={show:!0,position:"ct",labelFormatter:function(e){return n(e,t.markers,t.dates)}}),r}function i(e,n,i,s){var o=Report.getAllMetrics(),u=null;$.each(i,function(i,a){config=s,a.envision&&(config=DataProcess.mergeConfig(s,a.envision)),$.inArray(i,t.envision_hide)===-1&&(n[i]=r("report-"+e.getName()+"-"+i,config),u=i,o[i]&&(u=o[i].name),n[i].config.subtitle=u,e.getMainMetric()==i&&(n[i+"_relative"]=r("report-"+e.getName()+"-"+i+"_relative",config),n[i].config["lite-lines"]={show:!1},n[i].config.lines={lineWidth:1,show:!0,stacked:!0,fill:!0,fillOpacity:1}))})}function s(n){var s=["#ffa500","#00A8F0","#C0D800","#ffff00","#00ff00","#4DA74D","#9440ED"],o={colors:s,dates:t.dates,g_type:"",markers:t.markers,y_labels:!1},u=Report.getDataSources(),a={},f={};return n?$.each(u,function(e,t){$.inArray(t.getName(),n)>-1&&(f=t.getMetrics(),i(t,a,f,o))}):$.each(u,function(e,t){f=t.getMetrics(),i(t,a,f,o)}),config=o,a.summary=r("report-summary",config),a.summary.config.xaxis={noTickets:10,showLabels:!0},a.summary.config.handles={show:!0},a.summary.config.selection={mode:"x"},a.summary.config.mouse={},a.connection={name:"report-connection",adapterConstructor:e.components.QuadraticDrawing},a}function o(e,t){var n=[],r=null;return $.each(e,function(e,n){if(n.getMetrics()[t])return r=n,!1}),n.push(r),$.each(e,function(e,t){if(t===r)return;n.push(t)}),n}function u(n,r){var i=n.data.main_metric;t=n.data,r||(r=Report.getDataSources()),r=o(r,i);var u=[];for(var a=0;a<r.length;a++){if(r[a].getData().length===0)continue;u.push(r[a].getName())}var f=n.data,l=s(u),c=new e.Visualization({name:"report-"+u.join(",")}),h=new e.Interaction,p=new e.Interaction,d={};$.each(r,function(e,t){if(t.getData().length===0)return;d=$.extend(d,t.getMetrics())}),$.each(d,function(e,t){if($.inArray(e,f.envision_hide)!==-1)return;if(f[e]===undefined)return;l[e].data=f[e],l[e].data.length<Report.getProjectsList().length&&(l[e].config.legend.show=!0),f[e+"_relative"]&&(l[e].data=f[e+"_relative"])}),l.summary.data=f.summary,l[i].config.legend.show=!0,n.legend_show===!1&&(l[i].config.legend.show=!1),l[i].config.mouse.trackFormatter=n.trackFormatter,n.xTickFormatter&&(l.summary.config.xaxis.tickFormatter=n.xTickFormatter),l[i].config.yaxis.tickFormatter=n.yTickFormatter||function(e){return"$"+e};var v={};$.each(d,function(t,n){if(f[t]===undefined)return;$.inArray(t,f.envision_hide)===-1&&(v[t]=new e.Component(l[t]))}),connection=new e.Component(l.connection),summary=new e.Component(l.summary),$.each(v,function(e,t){c.add(t)}),c.add(connection).add(summary).render(n.container),$.each(v,function(e,t){h.follower(t)}),h.follower(connection).leader(summary).add(e.actions.selection,n.selectionCallback?{callback:n.selectionCallback}:null);var m=[];$.each(v,function(e,t){m.push(t)}),p.group(m).add(e.actions.hit),n.selection&&summary.trigger("select",n.selection)}var e=envision,t={};e.templates.Envision_Report=u}();if(Loader===undefined)var Loader={};(function(){function a(e,t){e.project_name===undefined&&(e.project_name=t.replace("data/json","").replace(/\.\.\//g,""));var n=Report.getProjectsData();n[e.project_name]={dir:t,url:e.project_url}}function f(e,t,n){$.when($.getJSON(e)).done(function(e){t(e,n),D()}).fail(function(){t([],n),D()})}function l(){var e=["irc","mediawiki"],t=Report.getDataSources();$.each(t,function(t,n){$.inArray(n.getName(),e)>-1?n.setCompaniesData([]):f(n.getCompaniesDataFile(),n.setCompaniesData,n)})}function c(){var e=["mediawiki"],t=Report.getDataSources();$.each(t,function(t,n){$.inArray(n.getName(),e)>-1?n.setReposData([]):f(n.getReposDataFile(),n.setReposData,n)}),f(Report.getReposMapFile(),Report.setReposMap)}function h(){var e=["irc","mediawiki"],t=Report.getDataSources();$.each(t,function(t,n){$.inArray(n.getName(),e)>-1?n.setCountriesData([]):f(n.getCountriesDataFile(),n.setCountriesData,n)})}function p(){var e=["irc","mediawiki"],t=Report.getDataSources();$.each(t,function(t,n){$.inArray(n.getName(),e)>-1?n.setDomainsData([]):f(n.getDomainsDataFile(),n.setDomainsData,n)})}function d(){var e=["irc","mediawiki"],t=Report.getDataSources();$.each(t,function(t,n){$.inArray(n.getName(),e)>-1?n.setProjectsData([]):f(n.getProjectsDataFile(),n.setProjectsData,n)})}function v(){var e=Report.getDataSources();$.each(e,function(e,t){t.getName()==="its"&&f(t.getTimeToFixDataFile(),t.setTimeToFixData,t)})}function m(){var e=Report.getDataSources();$.each(e,function(e,t){t.getName()==="its"&&f(t.getMarkovTableDataFile(),t.setMarkovTableData,t)})}function g(){var e=Report.getDataSources();$.each(e,function(e,t){t.getName()==="mls"&&f(t.getTimeToAttentionDataFile(),t.setTimeToAttentionData,t)})}function y(){var e=Report.getDataSources();$.each(e,function(e,t){f(t.getDemographicsAgingFile(),t.setDemographicsAgingData,t),f(t.getDemographicsBirthFile(),t.setDemographicsBirthData,t)})}function b(e){var t=Report.getDataSources();$.each(t,function(e,t){var n=t.getTopDataFile();$.when($.getJSON(n)).done(function(e){t.setGlobalTopData(e),D()}).fail(function(){t.setGlobalTopData([],t),D()})})}function w(e,t){var n=null;return $.each(Report.getDataSources(),function(r,i){if(t=="repos"&&$.inArray(e,i.getReposData())>-1)return n=i,!1;if(t=="companies"&&$.inArray(e,i.getCompaniesData())>-1)return n=i,!1;if(t=="countries"&&$.inArray(e,i.getCountriesData())>-1)return n=i,!1;if(t=="domains"&&$.inArray(e,i.getDomainsData())>-1)return n=i,!1;if(t=="projects"&&$.inArray(e,i.getProjectsData())>-1)return n=i,!1}),n}function E(e){var t="";return e==="repos"?t="rep":e==="companies"?t="com":e==="countries"?t="cou":e==="domains"?t="dom":e==="projects"&&(t="prj"),t}function S(){var e=Report.getDataSources();$.each(e,function(e,t){f(t.getDataFile(),t.setData,t),f(t.getGlobalDataFile(),t.setGlobalData,t),t instanceof MLS&&f(t.getListsFile(),t.setListsData,t)})}function x(){f("VizGrimoireJS/data/metrics.json",Report.setMetricsDefinition)}function T(){var e=Report.getDataSources();$.each(e,function(e,t){f(t.getPeopleDataFile(),t.setPeopleData,t)})}function N(){f(Report.getDataDir()+"/people.json",Report.setPeopleIdentities)}function C(e){return e.getCompaniesData()===null?!1:!0}function k(e){return e.getReposData()===null?!1:!0}function L(e){return e.getCountriesData()===null?!1:!0}function A(e){return e.getDomainsData()===null?!1:!0}function O(e){return e.getProjectsData()===null?!1:!0}function M(){var e=0,t=Report.getProjectsData(),n=Report.getProjectsDirs();for(var r in t)e++;return e<n.length?!1:!0}function _(){var e=!0;if(Report.getProjectData()===null||Report.getVizConfig()===null)return!1;if(Report.getConfig()===null&&Report.getMarkers()===null)return!1;if(Report.getReposMap()===null)return!1;if(Report.getConfig()===null&&!M())return!1;var t=Report.getDataSources();return $.each(t,function(t,n){if(n.getData()===null)return e=!1,!1;if(n.getGlobalData()===null)return e=!1,!1;if(n.getGlobalTopData()===null)return e=!1,!1;if(n.getDemographicsData().aging===undefined||n.getDemographicsData().birth===undefined)return e=!1,!1;if(n.getName()==="its"&&n.getTimeToFixData()===null)return e=!1,!1;if(n.getName()==="mls"&&n.getTimeToAttentionData()===null)return e=!1,!1}),e}function D(){if(_()){for(var n=0;n<t.length;n++)t[n]();t=[]}if(Loader.check_data_loaded())for(var r=0;r<e.length;r++)e[r].called!==!0&&e[r](),e[r].called=!0}var e=[],t=[],n=[],r=!1,i=!1,s=!1,o=["scr","irc","mediawiki"],u=["scm","mls","its"];Loader.data_ready=function(t){e.push(t)},Loader.data_ready_global=function(e){t.push(e)},Loader.data_load=function(){Report.getConfig()!==null&&Report.getConfig().project_info!==undefined?(Report.setProjectData(Report.getConfig().project_info),Report.getConfig().markers&&f(Report.getMarkersFile(),function(e,t){Report.setMarkers(e)})):(f(Report.getProjectFile(),function(e,t){Report.setProjectData(e)}),f(Report.getMarkersFile(),function(e,t){Report.setMarkers(e)}));var e=Report.getProjectsDirs();for(var t=0;t<e.length;t++){var n=e[t],r=Report.getDataDir()+"/project-info.json";f(r,a,n)}f(Report.getProjectsHierarchyFile(),Report.setProjectsHierarchy),f(Report.getMenuElementsFile(),Report.setMenuElements),f(Report.getVizConfigFile(),function(e,t){Report.setVizConfig(e)}),x(),S(),b("authors"),v(),g(),y(),m();if(Report.getConfig()!==null&&Report.getConfig().reports!==undefined){var i=Report.getConfig().reports;$.inArray("companies",i)>-1&&l(),$.inArray("repositories",i)>-1&&c(),$.inArray("countries",i)>-1&&h(),$.inArray("domains",i)>-1&&p(),$.inArray("projects",i)>-1&&d(),$.inArray("people",i)>-1&&(T(),N())}else l(),c(),h(),p(),d(),T(),N()},Loader.get_file_data_div=function(e,t,n){$.when($.getJSON(e)).done(function(r){t(n,e,r)}).fail(function(){t(e,null)})},Loader.check_filters_page=function(e){var t=!0,n=["repos","companies","countries"];return $.each(n,function(n,r){if(!Loader.check_filter_page(e,r))return t=!1,!1}),t},Loader.check_filter_page=function(e,t){var n=!0;e===undefined&&(e=1);var r=Report.getPageSize()*(e-1),i=r+Report.getPageSize();return $.each(Report.getDataSources(),function(e,s){var o=0;t==="repos"&&(o=s.getReposData().length),t==="companies"&&(o=s.getCompaniesData().length),t==="countries"&&(o=s.getCountriesData().length),t==="domains"&&(o=s.getDomainsData().length),t==="projects"&&(o=s.getProjectsData().length),i>o&&(i=o);for(var u=r;u<i;u++){var a;if(t==="repos"){a=s.getReposData()[u];if(s.getReposGlobalData()[a]===undefined||s.getReposMetricsData()[a]===undefined)return n=!1,!1}if(t==="companies"){a=s.getCompaniesData()[u];if(s.getCompaniesGlobalData()[a]===undefined||s.getCompaniesMetricsData()[a]===undefined)return n=!1,!1}if(t==="countries"){a=s.getCountriesData()[u];if(s.getCountriesGlobalData()[a]===undefined||s.getCountriesMetricsData()[a]===undefined)return n=!1,!1}if(t==="domains"){a=s.getDomainsData()[u];if(s.getDomainsGlobalData()[a]===undefined||s.getDomainsMetricsData()[a]===undefined)return n=!1,!1}if(t==="projects"){a=s.getProjectsData()[u];if(s.getProjectsGlobalData()[a]===undefined||s.getProjectsMetricsData()[a]===undefined)return n=!1,!1}}i=r+Report.getPageSize()}),n},Loader.filterTopCheck=function(e,t){var n=!0;return t==="repos"&&Loader.check_item(e,t,"top")===!1?(ds=w(e,t),ds===null?(Report.log("Can't find data source for "+e),!0):($.inArray(ds.getName(),u)>=0&&Loader.data_load_item_top(e,ds,null,Convert.convertFilterTop,t,"top"),!1)):n},Loader.FilterItemCheck=function(e,t){var n=!0,r,i=Report.getReposMap();if(t==="repos"){if(Loader.check_item(e,t)===!1)return r=w(e,t),r===null?(Report.log("Can't find data source for "+e),!0):(Loader.data_load_item(e,r,null,Convert.convertFilterStudyItem,t,null),$.inArray(r.getName(),u)>=0&&Loader.data_load_item_top(e,r,null,Convert.convertFilterStudyItem,t),!1);if(i!==undefined&&i.length!==0){var s=[];$.each(Report.getDataSources(),function(n,r){var i=Convert.getRealItem(r,t,e);i!==undefined&&i!==null&&s.push(i)});if(Loader.check_items(s,t)===!1){for(var a=0;a<s.length;a++)if(Loader.check_item(s[a],t)===!1){r=w(s[a],t);if(r===null){Report.log("Can't find "+s[a]),Report.log("Check repos-map.json");continue}Loader.data_load_item(s[a],r,null,Convert.convertFilterStudyItem,t,s)}n=!1}}}else $.each(Report.getDataSources(),function(r,i){Loader.check_item(e,t)===!1&&(n=!1,Loader.data_load_item(e,i,null,Convert.convertFilterStudyItem,t,null),t==="companies"&&$.inArray(i.getName(),o)===-1&&Loader.data_load_item_top(e,i,null,Convert.convertFilterStudyItem,t))});return n},Loader.check_item=function(e,t,n){var r=!1;return $.each(Report.getDataSources(),function(i,s){if(t==="repos"){if(n==="top"){if($.inArray(s.getName(),u)>=0&&$.inArray(e,s.getReposData())>=0&&s.getRepositoriesTopData()[e]!==undefined)return r=!0,!1}else if(s.getReposGlobalData()[e]!==undefined&&s.getReposMetricsData()[e]!==undefined)return r=!0,!1}else if(t==="companies"){var a=s.getCompaniesData();if(a.length===0)r=!0;else if($.inArray(e,a)===-1)r=!0;else{if(s.getCompaniesGlobalData()[e]===undefined||s.getCompaniesMetricsData()[e]===undefined)return r=!1,!1;if($.inArray(s.getName(),o)===-1&&s.getCompaniesTopData()[e]===undefined)return r=!1,!1;r=!0}}else if(t==="countries"){var f=s.getCountriesData();if(f.length===0)r=!0;else if($.inArray(e,f)===-1)r=!0;else{if(s.getCountriesGlobalData()[e]===undefined||s.getCountriesMetricsData()[e]===undefined)return r=!1,!1;r=!0}}else if(t==="domains"){var l=s.getDomainsData();if(l.length===0)r=!0;else if($.inArray(e,l)===-1)r=!0;else{if(s.getDomainsGlobalData()[e]===undefined||s.getDomainsMetricsData()[e]===undefined)return r=!1,!1;r=!0}}else if(t==="projects"){var c=s.getProjectsData();if(c.length===0)r=!0;else if($.inArray(e,c)===-1)r=!0;else{if(s.getProjectsGlobalData()[e]===undefined||s.getProjectsMetricsData()[e]===undefined)return r=!1,!1;r=!0}}}),r},Loader.check_items=function(e,t){var n=!0;return $.each(e,function(e,r){if(Loader.check_item(r,t)===!1)return n=!1,!1}),n},Loader.data_load_items_page=function(e,t,n,r){t===undefined&&(t=1);if(r==="repos"&&e.getReposData()===null)return!1;if(r==="companies"&&e.getCompaniesData()===null)return!1;if(r==="countries"&&e.getCountriesData()===null)return!1;if(r==="domains"&&e.getDomainsData()===null)return!1;if(r==="projects"&&e.getProjectsData()===null)return!1;var i=0;r==="repos"&&(i=e.getReposData().length),r==="companies"&&(i=e.getCompaniesData().length),r==="countries"&&(i=e.getCountriesData().length),r==="domains"&&(i=e.getDomainsData().length),r==="projects"&&(i=e.getProjectsData().length);if(i===0)return!0;var s=Report.getPageSize()*(t-1),o=s+Report.getPageSize();o>i&&(o=i);for(var u=s;u<o;u++)if(r==="repos"){var a=e.getReposData()[u];Loader.data_load_item(a,e,t,n,"repos")}else if(r==="companies"){var f=e.getCompaniesData()[u];Loader.data_load_item(f,e,t,n,"companies")}else if(r==="countries"){var l=e.getCountriesData()[u];Loader.data_load_item(l,e,t,n,"countries")}else if(r==="domains"){var c=e.getDomainsData()[u];Loader.data_load_item(c,e,t,n,"domains")}else if(r==="projects"){var h=e.getProjectsData()[u];Loader.data_load_item(h,e,t,n,"projects")}},Loader.check_people_item=function(e){var t=!0;return $.each(Report.getDataSources(),function(n,r){if(r.getPeopleGlobalData()[e]===undefined||r.getPeopleMetricsData()[e]===undefined)return t=!1,!1}),t},Loader.data_load_people_item=function(e,t,n){var r=t.getDataDir()+"/people-"+e+"-"+t.getName(),i=r+"-evolutionary.json",s=r+"-static.json";$.when($.getJSON(i),$.getJSON(s)).done(function(r,i){t.addPeopleMetricsData(e,r[0],t),t.addPeopleGlobalData(e,i[0],t),Loader.check_people_item(e)&&n(e)}).fail(function(){t.addPeopleMetricsData(e,[],t),t.addPeopleGlobalData(e,[],t),Loader.check_people_item(e)&&n(e)})},Loader.data_load_item_top=function(e,t,n,r,i,s){var o=t.getDataDir()+"/"+e+"-"+t.getName();o+="-"+E(i)+"-top-";if(t.getName()==="scm")o+="authors";else if(t.getName()==="its")o+="closers";else{if(t.getName()!=="mls")return;o+="senders"}o+=".json",$.when($.getJSON(o)).done(function(n){i==="companies"?t.addCompanyTopData(e,n):i==="repos"&&t.addRepositoryTopData(e,n)}).fail(function(){i==="companies"?t.addCompanyTopData(e,[]):i==="repos"&&t.addRepositoryTopData(e,[])}).always(function(){Loader.check_item(e,i,s)&&(r.called_item||r(i),r.called_item=!0)})},Loader.data_load_item=function(e,t,n,r,i,s){var o=["irc","mediawiki"],u=["irc","mediawiki"],a=["irc","mediawiki"],f=["mediawiki"],l=["irc","mediawiki"];if(i==="repos"){if($.inArray(t.getName(),f)>-1){t.addRepoMetricsData(e,[],t),t.addRepoGlobalData(e,[],t);return}}else if(i==="companies"){if($.inArray(t.getName(),u)>-1){t.addCompanyMetricsData(e,[],t),t.addCompanyGlobalData(e,[],t);return}}else if(i==="countries"){if($.inArray(t.getName(),o)>-1){t.addCountryMetricsData(e,[],t),t.addCountryGlobalData(e,[],t);return}}else if(i==="domains"){if($.inArray(t.getName(),a)>-1){t.addDomainMetricsData(e,[],t),t.addDomainGlobalData(e,[],t);return}}else{if(i!=="projects")return;if($.inArray(t.getName(),l)>-1){t.addDomainMetricsData(e,[],t),t.addDomainGlobalData(e,[],t);return}}var c=encodeURIComponent(e),h=t.getDataDir()+"/"+c+"-";h+=t.getName()+"-"+E(i);var p=h+"-evolutionary.json",d=h+"-static.json";$.when($.getJSON(p),$.getJSON(d)).done(function(n,r){i==="repos"?(t.addRepoMetricsData(e,n[0],t),t.addRepoGlobalData(e,r[0],t)):i==="companies"?(t.addCompanyMetricsData(e,n[0],t),t.addCompanyGlobalData(e,r[0],t)):i==="countries"?(t.addCountryMetricsData(e,n[0],t),t.addCountryGlobalData(e,r[0],t)):i==="domains"?(t.addDomainMetricsData(e,n[0],t),t.addDomainGlobalData(e,r[0],t)):i==="projects"&&(t.addProjectMetricsData(e,n[0],t),t.addProjectGlobalData(e,r[0],t))}).always(function(){n!==null?Loader.check_filter_page(n,i)&&(r.called_page===undefined?(r.called_page={},r.called_page[i]=!0,r(i)):r.called_page[i]||(r(i),r.called_page[i]=!0)):s!==null?Loader.check_items(s,i)&&(r.called_map===undefined?(r.called_map={},r.called_map[i]=!0,r(i)):r.called_map[i]||(r(i),r.called_map[i]=!0)):Loader.check_item(e,i)&&(r.called_item===undefined?(r.called_item={},r.called_item[i]=!0,r(i,e)):r.called_item[i]||(r(i,e),r.called_item[i]=!0))})},Loader.check_data_loaded=function(){var e=!0;if(!_())return!1;var t=Report.getDataSources(),n=["companies","repositories","countries","domains","projects"];return Report.getConfig()!==null&&Report.getConfig().reports!==undefined&&(n=Report.getConfig().reports),$.each(t,function(t,r){if(r.getPeopleData()===null)return e=!1,!1;if($.inArray("companies",n)>-1&&!C(r))return e=!1,!1;if($.inArray("repositories",n)>-1&&!k(r))return e=!1,!1;if($.inArray("countries",n)>-1&&!L(r))return e=!1,!1;if($.inArray("domains",n)>-1&&!A(r))return e=!1,!1;if($.inArray("projects",n)>-1&&!O(r))return e=!1,!1;if(r instanceof MLS&&r.getListsData()===null)return e=!1,!1}),e}})();var DataProcess={};(function(){DataProcess.info=function(){},DataProcess.paginate=function(e,t){if(t===undefined||t===0||isNaN(t))return e;var n=[],r=Report.getPageSize(),i=(t-1)*r;for(var s=i;s<r*t;s++)e[s]&&n.push(e[s]);return n},DataProcess.convert=function(e,t,n){return t==="aggregate"?e=DataProcess.aggregate(e,n):t==="substract"?(e=DataProcess.substract(e,n[0],n[1]),n=["substract"]):t==="substract-aggregate"?(e=DataProcess.substract(e,n[0],n[1]),n=["substract"],e=DataProcess.aggregate(e,n)):t==="divide"&&(e=DataProcess.divide(e,n[0],n[1]),n=["divide"]),e},DataProcess.sortGlobal=function(e,t,n){t===undefined&&(t="scm_commits");var r=[],i=[],s={};s.name=[],s[t]=[];var o=null;n==="companies"?(i=e.getCompaniesData(),o=e.getCompaniesDataFull()):n==="repos"?(i=e.getReposData(),o=e.getReposDataFull()):n==="countries"?i=e.getCountriesData():n==="domains"?(i=e.getDomainsData(),o=e.getDomainsDataFull()):n==="projects"&&(i=e.getProjectsData());if(i===null)return[];if(o===null)return i;if(o instanceof Array||t in o==0)return i;for(var u=0;u<o[t].length;u++){var a=o[t][u];a==="NA"&&(a=0),r.push([o.name[u],a])}return r.sort(function(e,t){return t[1]-e[1]}),$.each(r,function(e,n){s.name.push(n[0]),s[t].push(n[1])}),s.name},DataProcess.orderItems=function(e){$.each($("[class^='FilterItems']"),function(t,n){order_by=$(this).data("order-by");if(order_by!==undefined){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;var r=$(this).data("filter");if(r===undefined)return;if(r!==e)return;Report.log("Ordering with "+order_by+" "+ds+" for "+r);var i=DataProcess.sortGlobal(DS,order_by,r);return r==="companies"&&DS.setCompaniesData(i),r==="repos"&&DS.setReposData(i),r==="countries"&&DS.setCountriesData(i),r==="domains"&&DS.setDomainsData(i),!1}})},DataProcess.mergeConfig=function(e,t){var n={};return $.each(e,function(e,t){n[e]=t}),$.each(t,function(e,t){n[e]=t}),n},DataProcess.hideEmail=function(e){var t=e;return typeof e=="string"&&e.indexOf("@")>-1&&(t=e.split("@")[0]),t},DataProcess.selectPersonName=function(e){var t="",n,r;for(var i=0;i<e.identity.length;i++)n=e.identity[i],r=e.type[i],r==="name"&&n.length>t.length&&(t=n);return t},DataProcess.selectPersonEmail=function(e){var t="",n,r;for(var i=0;i<e.identity.length;i++)n=e.identity[i],r=e.type[i],r==="email"&&(t=n);return t},DataProcess.frameTime=function(e,t){var n={},r=-1,i=-1,s=0;if(t.length===0)return e;var o=e[t[0]].length,u=0;$.each(t,function(t,n){s=0;for(u=0;u<e[n].length;u++){if(e[n][u]!==0){r===-1&&(r=s),s<r&&(r=s);break}s++}}),$.each(t,function(t,n){s=0;for(u=e[n].length-1;u>=0;u--){if(e[n][u]!==0){i===-1&&(i=s),s<i&&(i=s);break}s++}});for(var a in e){n[a]=[];for(u=0;u<e[a].length;u++){if(u<r)continue;if(u>=o-i)continue;n[a].push(e[a][u])}}return n},DataProcess.filterDates=function(e,t,n){var r={};return $.each(n,function(i,s){r[i]=[],$.each(s,function(s,o){var u=n.unixtime[s];u>e&&(!t||t&&u<=t)&&r[i].push(o)})}),r},DataProcess.filterYear=function(e,t){e=parseInt(e,null);var n=(new Date(e.toString())).getTime(),r=(new Date((e+1).toString())).getTime(),i=filterDates(n,r,t);return i},DataProcess.fillDates=function(e,t){if(e[0].length===0)return t;var n=[[],[]],r=0;if(e[0][0]>t[0][0])for(r=0;r<t[0].length;r++)n[0][r]=t[0][r],n[1][r]=t[1][r];for(r=0;r<e[0].length;r++)pos=n[0].indexOf(e[0][r]),pos===-1&&(n[0].push(e[0][r]),n[1].push(e[1][r]));if(e[0][e[0].length-1]<t[0][t[0].length-1])for(r=0;r<t[0].length;r++)pos=n[0].indexOf(t[0][r]),pos===-1&&(n[0].push(t[0][r]),n[1].push(t[1][r]));return n},DataProcess.fillHistory=function(e,t){var n=[[],[]];for(var r=0;r<e.length;r++)pos=t[0].indexOf(e[r]),n[0][r]=e[r],pos!=-1?n[1][r]=t[1][pos]:n[1][r]=0;return n},DataProcess.fillHistoryLines=function(e,t){var n=[[],[]],r=[[],[]],i=[];for(var s=0;s<t.length;s++)n[0].push(t[s][0]),n[1].push(t[s][1]);r=DataProcess.fillHistory(e,n);for(s=0;s<e.length;s++)i.push([r[0][s],r[1][s]]);return i},DataProcess.addRelativeValues=function(e,t){if(e[t]===undefined)return;e[t+"_relative"]=[];var n=[];$.each(e[t],function(e,t){var r=t.data[1];for(var i=0;i<r.length;i++)n[i]===undefined&&(n[i]=0),n[i]+=r[i]}),$.each(e[t],function(r,i){var s=[];for(var o=0;o<i.data[0].length;o++)if(n[o]===0)s[o]=0;else{var u=i.data[1][o]/n[o]*100;s[o]=u}e[t+"_relative"].push({label:i.label,data:[i.data[0],s]})})},DataProcess.aggregate=function(e,t){var n={};return t instanceof Array||(t=[t]),$.each(e,function(r,i){if($.inArray(r,t)>-1){var s=[];s[0]=e[r][0];for(var o=1;o<e[r].length;o++)s[o]=s[o-1]+e[r][o];n[r]=s}else n[r]=e[r]}),n},DataProcess.substract=function(e,t,n){var r={},i=[];for(var s=0;s<e[t].length;s++)i[s]=e[t][s]-e[n][s];return $.each(e,function(t,n){r[t]=e[t]}),r.substract=i,r},DataProcess.divide=function(e,t,n){var r={},i=[];for(var s=0;s<e[t].length;s++)e[t][s]===0||e[n][s]===0?i[s]=0:i[s]=parseInt(e[t][s]/e[n][s],null);return $.each(e,function(t,n){r[t]=e[t]}),r.divide=i,r},DataProcess.revomeLastPoint=function(e){var t={};return $.each(e,function(n,r){t[n]=[];for(var i=0;i<e[n].length-1;i++)t[n].push(e[n][i])}),t}})();var Convert={};(function(){function e(e,t){return t.hasOwnProperty(e)&&t[e].title?t[e].title:undefined}function t(e,t){return e.project_id<t.project_id?-1:e.project_id>t.project_id?1:0}function n(e,t){var n=[],r=e,i="",s={};while(t[r].hasOwnProperty("parent_project"))i=t[r].parent_project,s=t[i],s.project_id=i,n.push(s),r=i;return n.reverse()}function r(e,n){var r=[],i={};return $.each(n,function(t,s){n[t].parent_project===e&&(i=n[t],i.project_id=t,r.push(i))}),r.sort(t),r}function i(t,n,i){var s="",o=n.length;return o>0?(s+='<li class="dropdown">',s+='<span data-toggle="tooltip" title="Project name"> '+e(t,i)+"</span>",s+='&nbsp;<a class="dropdown-toggle" data-toggle="dropdown" href="#">',s+='<span data-toggle="tooltip" title="Select subproject" class="badge"> '+o+" Subprojects </span></a>",s+='<ul class="dropdown-menu scrollable-menu">',$.each(n,function(e,t){gchildren=r(t.project_id,i),gchildren.length>0?s+='<li><a href="project.html?project='+t.project_id+'">'+t.title+'&nbsp;&nbsp;<span data-toggle="tooltip" title="Number of suprojects" class="badge">'+gchildren.length+'&nbsp;<i class="fa fa-rocket"></i></span></a></li>':s+='<li><a href="project.html?project='+t.project_id+'">'+t.title+"</a></li>"}),s+='<li class="divider"></li>',s+='<li><a href="./project_map.html"><i class="fa fa-icon fa-sitemap"></i> Projects treemap</a></li>',s+="</ul></li>"):s+="<li>"+e(t,i)+"</li>",s}function s(e){var t='<ol class="breadcrumbtitle">',s=Report.getProjectsHierarchy();if(s.length===0)return"";e===undefined&&(e="root");var o=r(e,s),u=n(e,s);return u.length>0&&$.each(u,function(e,n){n.parent_project?t+='<li><a href="project.html?project='+n.project_id+'">'+n.title+"</a></li>":t+='<li><a href="./">'+n.title+"</a></li>"}),t+=i(e,o,s),t+="</ol>",t}function o(e){var t="";return t=e.replace(" ","_"),t=t.toLowerCase(),t}function u(t,n,i){var s="",a=n.length,f=o(t);return a>0?(s+="<li>",s+='<a href="project.html?project='+f+'">'+e(t,i)+"</a>",s+='&nbsp;<a data-toggle="collapse" data-parent="#accordion" href="#collapse'+f+'"><span class="badge">'+a+'&nbsp;subprojects</span></a><div id="collapse'+f+'" class="panel-collapse collapse"><ul>',$.each(n,function(e,t){gchildren=r(t.project_id,i),s+=u(t.project_id,gchildren,i)}),s+="</ul></li>"):s+='<li><a href="project.html?project='+t+'">'+e(t,i)+"</a></li>",s}function a(){var e="<ul>",t=Report.getProjectsHierarchy();if(t.length===0)return"";project_id="root";var i=r(project_id,t),s=n(project_id,t);return $.each(i,function(n,i){grandchildren=r(i.project_id,t),e+=u(i.project_id,grandchildren,t)}),e+="</ul>",e}function f(){var e=[],t={mls:"MLS overview",irc:"IRC overview",its:"ITS overview",qaforums:"QA Forums overview",scr:"Code Review overview",scm:"SCM overview",wiki:"Wiki overview",people:"Contributor",company:"Company",country:"Country",repository:"Repository",data_sources:"Data sources",project_map:"Project map"},n={companies:"Activity by companies",contributors:"Activity by contributors",countries:"Activity by companies",domains:"Activity by domains",projects:"Activity by project",repos:"Activity by repositories",states:"Activity by states",tags:"Activity by tags"},r=document.URL.split("/"),i=r[r.length-1].split(".")[0];if(i==="project"||i==="index"||i==="")return[];var s=i.split("-");return t.hasOwnProperty(s[0])?(e.push([s[0],t[s[0]]]),s.length>0&&n.hasOwnProperty(s[1])&&e.push([s[0],n[s[1]]]),e):[["#","Unavailable section name"]]}function l(e,t,n,r){return text={companies:"Companies","companies-summary":"Companies summary",contributors:"Contributors",countries:"Countries",domains:"Domains",projects:"Projects",repos:"Repositories",tags:"Tags",states:"States"},html="",html+='<li class="dropdown">',html+='<a href="#" class="dropdown-toggle" data-toggle="dropdown">',html+='<i class="fa '+e+'"></i>&nbsp;'+t+' <b class="caret"></b></a>',html+='<ul class="dropdown-menu navmenu-nav">',html+='<li><a href="'+n+'.html">&nbsp;Overview</a></li>',$.each(r,function(e,t){if(text.hasOwnProperty(t)){var r=text[t];if(t==="repos"){var i=Report.getDataSourceByName(n);r=i.getLabelForRepositories(),r=r.charAt(0).toUpperCase()+r.slice(1)}html+='<li><a href="'+n+"-"+t+'.html">&nbsp;'+r+"</a></li>"}else html+='<li><a href="'+n+"-"+t+'.html">&nbsp;'+t+"</a></li>"}),html+="</ul></li>",html}function c(e){e===undefined&&(e="root");var t="",n="";t+='<ul class="nav navmenu-nav">';var r=Report.getMenuElements();return t+='<li><a href="./"><i class="fa fa-home"></i> Home</a></li>',e==="root"&&(r.hasOwnProperty("scm")&&(aux=r.scm,aux_html=l("fa-code","Source code management","scm",aux),t+=aux_html),r.hasOwnProperty("scr")&&(aux=r.scr,aux_html=l("fa-check","Code review","scr",aux),t+=aux_html),r.hasOwnProperty("its")&&
(aux=r.its,aux_html=l("fa-ticket","Tickets","its",aux),t+=aux_html),r.hasOwnProperty("mls")&&(aux=r.mls,aux_html=l("fa-envelope-o","Mailing lists","mls",aux),t+=aux_html),r.hasOwnProperty("qaforums")&&(aux=r.qaforums,aux_html=l("fa-question","Q&A Forums","qaforums",aux),t+=aux_html),r.hasOwnProperty("irc")&&(aux=r.irc,aux_html=l("fa-comment-o","IRC","irc",aux),t+=aux_html),r.hasOwnProperty("downloads")&&(aux=r.downloads,aux_html=l("fa-download","Downloads","downloads",aux),t+=aux_html),r.hasOwnProperty("wiki")&&(aux=r.wiki,aux_html=l("fa-pencil-square-o","Wiki","wiki",aux),t+=aux_html),r.hasOwnProperty("studies")&&(aux=r.studies,t+='<li class="dropdown">',t+='<a href="#" class="dropdown-toggle" data-toggle="dropdown">',t+='<i class="fa fa-lightbulb-o"></i>&nbsp;Studies <b class="caret"></b></a>',t+='<ul class="dropdown-menu navmenu-nav">',aux.indexOf("demographics")>=0&&(t+='<li><a href="demographics.html">&nbsp;Demographics</a></li>'),t+="</ul></li>")),t+='<li><a href="data_sources.html"><i class="fa fa-database"></i> Data sources</a></li>',t+='<li><a href="project_map.html"><i class="fa fa-icon fa-sitemap"></i> Project map</a></li>',r.hasOwnProperty("extra")&&(aux=r.extra,n+='<li class="sidemenu-divider"></li>',n+='<li class="sidemenu-smallheader">More links:</li>',$.each(aux,function(e,t){n+='<li><a href="'+t[1]+'">&nbsp;'+t[0]+"</a></li>"})),t+=n,t+="</ul>",t}function h(e){var t='<ol class="breadcrumb">';if(e===undefined){var n=f();if(n.length>0){t+='<li><a href="./">Project Overview</a></li>';var r=1;$.each(n,function(e,i){n.length===r?t+='<li class="active">'+i[1]+"</li>":t+='<li><a href="'+i[0]+'.html">'+i[1]+"</a></li>",r+=1})}else t+='<li class="active">Project Overview</li>'}else t+="<li> "+f()+"</li>";return t+="</ol>",t}function p(e){var t=Report.getParameterByName("repository");if(t&&$.inArray(t,e.getReposData())<0)return"";var n=e.getName(),r="",i=e.getLabelForRepository(),s=e.getLabelForRepositories();return t!==undefined?r=t:r="All "+s,html='<div class="row"><span class="col-md-12">',html='<ol class="filterbar"><li>Filtered by '+i+":&nbsp;&nbsp;</li>",html+='<li><div class="dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"> '+r+' <span class="caret"></span></button>',html+='<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">',t&&(html+='<li role="presentation"><a role="menuitem" tabindex="-1" href="'+n+'-contributors.html">',html+="All "+s,html+="</a></li>"),$.each(e.getReposData(),function(e,n){if(n===t)return;html+='<li role="presentation"><a role="menuitem" tabindex="-1" href="?repository=',html+=n,html+='">',html+=n,html+="</a></li>"}),html+="</ul></div></li></ol>",html+="</span></div>",html}function d(){data=Report.getProjectData(),document.title=data.project_name+" Report by Bitergia",data.title&&(document.title=data.title),$(".report_date").text(data.date),$(".report_name").text(data.project_name),str=data.blog_url,str&&str.length>0?($("#blogEntry").html("<br><a href='"+str+"'>Blog post with some more details</a>"),$(".blog_url").attr("href",data.blog_url)):$("#more_info").hide(),str=data.producer,str&&str.length>0?$("#producer").html(str):$("#producer").html("<a href='http://bitergia.com'>Bitergia</a>"),$(".project_name").text(data.project_name),$("#project_url").attr("href",data.project_url)}function v(e,t){t.help=!0;var n=$(e).data("help");n!==undefined&&(t.help=n),t.show_legend=!1,$(e).data("frame-time")&&(t.frame_time=!0),t.graph=$(e).data("graph"),$(e).data("min")&&(t.show_legend=!1,t.show_labels=!0,t.show_grid=!0,t.help=!1),$(e).data("legend")&&(t.show_legend=!0),t.ligth_style=!1,$(e).data("light-style")&&(t.light_style=!0),$(e).data("custom-title")&&(t.custom_title=$(e).data("custom-title")),t.help&&$(e).data("custom-help")?t.custom_help=$(e).data("custom-help"):t.custom_help="";var r=$(e).data("start");r&&(t.start_time=r);var i=$(e).data("end");i&&(t.end_time=i);var s=$(e).data("remove-last-point");return s&&(t.remove_last_point=!0),t}function m(){return Math.floor(Math.random()*1e3+1)}function g(){var e={};return e.show_desc=!1,e.show_title=!1,e.show_labels=!0,e.show_legend=!1,e}Convert.convertMicrodashText=function(){var e=$(".MicrodashText");e.length>0&&$.each(e,function(e,t){$(this).empty();var n=$(this).data("metric"),r=$(this).data("name"),i=Report.getMetricDS(n)[0];if(i===undefined)return;var s=i.getGlobalData()[n],o='<div class="row">';r&&(o+='<div class="col-md-3">',o+='<span class="dayschange">'+i.basic_metrics[n].name+"</span>",o+="</div>"),$.each([365,30,7],function(e,t){var s=i.getMetrics()[n].column,u=i.getGlobalData()[n+"_"+t],a=i.getGlobalData()["diff_net"+s+"_"+t],f=i.getGlobalData()["percentage_"+s+"_"+t];f=Math.round(f*10)/10;if(u===undefined)return;var l="";f===0?l=Math.abs(f):a>0?l="+"+f:a<0&&(l="-"+Math.abs(f)),r?o+='<div class="col-md-3">':o+='<div class="col-md-4">',o+='<span class="dayschange">Last '+t+" days:</span>",o+=" "+Report.formatValue(u)+"<br>",f===0?o+='<i class="fa fa-arrow-circle-right"></i> <span class="zeropercent">&nbsp;'+l+"%</span>&nbsp;":a>0?o+='<i class="fa fa-arrow-circle-up"></i> <span class="pospercent">&nbsp;'+l+"%</span>&nbsp;":a<0&&(o+='<i class="fa fa-arrow-circle-down"></i> <span class="negpercent">&nbsp;'+l+"%</span>&nbsp;"),o+="</div><!--col-md-4-->"}),o+="</div><!--row-->",$(t).append(o)})},Convert.convertMicrodash=function(){var e=$(".Microdash");e.length>0&&$.each(e,function(e,t){$(this).empty();var n=$(this).data("metric"),r=$(this).data("text"),i=Report.getMetricDS(n)[0],s=i.getGlobalData()[n],o="<div>";o+='<div style="float:left">',o+='<span class="medium-fp-number">'+Report.formatValue(s),o+="</span> "+i.getMetrics()[n].name,o+="</div>",o+='<div id="Microdash" class="MetricsEvol" data-data-source="'+i.getName()+'" data-metrics="'+n+'" data-min=true style="margin-left:10px; float:left;width:100px; height:25px;"></div>',o+='<div style="clear:both"></div><div>',$.each([365,30,7],function(e,t){var r=i.getMetrics()[n].column,s=i.getGlobalData()["diff_net"+r+"_"+t],u=i.getGlobalData()["percentage_"+r+"_"+t],a=i.getGlobalData()[n+"_"+t];if(a===undefined)return;o+="<span class='dayschange'>"+t+" Days Change</span>:"+Report.formatValue(a)+"&nbsp;",s===0?o+="":s>0?(o+='<i class="icon-circle-arrow-up"></i>',o+="<small>(+"+u+"%)</small>&nbsp;"):s<0&&(o+='<i class="icon-circle-arrow-down"></i>',o+="<small>(-"+Math.abs(u)+"%)</small>&nbsp;")}),o+="</div>",o+="<div>",$(t).append(o)})},Convert.convertSideBar=function(e){var t=$(".SideNavBar");t.length>0&&$.each(t,function(t,n){$(this).empty(),n.id||(n.id="SideNavBar");var r;e&&(r=Report.cleanLabel(e));var i=c(r);$("#"+n.id).append(i),data=Report.getProjectData(),$(".report_name").text(data.project_name)})},Convert.convertProjectNavBar=function(e){var t=$(".ProjectNavBar");t.length>0&&$.each(t,function(t,n){$(this).empty(),n.id||(n.id="ProjectNavBar");var r;e&&(r=Report.cleanLabel(e));var i=s(r);$("#"+n.id).append(i)})},Convert.convertNavbar=function(){$.get(Report.getHtmlDir()+"navbar.html",function(e){$("#Navbar").html(e);var t=Report.getParameterByName("project");Convert.convertProjectNavBar(t),Convert.convertSideBar(t)})},Convert.convertSectionBreadcrumb=function(e){var t=$(".SectionBreadcrumb");t.length>0&&$.each(t,function(t,n){$(this).empty(),n.id||(n.id="SectionBreadcrumb");var r;e&&(r=Report.cleanLabel(e));var i=h(r);$("#"+n.id).append(i)})},Convert.convertProjectMap=function(){var e=$(".ProjectMap");e.length>0&&$.each(e,function(e,t){$(this).empty(),t.id||(t.id="ProjectMap");var n,r=a();$("#"+t.id).append(r)})},Convert.convertFooter=function(){$.get(Report.getHtmlDir()+"footer.html",function(e){$("#Footer").html(e),$("#vizjs-lib-version").append(vizjslib_git_tag)})},Convert.convertSummary=function(){div_param="Summary";var e=$("."+div_param);e.length>0&&$.each(e,function(e,t){$(this).empty();var n=$(this).data("data-source"),r=Report.getDataSourceByName(n);if(r===null)return;t.id=n+"-Summary",r.displayGlobalSummary(t.id)})},Convert.convertRepositorySelector=function(){var e=$(".repository-selector");e.length>0&&$.each(e,function(e,t){$(this).empty();var n=$(this).data("data-source"),r=Report.getDataSourceByName(n);if(r===null)return;t.id=n+"-repository-selector";var i=p(r);$("#"+t.id).append(i)})},Convert.convertRefcard=function(){$.when($.get(Report.getHtmlDir()+"refcard.html"),$.get(Report.getHtmlDir()+"project-card.html")).done(function(e,t){refcard=e[0],projcard=t[0],$("#Refcard").html(refcard),d(),$.each(Report.getProjectsData(),function(e,t){var n="card-"+e.replace(".","").replace(" ","");$("#Refcard #projects_info").append(projcard),$("#Refcard #projects_info #new_card").attr("id",n),$.each(Report.getDataSources(),function(t,r){if(r.getProject()!==e){$("#"+n+" ."+r.getName()+"-info").hide();return}r.displayData(n)}),$("#"+n+" #project_name").text(e),Report.getProjectsDirs.length>1&&$("#"+n+" .project_info").append(' <a href="VizGrimoireJS/browser/index.html?data_dir=../../'+t.dir+'">Report</a>'),$("#"+n+" #project_url").attr("href",t.url)})})},Convert.convertGlobalData=function(){var e=$(".GlobalData");e.length>0&&$.each(e,function(e,t){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;var n=DS.getGlobalData(),r=$(this).data("field");$(this).text(Report.formatValue(n[r],r))})},Convert.convertProjectData=function(){var e=$(".ProjectData"),t=Report.getParameterByName("project");e.length>0&&$.each(e,function(e,n){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;var r=DS.getProjectsGlobalData()[t],i=$(this).data("field");$(this).text(Report.formatValue(r[i],i))})},Convert.convertRadarActivity=function(){var e="RadarActivity",t=$("#"+e);t.length>0&&($.each(t,function(e,t){$(this).empty()}),Viz.displayRadarActivity(e))},Convert.convertRadarCommunity=function(){var e="RadarCommunity",t=$("#"+e);t.length>0&&($.each(t,function(e,t){$(this).empty()}),Viz.displayRadarCommunity("RadarCommunity"))},Convert.convertTreemap=function(){var e="Treemap",t=$("#"+e);if(t.length>0){$.each(t,function(e,t){$(this).empty()});var n=$("#Treemap").data("file");$("#Treemap").empty(),Viz.displayTreeMap("Treemap",n)}},Convert.convertBubbles=function(){div_param="Bubbles";var e=$("."+div_param);e.length>0&&$.each(e,function(e,t){$(this).empty();var n=$(this).data("data-source"),r=Report.getDataSourceByName(n);if(r===null)return;if(r.getData().length===0)return;var i=$(this).data("radius");t.id=n+"-Bubbles",r.displayBubbles(t.id,i)})},Convert.convertMetricsEvol=function(){var e={};e.show_desc=!1,e.show_title=!0,e.show_labels=!0;var t=Report.getVizConfig();t&&$.each(t,function(t,n){e[t]=n});var n="MetricsEvol",r=$("."+n);r.length>0&&$.each(r,function(t,n){var r={};$.each(e,function(e,t){r[e]=t}),$(this).empty();var i=$(this).data("metrics"),s=$(this).data("data-source"),o=Report.getDataSourceByName(s);if(o===null)return;r=v(n,r),n.id=i.replace(/,/g,"-")+"-"+s+"-metrics-evol-"+this.id,n.id=n.id.replace(/\n|\s/g,""),o.displayMetricsEvol(i.split(","),n.id,r,$(this).data("convert"))})},Convert.convertMetricsEvolSelector=function(){var e={};e.show_desc=!1,e.show_title=!0,e.show_labels=!0;var t=Report.getVizConfig();t&&$.each(t,function(t,n){e[t]=n});var n="MetricsEvol",r=$("."+n);r.length>0&&$.each(r,function(t,n){var r={};$.each(e,function(e,t){r[e]=t}),$(this).empty();var i=$(this).data("metrics"),s=$(this).data("data-source"),o=Report.getDataSourceByName(s);if(o===null)return;var u=Report.getParameterByName("repository");r=v(n,r),n.id=i.replace(/,/g,"-")+"-"+s+"-metrics-evol-"+this.id,n.id=n.id.replace(/\n|\s/g,""),o.displayMetricsEvol(i.split(","),n.id,r,$(this).data("convert"),u)})},Convert.convertMetricsEvolSet=function(){div_param="MetricsEvolSet";var e=$("."+div_param);e.length>0&&$.each(e,function(e,t){$(this).empty();var n=$(this).data("all"),r=$(this).data("relative"),i=$(this).data("summary-graph"),s=$(this).data("legend-show");t.id=o+"-MetricsEvolSet-"+this.id;if(n===!0)return t.id=o+"-All",Viz.displayEnvisionAll(t.id,r,s,i),!1;var o=$(this).data("data-source"),u=Report.getDataSourceByName(o);if(u===null)return;u.displayEnvision(t.id,r,s,i)})},Convert.convertTimeTo=function(){var e="TimeTo";divs=$("."+e),divs.length>0&&$.each(divs,function(e,t){$(this).empty();var n=$(this).data("data-source"),r=Report.getDataSourceByName(n);if(r===null)return;var i=$(this).data("quantil"),s=$(this).data("type");t.id=n+"-time-to-"+s+"-"+i,s==="fix"&&r.displayTimeToFix(t.id,i),s==="attention"&&r.displayTimeToAttention(t.id,i)})},Convert.convertMarkovTable=function(){var e="MarkovTable",t=$("."+e),n,r;t.length>0&&$.each(t,function(e,t){$(this).empty(),r=$(this).data("data-source"),n=Report.getDataSourceByName(r);if(n===null)return;if(n.getData().length===0)return;var i=$(this).data("title");t.id=r+"-markov-table",n.displayMarkovTable(t.id,i)})},Convert.convertLastActivity=function(){function t(t,n,r){var i="<h4>Last "+r+"</h4>";$.each(Report.getDataSources(),function(t,s){var o=s.getGlobalData();$.each(o,function(t,s){var u="_"+n;if(t.indexOf(u,t.length-u.length)!==-1){var a=t.substring(0,t.length-u.length);r=a,e[a]&&(r=e[a].name),i+=r+":"+o[t]+"<br>"}})}),$(t).append(i)}var e=Report.getAllMetrics(),n=$(".LastActivity"),r=null,i={Week:7,Month:30,Quarter:90,Year:365};n.length>0&&$.each(n,function(e,n){r=$(n).data("period"),t(n,i[r],r)})},Convert.convertTop=function(){var e="Top",t=$("."+e),n,r;if(t.length>0){var i=0;$.each(t,function(t,s){$(this).empty(),r=$(this).data("data-source"),n=Report.getDataSourceByName(r);if(n===null)return;if(n.getData().length===0)return;var o=!1;$(this).data("show_all")&&(o=!0);var u=$(this).data("metric"),a=$(this).data("limit"),f=$(this).data("graph"),l=$(this).data("people_links"),c=$(this).data("threads_links"),h=$(this).data("period"),p=$(this).data("period_all"),d=Report.getParameterByName("repository");s.id=r+"-"+e+i++,f&&(s.id+="-"+f),h===undefined&&p===undefined&&(p=!0),a===undefined&&(a=10),n.displayTop(s.id,o,u,h,p,f,a,l,c,d)})}},Convert.convertPersonMetrics=function(e,t){var n={};n.show_desc=!1,n.show_title=!1,n.show_labels=!0,divs=$(".PersonMetrics"),divs.length&&$.each(divs,function(r,i){$(this).empty(),ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;var s=$(this).data("metrics");n.show_legend=!1,$(this).data("legend")&&(n.show_legend=!0),$(this).data("person_id")&&(e=$(this).data("person_id")),$(this).data("person_name")&&(t=$(this).data("person_name")),i.id=s.replace(/,/g,"-")+"-people-metrics",DS.displayMetricsPeople(e,t,s.split(","),i.id,n)})},Convert.convertPersonData=function(e,t){var n=$(".PersonData"),r,i;n.length>0&&$.each(n,function(n,s){$(this).empty(),$(this).data("person_id")&&(e=$(this).data("person_id")),s.id||(s.id="PersonData-"+e+"-"+m());var o=Report.getPeopleIdentities()[e];o?(r=DataProcess.selectPersonName(o),i=DataProcess.selectPersonEmail(o),i="("+DataProcess.hideEmail(i)+")"):(t!==undefined?r=t:r=e,i=""),$("#"+s.id).append("<h2>"+r+" "+i+"</h2>")})},Convert.convertPersonSummary=function(e,t){var n=$(".PersonSummary");n.length>0&&$.each(n,function(n,r){$(this).empty(),ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;$(this).data("person_id")&&(e=$(this).data("person_id")),$(this).data("person_name")&&(t=$(this).data("person_name")),r.id=ds+"-refcard-people",DS.displayPeopleSummary(r.id,e,t,DS)})},Convert.convertPeople=function(e,t){e===undefined&&(e=Report.getParameterByName("id")),t===undefined&&(t=Report.getParameterByName("name"));if(e===undefined)return;if(Loader.check_people_item(e)===!1){$.each(Report.getDataSources(),function(t,n){Loader.data_load_people_item(e,n,Convert.convertPeople)});return}Convert.convertPersonData(e,t),Convert.convertPersonSummary(e,t),Convert.convertPersonMetrics(e,t),Convert.activateHelp()},Convert.convertDemographics=function(){var e=$(".Demographics");e.length>0&&$.each(e,function(e,t){$(this).empty(),ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;var n=$(this).data("period");t.id="Demographics-"+ds+"-"+"-"+n,DS.displayDemographics(t.id,n)})},Convert.getRealItem=function(e,t,n){var r=Report.getReposMap();if(r===undefined||r.length===0)return $.inArray(n,e.getReposData())>-1?n:null;var i=null;if(t==="repos"){var s=e.getReposMetricsData()[n];s===undefined?$.each(r,function(t,r){$.each(Report.getDataSources(),function(t,s){if(r[s.getName()]===n)return i=r[e.getName()],!1});if(i!==null)return!1}):i=n}else i=n;return i},Convert.convertFilterItemsSummary=function(e){var t="FilterItemsSummary";divs=$("."+t),divs.length>0&&$.each(divs,function(n,r){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;r.id=ds+"-"+t,$(this).empty(),e==="repos"&&DS.displayReposSummary(r.id,DS),e==="countries"&&DS.displayCountriesSummary(r.id,DS),e==="companies"&&DS.displayCompaniesSummary(r.id,DS),e==="domains"&&DS.displayDomainsSummary(r.id,DS),e==="projects"&&DS.displayProjectsSummary(r.id,DS)})},Convert.convertFilterItemsGlobal=function(e){var t=g(),n="FilterItemsGlobal";divs=$("."+n),divs.length>0&&$.each(divs,function(r,i){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;var s=$(this).data("metric"),o=$(this).data("show-others"),u=$(this).data("order-by");t.show_legend=$(this).data("legend"),$("#"+$(this).data("legend-div")).length>0?t.legend={container:$(this).data("legend-div")}:t.legend={container:null},t.graph=$(this).data("graph"),i.id=s+"-"+n,$(this).empty(),e==="repos"&&DS.displayMetricReposStatic(s,i.id,t,u,o),e==="countries"&&DS.displayMetricCountriesStatic(s,i.id,t,u,o),e==="companies"&&DS.displayMetricCompaniesStatic(s,i.id,t,u,o),e==="domains"&&DS.displayMetricDomainsStatic(s,i.id,t,u,o),e==="projects"&&DS.displayMetricProjectsStatic(s,i.id,t,u,o)})},Convert.convertFilterItemsNav=function(e,t){var n="FilterItemsNav";divs=$("."+n),divs.length>0&&$.each(divs,function(r,i){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;$(this).data("page")&&(t=$(this).data("page")),order_by=$(this).data("order-by"),i.id=ds+"-"+n,$(this).empty(),e==="repos"?DS.displayItemsNav(i.id,e,t,order_by):e==="countries"?DS.displayItemsNav(i.id,e,t):e==="companies"?DS.displayItemsNav(i.id,e,t):e==="domains"?DS.displayItemsNav(i.id,e,t):e==="projects"&&DS.displayItemsNav(i.id,e,t)})},Convert.convertFilterItemsMetricsEvol=function(e){var t=g(),n="FilterItemsMetricsEvol";divs=$("."+n),divs.length>0&&$.each(divs,function(r,i){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;var s=$(this).data("metric"),o=!1;$(this).data("stacked")&&(o=!0),$(this).data("min")&&(config_viz.show_legend=!1,config_viz.show_labels=!0,config_viz.show_grid=!0,config_viz.help=!1);var u=$(this).data("start"),a=$(this).data("end");t.lines={stacked:o},$("#"+$(this).data("legend-div")).length>0?t.legend={container:$(this).data("legend-div")}:t.legend={container:null},t.show_legend=$(this).data("legend"),t.mouse_tracker=$(this).data("mouse_tracker");var f=$(this).data("remove-last-point");f&&(t.remove_last_point=!0),i.id=s+"-"+n,$(this).empty(),e==="companies"?DS.displayMetricCompanies(s,i.id,t,u,a):e==="repos"?DS.displayMetricRepos(s,i.id,t,u,a):e==="domains"?DS.displayMetricDomains(s,i.id,t,u,a):e==="projects"&&DS.displayMetricProjects(s,i.id,t,u,a)})},Convert.convertFilterItemsMiniCharts=function(e,t){var n=g(),r="FilterItemsMiniCharts";divs=$("."+r),divs.length>0&&$.each(divs,function(i,s){ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;$(this).data("page")&&(t=$(this).data("page"));var o=$(this).data("metrics"),u=$(this).data("order-by"),a=!0;$(this).data("show_links")!==undefined&&(a=$(this).data("show_links"));var f=$(this).data("start"),l=$(this).data("end"),c=$(this).data("convert"),h=$(this).data("remove-last-point");h&&(n.remove_last_point=!0),s.id=o.replace(/,/g,"-")+"-"+e+"-"+r,$(this).empty(),e==="repos"?DS.displayReposList(o.split(","),s.id,n,u,t,a,f,l,c):e==="countries"?DS.displayCountriesList(o.split(","),s.id,n,u,t,a,f,l,c):e==="companies"?DS.displayCompaniesList(o.split(","),s.id,n,u,t,a,f,l,c):e==="domains"?DS.displayDomainsList(o.split(","),s.id,n,u,t,a,f,l,c):e==="projects"&&DS.displayProjectsList(o.split(","),s.id,n,u,t,a,f,l,c)})},Convert.convertFilterItemData=function(e,t){var n=$(".FilterItemData");n.length>0&&$.each(n,function(e,n){$(this).empty();var r=Report.cleanLabel(t);n.id||(n.id="FilterItemData"+m()),$("#"+n.id).append("<h2>"+r+"</h2>")})},Convert.convertFilterItemSummary=function(e,t){var n="FilterItemSummary";divs=$("."+n),t!==null&&divs.length>0&&$.each(divs,function(r,i){var s=t;ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;$(this).data("item")&&(s=$(this).data("item")),i.id=ds+"-"+e+"-"+n,$(this).empty(),e==="repos"?(s=Convert.getRealItem(DS,e,s),s&&DS.displayRepoSummary(i.id,s,DS)):e==="countries"?DS.displayCountrySummary(i.id,s,DS):e==="companies"?DS.displayCompanySummary(i.id,s,DS):e==="domains"?DS.displayDomainSummary(i.id,s,DS):e==="projects"&&DS.displayProjectSummary(i.id,s,DS)})},Convert.convertFilterItemMicrodashText=function(e,t){var n=$(".FilterItemMicrodashText");n.length>0&&$.each(n,function(n,r){$(this).empty();var i=t,s=$(this).data("metric"),o=$(this).data("name"),u=Report.getMetricDS(s)[0];if(u===undefined)return;if(e!=="projects")return;var a=u.getProjectsGlobalData()[t],f='<div class="row">';o&&(f+='<div class="col-md-3">',f+='<span class="dayschange">'+u.basic_metrics[s].name+"</span>",f+="</div>"),$.each([365,30,7],function(e,t){var n=u.getMetrics()[s].column,r=a[s+"_"+t],i=a["diff_net"+n+"_"+t],l=a["percentage_"+n+"_"+t];l=Math.round(l*10)/10;if(r===undefined)return;var c="";i>0&&(c="+"+l),i<0&&(c="-"+Math.abs(l)),o?f+='<div class="col-md-3">':f+='<div class="col-md-4">',f+='<span class="dayschange">Last '+t+" days:</span>",f+=" "+Report.formatValue(r)+"<br>",i===0?f+='<i class="fa fa-arrow-circle-right"></i> <span class="zeropercent">&nbsp;'+c+"%</span>&nbsp;":i>0?f+='<i class="fa fa-arrow-circle-up"></i> <span class="pospercent">&nbsp;'+c+"%</span>&nbsp;":i<0&&(f+='<i class="fa fa-arrow-circle-down"></i> <span class="negpercent">&nbsp;'+c+"%</span>&nbsp;"),f+="</div><!--col-md-4-->"}),f+="</div><!--row-->",$(r).append(f)})},Convert.convertFilterItemMetricsEvol=function(e,t){var n=g(),r="FilterItemMetricsEvol";divs=$("."+r),t!==null&&divs.length>0&&$.each(divs,function(i,s){var o=t,u=$(this).data("metrics");ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;$(this).data("item")&&(o=$(this).data("item")),n=v(s,n),s.id=Report.cleanLabel(t).replace(/ /g,"_")+"-",s.id+=u.replace(/,/g,"-")+"-"+ds+"-"+e+"-"+r,$(this).empty(),e==="repos"?(o=Convert.getRealItem(DS,e,o),o?DS.displayMetricsRepo(o,u.split(","),s.id,n):$(this).hide()):e==="countries"?DS.displayMetricsCountry(o,u.split(","),s.id,n):e==="companies"?DS.displayMetricsCompany(o,u.split(","),s.id,n):e==="domains"?DS.displayMetricsDomain(o,u.split(","),s.id,n):e==="projects"&&DS.displayMetricsProject(o,u.split(","),s.id,n)})},Convert.convertFilterItemTop=function(e,t){var n="FilterItemTop";divs=$("."+n),divs.length>0&&$.each(divs,function(r,i){var s=t;$(this).empty(),ds=$(this).data("data-source"),DS=Report.getDataSourceByName(ds);if(DS===null)return;e===undefined&&(e=$(this).data("filter"));if(e!==$(this).data("filter"))return;if(!e)return;$(this).data("item")&&(s=$(this).data("item"));var o=$(this).data("metric"),u=$(this).data("period"),a=$(this).data("titles");i.id=o+"-"+ds+"-"+e+"-"+n+"-"+m(),$(this).empty(),i.className="",e==="companies"&&DS.displayTopCompany(s,i.id,o,u,a)})},Convert.convertFilterStudyItem=function(e,t){var n=Convert.convertFilterStudyItem;if(n.done===undefined)n.done={};else if(n.done[e]===!0)return;e==="repositories"&&(e="repos"),t===undefined&&(e==="repos"&&(t=Report.getParameterByName("repository")),e==="countries"&&(t=Report.getParameterByName("country")),e==="companies"&&(t=Report.getParameterByName("company")),e==="domains"&&(t=Report.getParameterByName("domain")),e==="projects"&&(t=Report.getParameterByName("project")));if(!t)return;if(Loader.FilterItemCheck(t,e)===!1)return;Convert.convertFilterItemData(e,t),Convert.convertFilterItemSummary(e,t),Convert.convertFilterItemMetricsEvol(e,t),Convert.convertFilterItemTop(e,t),Convert.convertFilterItemMicrodashText(e,t),Convert.convertProjectData(),Convert.activateHelp(),Convert.convertMetricsEvolSelector(),n.done[e]=!0},Convert.activateHelp=function(){$(".help").popover({html:!0,trigger:"manual"}).click(function(e){$(this).popover("toggle"),e.stopPropagation()})},Convert.convertFilterStudy=function(e){var t=Report.getCurrentPage();t===null&&(t=Report.getParameterByName("page"),t!==undefined&&Report.setCurrentPage(t));if(t===undefined){if(!($("[class^='FilterItems']").length>0))return;t=1,Report.setCurrentPage(t)}e==="repositories"&&(e="repos");if(Loader.check_filter_page(t,e)===!1){$.each(Report.getDataSources(),function(n,r){Loader.data_load_items_page(r,t,Convert.convertFilterStudy,e)});return}Convert.convertFilterItemsSummary(e),Convert.convertFilterItemsGlobal(e),Convert.convertFilterItemsNav(e,t),Convert.convertFilterItemsMetricsEvol(e),Convert.convertFilterItemsMiniCharts(e,t)},Convert.convertDSTable=function(){var e="DataSourcesTable",t=$("."+e),n,r;if(t.length>0){var i=0;$.each(t,function(t,n){$(this).empty(),n.id=e+i++,Viz.displayDataSourcesTable(n)})}},Convert.convertBasicDivs=function(){Convert.convertNavbar(),Convert.convertSectionBreadcrumb(),Convert.convertProjectMap(),Convert.convertFooter(),Convert.convertDSTable(),Convert.convertGlobalData(),Convert.convertSummary()},Convert.convertBasicDivsMisc=function(){Convert.convertRadarActivity(),Convert.convertRadarCommunity(),Convert.convertTreemap(),Convert.convertBubbles()},Convert.convertBasicMetrics=function(e){var t=Report.getParameterByName("repository");t===undefined&&Convert.convertMetricsEvol(),Convert.convertTimeTo(),Convert.convertMarkovTable()},Convert.convertFilterTop=function(e){var t=Report.getParameterByName("repository");if(Loader.filterTopCheck(t,e)===!1)return;Convert.convertTop(),Convert.convertRepositorySelector()}})();if(Report===undefined)var Report={};(function(){function x(){return t}function T(){return n}function N(){return projects_hierarchy}function C(){return menu_elements}function k(){return r}function L(e){r=e}function A(){return e}function O(){return h}function M(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function _(e){var t=[];return $.each(Report.getDataSources(),function(n,r){r.getMetrics()[e]&&t.push(r)}),t}function D(){var e={};return $.each(Report.getDataSources(),function(t,n){e=$.extend({},e,n.getMetrics())}),e}function P(){function t(t){var n=t.split("&"),r=$.grep(n,function(e,t){return e.indexOf("data_dir=")===0});for(var i=0;i<r.length;i++){var s=r[i].split("=")[1];e.push(s),i===0&&Report.setDataDir(s)}}var e=[],n=window.location.search.substr(1);n&&n.indexOf("data_dir")>=0&&(t(n),e.length>0&&Report.setProjectsDirs(e))}function H(){P();var e=Report.getProjectsDirs(),t,n,r,i,s,o,u,a,f,l;return $.each(e,function(e,c){if(Report.getConfig()===null||Report.getConfig()["data-sources"]===undefined)n=new ITS,Report.registerDataSource(n),r=new MLS,Report.registerDataSource(r),t=new SCM,Report.registerDataSource(t),i=new SCR,Report.registerDataSource(i),s=new IRC,Report.registerDataSource(s),o=new MediaWiki,Report.registerDataSource(o),u=new People,Report.registerDataSource(u),a=new Downloads,Report.registerDataSource(a),f=new QAForums,Report.registerDataSource(f),l=new Releases,Report.registerDataSource(l);else{var h=Report.getConfig()["data-sources"];$.each(h,function(e,c){c==="its"?(n=new ITS,Report.registerDataSource(n)):c==="mls"?(r=new MLS,Report.registerDataSource(r)):c==="scm"?(t=new SCM,Report.registerDataSource(t)):c==="scr"?(i=new SCR,Report.registerDataSource(i)):c==="irc"?(s=new IRC,Report.registerDataSource(s)):c==="mediawiki"?(o=new MediaWiki,Report.registerDataSource(o)):c==="people"?(u=new People,Report.registerDataSource(u)):c==="downloads"?(a=new Downloads,Report.registerDataSource(a)):c==="qaforums"?(f=new QAForums,Report.registerDataSource(f)):c==="releases"?(l=new Releases,Report.registerDataSource(l)):Report.log("Not support data source "+c)})}n&&n.setDataDir(c),r&&r.setDataDir(c),t&&t.setDataDir(c),i&&i.setDataDir(c),s&&s.setDataDir(c),o&&o.setDataDir(c),u&&u.setDataDir(c),a&&a.setDataDir(c),f&&f.setDataDir(c),l&&l.setDataDir(c),t&&n&&t.setITS(n)}),!0}function B(){$.each(Report.getActiveStudies(),function(e,t){var n=t;t==="repositories"&&(n="repos"),DataProcess.orderItems(n),Convert.convertFilterStudy(t),Convert.convertFilterStudyItem(t)})}var e=null,t=null,n=null,r={},i=[],s=null,o="",u="data/json",a="config",f="data/json",l="",c=[f],h={},p={},d,v=a+"/project-info.json",m=u+"/viz_cfg.json",g=u+"/markers.json",y=u+"/repos-map.json",b=u+"/projects_hierarchy.json";menu_elements_file=a+"/menu-elements.json";var w=10,E=null,S={};Report.createDataSources=H,Report.getAllMetrics=D,Report.getMarkers=x,Report.getVizConfig=T,Report.getProjectsHierarchy=N,Report.getMenuElements=C,Report.getMetricDS=_,Report.getGridster=k,Report.setGridster=L,Report.getCurrentPage=function(){return E},Report.setCurrentPage=function(e){E=e},Report.getPageSize=function(){return w},Report.setPageSize=function(e){w=e},Report.getProjectData=A,Report.getProjectsData=O,Report.convertStudies=B,Report.getDataSources=function(){return i},Report.registerDataSource=function(e){i.push(e)},Report.setHtmlDir=function(e){o=e},Report.getHtmlDir=function(){return o},Report.getDataDir=function(){return u},Report.setDataDir=function(e){u=e,v=e+"/project-info.json",config_file=e+"/viz_cfg.json",g=e+"/markers.json",repos_mapping_file=u+"/repos-mapping.json",b=u+"/projects_hierarchy.json"},Report.setMarkers=function(e){t=e},Report.getMarkersFile=function(){return g},Report.getReposMap=function(){return d},Report.setReposMap=function(e){d=e},Report.getReposMapFile=function(){return y},Report.setVizConfig=function(e){n=e},Report.getVizConfigFile=function(){return m},Report.setProjectsHierarchy=function(e){projects_hierarchy=e},Report.getProjectsHierarchyFile=function(){return b},Report.setMenuElements=function(e){menu_elements=e},Report.getMenuElementsFile=function(){return menu_elements_file},Report.setProjectData=function(t){e=t},Report.getProjectFile=function(){return v},Report.getProjectsDirs=function(){return c},Report.setProjectsDirs=function(e){c=e},Report.getProjectsList=function(){var e=[];return $.each(O(),function(t,n){e.push(t)}),e},Report.getProjectsDataSources=function(){return p},Report.setMetricsDefinition=function(e){$.each(Report.getDataSources(),function(t,n){n.setMetricsDefinition(e[n.getName()])})},Report.getPeopleIdentities=function(){return S},Report.setPeopleIdentities=function(e){S=e},Report.cleanLabel=function(e){var t=e,n=null;return e.split("___").length===2?(n=e.split(" "),t=n[0]):e.lastIndexOf("http")===0||e.split("_").length>3?(n=e.split("_"),t=n.pop(),t===""&&(t=n.pop()),t=t.replace("buglist.cgi?product=",""),t=t.replace("gmane.comp.sysutils.","")):e.lastIndexOf("<")===0&&(t=MLS.displayMLSListName(e)),t},Report.formatValue=function(e,t){if(e===undefined)return"-";var n=["last_date","first_date"],r=e;try{r=parseFloat(e).toFixed(1).toString().replace(/\.0$/,""),r=M(r);if(navigator.language==="es"){var i=r.split(".");i[0]=i[0].replace(/,/g,"."),r=i.join(",")}}catch(s){}return typeof r=="number"&&isNaN(r)&&(r=e.toString()),t!==undefined&&$.inArray(t,n)>-1&&(r=e.toString()),r},Report.escapeHtml=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},Report.getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return n===null?undefined:Report.escapeHtml(decodeURIComponent(n[1].replace(/\+/g," ")))},Report.getDataSourceByName=function(e){var t=null;return $.each(Report.getDataSources(),
function(n,r){if(r.getName()===e)return t=r,!1}),t},Report.displayActiveMenu=function(){var e=window.location.href,t=e.substr(e.lastIndexOf("/")+1,e.length);t=t.split(".html")[0];if(t.indexOf("scm")===0)$(".scm-menu")[0].className=$(".scm-menu")[0].className+" active";else if(t.indexOf("its")===0)$(".its-menu")[0].className=$(".its-menu")[0].className+" active";else if(t.indexOf("mls")===0)$(".mls-menu")[0].className=$(".mls-menu")[0].className+" active";else if(t.indexOf("scr")===0)$(".scr-menu")[0].className=$(".scr-menu")[0].className+" active";else if(t.indexOf("irc")===0)$(".irc-menu")[0].className=$(".irc-menu")[0].className+" active";else if(t.indexOf("qaforum")===0)$(".qaforum-menu")[0].className=$(".qaforum-menu")[0].className+" active";else if(t.indexOf("studies")===0)$(".studies-menu")[0].className=$(".studies-menu")[0].className+" active";else if(t.indexOf("wiki")===0)$(".wiki-menu")[0].className=$(".wiki-menu")[0].className+" active";else if(t.indexOf("downloads")===0)$(".downloads-menu")[0].className=$(".downloads-menu")[0].className+" active";else if(t.indexOf("projects")===0)$(".listprojects-menu")[0].className=$(".listprojects-menu")[0].className+" active";else if(t.indexOf("index")===0||t===""){if($(".summary-menu").length===0)return;$(".summary-menu")[0].className=$(".summary-menu")[0].className+" active"}else $(".experimental-menu")[0]&&($(".experimental-menu")[0].className=$(".experimental-menu")[0].className+" active")},Report.addDataDir=function(){var e,t=window.location.search.substr(1);return t&&t.indexOf("data_dir")!==-1&&(e=window.location.search.substr(1)),e},Report.configDataSources=function(){var e=Report.getProjectsDataSources();$.each(Report.getDataSources(),function(t,n){if(n.getData()instanceof Array)return;$.each(h,function(t,r){if(r.dir===n.getDataDir())return e[t]===undefined&&(e[t]=[]),$.each(e[t],function(e,t){if(n.getName()===t.getName())return!1}),n.setProject(t),e[t].push(n),!1})})},Report.getConfig=function(){return s},Report.setConfig=function(e){s=e,e&&(Report.log("Global config file found"),e["global-html-dir"]&&Report.setHtmlDir(e["global-html-dir"]),e["global-data-dir"]&&(Report.setDataDir(e["global-data-dir"]),Report.setProjectsDirs([e["global-data-dir"]])),e["projects-data-dirs"]&&Report.setProjectsDirs(e["projects-data-dirs"]))},Report.convertGlobal=function(){Convert.convertMicrodash(),Convert.convertMicrodashText(),Convert.convertBasicDivs(),Convert.convertBasicDivsMisc(),Convert.convertBasicMetrics(),Convert.convertDemographics(),Convert.convertMetricsEvolSet(),Convert.convertLastActivity()},Report.getActiveStudies=function(){var e=[],t,n=["repositories","countries","companies","domains","projects"];return Report.getConfig()!==null?t=Report.getConfig().reports:t=n,$.each(n,function(n,r){$.inArray(r,t)>-1&&e.push(r)}),e},Report.convertStudiesGlobal=function(){Convert.convertPeople()};var j=!0;Report.getLog=function(){return j},Report.setLog=function(e){j=e},Report.log=function(e){Report.getLog()===!0&&window.console&&console.log(e)}})(),Loader.data_ready_global(function(){Report.configDataSources(),Report.convertGlobal(),Report.convertStudiesGlobal()}),Loader.data_ready(function(){study="repos",Convert.convertFilterTop(study)}),Loader.data_ready(function(){Report.convertStudies(),$("body").css("cursor","auto"),$("html").click(function(e){$(".help").popover("hide")}),Convert.activateHelp()}),$(document).ready(function(){var e="./config.json";$.getJSON(e,function(e){Report.setConfig(e)}).fail(function(){window.console&&Report.log("Can't read global config file "+e)}).always(function(e){Report.createDataSources(),Loader.data_load(),$("body").css("cursor","progress")})});var resized;$(window).resize(function(){clearTimeout(resized),resized=setTimeout(resizedw,100)});if(Viz===undefined)var Viz={};(function(){function t(e,t){var n="";return $.each(Report.getAllMetrics(),function(e,r){if(r.action===t)return n=r.column,!1}),n}function n(e,t,n){var r="<h4>"+n+"</h4>",i='<table id="itsmarkovtable" class="table table-striped">';i+="<thead><tr><th>Transition</th><th>Number</th><th>Percent</th></tr></thead><tbody>",$.each(t,function(e,n){subdata=t[e],old_value="old_value",new_value="new_value",percent="f",number="issue";for(var r=0;r<subdata[old_value].length;r++){var s=subdata[new_value][r],o=subdata[percent][r];o=Math.round(o*100)/100;var u=subdata[number][r];i+="<tr><td>"+e+" -> "+s+"</td>",i+="<td>"+u+"</td>",i+="<td>"+o+"</td></tr>"}}),i+="</tbody></table>",r+=i,div=$("#"+e),div.append(r);return}function r(e,t){return e.hasOwnProperty(t)?e[t]:t}function i(e,t){var n={};return n.id="id",e==="senders"&&(t==="mls"||t==="irc")&&(n.name="senders",n.action="sent"),e==="authors"&&t==="scm"&&(n.name="authors",n.action="commits"),e==="closers"&&t==="its"&&(n.name="closers",n.action="closed"),t==="scr"&&(e==="mergers"&&(n.name="mergers",n.action="merged"),e==="openers"&&(n.name="openers",n.action="opened"),e==="reviewers"&&(n.name="reviewers",n.action="reviews")),t==="downloads"&&(e==="ips"&&(n.name="ips",n.action="downloads"),e==="packages"&&(n.name="packages",n.action="downloads")),t==="mediawiki"&&e==="authors"&&(n.name="authors",n.action="reviews"),t==="qaforums"&&(e==="senders"||e==="asenders"||e==="qsenders")&&(n.name="senders",n.action="sent"),t==="releases"&&e==="authors"&&(n.name="username",n.action="releases"),n}function s(){return["last month","last year",""]}function o(e,t,n){var r="";for(var i=0;i<e[n.name].length;i++){if(t&&t<=i)break;var s=e[n.action][i];r+="<tr><td>#"+(i+1)+"</td>",r+="<td>",r+=e[n.name][i],r+="</td>",r+="<td>"+s+"</td></tr>"}return r}function u(e,t,n){var r="";for(var i=0;i<e.subject.length;i++){if(t&&t<=i)break;r+="<tr><td>#"+(i+1)+"</td>",r+="<td>";if(n===!0){var s="http://www.google.com/search?output=search&q=X&btnI=1";e.hasOwnProperty("url")&&e.url[i].length>0&&(s="http://www.google.com/search?output=search&q=X%20site%3AY&btnI=1",s=s.replace(/Y/g,e.url[i])),s=s.replace(/X/g,e.subject[i]),r+="<td>",r+='<a target="_blank" href="'+s+'">',r+=e.subject[i]+"</a>",r+='&nbsp;<i class="fa fa-external-link"></i></td>'}else r+="<td>"+e.subject[i]+"</td>";r+="<td>"+e.initiator_name[i]+"</td>",r+="<td>"+e.length[i]+"</td>",r+="</tr>"}return r}function a(e,t,n,r){var i="";for(var s=0;s<e[r.id].length;s++){if(t&&t<=s)break;var o=e[r.action][s];i+="<tr><td>#"+(s+1)+"</td>",i+="<td>",n?(i+='<a href="people.html?id='+e[r.id][s]+'">',i+=e[r.name][s]+"</a>"):i+=e[r.name][s],i+="</td>",i+="<td>"+o+"</td></tr>"}return i}function f(e,t,n,r){var i="",s=!0;i+='<ul id="myTab" class="nav nav-tabs">';for(var o=0;o<e.length;o++){var u=t+"."+e[o];if(n[u]){var a=e[o],f=a;a===""&&(a="all",f="complete history");var l=a.replace(/\ /g,""),c="";s===!0&&(c=' class="active"',s=!1),i+="<li"+c+'><a href="#'+r+t+l+'"data-toogle="tab">',i+=f+"</a></li>"}}return i+="</ul>",i}function l(e,t,n,r,i){var s=t+"_"+e,o="",u="";return s in r&&(o=r[s].desc,o=o.toLowerCase()),n===!0?u+="<h6>Top "+o+"</h6>":u+="<h6>Top "+o+" "+i+"</h6>",u}function c(e,t,n,r,c,h,p,d){var v="",m="",g="",y=!0,b=$("#"+e),w=b.attr("data-data-source");periods=s(),d!==undefined&&(y=!1),g+=l(n,w,y,c,d),y===!0&&(v+=f(periods,n,t,w)),m+='<div class="tab-content">';var E=i(n,w);if(y===!0){var S=!0,x="";for(var T=0;T<periods.length;T++){x="";var N=n+"."+periods[T];if(t[N]){var C=periods[T];C===""&&(C="all");var k=C.replace(/\ /g,"");S===!0&&(x=" active in",S=!1),m+='<div class="tab-pane fade'+x+'" id="'+w+n+k+'">',m+='<table class="table table-striped"><tbody>',n==="threads"?m+=u(t[N],r,p):n==="packages"||n==="ips"?m+=o(t[N],r,E):m+=a(t[N],r,h,E),m+="</tbody></table>",m+="</div>"}}}else m+='<table class="table table-striped"><tbody>',n==="threads"?m+=u(t,r,p):n==="packages"||n==="ips"?m+=o(t,r,E):m+=a(t,r,h,E),m+="</tbody></table>";m+="</div>",b.append(g),b.append(v),b.append(m),y===!0&&(script="<script>$('#myTab a').click(function (e) {e.preventDefault();$(this).tab('show');});</script>",b.append(script))}function h(e,n,r,i,s,o,u,a){var f=n.name;if(!i||$.isEmptyObject(i))return;var l=n.action;u&&i[l].length<u&&(u=i[l].length,s=!1);var c=n.column;c===undefined&&(c=t(i,l));var h="Top "+f+" "+r,p=displayTopMetricTable(i,l,c,u,a,h),d=null;if(p===undefined)return;if(o===!1){d=$("#"+e),d.append(p);return}var v="",m="";s&&(v="top-"+s+"-"+c+"-",v+=l+"-"+r,m+="<div id='"+v+"' class='graph' style='float:right'></div>"),m+=p,d=$("#"+e),d.append(m);if(s){var g=i[c],y=i[l];if(u){g=[],y=[];for(var b=0;b<u;b++)g.push(i[c][b]),y.push(i[l][b])}k(v,g,y,s)}}function p(e){dsources=Report.getDataSources(),html='<table class="table table-striped">',html+="<thead><th>Data Source</th><th>From</th>",html+="<th>To <small>(Updated on)</small></th></thead><tbody>",$.each(dsources,function(e,t){if(t.getName()==="people")return;var n=t.getGlobalData(),r=t.getTitle();r===undefined&&(r="-");var i=n.last_date;if(i===undefined)return;var s=n.first_date;s===undefined&&(s="-");var o=n.type;html+="<tr><td>"+r,o!==undefined&&(o=o.toLowerCase(),o=o.charAt(0).toUpperCase()+o.slice(1),html+=" ("+o+")"),html+="</td>",html+="<td>"+s+"</td>",html+="<td>"+i+"</td></tr>"}),html+="</tbody></table>",$(e).append(html)}function d(e,t,n){var r=Report.getAllMetrics(),i='<a href="#" class="help"',s="";if(n===""){var o=function(e,n){if(t[u]===e)return s+="<strong>"+n.name+"</strong>: "+n.desc+"<br>",!1};for(var u=0;u<t.length;u++)$.each(r,o)}else s="<strong>Description</strong>: "+n;i+='data-content="'+s+'" data-html="true">',i+='<img src="qm_15.png"></a>';var a=$("#"+e).prev()[0];a&&a.className==="help"&&$("#"+e).prev().empty(),$("#"+e).before(i)}function v(e,t,n,r,i){(!i||i.help!==!1)&&d(e,t,i.custom_help);var s=[];i.remove_last_point&&(n=DataProcess.revomeLastPoint(n)),i.frame_time&&(n=DataProcess.frameTime(n,t)),i.start_time&&(n=DataProcess.filterDates(i.start_time,i.end_time,n)),$.each(t,function(e,t){if(!n[t])return;var r=[[],[]];$.each(n[t],function(e,i){r[e]=[n.id[e],n[t][e]]});var i=t;Report.getAllMetrics()[t]&&(i=Report.getAllMetrics()[t].name),s.push({label:i,data:r})}),T(e,n,s,r,i)}function m(e,t,n,r,i,s,o,u,a){var f=[],l={};$.each(n,function(e,n){if(n===undefined)return!1;if(n[t]===undefined)return!1;u&&(n=DataProcess.convert(n,u,t)),s&&(n=DataProcess.filterDates(s,o,n));var r=[[],[]];for(var i=0;i<n.id.length;i++)r[i]=[n.id[i],n[t][i]];e=Report.cleanLabel(e),f.push({label:e,data:r}),l=n});if(f.length===0)return;if(a){var c=[];$.each(a,function(e,t){$.each(f,function(e,n){if(t===n.label)return c.push(n),!1})}),f=c}T(e,l,f,r,i)}function g(e,t,n,r,i){var s={subtitle:e,legend:{show:!0,container:t},xaxis:{minorTickFreq:4,mode:"time",timeUnit:"second",timeFormat:"%b %y",margin:!0},yaxis:{min:null,noTicks:2,autoscale:!0},grid:{verticalLines:!1,color:"#000000",outlineWidth:1,outline:"s"},mouse:{container:t,track:!0,trackY:!1,relative:!0,position:"ne",trackFormatter:function(e){var t=n.date[parseInt(e.index,10)];t===undefined?t="":t+="<br>";for(var i=0;i<r.length;i++){var s=r[i].data[e.index][1];if(s===undefined)continue;r.length>1&&r[i].label!==undefined&&(value_name=r[i].label,t+=value_name.substring(0,9)+":"),t+="<strong>"+Report.formatValue(s)+"</strong><br>"}return t}},selection:{mode:"x",fps:10},shadowSize:4};return i&&(Viz._history=n,Viz._lines_data=r,s.mouse.trackFormatter=Viz[i]),s}function y(e,t){if(t.length===0)return t;if(t.length>1)for(var n=0;n<t.length;n++){var r=t[n].data.length-1;t[n].data[r][1]=undefined}}function b(e,t){if(t.length!==1)return t;var n=t[0].data.length,r=[],i=0;for(var s=0;s<n-1;s++)i=parseInt(e.unixtime[s],10),r.push([i,undefined]);i=parseInt(e.unixtime[n-1],10),r.push([i,t[0].data[n-1][1]]);var o={data:r};return o.points={show:!0,radius:3,lineWidth:1,fillColor:null,shadowSize:0},t.push(o),t[0].data[n-1][1]=undefined,t[1].label=t[0].label,t}function w(e,t,n){var r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=new Date(parseInt(t,10)*1e3),s=r[i.getMonth()]+" "+i.getFullYear();i=new Date(parseInt(n,10)*1e3);var o=r[i.getMonth()]+" "+i.getFullYear();return e+" ( "+s+" - "+o+" )"}function E(e){return e.sort(function(e,t){return e[1]>t[1]||t[1]===undefined?1:-1}),e}function S(e,t,n){t=Math.round(t),n=Math.round(n);var r=e.length,i=[];for(var s=0;s<r;s++)for(var o=e[s].data.length-1;o>0;o--){var u=e[s].data[o][0],a=u<t||u>n;a&&e[s].data.splice(o,1)}var f=[];for(s=0;s<r;s++)i=e[s].data,i=E(i),f.push(i[i.length-1][1]);return f.sort(function(e,t){return e-t}),f[f.length-1]}function x(e){var t=e[0].data[1][0]-e[0].data[0][0],n=e.length,r=0;for(var i=0;i<n;i++){var s=e[i].data.length;r=e[i].data[s-1][0],e[i].data.push([r+t,undefined])}return e}function T(e,t,n,r,i){var s=!1;i&&i.lines&&i.lines.stacked&&(s=!0),s?N(e,t,n,r,i):t.unixtime===undefined?N(e,t,n,r,i):C(e,t,n,r,i)}function N(e,t,n,r,i){var s=document.getElementById(e),o=null;i&&i.legend&&i.legend.container&&(o=$("#"+i.legend.container));var u={subtitle:r,legend:{show:!0,container:o},xaxis:{minorTickFreq:4,tickFormatter:function(e){var n=null;for(var r=0;r<t.id.length;r++)if(parseInt(e,10)===t.id[r]){n=r;break}return t.date[n]}},yaxis:{min:0,noTicks:2,autoscale:!1},grid:{verticalLines:!1,color:"#000000",outlineWidth:1,outline:"s"},mouse:{container:o,track:!0,trackY:!1,trackFormatter:function(e){var r=t.date[parseInt(e.index,10)];r===undefined?r="":r+="<br>";for(var i=0;i<n.length;i++){var s=n[i].data[e.index][1];if(s===undefined)continue;n.length>1&&n[i].label!==undefined&&(r+=n[i].label+":"),r+=Report.formatValue(s)+"<br>"}return r}}};i&&(i.show_title||(u.title=""),"show_legend"in i&&(i.show_legend===!0?u.legend.show=!0:u.legend.show=!1),i.lines&&i.lines.stacked&&(u.lines={stacked:!0,fill:!0,fillOpacity:1,fillBorder:!0,lineWidth:.01}),i.show_labels||(u.xaxis.showLabels=!1,u.yaxis.showLabels=!1),i.show_grid===!1&&(u.grid.verticalLines=!1,u.grid.horizontalLines=!1,u.grid.outlineWidth=0),i.show_mouse===!1&&(u.mouse.track=!1),i.graph==="bars"&&(u.bars={show:!0}),i.light_style===!0&&(u.grid.color="#ccc",u.legend.show=!1),i.custom_title&&(u.subtitle=i.custom_title));var a=!1;i.graph!=="bars"&&n.length===1&&n[0].data[0][0]===0&&(a=!0);if(a){n=b(t,n);var f=t.id[t.id.length-1]+1;n[0].data.push([f,undefined]),n[1].data.push([f,undefined]),t.date.push(""),t.id.push(f)}graph=Flotr.draw(s,n,u),a&&(t.date&&t.date.pop(),t.id&&t.id.pop())}function C(e,t,n,r,i){function p(e){var t=Flotr._.extend(Flotr._.clone(u),e||{});return Flotr.draw(s,n,t)}if(n.length===0)return;var s=document.getElementById(e),o=null;i&&i.legend&&i.legend.container&&(o=$("#"+i.legend.container));var u=g(r,o,t,n,i.mouse_tracker);i&&(i.show_title||(u.title=""),"show_legend"in i&&(i.show_legend===!0?u.legend.show=!0:u.legend.show=!1),i.lines&&i.lines.stacked&&(u.lines={stacked:!0,fill:!0,fillOpacity:1,fillBorder:!0,lineWidth:.01}),i.show_labels||(u.xaxis.showLabels=!1,u.yaxis.showLabels=!1),i.show_grid===!1&&(u.grid.verticalLines=!1,u.grid.horizontalLines=!1,u.grid.outlineWidth=0),i.show_mouse===!1&&(u.mouse.track=!1),i.graph==="bars"&&(u.bars={show:!0}),i.light_style===!0&&(u.grid.color="#ccc",u.legend.show=!1),i.custom_title&&(u.subtitle=i.custom_title));var a=n.length,f=n[0].data.length;for(var l=0;l<a;l++)for(var c=0;c<f;c++)n[l].data[c][0]=parseInt(t.unixtime[c],10);var h=!1;i.graph!=="bars"&&n.length===1&&(h=!0),h?(n=b(t,n),x(n)):!h&&n.length>1&&y(t,n),graph=p(),Flotr.EventAdapter.observe(s,"flotr:select",function(e){var t={xaxis:{minorTickFreq:4,mode:"time",timeUnit:"second",timeFormat:"%b %y",min:e.x1,max:e.x2},yaxis:{min:e.y1,autoscale:!0},grid:{verticalLines:!0,color:"#000000",outlineWidth:1,outline:"s"}};t.subtitle=w(u.subtitle,e.xfirst,e.xsecond);var r=JSON.parse(JSON.stringify(n)),i=S(r,e.x1,e.x2);t.yaxis.max=i+i*.2,graph=p(t)}),Flotr.EventAdapter.observe(s,"flotr:click",function(){p()})}function k(e,t,n,r,i,s,o,u,a){var f=!1;o&&(f=!0);var l=document.getElementById(e),c=null;s&&s.legend&&s.legend.container&&(c=$("#"+s.legend.container));var h=[],p,d="";if(!f)for(p=0;p<n.length;p++)t&&(d=DataProcess.hideEmail(t[p])),h.push({data:[[p,n[p]]],label:d});else for(p=0;p<n.length;p++)t&&(d=DataProcess.hideEmail(t[p])),h.push({data:[[n[p],p]],label:d});var v={title:i,grid:{verticalLines:!1,horizontalLines:!1,outlineWidth:0},xaxis:{showLabels:!1,min:0},yaxis:{showLabels:!1,min:0},mouse:{container:c,track:!0,trackFormatter:function(e){var r="x";f&&(r="y");var i="";return t&&(i=DataProcess.hideEmail(t[parseInt(e[r],10)])+": "),i+n[parseInt(e[r],10)]}},legend:{show:!1,position:"se",backgroundColor:"#D2E8FF",container:c}};s&&(s.show_title||(v.title=""),s.show_legend&&(v.legend.show=!0)),r==="bars"&&(v.bars={show:!0,horizontal:f},u&&(v.bars.color=u,v.bars.fillColor=u),s&&s.show_legend!==!1&&(v.legend={show:!0,position:"ne",container:c}),v.grid.horizontalLines=!0,v.yaxis={showLabels:!0,min:0},s&&s.xaxis&&(v.xaxis={showLabels:s.xaxis,min:0}),a&&(v.yaxis={showLabels:!0,min:0,tickFormatter:a})),r==="pie"&&(v.pie={show:!0},v.mouse.position="ne"),r=Flotr.draw(l,h,v)}function L(e,t,n,r,i,s,o,u){var a=.4,f=n[0].length;n[1].length>f&&(f=n[1].length);var l=!1;s&&(l=!0);var c=document.getElementById(e),h=null;i&&i.legend&&i.legend.container&&(h=$("#"+i.legend.container));var p=[],d,v=[],m=[];for(d=0;d<f;d++){var g,y;n[0].length>d?g=n[0][d]:g=undefined,n[1].length>d?y=n[1][d]:y=undefined,l?(p.push([g,d-a/2]),v.push([y,d+a/2])):(p.push([d-a/2,g]),v.push([d+a/2,y]))}m=[{data:p,label:t[0]},{data:v,label:t[1]}];var b={title:r,bars:{show:!0,horizontal:l,barWidth:a},grid:{verticalLines:!1,horizontalLines:!1,outlineWidth:0},xaxis:{showLabels:!1,min:0},yaxis:{showLabels:!0,min:0},mouse:{container:h,track:!0,trackFormatter:function(e){var n,r="x";l&&(r="y");var i=parseFloat(e[r],1),s=Math.round((i-.2)*10)/10,o=Math.round((i+.2)*10)/10;s===parseInt(i,10)?n=s:n=o;var a=n;u&&(a=n*u);var f=a+" years: ",c,h;return p[n]===undefined?c=0:c=parseInt(p[n][0],10),isNaN(c)&&(c=0),v[n]===undefined?h=0:h=parseInt(v[n][0],10),isNaN(h)&&(h=0),f+=c+" "+t[0],f+=" , ",f+=h+" "+t[1],f+=" ("+parseInt(c/h*100,10)+"% )",f}},legend:{show:!0,position:"ne",backgroundColor:"#D2E8FF",container:h}};i&&(i.show_title||(b.title=""),i.show_legend&&(b.legend.show=!0)),i&&i.show_legend!==!1&&(b.legend={show:!0,position:"ne",container:h}),b.grid.horizontalLines=!0,b.yaxis={showLabels:!0,min:0},o&&(b.yaxis={showLabels:!0,min:0,tickFormatter:o}),i&&i.xaxis&&(b.xaxis={showLabels:i.xaxis,min:0}),graph=Flotr.draw(c,m,b)}function A(e,t,n,r){var i=document.getElementById(e),s=Report.getMetricDS(t)[0],o=Report.getMetricDS(n)[0],u=[];if(s!=o){Report.log("Metrics for bubbles have different data sources");return}var a=[],f=[];$.each(Report.getDataSources(),function(e,t){t.getName()===s.getName()&&(a.push(t.getData()),f.push(t.getProject()))});var l=[[],[]];l=[a[0].id,a[0].date];for(var c=0;c<a.length;c++){if(a[c]instanceof Array)return;l=DataProcess.fillDates(l,[a[c].id,a[c].date])}for(var h=0;h<a.length;h++){var p=[],d=a[h],v=DataProcess.fillHistory(l[0],[d.id,d[t]]),m=DataProcess.fillHistory(l[0],[d.id,d[n]]);for(c=0;c<l[0].length;c++)p.push([l[0][c],v[1][c],m[1][c]]);u.push({label:f[h],data:p})}var g={bubbles:{show:!0,baseRadius:5},mouse:{track:!0,trackFormatter:function(e){var r=a[0].date[e.index]+": ";return r+=e.series.label+" ",r+=e.series.data[e.index][1]+" "+t+",",r+=e.series.data[e.index][2]+" "+n,r}},xaxis:{tickFormatter:function(e){return a[0].date[parseInt(e,10)-a[0].id[0]]}}};s.getName()==="its"&&$.extend(g.bubbles,{baseRadius:1}),r&&$.extend(g.bubbles,{baseRadius:r}),Flotr.draw(i,u,g)}function O(e,t,n,r){if(!n)return;r?period=365*r:r=.25;var i=[],s=[],o=[],u,a={show_legend:!1,xaxis:!0},f,l;for(u=0;u<n.aging.persons.age.length;u++)f=n.aging.persons.age[u],l=parseInt(f/period,10),i[l]||(i[l]=0),i[l]+=1;for(u=0;u<n.birth.persons.age.length;u++)f=n.birth.persons.age[u],l=parseInt(f/period,10),s[l]||(s[l]=0),s[l]+=1;o=["Retained","Attracted"],yticks=function(e,t){var n=r,i="years";return e*=r,e+" "+i};var c=[i,s];n&&L(e,o,c,"",a,!0,yticks,r)}function M(e,t,n){var r=document.getElementById(e),i=$("#"+e).data("max"),s=.2;i||(i=0);for(var o=0;o<n.length;o++)for(var u=0;u<n[o].data.length;u++){var a=n[o].data[u][1];a>i&&(i=a,i=parseInt(i*(1+s),10))}(function(){var e=[n,t]})(),graph=Flotr.draw(r,n,{radar:{show:!0},mouse:{track:!0,trackFormatter:function(e){var r="";for(var i=0;i<n.length;i++)r+=n[i].label+" ",r+=n[i].data[e.index][1]+" ",r+=t[e.index][1]+"<br>";return r}},grid:{circular:!0,minorHorizontalLines:!0},yaxis:{min:0,max:i,minorTickFreq:1},xaxis:{ticks:t}})}function _(e,t){var n=[],r=[],i=[],s=[],o=0,u=0;for(o=0;o<t.length;o++){var a=Report.getMetricDS(t[o]);for(u=0;u<a.length;u++)n[u]||(n[u]=[],s[u]=a[u].getProject()),n[u].push([o,parseInt(a[u].getGlobalData()[t[o]],10)]);r.push([o,a[0].getMetrics()[t[o]].name])}for(u=0;u<n.length;u++)i.push({label:s[u],data:n[u]});M(e,r,i)}function D(e){var t=["scm_committers","scm_authors","its_openers","its_closers","its_changers","mls_senders"];_(e,t)}function P(e){var t=["scm_commits","scm_files","its_opened","its_closed","its_changed","mls_sent"];_(e,t)}function H(e,t,n,r,i){j(e,t,n,r,i)}function B(e,t,n,r,i){j(e,t,n,r,i)}function j(e,t,n,r,i){var s=n.split(","),o=t.data;if(!o[s[0]])return;var u={};u.date=o.date,$.each(o,function(e,t){if($.inArray(e,s)===-1)return;u[e]=[];for(var n=0;n<t.length;n++){var r=parseFloat((parseInt(t[n],null)/24).toFixed(2),10);u[e].push(r)}}),u.id=[];for(var a=0;a<o[s[0]].length;a++)u.id.push(a);var f={show_legend:!0,show_labels:!0};v(e,s,u,n,f)}function F(e,t,n,r,i,s,o,u,a,f,l,h){var p=t.getMetrics();n===undefined&&(n=!0);var d;h===undefined?d=t.getGlobalTopData():d=t.getRepositoriesTopData()[h];if(s===!0){var v={};$.each(d,function(e,t){var n=e.split("."),i=n[0],s=n[1];if(r&&r!==i)return!0;r&&r===i&&(v[e]=d[e])}),c(e,v,r,a,p,f,l)}else $.each(d,function(t,n){var s=t.split("."),o=s[0],u=s[1];if(r&&r!==o)return!0;if(i!==undefined&&i!==u)return!0;c(e,d[t],r,a,p,f,l,i)})}function I(e,t,n,r,i,s){var o=null;h(n,r,i,t,o,s)}function q(e,t,n,r,i){var s=t.getProject(),o=t.getMetrics()[n],u=null;if(!t.getGlobalTopData()[n])return;data=t.getGlobalTopData()[n][r],h(e,s,o,r,data,u,i)}function R(e,t,n){if(n===undefined){if(t===undefined)return;Loader.get_file_data_div(t,Viz.displayTreeMap,e);return}if(n===null)return;var r=d3.scale.category20c(),i=d3.select("#"+e),s=$("#"+e).width(),o=$("#"+e).height(),u=d3.layout.treemap().size([s,o]).sticky(!0).value(function(e){return e.size}),a=function(){this.style("left",function(e){return e.x+"px"}).style("top",function(e){return e.y+"px"}).style("width",function(e){return Math.max(0,e.dx-1)+"px"}).style("height",function(e){return Math.max(0,e.dy-1)+"px"})},f=i.datum(n).selectAll(".node").data(u.nodes).enter().append("div").attr("class","treemap-node").call(a).style("background",function(e){return e.children?r(e.name):null}).text(function(e){return e.children?null:e.name});d3.selectAll("input").on("change",function(){var t=this.value==="count"?function(){return 1}:function(e){return e.size};f.data(u.value(t).nodes).transition().duration(1500).call(a)})}function U(e,t,n,r,i){var s=null,o="",u=[[],[]];n?$.each(Report.getDataSources(),function(e,t){if(t.getName()===n)return s=t.getMetrics(),!1}):s=Report.getAllMetrics(),$.each(Report.getDataSources(),function(e,t){o=t.getMainMetric();if(n===null&&t.getName()==="scm"||n&&t.getName()==n)return u=[t.getData().id,t.getData()[o]],i===!1&&(u=[t.getData().id,[]]),!1});var a=[[],[]];$.each(t,function(e,t){$.each(t,function(e,t){if(n&&n!==t.getName())return;a=DataProcess.fillDates(a,[t.getData().id,t.getData().date])})});var f=a[0][0],l=document.getElementById(e),c,h=Report.getMarkers();c={container:l,xTickFormatter:function(e){var t=a[1][e-f];return t==="0"&&(t=""),t},yTickFormatter:function(e){return e+""},selection:{data:{x:{min:a[0][0],max:a[0][a[0].length-1]}}}},c.data={summary:DataProcess.fillHistory(a[0],u),markers:h,dates:a[1],envision_hide:r,main_metric:o};var p=null,d=function(e,t){var n=t.getData();if(n[m]===undefined)return;c.data[m]===undefined&&(c.data[m]=[]);var r=DataProcess.fillHistory(a[0],[n.id,n[m]]);if(m===o){c.data[m].push({label:p,data:r});if(n[m+"_relative"]===undefined)return;c.data[m+"_relative"]===undefined&&(c.data[m+"_relative"]=[]),r=DataProcess.fillHistory(a[0],[n.id,n[m+"_relative"]]),c.data[m+"_relative"].push({label:p,data:r})}else c.data[m].push({label:p,data:r})},v=function(e,t){p=e,$.each(t,d)};for(var m in s)$.each(t,v);return c.trackFormatter=function(e){var t=e.series.data,n=t[e.index][0]-f,r={},i=Report.getProjectsList();for(var o=0;o<i.length;o++)r[i[o]]={};var u=a[1][n]+":<br>";for(var l in s){if(c.data[l]===undefined)continue;if($.inArray(l,c.data.envision_hide)>-1)continue;for(o=0;o<i.length;o++){if(c.data[l][o]===undefined)continue;var h=c.data[l][o].label,p=c.data[l][o].data;u=p[1][n],r[h][l]=u}}u="<table><tr><td align='right'>"+a[1][n]+"</td></tr>",u+="<tr>",i.length>1&&(u+="<td></td>");for(l in s){if(c.data[l]===undefined)continue;if($.inArray(l,c.data.envision_hide)>-1)continue;u+="<td>"+s[l].name+"</td>"}return u+="</tr>",$.each(r,function(e,t){var n="<tr>";for(var o in s){if(c.data[o]===undefined)continue;if($.inArray(o,c.data.envision_hide)>-1)continue;mvalue=r[e][o],mvalue===undefined&&(mvalue="n/a"),n+="<td>"+mvalue+"</td>"}i.length>1&&(n="<td>"+e+"</td>"+n),n+="</tr>",u+=n}),u+="</table>",u},c}function z(e){return e===undefined&&(e={}),e.show_desc===undefined&&(e.show_desc=!0),e.show_title===undefined&&(e.show_title=!0),e.show_labels===undefined&&(e.show_labels=!0),e}function W(e,t){var n=e.getMetrics(),r="";for(var i=0;i<t.length;i++)i!==0&&(r+=" vs. "),t[i]in n?r+=n[t[i]].name:r+=t[i];return r}function X(e,t,n,r,i){i=z(i);var s="";i.show_title&&(s=W(e,t)),v(r,t,n,s,i)}function V(e,t,n,r,i,s){s=z(s);var o=W(e,n);v(i,n,r,o,s)}function J(e,t,n,r,i,s){s=z(s);var o=W(e,n);v(i,n,r,o,s)}function K(e,t,n,r,i,s){s=z(s);var o=W(e,n);v(i,n,r,o,s)}function Q(e,t,n,r,i,s){s=z(s);var o=W(e,n);v(i,n,r,o,s)}function G(e,t,n,r,i,s){s=z(s);var o=W(e,n);v(i,n,r,o,s)}function Y(e,t,n,r,i,s){r=z(r),r.show_legend!==!1&&(r.show_legend=!0);var o=e;m(n,e,t,o,r,i,s)}function Z(e,t,n,r,i,s){s=z(s);var o=W(e,n);v(i,n,r,o,s)}function et(e,t,n,r,i,s,o){r=z(r),r.show_legend!==!1&&(r.show_legend=!0);var u=e;m(n,e,t,u,r,i,s,null,o)}function tt(e,t,n,r,i,s){r=z(r),r.show_legend!==!1&&(r.show_legend=!0);var o=e;m(n,e,t,o,r,i,s)}function nt(e,t,n,r,i,s){r=z(r),r.show_legend!==!1&&(r.show_legend=!0);var o=e;m(n,e,t,o,r,i,s)}function rt(e,t,n,r,i){i=z(i);var s=e,o=[],u=[],a="bars";i.graph&&(a=i.graph),$.each(n,function(n,r){var i=Report.cleanLabel(r);u.push(i),o.push(t[r][e])}),k(r,u,o,a,s,i)}function it(e,t,n,r){var i=Report.getProjectsDataSources(),s=Report.getVizConfig(),o=Viz.getEnvisionOptions(e,i,null,s.summary_hide,r);o.legend_show=n,t&&($.each(i,function(e,t){$.each(t,function(e,t){main_metric=t.getMainMetric()})}),DataProcess.addRelativeValues(o.data,main_metric)),new envision.templates.Envision_Report(o)}var e="#ffa500";Viz.displayTop=F,Viz.displayTopCompany=I,Viz.displayTopGlobal=q,Viz.displayBasicChart=k,Viz.displayMetricCompanies=et,Viz.displayMetricSubReportStatic=rt,Viz.displayMetricsCompany=V,Viz.displayMetricsDomain=K,Viz.displayMetricsProject=Q,Viz.displayMetricsPeople=G,Viz.displayMetricsRepo=J,Viz.displayMetricRepos=Y,Viz.displayMetricsCountry=Z,Viz.displayMetricDomains=tt,Viz.displayMetricProjects=nt,Viz.displayMetricsEvol=X,Viz.displayBubbles=A,Viz.displayDemographicsChart=O,Viz.displayEnvisionAll=it,Viz.displayTimeToFix=B,Viz.displayTimeToAttention=H,Viz.displayMetricSubReportLines=m,Viz.displayRadarActivity=P,Viz.displayRadarCommunity=D,Viz.displayTreeMap=R,Viz.displayMarkovTable=n,Viz.displayDataSourcesTable=p,Viz.getEnvisionOptions=U,Viz.checkBasicConfig=z,Viz.track_formatter_com_pending=function(e){scr=Report.getDataSourceByName("scr"),companies=scr.getCompaniesMetricsData(),dhistory=Viz._history,lines_data=Viz._lines_data;var t=dhistory.date[parseInt(e.index,10)];t===undefined?t="":t+="<br>";for(var n=0;n<lines_data.length;n++){var r=lines_data[n].data[e.index][1];if(r===undefined)continue;lines_data.length>1&&(lines_data[n].label!==undefined&&(company_name=lines_data[n].label),t+=lines_data[n].label+":"),t+="<strong>"+Report.formatValue(r)+"</strong>",company_name&&(t+="("+companies[company_name].pending[e.index]+")"),t+="<br>"}return t},Viz.getEnvisionOptionsMin=function(e,t,n){var r=t.id[0],i=document.getElementById(e),s,o=Report.getMarkers(),u=Report.getAllMetrics();s={container:i,xTickFormatter:function(e){var n=t.date[e-r];return n==="0"&&(n=""),n},yTickFormatter:function(e){return e+""},selection:{data:{x:{min:t.id[0],max:t.id[t.id.length-1]}}}},s.data={summary:[t.id,t.sent],markers:o,dates:t.date,envision_hide:n,main_metric:"sent"};var a=Report.getAllMetrics(),f=null;for(var l in t)f=l,a[l]&&(f=a[l].name),s.data[l]=[{label:f,data:[t.id,t[l]]}];return s.trackFormatter=function(e){var n=e.series.data,i=n[e.index][0]-r,s=t.date[i]+":<br>";for(var o in u){if(t[o]===undefined)continue;s+=t[o][i]+" "+o+" , "}return s},s}})(),IRC.prototype=new DataSource("irc"),ITS.prototype=new DataSource("its"),MediaWiki.prototype=new DataSource("mediawiki"),MLS.prototype=new DataSource("mls"),SCM.prototype=new DataSource("scm"),SCR.prototype=new DataSource("scr"),People.prototype=new DataSource("people"),Downloads.prototype=new DataSource("downloads"),QAForums.prototype=new DataSource("qaforums"),Releases.prototype=new DataSource("releases");var Identity={};(function(){function t(t,n,r){var i="";t===e?i="":i=e,$("#"+r).sortable({handle:".handle",connectWith:"#"+i,start:function(e,t){t.item.siblings(".ui-selected").appendTo(t.item)},stop:function(t,n){n.item.parent()[0].id===e&&n.item.find(".handle").remove(),n.item.parent().append(n.item.find("li")),n.item.parent().find("li").addClass("mjs-nestedSortable-leaf")}}).selectable().find("li").prepend("<div class='handle'></div>")}function n(e,t){$("#"+e.getName()+"filter").autocomplete({source:t,select:function(t,n){return $("#"+e.getName()+"filter").val(""),$("#"+e.getName()+"_people_"+n.item.value).addClass("ui-selected"),!1}})}var e="unique-sortable";Identity.showListNested=function(t,n){list="<ol id="+e+' class="nested_sortable" ',list+='style="padding: 5px; background: #eee;"></ol>',$("#"+t).append(list),$("#"+e).nestedSortable({forcePlaceholderSize:!0,handle:"div",helper:"clone",items:"li",tolerance:"pointer",toleranceElement:"> div",maxLevels:2,isTree:!0,expandOnHover:700,startCollapsed:!0}),$(".disclose").on("click",function(){$(this).closest("li").toggleClass("mjs-nestedSortable-collapsed").toggleClass("mjs-nestedSortable-expanded")})},Identity.showList=function(e,r){var i="",s=r.getPeopleData(),o=[];i='<ol id="'+r.getName()+'-sortable" class="sortable">';for(var u=0;u<s.id.length;u++){var a=s.id[u];typeof a=="string"&&(a=a.replace("@","_at_").replace(".","_")),o.push({value:a,label:s.name[u]}),i+='<li id="'+r.getName()+"_people_"+a+'" ',i+='class="ui-widget-content ui-selectee">',i+='<div><span class="disclose"><span></span></span>',i+=s.id[u]+" "+s.name[u],i+="</div></li>"}i+="</ol>",$("#"+e).append("<input id='"+r.getName()+"filter'>"),n(r,o),$("#"+e).append(i),t(e,i,r.getName()+"-sortable")}})(),vizjslib_git_revision="cd7e40057a007260006990d58cb098334a1893a3",vizjslib_git_tag="2.1.5-11-gcd7e400";
=======
(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){return new wrapper(obj)};if(typeof module!=="undefined"&&module.exports){module.exports=_;_._=_}else{root["_"]=_}_.VERSION="1.1.7";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker)return}}else{for(var key in obj){if(hasOwnProperty.call(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return}}}};_.map=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=memo!==void 0;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError("Reduce of empty array with no initial value");return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return memo!==void 0?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var reversed=(_.isArray(obj)?obj.slice():_.toArray(obj)).reverse();return _.reduce(reversed,iterator,memo,context)};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){var results=[];if(obj==null)return results;each(obj,function(value,index,list){if(!iterator.call(context,value,index,list))results[results.length]=value});return results};_.every=_.all=function(obj,iterator,context){var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return result};var any=_.some=_.any=function(obj,iterator,context){iterator=iterator||_.identity;var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result|=iterator.call(context,value,index,list))return breaker});return!!result};_.include=_.contains=function(obj,target){var found=false;if(obj==null)return found;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;any(obj,function(value){if(found=value===target)return true});return found};_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(method.call?method||value:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.max.apply(Math,obj);var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.min.apply(Math,obj);var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.sortBy=function(obj,iterator,context){return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}),"value")};_.groupBy=function(obj,iterator){var result={};each(obj,function(value,index){var key=iterator(value,index);(result[key]||(result[key]=[])).push(value)});return result};_.sortedIndex=function(array,obj,iterator){iterator||(iterator=_.identity);var low=0,high=array.length;while(low<high){var mid=low+high>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low};_.toArray=function(iterable){if(!iterable)return[];if(iterable.toArray)return iterable.toArray();if(_.isArray(iterable))return slice.call(iterable);if(_.isArguments(iterable))return slice.call(iterable);return _.values(iterable)};_.size=function(obj){return _.toArray(obj).length};_.first=_.head=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]};_.rest=_.tail=function(array,index,guard){return slice.call(array,index==null||guard?1:index)};_.last=function(array){return array[array.length-1]};_.compact=function(array){return _.filter(array,function(value){return!!value})};_.flatten=function(array){return _.reduce(array,function(memo,value){if(_.isArray(value))return memo.concat(_.flatten(value));memo[memo.length]=value;return memo},[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted){return _.reduce(array,function(memo,el,i){if(0==i||(isSorted===true?_.last(memo)!=el:!_.include(memo,el)))memo[memo.length]=el;return memo},[])};_.union=function(){return _.uniq(_.flatten(arguments))};_.intersection=_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array,other){return _.filter(array,function(value){return!_.include(other,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,"length"));var results=new Array(length);for(var i=0;i<length;i++)results[i]=_.pluck(args,""+i);return results};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i,l;if(isSorted){i=_.sortedIndex(array,item);return array[i]===item?i:-1}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(i=0,l=array.length;i<l;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item){if(array==null)return-1;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return array.lastIndexOf(item);var i=array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};_.bind=function(func,obj){if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));var args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return hasOwnProperty.call(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(func,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};var limit=function(func,wait,debounce){var timeout;return function(){var context=this,args=arguments;var throttler=function(){timeout=null;func.apply(context,args)};if(debounce)clearTimeout(timeout);if(debounce||!timeout)timeout=setTimeout(throttler,wait)}};_.throttle=function(func,wait){return limit(func,wait,false)};_.debounce=function(func,wait){return limit(func,wait,true)};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;return memo=func.apply(this,arguments)}};_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments));return wrapper.apply(this,args)}};_.compose=function(){var funcs=slice.call(arguments);return function(){var args=slice.call(arguments);for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)if(hasOwnProperty.call(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){return _.map(obj,_.identity)};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(source[prop]!==void 0)obj[prop]=source[prop]}});return obj};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(obj[prop]==null)obj[prop]=source[prop]}});return obj};_.clone=function(obj){return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isEqual=function(a,b){if(a===b)return true;var atype=typeof a,btype=typeof b;if(atype!=btype)return false;if(a==b)return true;if(!a&&b||a&&!b)return false;if(a._chain)a=a._wrapped;if(b._chain)b=b._wrapped;if(a.isEqual)return a.isEqual(b);if(b.isEqual)return b.isEqual(a);if(_.isDate(a)&&_.isDate(b))return a.getTime()===b.getTime();if(_.isNaN(a)&&_.isNaN(b))return false;if(_.isRegExp(a)&&_.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(atype!=="object")return false;if(a.length&&a.length!==b.length)return false;var aKeys=_.keys(a),bKeys=_.keys(b);if(aKeys.length!=bKeys.length)return false;for(var key in a)if(!(key in b)||!_.isEqual(a[key],b[key]))return false;return true};_.isEmpty=function(obj){if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(hasOwnProperty.call(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType==1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){return obj===Object(obj)};_.isArguments=function(obj){return!!(obj&&hasOwnProperty.call(obj,"callee"))};_.isFunction=function(obj){return!!(obj&&obj.constructor&&obj.call&&obj.apply)};_.isString=function(obj){return!!(obj===""||obj&&obj.charCodeAt&&obj.substr)};_.isNumber=function(obj){return!!(obj===0||obj&&obj.toExponential&&obj.toFixed)};_.isNaN=function(obj){return obj!==obj};_.isBoolean=function(obj){return obj===true||obj===false};_.isDate=function(obj){return!!(obj&&obj.getTimezoneOffset&&obj.setUTCFullYear)};_.isRegExp=function(obj){return!!(obj&&obj.test&&obj.exec&&(obj.ignoreCase||obj.ignoreCase===false))};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)};_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};_.template=function(str,data){var c=_.templateSettings;var tmpl="var __p=[],print=function(){__p.push.apply(__p,arguments);};"+"with(obj||{}){__p.push('"+str.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(match,code){return"',"+code.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(match,code){return"');"+code.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var func=new Function("obj",tmpl);return data?func(data):func};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj};var addToWrapper=function(name,func){wrapper.prototype[name]=function(){var args=slice.call(arguments);unshift.call(args,this._wrapped);return result(func.apply(_,args),this._chain)}};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){method.apply(this._wrapped,arguments);return result(this._wrapped,this._chain)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}});wrapper.prototype.chain=function(){this._chain=true;return this};wrapper.prototype.value=function(){return this._wrapped}})();!function(name,context,definition){if(typeof module!=="undefined")module.exports=definition(name,context);else if(typeof define==="function"&&typeof define.amd==="object")define(definition);else context[name]=definition(name,context)}("bean",this,function(name,context){var win=window,old=context[name],overOut=/over|out/,namespaceRegex=/[^\.]*(?=\..*)\.|.*/,nameRegex=/\..*/,addEvent="addEventListener",attachEvent="attachEvent",removeEvent="removeEventListener",detachEvent="detachEvent",doc=document||{},root=doc.documentElement||{},W3C_MODEL=root[addEvent],eventSupport=W3C_MODEL?addEvent:attachEvent,slice=Array.prototype.slice,mouseTypeRegex=/click|mouse|menu|drag|drop/i,touchTypeRegex=/^touch|^gesture/i,ONE={one:1},nativeEvents=function(hash,events,i){for(i=0;i<events.length;i++)hash[events[i]]=1;return hash}({},("click dblclick mouseup mousedown contextmenu "+"mousewheel DOMMouseScroll "+"mouseover mouseout mousemove selectstart selectend "+"keydown keypress keyup "+"orientationchange "+"focus blur change reset select submit "+"load unload beforeunload resize move DOMContentLoaded readystatechange "+"error abort scroll "+(W3C_MODEL?"show "+"input invalid "+"touchstart touchmove touchend touchcancel "+"gesturestart gesturechange gestureend "+"message readystatechange pageshow pagehide popstate "+"hashchange offline online "+"afterprint beforeprint "+"dragstart dragenter dragover dragleave drag drop dragend "+"loadstart progress suspend emptied stalled loadmetadata "+"loadeddata canplay canplaythrough playing waiting seeking "+"seeked ended durationchange timeupdate play pause ratechange "+"volumechange cuechange "+"checking noupdate downloading cached updateready obsolete "+"":"")).split(" ")),customEvents=function(){function isDescendant(parent,node){while((node=node.parentNode)!==null){if(node===parent)return true}return false}function check(event){var related=event.relatedTarget;if(!related)return related===null;return related!==this&&related.prefix!=="xul"&&!/document/.test(this.toString())&&!isDescendant(this,related)}return{mouseenter:{base:"mouseover",condition:check},mouseleave:{base:"mouseout",condition:check},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}}(),fixEvent=function(){var commonProps="altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which".split(" "),mouseProps=commonProps.concat("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" ")),keyProps=commonProps.concat("char charCode key keyCode".split(" ")),touchProps=commonProps.concat("touches targetTouches changedTouches scale rotation".split(" ")),preventDefault="preventDefault",createPreventDefault=function(event){return function(){if(event[preventDefault])event[preventDefault]();else event.returnValue=false}},stopPropagation="stopPropagation",createStopPropagation=function(event){return function(){if(event[stopPropagation])event[stopPropagation]();else event.cancelBubble=true}},createStop=function(synEvent){return function(){synEvent[preventDefault]();synEvent[stopPropagation]();synEvent.stopped=true}},copyProps=function(event,result,props){var i,p;for(i=props.length;i--;){p=props[i];if(!(p in result)&&p in event)result[p]=event[p]}};return function(event,isNative){var result={originalEvent:event,isNative:isNative};if(!event)return result;var props,type=event.type,target=event.target||event.srcElement;result[preventDefault]=createPreventDefault(event);result[stopPropagation]=createStopPropagation(event);result.stop=createStop(result);result.target=target&&target.nodeType===3?target.parentNode:target;if(isNative){if(type.indexOf("key")!==-1){props=keyProps;result.keyCode=event.which||event.keyCode}else if(mouseTypeRegex.test(type)){props=mouseProps;result.rightClick=event.which===3||event.button===2;result.pos={x:0,y:0};if(event.pageX||event.pageY){result.clientX=event.pageX;result.clientY=event.pageY}else if(event.clientX||event.clientY){result.clientX=event.clientX+doc.body.scrollLeft+root.scrollLeft;result.clientY=event.clientY+doc.body.scrollTop+root.scrollTop}if(overOut.test(type))result.relatedTarget=event.relatedTarget||event[(type==="mouseover"?"from":"to")+"Element"]}else if(touchTypeRegex.test(type)){props=touchProps}copyProps(event,result,props||commonProps)}return result}}(),targetElement=function(element,isNative){return!W3C_MODEL&&!isNative&&(element===doc||element===win)?root:element},RegEntry=function(){function entry(element,type,handler,original,namespaces){this.element=element;this.type=type;this.handler=handler;this.original=original;this.namespaces=namespaces;this.custom=customEvents[type];this.isNative=nativeEvents[type]&&element[eventSupport];this.eventType=W3C_MODEL||this.isNative?type:"propertychange";this.customType=!W3C_MODEL&&!this.isNative&&type;this.target=targetElement(element,this.isNative);this.eventSupport=this.target[eventSupport]}entry.prototype={inNamespaces:function(checkNamespaces){var i,j;if(!checkNamespaces)return true;if(!this.namespaces)return false;for(i=checkNamespaces.length;i--;){for(j=this.namespaces.length;j--;){if(checkNamespaces[i]===this.namespaces[j])return true}}return false},matches:function(checkElement,checkOriginal,checkHandler){return this.element===checkElement&&(!checkOriginal||this.original===checkOriginal)&&(!checkHandler||this.handler===checkHandler)}};return entry}(),registry=function(){var map={},forAll=function(element,type,original,handler,fn){if(!type||type==="*"){for(var t in map){if(t.charAt(0)==="$")forAll(element,t.substr(1),original,handler,fn)}}else{var i=0,l,list=map["$"+type],all=element==="*";if(!list)return;for(l=list.length;i<l;i++){if(all||list[i].matches(element,original,handler))if(!fn(list[i],list,i,type))return}}},has=function(element,type,original){var i,list=map["$"+type];if(list){for(i=list.length;i--;){if(list[i].matches(element,original,null))return true}}return false},get=function(element,type,original){var entries=[];forAll(element,type,original,null,function(entry){return entries.push(entry)});return entries},put=function(entry){(map["$"+entry.type]||(map["$"+entry.type]=[])).push(entry);return entry},del=function(entry){forAll(entry.element,entry.type,null,entry.handler,function(entry,list,i){list.splice(i,1);if(list.length===0)delete map["$"+entry.type];return false})},entries=function(){var t,entries=[];for(t in map){if(t.charAt(0)==="$")entries=entries.concat(map[t])}return entries};return{has:has,get:get,put:put,del:del,entries:entries}}(),listener=W3C_MODEL?function(element,type,fn,add){element[add?addEvent:removeEvent](type,fn,false)}:function(element,type,fn,add,custom){if(custom&&add&&element["_on"+custom]===null)element["_on"+custom]=0;element[add?attachEvent:detachEvent]("on"+type,fn)},nativeHandler=function(element,fn,args){return function(event){event=fixEvent(event||((this.ownerDocument||this.document||this).parentWindow||win).event,true);return fn.apply(element,[event].concat(args))}},customHandler=function(element,fn,type,condition,args,isNative){return function(event){if(condition?condition.apply(this,arguments):W3C_MODEL?true:event&&event.propertyName==="_on"+type||!event){if(event)event=fixEvent(event||((this.ownerDocument||this.document||this).parentWindow||win).event,isNative);fn.apply(element,event&&(!args||args.length===0)?arguments:slice.call(arguments,event?0:1).concat(args))}}},once=function(rm,element,type,fn,originalFn){return function(){rm(element,type,originalFn);fn.apply(this,arguments)}},removeListener=function(element,orgType,handler,namespaces){var i,l,entry,type=orgType&&orgType.replace(nameRegex,""),handlers=registry.get(element,type,handler);for(i=0,l=handlers.length;i<l;i++){if(handlers[i].inNamespaces(namespaces)){if((entry=handlers[i]).eventSupport)listener(entry.target,entry.eventType,entry.handler,false,entry.type);registry.del(entry)}}},addListener=function(element,orgType,fn,originalFn,args){var entry,type=orgType.replace(nameRegex,""),namespaces=orgType.replace(namespaceRegex,"").split(".");if(registry.has(element,type,fn))return element;if(type==="unload")fn=once(removeListener,element,type,fn,originalFn);if(customEvents[type]){if(customEvents[type].condition)fn=customHandler(element,fn,type,customEvents[type].condition,true);type=customEvents[type].base||type}entry=registry.put(new RegEntry(element,type,fn,originalFn,namespaces[0]&&namespaces));entry.handler=entry.isNative?nativeHandler(element,entry.handler,args):customHandler(element,entry.handler,type,false,args,false);if(entry.eventSupport)listener(entry.target,entry.eventType,entry.handler,true,entry.customType)},del=function(selector,fn,$){return function(e){var target,i,array=typeof selector==="string"?$(selector,this):selector;for(target=e.target;target&&target!==this;target=target.parentNode){for(i=array.length;i--;){if(array[i]===target){return fn.apply(target,arguments)}}}}},remove=function(element,typeSpec,fn){var k,m,type,namespaces,i,rm=removeListener,isString=typeSpec&&typeof typeSpec==="string";if(isString&&typeSpec.indexOf(" ")>0){typeSpec=typeSpec.split(" ");for(i=typeSpec.length;i--;)remove(element,typeSpec[i],fn);return element}type=isString&&typeSpec.replace(nameRegex,"");if(type&&customEvents[type])type=customEvents[type].type;if(!typeSpec||isString){if(namespaces=isString&&typeSpec.replace(namespaceRegex,""))namespaces=namespaces.split(".");rm(element,type,fn,namespaces)}else if(typeof typeSpec==="function"){rm(element,null,typeSpec)}else{for(k in typeSpec){if(typeSpec.hasOwnProperty(k))remove(element,k,typeSpec[k])}}return element},add=function(element,events,fn,delfn,$){var type,types,i,args,originalFn=fn,isDel=fn&&typeof fn==="string";if(events&&!fn&&typeof events==="object"){for(type in events){if(events.hasOwnProperty(type))add.apply(this,[element,type,events[type]])}}else{args=arguments.length>3?slice.call(arguments,3):[];types=(isDel?fn:events).split(" ");isDel&&(fn=del(events,originalFn=delfn,$))&&(args=slice.call(args,1));this===ONE&&(fn=once(remove,element,events,fn,originalFn));for(i=types.length;i--;)addListener(element,types[i],fn,originalFn,args)}return element},one=function(){return add.apply(ONE,arguments)},fireListener=W3C_MODEL?function(isNative,type,element){var evt=doc.createEvent(isNative?"HTMLEvents":"UIEvents");evt[isNative?"initEvent":"initUIEvent"](type,true,true,win,1);element.dispatchEvent(evt)}:function(isNative,type,element){element=targetElement(element,isNative);isNative?element.fireEvent("on"+type,doc.createEventObject()):element["_on"+type]++},fire=function(element,type,args){var i,j,l,names,handlers,types=type.split(" ");for(i=types.length;i--;){type=types[i].replace(nameRegex,"");if(names=types[i].replace(namespaceRegex,""))names=names.split(".");if(!names&&!args&&element[eventSupport]){fireListener(nativeEvents[type],type,element)}else{handlers=registry.get(element,type);args=[false].concat(args);for(j=0,l=handlers.length;j<l;j++){if(handlers[j].inNamespaces(names))handlers[j].handler.apply(element,args)}}}return element},clone=function(element,from,type){var i=0,handlers=registry.get(from,type),l=handlers.length;for(;i<l;i++)handlers[i].original&&add(element,handlers[i].type,handlers[i].original);return element},bean={add:add,one:one,remove:remove,clone:clone,fire:fire,noConflict:function(){context[name]=old;return this}};if(win[attachEvent]){var cleanup=function(){var i,entries=registry.entries();for(i in entries){if(entries[i].type&&entries[i].type!=="unload")remove(entries[i].element,entries[i].type)}win[detachEvent]("onunload",cleanup);win.CollectGarbage&&win.CollectGarbage()};win[attachEvent]("onunload",cleanup)}return bean});(function(){var global=this,previousFlotr=this.Flotr,Flotr;Flotr={_:_,bean:bean,isIphone:/iphone/i.test(navigator.userAgent),isIE:navigator.appVersion.indexOf("MSIE")!=-1?parseFloat(navigator.appVersion.split("MSIE")[1]):false,graphTypes:{},plugins:{},addType:function(name,graphType){Flotr.graphTypes[name]=graphType;Flotr.defaultOptions[name]=graphType.options||{};Flotr.defaultOptions.defaultType=Flotr.defaultOptions.defaultType||name},addPlugin:function(name,plugin){Flotr.plugins[name]=plugin;Flotr.defaultOptions[name]=plugin.options||{}},draw:function(el,data,options,GraphKlass){GraphKlass=GraphKlass||Flotr.Graph;return new GraphKlass(el,data,options)},merge:function(src,dest){var i,v,result=dest||{};for(i in src){v=src[i];if(v&&typeof v==="object"){if(v.constructor===Array){result[i]=this._.clone(v)}else if(v.constructor!==RegExp&&!this._.isElement(v)&&!v.jquery){result[i]=Flotr.merge(v,dest?dest[i]:undefined)}else{result[i]=v}}else{result[i]=v}}return result},clone:function(object){return Flotr.merge(object,{})},getTickSize:function(noTicks,min,max,decimals){var delta=(max-min)/noTicks,magn=Flotr.getMagnitude(delta),tickSize=10,norm=delta/magn;if(norm<1.5)tickSize=1;else if(norm<2.25)tickSize=2;else if(norm<3)tickSize=decimals===0?2:2.5;else if(norm<7.5)tickSize=5;return tickSize*magn},defaultTickFormatter:function(val,axisOpts){return val+""},defaultTrackFormatter:function(obj){return"("+obj.x+", "+obj.y+")"},engineeringNotation:function(value,precision,base){var sizes=["Y","Z","E","P","T","G","M","k",""],fractionSizes=["y","z","a","f","p","n","","m",""],total=sizes.length;base=base||1e3;precision=Math.pow(10,precision||2);if(value===0)return 0;if(value>1){while(total--&&value>=base)value/=base}else{sizes=fractionSizes;total=sizes.length;while(total--&&value<1)value*=base}return Math.round(value*precision)/precision+sizes[total]},getMagnitude:function(x){return Math.pow(10,Math.floor(Math.log(x)/Math.LN10))},toPixel:function(val){return Math.floor(val)+.5},toRad:function(angle){return-angle*(Math.PI/180)},floorInBase:function(n,base){return base*Math.floor(n/base)},drawText:function(ctx,text,x,y,style){if(!ctx.fillText){ctx.drawText(text,x,y,style);return}style=this._.extend({size:Flotr.defaultOptions.fontSize,color:"#000000",textAlign:"left",textBaseline:"bottom",weight:1,angle:0},style);ctx.save();ctx.translate(x,y);ctx.rotate(style.angle);ctx.fillStyle=style.color;ctx.font=(style.weight>1?"bold ":"")+style.size*1.3+"px sans-serif";ctx.textAlign=style.textAlign;ctx.textBaseline=style.textBaseline;ctx.fillText(text,0,0);ctx.restore()},getBestTextAlign:function(angle,style){style=style||{textAlign:"center",textBaseline:"middle"};angle+=Flotr.getTextAngleFromAlign(style);if(Math.abs(Math.cos(angle))>.01)style.textAlign=Math.cos(angle)>0?"right":"left";if(Math.abs(Math.sin(angle))>.01)style.textBaseline=Math.sin(angle)>0?"top":"bottom";return style},alignTable:{"right middle":0,"right top":Math.PI/4,"center top":Math.PI/2,"left top":3*(Math.PI/4),"left middle":Math.PI,"left bottom":-3*(Math.PI/4),"center bottom":-Math.PI/2,"right bottom":-Math.PI/4,"center middle":0},getTextAngleFromAlign:function(style){return Flotr.alignTable[style.textAlign+" "+style.textBaseline]||0},noConflict:function(){global.Flotr=previousFlotr;return this}};global.Flotr=Flotr})();Flotr.defaultOptions={colors:["#00A8F0","#C0D800","#CB4B4B","#4DA74D","#9440ED"],ieBackgroundColor:"#FFFFFF",title:null,subtitle:null,shadowSize:4,defaultType:null,HtmlText:true,fontColor:"#545454",fontSize:7.5,resolution:1,parseFloat:true,preventDefault:true,xaxis:{ticks:null,minorTicks:null,showLabels:true,showMinorLabels:false,labelsAngle:0,title:null,titleAngle:0,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:false,autoscaleMargin:0,color:null,mode:"normal",timeFormat:null,timeMode:"UTC",timeUnit:"millisecond",scaling:"linear",base:Math.E,titleAlign:"center",margin:true},x2axis:{},yaxis:{ticks:null,minorTicks:null,showLabels:true,showMinorLabels:false,labelsAngle:0,title:null,titleAngle:90,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:false,autoscaleMargin:0,color:null,scaling:"linear",base:Math.E,titleAlign:"center",margin:true},y2axis:{titleAngle:270},grid:{color:"#545454",backgroundColor:null,backgroundImage:null,watermarkAlpha:.4,tickColor:"#DDDDDD",labelMargin:3,verticalLines:true,minorVerticalLines:null,horizontalLines:true,minorHorizontalLines:null,outlineWidth:1,outline:"nsew",circular:false},mouse:{track:false,trackAll:false,position:"se",relative:false,trackFormatter:Flotr.defaultTrackFormatter,margin:5,lineColor:"#FF3F19",trackDecimals:1,sensibility:2,trackY:true,radius:3,fillColor:null,fillOpacity:.4}};(function(){var _=Flotr._;function Color(r,g,b,a){this.rgba=["r","g","b","a"];var x=4;while(-1<--x){this[this.rgba[x]]=arguments[x]||(x==3?1:0)}this.normalize()}var COLOR_NAMES={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]};Color.prototype={scale:function(rf,gf,bf,af){var x=4;while(-1<--x){if(!_.isUndefined(arguments[x]))this[this.rgba[x]]*=arguments[x]}return this.normalize()},alpha:function(alpha){if(!_.isUndefined(alpha)&&!_.isNull(alpha)){this.a=alpha}return this.normalize()},clone:function(){return new Color(this.r,this.b,this.g,this.a)},limit:function(val,minVal,maxVal){return Math.max(Math.min(val,maxVal),minVal)
},normalize:function(){var limit=this.limit;this.r=limit(parseInt(this.r,10),0,255);this.g=limit(parseInt(this.g,10),0,255);this.b=limit(parseInt(this.b,10),0,255);this.a=limit(this.a,0,1);return this},distance:function(color){if(!color)return;color=new Color.parse(color);var dist=0,x=3;while(-1<--x){dist+=Math.abs(this[this.rgba[x]]-color[this.rgba[x]])}return dist},toString:function(){return this.a>=1?"rgb("+[this.r,this.g,this.b].join(",")+")":"rgba("+[this.r,this.g,this.b,this.a].join(",")+")"},contrast:function(){var test=1-(.299*this.r+.587*this.g+.114*this.b)/255;return test<.5?"#000000":"#ffffff"}};_.extend(Color,{parse:function(color){if(color instanceof Color)return color;var result;if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color))return new Color(parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16));if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color))return new Color(parseInt(result[1],10),parseInt(result[2],10),parseInt(result[3],10));if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color))return new Color(parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16));if(result=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(color))return new Color(parseInt(result[1],10),parseInt(result[2],10),parseInt(result[3],10),parseFloat(result[4]));if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color))return new Color(parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55);if(result=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(color))return new Color(parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55,parseFloat(result[4]));var name=(color+"").replace(/^\s*([\S\s]*?)\s*$/,"$1").toLowerCase();if(name=="transparent"){return new Color(255,255,255,0)}return(result=COLOR_NAMES[name])?new Color(result[0],result[1],result[2]):new Color(0,0,0,0)},processColor:function(color,options){var opacity=options.opacity;if(!color)return"rgba(0, 0, 0, 0)";if(color instanceof Color)return color.alpha(opacity).toString();if(_.isString(color))return Color.parse(color).alpha(opacity).toString();var grad=color.colors?color:{colors:color};if(!options.ctx){if(!_.isArray(grad.colors))return"rgba(0, 0, 0, 0)";return Color.parse(_.isArray(grad.colors[0])?grad.colors[0][1]:grad.colors[0]).alpha(opacity).toString()}grad=_.extend({start:"top",end:"bottom"},grad);if(/top/i.test(grad.start))options.x1=0;if(/left/i.test(grad.start))options.y1=0;if(/bottom/i.test(grad.end))options.x2=0;if(/right/i.test(grad.end))options.y2=0;var i,c,stop,gradient=options.ctx.createLinearGradient(options.x1,options.y1,options.x2,options.y2);for(i=0;i<grad.colors.length;i++){c=grad.colors[i];if(_.isArray(c)){stop=c[0];c=c[1]}else stop=i/(grad.colors.length-1);gradient.addColorStop(stop,Color.parse(c).alpha(opacity))}return gradient}});Flotr.Color=Color})();Flotr.Date={set:function(date,name,mode,value){mode=mode||"UTC";name="set"+(mode==="UTC"?"UTC":"")+name;date[name](value)},get:function(date,name,mode){mode=mode||"UTC";name="get"+(mode==="UTC"?"UTC":"")+name;return date[name]()},format:function(d,format,mode){if(!d)return;var get=this.get,tokens={h:get(d,"Hours",mode).toString(),H:leftPad(get(d,"Hours",mode)),M:leftPad(get(d,"Minutes",mode)),S:leftPad(get(d,"Seconds",mode)),s:get(d,"Milliseconds",mode),d:get(d,"Date",mode).toString(),m:(get(d,"Month",mode)+1).toString(),y:get(d,"FullYear",mode).toString(),b:Flotr.Date.monthNames[get(d,"Month",mode)]};function leftPad(n){n+="";return n.length==1?"0"+n:n}var r=[],c,escape=false;for(var i=0;i<format.length;++i){c=format.charAt(i);if(escape){r.push(tokens[c]||c);escape=false}else if(c=="%")escape=true;else r.push(c)}return r.join("")},getFormat:function(time,span){var tu=Flotr.Date.timeUnits;if(time<tu.second)return"%h:%M:%S.%s";else if(time<tu.minute)return"%h:%M:%S";else if(time<tu.day)return span<2*tu.day?"%h:%M":"%b %d %h:%M";else if(time<tu.month)return"%b %d";else if(time<tu.year)return span<tu.year?"%b":"%b %y";else return"%y"},formatter:function(v,axis){var options=axis.options,scale=Flotr.Date.timeUnits[options.timeUnit],d=new Date(v*scale);if(axis.options.timeFormat)return Flotr.Date.format(d,options.timeFormat,options.timeMode);var span=(axis.max-axis.min)*scale,t=axis.tickSize*Flotr.Date.timeUnits[axis.tickUnit];return Flotr.Date.format(d,Flotr.Date.getFormat(t,span),options.timeMode)},generator:function(axis){var set=this.set,get=this.get,timeUnits=this.timeUnits,spec=this.spec,options=axis.options,mode=options.timeMode,scale=timeUnits[options.timeUnit],min=axis.min*scale,max=axis.max*scale,delta=(max-min)/options.noTicks,ticks=[],tickSize=axis.tickSize,tickUnit,formatter,i;formatter=options.tickFormatter===Flotr.defaultTickFormatter?this.formatter:options.tickFormatter;for(i=0;i<spec.length-1;++i){var d=spec[i][0]*timeUnits[spec[i][1]];if(delta<(d+spec[i+1][0]*timeUnits[spec[i+1][1]])/2&&d>=tickSize)break}tickSize=spec[i][0];tickUnit=spec[i][1];if(tickUnit=="year"){tickSize=Flotr.getTickSize(options.noTicks*timeUnits.year,min,max,0);if(tickSize==.5){tickUnit="month";tickSize=6}}axis.tickUnit=tickUnit;axis.tickSize=tickSize;var step=tickSize*timeUnits[tickUnit];d=new Date(min);function setTick(name){set(d,name,mode,Flotr.floorInBase(get(d,name,mode),tickSize))}switch(tickUnit){case"millisecond":setTick("Milliseconds");break;case"second":setTick("Seconds");break;case"minute":setTick("Minutes");break;case"hour":setTick("Hours");break;case"month":setTick("Month");break;case"year":setTick("FullYear");break}if(step>=timeUnits.second)set(d,"Milliseconds",mode,0);if(step>=timeUnits.minute)set(d,"Seconds",mode,0);if(step>=timeUnits.hour)set(d,"Minutes",mode,0);if(step>=timeUnits.day)set(d,"Hours",mode,0);if(step>=timeUnits.day*4)set(d,"Date",mode,1);if(step>=timeUnits.year)set(d,"Month",mode,0);var carry=0,v=NaN,prev;do{prev=v;v=d.getTime();ticks.push({v:v/scale,label:formatter(v/scale,axis)});if(tickUnit=="month"){if(tickSize<1){set(d,"Date",mode,1);var start=d.getTime();set(d,"Month",mode,get(d,"Month",mode)+1);var end=d.getTime();d.setTime(v+carry*timeUnits.hour+(end-start)*tickSize);carry=get(d,"Hours",mode);set(d,"Hours",mode,0)}else set(d,"Month",mode,get(d,"Month",mode)+tickSize)}else if(tickUnit=="year"){set(d,"FullYear",mode,get(d,"FullYear",mode)+tickSize)}else d.setTime(v+step)}while(v<max&&v!=prev);return ticks},timeUnits:{millisecond:1,second:1e3,minute:1e3*60,hour:1e3*60*60,day:1e3*60*60*24,month:1e3*60*60*24*30,year:1e3*60*60*24*365.2425},spec:[[1,"millisecond"],[20,"millisecond"],[50,"millisecond"],[100,"millisecond"],[200,"millisecond"],[500,"millisecond"],[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};(function(){var _=Flotr._;function getEl(el){return el&&el.jquery?el[0]:el}Flotr.DOM={addClass:function(element,name){element=getEl(element);var classList=element.className?element.className:"";if(_.include(classList.split(/\s+/g),name))return;element.className=(classList?classList+" ":"")+name},create:function(tag){return document.createElement(tag)},node:function(html){var div=Flotr.DOM.create("div"),n;div.innerHTML=html;n=div.children[0];div.innerHTML="";return n},empty:function(element){element=getEl(element);element.innerHTML=""},remove:function(element){element=getEl(element);element.parentNode.removeChild(element)},hide:function(element){element=getEl(element);Flotr.DOM.setStyles(element,{display:"none"})},insert:function(element,child){element=getEl(element);if(_.isString(child))element.innerHTML+=child;else if(_.isElement(child))element.appendChild(child)},opacity:function(element,opacity){element=getEl(element);element.style.opacity=opacity},position:function(element,p){element=getEl(element);if(!element.offsetParent)return{left:element.offsetLeft||0,top:element.offsetTop||0};p=this.position(element.offsetParent);p.left+=element.offsetLeft;p.top+=element.offsetTop;return p},removeClass:function(element,name){var classList=element.className?element.className:"";element=getEl(element);element.className=_.filter(classList.split(/\s+/g),function(c){if(c!=name)return true}).join(" ")},setStyles:function(element,o){element=getEl(element);_.each(o,function(value,key){element.style[key]=value})},show:function(element){element=getEl(element);Flotr.DOM.setStyles(element,{display:""})},size:function(element){element=getEl(element);return{height:element.offsetHeight,width:element.offsetWidth}}}})();(function(){var F=Flotr,bean=F.bean;F.EventAdapter={observe:function(object,name,callback){bean.add(object,name,callback);return this},fire:function(object,name,args){bean.fire(object,name,args);if(typeof Prototype!="undefined")Event.fire(object,name,args);return this},stopObserving:function(object,name,callback){bean.remove(object,name,callback);return this},eventPointer:function(e){if(!F._.isUndefined(e.touches)&&e.touches.length>0){return{x:e.touches[0].pageX,y:e.touches[0].pageY}}else if(!F._.isUndefined(e.changedTouches)&&e.changedTouches.length>0){return{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}}else if(e.pageX||e.pageY){return{x:e.pageX,y:e.pageY}}else if(e.clientX||e.clientY){var d=document,b=d.body,de=d.documentElement;return{x:e.clientX+b.scrollLeft+de.scrollLeft,y:e.clientY+b.scrollTop+de.scrollTop}}}}})();(function(){var D=Flotr.DOM,E=Flotr.EventAdapter,_=Flotr._,flotr=Flotr;Graph=function(el,data,options){this._setEl(el);this._initMembers();this._initPlugins();E.fire(this.el,"flotr:beforeinit",[this]);this.data=data;this.series=flotr.Series.getSeries(data);this._initOptions(options);this._initGraphTypes();this._initCanvas();this._text=new flotr.Text({element:this.el,ctx:this.ctx,html:this.options.HtmlText,textEnabled:this.textEnabled});E.fire(this.el,"flotr:afterconstruct",[this]);this._initEvents();this.findDataRanges();this.calculateSpacing();this.draw(_.bind(function(){E.fire(this.el,"flotr:afterinit",[this])},this))};function observe(object,name,callback){E.observe.apply(this,arguments);this._handles.push(arguments);return this}Graph.prototype={destroy:function(){E.fire(this.el,"flotr:destroy");_.each(this._handles,function(handle){E.stopObserving.apply(this,handle)});this._handles=[];this.el.graph=null},observe:observe,_observe:observe,processColor:function(color,options){var o={x1:0,y1:0,x2:this.plotWidth,y2:this.plotHeight,opacity:1,ctx:this.ctx};_.extend(o,options);return flotr.Color.processColor(color,o)},findDataRanges:function(){var a=this.axes,xaxis,yaxis,range;_.each(this.series,function(series){range=series.getRange();if(range){xaxis=series.xaxis;yaxis=series.yaxis;xaxis.datamin=Math.min(range.xmin,xaxis.datamin);xaxis.datamax=Math.max(range.xmax,xaxis.datamax);yaxis.datamin=Math.min(range.ymin,yaxis.datamin);yaxis.datamax=Math.max(range.ymax,yaxis.datamax);xaxis.used=xaxis.used||range.xused;yaxis.used=yaxis.used||range.yused}},this);if(!a.x.used&&!a.x2.used)a.x.used=true;if(!a.y.used&&!a.y2.used)a.y.used=true;_.each(a,function(axis){axis.calculateRange()});var types=_.keys(flotr.graphTypes),drawn=false;_.each(this.series,function(series){if(series.hide)return;_.each(types,function(type){if(series[type]&&series[type].show){this.extendRange(type,series);drawn=true}},this);if(!drawn){this.extendRange(this.options.defaultType,series)}},this)},extendRange:function(type,series){if(this[type].extendRange)this[type].extendRange(series,series.data,series[type],this[type]);if(this[type].extendYRange)this[type].extendYRange(series.yaxis,series.data,series[type],this[type]);if(this[type].extendXRange)this[type].extendXRange(series.xaxis,series.data,series[type],this[type])},calculateSpacing:function(){var a=this.axes,options=this.options,series=this.series,margin=options.grid.labelMargin,T=this._text,x=a.x,x2=a.x2,y=a.y,y2=a.y2,maxOutset=options.grid.outlineWidth,i,j,l,dim;_.each(a,function(axis){axis.calculateTicks();axis.calculateTextDimensions(T,options)});dim=T.dimensions(options.title,{size:options.fontSize*1.5},"font-size:1em;font-weight:bold;","flotr-title");this.titleHeight=dim.height;dim=T.dimensions(options.subtitle,{size:options.fontSize},"font-size:smaller;","flotr-subtitle");this.subtitleHeight=dim.height;for(j=0;j<options.length;++j){if(series[j].points.show){maxOutset=Math.max(maxOutset,series[j].points.radius+series[j].points.lineWidth/2)}}var p=this.plotOffset;if(x.options.margin===false){p.bottom=0;p.top=0}else if(x.options.margin===true){p.bottom+=(options.grid.circular?0:x.used&&x.options.showLabels?x.maxLabel.height+margin:0)+(x.used&&x.options.title?x.titleSize.height+margin:0)+maxOutset;p.top+=(options.grid.circular?0:x2.used&&x2.options.showLabels?x2.maxLabel.height+margin:0)+(x2.used&&x2.options.title?x2.titleSize.height+margin:0)+this.subtitleHeight+this.titleHeight+maxOutset}else{p.bottom=x.options.margin;p.top=x.options.margin}if(y.options.margin===false){p.left=0;p.right=0}else if(y.options.margin===true){p.left+=(options.grid.circular?0:y.used&&y.options.showLabels?y.maxLabel.width+margin:0)+(y.used&&y.options.title?y.titleSize.width+margin:0)+maxOutset;p.right+=(options.grid.circular?0:y2.used&&y2.options.showLabels?y2.maxLabel.width+margin:0)+(y2.used&&y2.options.title?y2.titleSize.width+margin:0)+maxOutset}else{p.left=y.options.margin;p.right=y.options.margin}p.top=Math.floor(p.top);this.plotWidth=this.canvasWidth-p.left-p.right;this.plotHeight=this.canvasHeight-p.bottom-p.top;x.length=x2.length=this.plotWidth;y.length=y2.length=this.plotHeight;y.offset=y2.offset=this.plotHeight;x.setScale();x2.setScale();y.setScale();y2.setScale()},draw:function(after){var context=this.ctx,i;E.fire(this.el,"flotr:beforedraw",[this.series,this]);if(this.series.length){context.save();context.translate(this.plotOffset.left,this.plotOffset.top);for(i=0;i<this.series.length;i++){if(!this.series[i].hide)this.drawSeries(this.series[i])}context.restore();this.clip()}E.fire(this.el,"flotr:afterdraw",[this.series,this]);if(after)after()},drawSeries:function(series){function drawChart(series,typeKey){var options=this.getOptions(series,typeKey);this[typeKey].draw(options)}var drawn=false;series=series||this.series;_.each(flotr.graphTypes,function(type,typeKey){if(series[typeKey]&&series[typeKey].show&&this[typeKey]){drawn=true;drawChart.call(this,series,typeKey)}},this);if(!drawn)drawChart.call(this,series,this.options.defaultType)},getOptions:function(series,typeKey){var type=series[typeKey],graphType=this[typeKey],xaxis=series.xaxis,yaxis=series.yaxis,options={context:this.ctx,width:this.plotWidth,height:this.plotHeight,fontSize:this.options.fontSize,fontColor:this.options.fontColor,textEnabled:this.textEnabled,htmlText:this.options.HtmlText,text:this._text,element:this.el,data:series.data,color:series.color,shadowSize:series.shadowSize,xScale:xaxis.d2p,yScale:yaxis.d2p,xInverse:xaxis.p2d,yInverse:yaxis.p2d};options=flotr.merge(type,options);options.fillStyle=this.processColor(type.fillColor||series.color,{opacity:type.fillOpacity});return options},getEventPosition:function(e){var d=document,b=d.body,de=d.documentElement,axes=this.axes,plotOffset=this.plotOffset,lastMousePos=this.lastMousePos,pointer=E.eventPointer(e),dx=pointer.x-lastMousePos.pageX,dy=pointer.y-lastMousePos.pageY,r,rx,ry;if("ontouchstart"in this.el){r=D.position(this.overlay);rx=pointer.x-r.left-plotOffset.left;ry=pointer.y-r.top-plotOffset.top}else{r=this.overlay.getBoundingClientRect();rx=e.clientX-r.left-plotOffset.left-b.scrollLeft-de.scrollLeft;ry=e.clientY-r.top-plotOffset.top-b.scrollTop-de.scrollTop}return{x:axes.x.p2d(rx),x2:axes.x2.p2d(rx),y:axes.y.p2d(ry),y2:axes.y2.p2d(ry),relX:rx,relY:ry,dX:dx,dY:dy,absX:pointer.x,absY:pointer.y,pageX:pointer.x,pageY:pointer.y}},clickHandler:function(event){if(this.ignoreClick){this.ignoreClick=false;return this.ignoreClick}E.fire(this.el,"flotr:click",[this.getEventPosition(event),this])},mouseMoveHandler:function(event){if(this.mouseDownMoveHandler)return;var pos=this.getEventPosition(event);E.fire(this.el,"flotr:mousemove",[event,pos,this]);this.lastMousePos=pos},mouseDownHandler:function(event){if(this.mouseUpHandler)return;this.mouseUpHandler=_.bind(function(e){E.stopObserving(document,"mouseup",this.mouseUpHandler);E.stopObserving(document,"mousemove",this.mouseDownMoveHandler);this.mouseDownMoveHandler=null;this.mouseUpHandler=null;E.fire(this.el,"flotr:mouseup",[e,this])},this);this.mouseDownMoveHandler=_.bind(function(e){var pos=this.getEventPosition(e);E.fire(this.el,"flotr:mousemove",[event,pos,this]);this.lastMousePos=pos},this);E.observe(document,"mouseup",this.mouseUpHandler);E.observe(document,"mousemove",this.mouseDownMoveHandler);E.fire(this.el,"flotr:mousedown",[event,this]);this.ignoreClick=false},drawTooltip:function(content,x,y,options){var mt=this.getMouseTrack(),style="opacity:0.7;background-color:#000;color:#fff;display:none;position:absolute;padding:2px 8px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;",p=options.position,m=options.margin,plotOffset=this.plotOffset;if(x!==null&&y!==null){if(!options.relative){if(p.charAt(0)=="n")style+="top:"+(m+plotOffset.top)+"px;bottom:auto;";else if(p.charAt(0)=="s")style+="bottom:"+(m+plotOffset.bottom)+"px;top:auto;";if(p.charAt(1)=="e")style+="right:"+(m+plotOffset.right)+"px;left:auto;";else if(p.charAt(1)=="w")style+="left:"+(m+plotOffset.left)+"px;right:auto;"}else{if(p.charAt(0)=="n")style+="bottom:"+(m-plotOffset.top-y+this.canvasHeight)+"px;top:auto;";else if(p.charAt(0)=="s")style+="top:"+(m+plotOffset.top+y)+"px;bottom:auto;";if(p.charAt(1)=="e")style+="left:"+(m+plotOffset.left+x)+"px;right:auto;";else if(p.charAt(1)=="w")style+="right:"+(m-plotOffset.left-x+this.canvasWidth)+"px;left:auto;"}mt.style.cssText=style;D.empty(mt);D.insert(mt,content);D.show(mt)}else{D.hide(mt)}},clip:function(ctx){var o=this.plotOffset,w=this.canvasWidth,h=this.canvasHeight;ctx=ctx||this.ctx;if(flotr.isIE&&flotr.isIE<9&&!flotr.isFlashCanvas){if(ctx===this.octx){return}ctx.save();ctx.fillStyle=this.processColor(this.options.ieBackgroundColor);ctx.fillRect(0,0,w,o.top);ctx.fillRect(0,0,o.left,h);ctx.fillRect(0,h-o.bottom,w,o.bottom);ctx.fillRect(w-o.right,0,o.right,h);ctx.restore()}else{ctx.clearRect(0,0,w,o.top);ctx.clearRect(0,0,o.left,h);ctx.clearRect(0,h-o.bottom,w,o.bottom);ctx.clearRect(w-o.right,0,o.right,h)}},_initMembers:function(){this._handles=[];this.lastMousePos={pageX:null,pageY:null};this.plotOffset={left:0,right:0,top:0,bottom:0};this.ignoreClick=true;this.prevHit=null},_initGraphTypes:function(){_.each(flotr.graphTypes,function(handler,graphType){this[graphType]=flotr.clone(handler)},this)},_initEvents:function(){var el=this.el,touchendHandler,movement,touchend;if("ontouchstart"in el){touchendHandler=_.bind(function(e){touchend=true;E.stopObserving(document,"touchend",touchendHandler);E.fire(el,"flotr:mouseup",[event,this]);this.multitouches=null;if(!movement){this.clickHandler(e)}},this);this.observe(this.overlay,"touchstart",_.bind(function(e){movement=false;touchend=false;this.ignoreClick=false;if(e.touches&&e.touches.length>1){this.multitouches=e.touches}E.fire(el,"flotr:mousedown",[event,this]);this.observe(document,"touchend",touchendHandler)},this));this.observe(this.overlay,"touchmove",_.bind(function(e){var pos=this.getEventPosition(e);if(this.options.preventDefault){e.preventDefault()}movement=true;if(this.multitouches||e.touches&&e.touches.length>1){this.multitouches=e.touches}else{if(!touchend){E.fire(el,"flotr:mousemove",[event,pos,this])}}this.lastMousePos=pos},this))}else{this.observe(this.overlay,"mousedown",_.bind(this.mouseDownHandler,this)).observe(el,"mousemove",_.bind(this.mouseMoveHandler,this)).observe(this.overlay,"click",_.bind(this.clickHandler,this)).observe(el,"mouseout",function(e){E.fire(el,"flotr:mouseout",e)})}},_initCanvas:function(){var el=this.el,o=this.options,children=el.children,removedChildren=[],child,i,size,style;for(i=children.length;i--;){child=children[i];if(!this.canvas&&child.className==="flotr-canvas"){this.canvas=child}else if(!this.overlay&&child.className==="flotr-overlay"){this.overlay=child}else{removedChildren.push(child)}}for(i=removedChildren.length;i--;){el.removeChild(removedChildren[i])}D.setStyles(el,{position:"relative"});size={};size.width=el.clientWidth;size.height=el.clientHeight;if(size.width<=0||size.height<=0||o.resolution<=0){throw"Invalid dimensions for plot, width = "+size.width+", height = "+size.height+", resolution = "+o.resolution}this.canvas=getCanvas(this.canvas,"canvas");this.overlay=getCanvas(this.overlay,"overlay");this.ctx=getContext(this.canvas);this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.octx=getContext(this.overlay);this.octx.clearRect(0,0,this.overlay.width,this.overlay.height);this.canvasHeight=size.height;this.canvasWidth=size.width;this.textEnabled=!!this.ctx.drawText||!!this.ctx.fillText;function getCanvas(canvas,name){if(!canvas){canvas=D.create("canvas");if(typeof FlashCanvas!="undefined"&&typeof canvas.getContext==="function"){FlashCanvas.initElement(canvas);this.isFlashCanvas=true}canvas.className="flotr-"+name;canvas.style.cssText="position:absolute;left:0px;top:0px;";D.insert(el,canvas)}_.each(size,function(size,attribute){D.show(canvas);if(name=="canvas"&&canvas.getAttribute(attribute)===size){return}canvas.setAttribute(attribute,size*o.resolution);canvas.style[attribute]=size+"px"});canvas.context_=null;return canvas}function getContext(canvas){if(window.G_vmlCanvasManager)window.G_vmlCanvasManager.initElement(canvas);var context=canvas.getContext("2d");if(!window.G_vmlCanvasManager)context.scale(o.resolution,o.resolution);return context}},_initPlugins:function(){_.each(flotr.plugins,function(plugin,name){_.each(plugin.callbacks,function(fn,c){this.observe(this.el,c,_.bind(fn,this))},this);this[name]=flotr.clone(plugin);_.each(this[name],function(fn,p){if(_.isFunction(fn))this[name][p]=_.bind(fn,this)},this)},this)},_initOptions:function(opts){var options=flotr.clone(flotr.defaultOptions);options.x2axis=_.extend(_.clone(options.xaxis),options.x2axis);options.y2axis=_.extend(_.clone(options.yaxis),options.y2axis);this.options=flotr.merge(opts||{},options);if(this.options.grid.minorVerticalLines===null&&this.options.xaxis.scaling==="logarithmic"){this.options.grid.minorVerticalLines=true}if(this.options.grid.minorHorizontalLines===null&&this.options.yaxis.scaling==="logarithmic"){this.options.grid.minorHorizontalLines=true}E.fire(this.el,"flotr:afterinitoptions",[this]);this.axes=flotr.Axis.getAxes(this.options);var assignedColors=[],colors=[],ln=this.series.length,neededColors=this.series.length,oc=this.options.colors,usedColors=[],variation=0,c,i,j,s;for(i=neededColors-1;i>-1;--i){c=this.series[i].color;if(c){--neededColors;if(_.isNumber(c))assignedColors.push(c);else usedColors.push(flotr.Color.parse(c))}}for(i=assignedColors.length-1;i>-1;--i)neededColors=Math.max(neededColors,assignedColors[i]+1);for(i=0;colors.length<neededColors;){c=oc.length==i?new flotr.Color(100,100,100):flotr.Color.parse(oc[i]);var sign=variation%2==1?-1:1,factor=1+sign*Math.ceil(variation/2)*.2;c.scale(factor,factor,factor);colors.push(c);if(++i>=oc.length){i=0;++variation}}for(i=0,j=0;i<ln;++i){s=this.series[i];if(!s.color){s.color=colors[j++].toString()}else if(_.isNumber(s.color)){s.color=colors[s.color].toString()}if(!s.xaxis)s.xaxis=this.axes.x;if(s.xaxis==1)s.xaxis=this.axes.x;else if(s.xaxis==2)s.xaxis=this.axes.x2;if(!s.yaxis)s.yaxis=this.axes.y;if(s.yaxis==1)s.yaxis=this.axes.y;else if(s.yaxis==2)s.yaxis=this.axes.y2;for(var t in flotr.graphTypes){s[t]=_.extend(_.clone(this.options[t]),s[t])}s.mouse=_.extend(_.clone(this.options.mouse),s.mouse);if(_.isUndefined(s.shadowSize))s.shadowSize=this.options.shadowSize}},_setEl:function(el){if(!el)throw"The target container doesn't exist";else if(el.graph instanceof Graph)el.graph.destroy();else if(!el.clientWidth)throw"The target container must be visible";el.graph=this;this.el=el}};Flotr.Graph=Graph})();(function(){var _=Flotr._,LOGARITHMIC="logarithmic";function Axis(o){this.orientation=1;this.offset=0;this.datamin=Number.MAX_VALUE;this.datamax=-Number.MAX_VALUE;_.extend(this,o)}Axis.prototype={setScale:function(){var length=this.length,max=this.max,min=this.min,offset=this.offset,orientation=this.orientation,options=this.options,logarithmic=options.scaling===LOGARITHMIC,scale;if(logarithmic){scale=length/(log(max,options.base)-log(min,options.base))}else{scale=length/(max-min)}this.scale=scale;if(logarithmic){this.d2p=function(dataValue){return offset+orientation*(log(dataValue,options.base)-log(min,options.base))*scale};this.p2d=function(pointValue){return exp((offset+orientation*pointValue)/scale+log(min,options.base),options.base)}}else{this.d2p=function(dataValue){return offset+orientation*(dataValue-min)*scale};this.p2d=function(pointValue){return(offset+orientation*pointValue)/scale+min}}},calculateTicks:function(){var options=this.options;this.ticks=[];this.minorTicks=[];if(options.ticks){this._cleanUserTicks(options.ticks,this.ticks);this._cleanUserTicks(options.minorTicks||[],this.minorTicks)}else{if(options.mode=="time"){this._calculateTimeTicks()}else if(options.scaling==="logarithmic"){this._calculateLogTicks()}else{this._calculateTicks()}}_.each(this.ticks,function(tick){tick.label+=""});_.each(this.minorTicks,function(tick){tick.label+=""})},calculateRange:function(){if(!this.used)return;var axis=this,o=axis.options,min=o.min!==null?o.min:axis.datamin,max=o.max!==null?o.max:axis.datamax,margin=o.autoscaleMargin;if(o.scaling=="logarithmic"){if(min<=0)min=axis.datamin;if(max<=0)max=min}if(max==min){var widen=max?.01:1;if(o.min===null)min-=widen;if(o.max===null)max+=widen}if(o.scaling==="logarithmic"){if(min<0)min=max/o.base;var maxexp=Math.log(max);if(o.base!=Math.E)maxexp/=Math.log(o.base);maxexp=Math.ceil(maxexp);var minexp=Math.log(min);if(o.base!=Math.E)minexp/=Math.log(o.base);minexp=Math.ceil(minexp);axis.tickSize=Flotr.getTickSize(o.noTicks,minexp,maxexp,o.tickDecimals===null?0:o.tickDecimals);if(o.minorTickFreq===null){if(maxexp-minexp>10)o.minorTickFreq=0;else if(maxexp-minexp>5)o.minorTickFreq=2;else o.minorTickFreq=5}}else{axis.tickSize=Flotr.getTickSize(o.noTicks,min,max,o.tickDecimals)}axis.min=min;axis.max=max;if(o.min===null&&o.autoscale){axis.min-=axis.tickSize*margin;if(axis.min<0&&axis.datamin>=0)axis.min=0;axis.min=axis.tickSize*Math.floor(axis.min/axis.tickSize)}if(o.max===null&&o.autoscale){axis.max+=axis.tickSize*margin;if(axis.max>0&&axis.datamax<=0&&axis.datamax!=axis.datamin)axis.max=0;axis.max=axis.tickSize*Math.ceil(axis.max/axis.tickSize)}if(axis.min==axis.max)axis.max=axis.min+1},calculateTextDimensions:function(T,options){var maxLabel="",length,i;if(this.options.showLabels){for(i=0;i<this.ticks.length;++i){length=this.ticks[i].label.length;if(length>maxLabel.length){maxLabel=this.ticks[i].label}}}this.maxLabel=T.dimensions(maxLabel,{size:options.fontSize,angle:Flotr.toRad(this.options.labelsAngle)},"font-size:smaller;","flotr-grid-label");this.titleSize=T.dimensions(this.options.title,{size:options.fontSize*1.2,angle:Flotr.toRad(this.options.titleAngle)},"font-weight:bold;","flotr-axis-title")},_cleanUserTicks:function(ticks,axisTicks){var axis=this,options=this.options,v,i,label,tick;if(_.isFunction(ticks))ticks=ticks({min:axis.min,max:axis.max});for(i=0;i<ticks.length;++i){tick=ticks[i];if(typeof tick==="object"){v=tick[0];label=tick.length>1?tick[1]:options.tickFormatter(v,{min:axis.min,max:axis.max})}else{v=tick;label=options.tickFormatter(v,{min:this.min,max:this.max})}axisTicks[i]={v:v,label:label}}},_calculateTimeTicks:function(){this.ticks=Flotr.Date.generator(this)},_calculateLogTicks:function(){var axis=this,o=axis.options,v,decadeStart;var max=Math.log(axis.max);if(o.base!=Math.E)max/=Math.log(o.base);max=Math.ceil(max);var min=Math.log(axis.min);if(o.base!=Math.E)min/=Math.log(o.base);min=Math.ceil(min);for(i=min;i<max;i+=axis.tickSize){decadeStart=o.base==Math.E?Math.exp(i):Math.pow(o.base,i);var decadeEnd=decadeStart*(o.base==Math.E?Math.exp(axis.tickSize):Math.pow(o.base,axis.tickSize));var stepSize=(decadeEnd-decadeStart)/o.minorTickFreq;axis.ticks.push({v:decadeStart,label:o.tickFormatter(decadeStart,{min:axis.min,max:axis.max})});for(v=decadeStart+stepSize;v<decadeEnd;v+=stepSize)axis.minorTicks.push({v:v,label:o.tickFormatter(v,{min:axis.min,max:axis.max})})}decadeStart=o.base==Math.E?Math.exp(i):Math.pow(o.base,i);axis.ticks.push({v:decadeStart,label:o.tickFormatter(decadeStart,{min:axis.min,max:axis.max})})},_calculateTicks:function(){var axis=this,o=axis.options,tickSize=axis.tickSize,min=axis.min,max=axis.max,start=tickSize*Math.ceil(min/tickSize),decimals,minorTickSize,v,v2,i,j;if(o.minorTickFreq)minorTickSize=tickSize/o.minorTickFreq;for(i=0;(v=v2=start+i*tickSize)<=max;++i){decimals=o.tickDecimals;if(decimals===null)decimals=1-Math.floor(Math.log(tickSize)/Math.LN10);if(decimals<0)decimals=0;v=v.toFixed(decimals);axis.ticks.push({v:v,label:o.tickFormatter(v,{min:axis.min,max:axis.max})});if(o.minorTickFreq){for(j=0;j<o.minorTickFreq&&i*tickSize+j*minorTickSize<max;++j){v=v2+j*minorTickSize;axis.minorTicks.push({v:v,label:o.tickFormatter(v,{min:axis.min,max:axis.max})})}}}}};_.extend(Axis,{getAxes:function(options){return{x:new Axis({options:options.xaxis,n:1,length:this.plotWidth}),x2:new Axis({options:options.x2axis,n:2,length:this.plotWidth}),y:new Axis({options:options.yaxis,n:1,length:this.plotHeight,offset:this.plotHeight,orientation:-1}),y2:new Axis({options:options.y2axis,n:2,length:this.plotHeight,offset:this.plotHeight,orientation:-1})}}});function log(value,base){value=Math.log(Math.max(value,Number.MIN_VALUE));if(base!==Math.E)value/=Math.log(base);return value}function exp(value,base){return base===Math.E?Math.exp(value):Math.pow(base,value)}Flotr.Axis=Axis})();(function(){var _=Flotr._;function Series(o){_.extend(this,o)}Series.prototype={getRange:function(){var data=this.data,length=data.length,xmin=Number.MAX_VALUE,ymin=Number.MAX_VALUE,xmax=-Number.MAX_VALUE,ymax=-Number.MAX_VALUE,xused=false,yused=false,x,y,i;if(length<0||this.hide)return false;for(i=0;i<length;i++){x=data[i][0];y=data[i][1];if(x!==null){if(x<xmin){xmin=x;xused=true}if(x>xmax){xmax=x;xused=true}}if(y!==null){if(y<ymin){ymin=y;yused=true}if(y>ymax){ymax=y;yused=true}}}return{xmin:xmin,xmax:xmax,ymin:ymin,ymax:ymax,xused:xused,yused:yused}}};_.extend(Series,{getSeries:function(data){return _.map(data,function(s){var series;if(s.data){series=new Series;_.extend(series,s)}else{series=new Series({data:s})}return series})}});Flotr.Series=Series})();(function(){var F=Flotr,D=F.DOM,_=F._,Text=function(o){this.o=o};Text.prototype={dimensions:function(text,canvasStyle,htmlStyle,className){if(!text)return{width:0,height:0};return this.o.html?this.html(text,this.o.element,htmlStyle,className):this.canvas(text,canvasStyle)},canvas:function(text,style){if(!this.o.textEnabled)return;style=style||{};var metrics=this.measureText(text,style),width=metrics.width,height=style.size||F.defaultOptions.fontSize,angle=style.angle||0,cosAngle=Math.cos(angle),sinAngle=Math.sin(angle),widthPadding=2,heightPadding=6,bounds;bounds={width:Math.abs(cosAngle*width)+Math.abs(sinAngle*height)+widthPadding,height:Math.abs(sinAngle*width)+Math.abs(cosAngle*height)+heightPadding};return bounds},html:function(text,element,style,className){var div=D.create("div");D.setStyles(div,{position:"absolute",top:"-100000px"});D.insert(div,'<div style="'+style+'" class="'+className+' flotr-dummy-div">'+text+"</div>");
D.insert(this.o.element,div);return D.size(div)},measureText:function(text,style){var context=this.o.ctx,metrics;if(!context.fillText||F.isIphone&&context.measure){return{width:context.measure(text,style)}}style=_.extend({size:F.defaultOptions.fontSize,weight:1,angle:0},style);context.save();context.font=(style.weight>1?"bold ":"")+style.size*1.3+"px sans-serif";metrics=context.measureText(text);context.restore();return metrics}};Flotr.Text=Text})();Flotr.addType("lines",{options:{show:false,lineWidth:2,fill:false,fillBorder:false,fillColor:null,fillOpacity:.4,steps:false,stacked:false},stack:{values:[]},draw:function(options){var context=options.context,lineWidth=options.lineWidth,shadowSize=options.shadowSize,offset;context.save();context.lineJoin="round";if(shadowSize&&false){context.lineWidth=shadowSize/2;offset=lineWidth/2+context.lineWidth/2;context.strokeStyle="rgba(0,0,0,0.1)";this.plot(options,offset+shadowSize/2,false);context.strokeStyle="rgba(0,0,0,0.2)";this.plot(options,offset,false)}context.lineWidth=lineWidth;context.strokeStyle=options.color;this.plot(options,0,true);context.restore()},plot:function(options,shadowOffset,incStack){var context=options.context,width=options.width,height=options.height,xScale=options.xScale,yScale=options.yScale,data=options.data,stack=options.stacked?this.stack:false,length=data.length-1,prevx=null,prevy=null,zero=yScale(0),start=null,x1,x2,y1,y2,stack1,stack2,i;if(length<1)return;context.beginPath();for(i=0;i<length;++i){if(data[i][1]===null||data[i+1][1]===null){if(options.fill){if(i>0&&data[i][1]){context.stroke();fill();start=null;context.closePath();context.beginPath()}}continue}x1=xScale(data[i][0]);x2=xScale(data[i+1][0]);if(start===null)start=data[i];if(stack){stack1=stack.values[i]||0;stack2=stack.values[i+1]||0;y1=yScale(data[i][1]+stack1);y2=yScale(data[i+1][1]+stack2)}else{y1=yScale(data[i][1]);y2=yScale(data[i+1][1])}if(y1>height&&y2>height||y1<0&&y2<0||x1<0&&x2<0||x1>width&&x2>width)continue;if(prevx!=x1||prevy!=y1+shadowOffset)context.moveTo(x1,y1+shadowOffset);prevx=x2;prevy=y2+shadowOffset;if(options.steps){context.lineTo(prevx+shadowOffset/2,y1+shadowOffset);context.lineTo(prevx+shadowOffset/2,prevy)}else{context.lineTo(prevx,prevy)}}if(!options.fill||options.fill&&!options.fillBorder)context.stroke();fill();if(stack){for(i=0;i<length;++i){stack1=stack.values[i]||0;stack2=stack.values[i+1]||0;if(incStack){stack.values[i]=data[i][1]+stack1;if(i==length-1)stack.values[i+1]=data[i+1][1]+stack2}}}function drawPathRev(data){var j=null;for(j=length-1;j>=0;--j){if(!options.fill)return;if(!data[j])return;if(data[j][1]===null){data[j][1]=0}x=xScale(data[j][0]);y=yScale(data[j][1]);if(y<0)y=0;if(y>height||x>width||y<0||x<0)return;context.lineTo(x,y);context.stroke()}}function stackToPlot(values){var stack_data=[];var x_offset=data[0][0];for(i=0;i<values.length;++i){stack_data.push([i+x_offset,values[i]])}return stack_data}function fill(){if(!shadowOffset&&options.fill&&start){if(options.fillBorder){context.stroke()}x1=xScale(start[0]);context.fillStyle=options.fillStyle;if(!stack||stack.values.length===0){context.lineTo(x2,zero);context.lineTo(x1,zero);context.lineTo(x1,yScale(start[1]))}else{var stack_plot=stackToPlot(stack.values);stack_x1=xScale(stack_plot[0][0]);stack_y2=yScale(stack_plot[stack_plot.length-1][1]);context.lineTo(x2,stack_y2);drawPathRev(stack_plot);context.lineTo(stack_x1,yScale(data[0][1]))}context.fill()}}},extendYRange:function(axis,data,options,lines){var o=axis.options;if(options.stacked&&(!o.max&&o.max!==0||!o.min&&o.min!==0)){var newmax=axis.max,newmin=axis.min,positiveSums=lines.positiveSums||{},negativeSums=lines.negativeSums||{},x,j;for(j=0;j<data.length;j++){x=data[j][0]+"";if(data[j][1]>0){positiveSums[x]=(positiveSums[x]||0)+data[j][1];newmax=Math.max(newmax,positiveSums[x])}else{negativeSums[x]=(negativeSums[x]||0)+data[j][1];newmin=Math.min(newmin,negativeSums[x])}}lines.negativeSums=negativeSums;lines.positiveSums=positiveSums;axis.max=newmax;axis.min=newmin}if(options.steps){this.hit=function(options){var data=options.data,args=options.args,yScale=options.yScale,mouse=args[0],length=data.length,n=args[1],x=options.xInverse(mouse.relX),relY=mouse.relY,i;for(i=0;i<length-1;i++){if(x>=data[i][0]&&x<=data[i+1][0]){if(Math.abs(yScale(data[i][1])-relY)<8){n.x=data[i][0];n.y=data[i][1];n.index=i;n.seriesIndex=options.index}break}}};this.drawHit=function(options){var context=options.context,args=options.args,data=options.data,xScale=options.xScale,index=args.index,x=xScale(args.x),y=options.yScale(args.y),x2;if(data.length-1>index){x2=options.xScale(data[index+1][0]);context.save();context.strokeStyle=options.color;context.lineWidth=options.lineWidth;context.beginPath();context.moveTo(x,y);context.lineTo(x2,y);context.stroke();context.closePath();context.restore()}};this.clearHit=function(options){var context=options.context,args=options.args,data=options.data,xScale=options.xScale,width=options.lineWidth,index=args.index,x=xScale(args.x),y=options.yScale(args.y),x2;if(data.length-1>index){x2=options.xScale(data[index+1][0]);context.clearRect(x-width,y-width,x2-x+2*width,2*width)}}}}});Flotr.addType("bars",{options:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,fillOpacity:.4,horizontal:false,stacked:false,centered:true,topPadding:.1,grouped:false},stack:{positive:[],negative:[],_positive:[],_negative:[]},draw:function(options){var context=options.context;this.current+=1;context.save();context.lineJoin="miter";context.lineWidth=options.lineWidth;context.strokeStyle=options.color;if(options.fill)context.fillStyle=options.fillStyle;this.plot(options);context.restore()},plot:function(options){var data=options.data,context=options.context,shadowSize=options.shadowSize,i,geometry,left,top,width,height;if(data.length<1)return;this.translate(context,options.horizontal);for(i=0;i<data.length;i++){geometry=this.getBarGeometry(data[i][0],data[i][1],options);if(geometry===null)continue;left=geometry.left;top=geometry.top;width=geometry.width;height=geometry.height;if(options.fill)context.fillRect(left,top,width,height);if(shadowSize){context.save();context.fillStyle="rgba(0,0,0,0.05)";context.fillRect(left+shadowSize,top+shadowSize,width,height);context.restore()}if(options.lineWidth){context.strokeRect(left,top,width,height)}}},translate:function(context,horizontal){if(horizontal){context.rotate(-Math.PI/2);context.scale(-1,1)}},getBarGeometry:function(x,y,options){var horizontal=options.horizontal,barWidth=options.barWidth,centered=options.centered,stack=options.stacked?this.stack:false,lineWidth=options.lineWidth,bisection=centered?barWidth/2:0,xScale=horizontal?options.yScale:options.xScale,yScale=horizontal?options.xScale:options.yScale,xValue=horizontal?y:x,yValue=horizontal?x:y,stackOffset=0,stackValue,left,right,top,bottom;if(options.grouped){this.current/this.groups;xValue=xValue-bisection;barWidth=barWidth/this.groups;bisection=barWidth/2;xValue=xValue+barWidth*this.current-bisection}if(stack){stackValue=yValue>0?stack.positive:stack.negative;stackOffset=stackValue[xValue]||stackOffset;stackValue[xValue]=stackOffset+yValue}left=xScale(xValue-bisection);right=xScale(xValue+barWidth-bisection);top=yScale(yValue+stackOffset);bottom=yScale(stackOffset);if(bottom<0)bottom=0;return x===null||y===null?null:{x:xValue,y:yValue,xScale:xScale,yScale:yScale,top:top,left:Math.min(left,right)-lineWidth/2,width:Math.abs(right-left)-lineWidth,height:bottom-top}},hit:function(options){var data=options.data,args=options.args,mouse=args[0],n=args[1],x=options.xInverse(mouse.relX),y=options.yInverse(mouse.relY),hitGeometry=this.getBarGeometry(x,y,options),width=hitGeometry.width/2,left=hitGeometry.left,height=hitGeometry.y,geometry,i;for(i=data.length;i--;){geometry=this.getBarGeometry(data[i][0],data[i][1],options);if((height>0&&height<geometry.y||height<0&&height>geometry.y)&&Math.abs(left-geometry.left)<width){n.x=data[i][0];n.y=data[i][1];n.index=i;n.seriesIndex=options.index}}},drawHit:function(options){var context=options.context,args=options.args,geometry=this.getBarGeometry(args.x,args.y,options),left=geometry.left,top=geometry.top,width=geometry.width,height=geometry.height;context.save();context.strokeStyle=options.color;context.lineWidth=options.lineWidth;this.translate(context,options.horizontal);context.beginPath();context.moveTo(left,top+height);context.lineTo(left,top);context.lineTo(left+width,top);context.lineTo(left+width,top+height);if(options.fill){context.fillStyle=options.fillStyle;context.fill()}context.stroke();context.closePath();context.restore()},clearHit:function(options){var context=options.context,args=options.args,geometry=this.getBarGeometry(args.x,args.y,options),left=geometry.left,width=geometry.width,top=geometry.top,height=geometry.height,lineWidth=2*options.lineWidth;context.save();this.translate(context,options.horizontal);context.clearRect(left-lineWidth,Math.min(top,top+height)-lineWidth,width+2*lineWidth,Math.abs(height)+2*lineWidth);context.restore()},extendXRange:function(axis,data,options,bars){this._extendRange(axis,data,options,bars);this.groups=this.groups+1||1;this.current=0},extendYRange:function(axis,data,options,bars){this._extendRange(axis,data,options,bars)},_extendRange:function(axis,data,options,bars){var max=axis.options.max;if(_.isNumber(max)||_.isString(max))return;var newmin=axis.min,newmax=axis.max,horizontal=options.horizontal,orientation=axis.orientation,positiveSums=this.positiveSums||{},negativeSums=this.negativeSums||{},value,datum,index,j;if(orientation==1&&!horizontal||orientation==-1&&horizontal){if(options.centered){newmax=Math.max(axis.datamax+options.barWidth,newmax);newmin=Math.min(axis.datamin-options.barWidth,newmin)}}if(options.stacked&&(orientation==1&&horizontal||orientation==-1&&!horizontal)){for(j=data.length;j--;){value=data[j][orientation==1?1:0]+"";datum=data[j][orientation==1?0:1];if(datum>0){positiveSums[value]=(positiveSums[value]||0)+datum;newmax=Math.max(newmax,positiveSums[value])}else{negativeSums[value]=(negativeSums[value]||0)+datum;newmin=Math.min(newmin,negativeSums[value])}}}if(orientation==1&&horizontal||orientation==-1&&!horizontal){if(options.topPadding&&(axis.max===axis.datamax||options.stacked&&this.stackMax!==newmax)){newmax+=options.topPadding*(newmax-newmin)}}this.stackMin=newmin;this.stackMax=newmax;this.negativeSums=negativeSums;this.positiveSums=positiveSums;axis.max=newmax;axis.min=newmin}});Flotr.addType("bubbles",{options:{show:false,lineWidth:2,fill:true,fillOpacity:.4,baseRadius:2},draw:function(options){var context=options.context,shadowSize=options.shadowSize;context.save();context.lineWidth=options.lineWidth;context.fillStyle="rgba(0,0,0,0.05)";context.strokeStyle="rgba(0,0,0,0.05)";this.plot(options,shadowSize/2);context.strokeStyle="rgba(0,0,0,0.1)";this.plot(options,shadowSize/4);context.strokeStyle=options.color;context.fillStyle=options.fillStyle;this.plot(options);context.restore()},plot:function(options,offset){var data=options.data,context=options.context,geometry,i,x,y,z;offset=offset||0;for(i=0;i<data.length;++i){geometry=this.getGeometry(data[i],options);context.beginPath();context.arc(geometry.x+offset,geometry.y+offset,geometry.z,0,2*Math.PI,true);context.stroke();if(options.fill)context.fill();context.closePath()}},getGeometry:function(point,options){return{x:options.xScale(point[0]),y:options.yScale(point[1]),z:point[2]*options.baseRadius}},hit:function(options){var data=options.data,args=options.args,mouse=args[0],n=args[1],relX=mouse.relX,relY=mouse.relY,distance,geometry,dx,dy;n.best=n.best||Number.MAX_VALUE;for(i=data.length;i--;){geometry=this.getGeometry(data[i],options);dx=geometry.x-relX;dy=geometry.y-relY;distance=Math.sqrt(dx*dx+dy*dy);if(distance<geometry.z&&geometry.z<n.best){n.x=data[i][0];n.y=data[i][1];n.index=i;n.seriesIndex=options.index;n.best=geometry.z}}},drawHit:function(options){var context=options.context,geometry=this.getGeometry(options.data[options.args.index],options);context.save();context.lineWidth=options.lineWidth;context.fillStyle=options.fillStyle;context.strokeStyle=options.color;context.beginPath();context.arc(geometry.x,geometry.y,geometry.z,0,2*Math.PI,true);context.fill();context.stroke();context.closePath();context.restore()},clearHit:function(options){var context=options.context,geometry=this.getGeometry(options.data[options.args.index],options),offset=geometry.z+options.lineWidth;context.save();context.clearRect(geometry.x-offset,geometry.y-offset,2*offset,2*offset);context.restore()}});(function(){Flotr.defaultMarkerFormatter=function(obj){return Math.round(obj.y*100)/100+""};Flotr.addType("markers",{options:{show:false,lineWidth:1,color:"#000000",fill:false,fillColor:"#FFFFFF",fillOpacity:.4,stroke:false,position:"ct",verticalMargin:0,labelFormatter:Flotr.defaultMarkerFormatter,fontSize:Flotr.defaultOptions.fontSize,stacked:false,stackingType:"b",horizontal:false},stack:{positive:[],negative:[],values:[]},draw:function(options){var data=options.data,context=options.context,stack=options.stacked?options.stack:false,stackType=options.stackingType,stackOffsetNeg,stackOffsetPos,stackOffset,i,x,y,label;context.save();context.lineJoin="round";context.lineWidth=options.lineWidth;context.strokeStyle="rgba(0,0,0,0.5)";context.fillStyle=options.fillStyle;function stackPos(a,b){stackOffsetPos=stack.negative[a]||0;stackOffsetNeg=stack.positive[a]||0;if(b>0){stack.positive[a]=stackOffsetPos+b;return stackOffsetPos+b}else{stack.negative[a]=stackOffsetNeg+b;return stackOffsetNeg+b}}for(i=0;i<data.length;++i){x=data[i][0];y=data[i][1];if(stack){if(stackType=="b"){if(options.horizontal)y=stackPos(y,x);else x=stackPos(x,y)}else if(stackType=="a"){stackOffset=stack.values[x]||0;stack.values[x]=stackOffset+y;y=stackOffset+y}}label=options.labelFormatter({x:x,y:y,index:i,data:data});this.plot(options.xScale(x),options.yScale(y),label,options)}context.restore()},plot:function(x,y,label,options){var context=options.context;if(isImage(label)&&!label.complete){throw"Marker image not loaded."}else{this._plot(x,y,label,options)}},_plot:function(x,y,label,options){var context=options.context,margin=2,left=x,top=y,dim;if(isImage(label))dim={height:label.height,width:label.width};else dim=options.text.canvas(label);dim.width=Math.floor(dim.width+margin*2);dim.height=Math.floor(dim.height+margin*2);if(options.position.indexOf("c")!=-1)left-=dim.width/2+margin;else if(options.position.indexOf("l")!=-1)left-=dim.width;if(options.position.indexOf("m")!=-1)top-=dim.height/2+margin;else if(options.position.indexOf("t")!=-1)top-=dim.height+options.verticalMargin;else top+=options.verticalMargin;left=Math.floor(left)+.5;top=Math.floor(top)+.5;if(options.fill)context.fillRect(left,top,dim.width,dim.height);if(options.stroke)context.strokeRect(left,top,dim.width,dim.height);if(isImage(label))context.drawImage(label,parseInt(left+margin,10),parseInt(top+margin,10));else Flotr.drawText(context,label,left+margin,top+margin,{textBaseline:"top",textAlign:"left",size:options.fontSize,color:options.color})}});function isImage(i){return typeof i==="object"&&i.constructor&&(Image?true:i.constructor===Image)}})();(function(){var _=Flotr._;Flotr.defaultPieLabelFormatter=function(total,value){return(100*value/total).toFixed(2)+"%"};Flotr.addType("pie",{options:{show:false,lineWidth:1,fill:true,fillColor:null,fillOpacity:.6,explode:6,sizeRatio:.6,startAngle:Math.PI/4,labelFormatter:Flotr.defaultPieLabelFormatter,pie3D:false,pie3DviewAngle:Math.PI/2*.8,pie3DspliceThickness:20,epsilon:.1},draw:function(options){var data=options.data,context=options.context,canvas=context.canvas,lineWidth=options.lineWidth,shadowSize=options.shadowSize,sizeRatio=options.sizeRatio,height=options.height,width=options.width,explode=options.explode,color=options.color,fill=options.fill,fillStyle=options.fillStyle,radius=Math.min(canvas.width,canvas.height)*sizeRatio/2,value=data[0][1],html=[],vScale=1,measure=Math.PI*2*value/this.total,startAngle=this.startAngle||2*Math.PI*options.startAngle,endAngle=startAngle+measure,bisection=startAngle+measure/2,label=options.labelFormatter(this.total,value),explodeCoeff=explode+radius+4,distX=Math.cos(bisection)*explodeCoeff,distY=Math.sin(bisection)*explodeCoeff,textAlign=distX<0?"right":"left",textBaseline=distY>0?"top":"bottom",style,x,y;context.save();context.translate(width/2,height/2);context.scale(1,vScale);x=Math.cos(bisection)*explode;y=Math.sin(bisection)*explode;if(shadowSize>0){this.plotSlice(x+shadowSize,y+shadowSize,radius,startAngle,endAngle,context);if(fill){context.fillStyle="rgba(0,0,0,0.1)";context.fill()}}this.plotSlice(x,y,radius,startAngle,endAngle,context);if(fill){context.fillStyle=fillStyle;context.fill()}context.lineWidth=lineWidth;context.strokeStyle=color;context.stroke();style={size:options.fontSize*1.2,color:options.fontColor,weight:1.5};if(label){if(options.htmlText||!options.textEnabled){divStyle="position:absolute;"+textBaseline+":"+(height/2+(textBaseline==="top"?distY:-distY))+"px;";divStyle+=textAlign+":"+(width/2+(textAlign==="right"?-distX:distX))+"px;";html.push('<div style="',divStyle,'" class="flotr-grid-label">',label,"</div>")}else{style.textAlign=textAlign;style.textBaseline=textBaseline;Flotr.drawText(context,label,distX,distY,style)}}if(options.htmlText||!options.textEnabled){var div=Flotr.DOM.node('<div style="color:'+options.fontColor+'" class="flotr-labels"></div>');Flotr.DOM.insert(div,html.join(""));Flotr.DOM.insert(options.element,div)}context.restore();this.startAngle=endAngle;this.slices=this.slices||[];this.slices.push({radius:Math.min(canvas.width,canvas.height)*sizeRatio/2,x:x,y:y,explode:explode,start:startAngle,end:endAngle})},plotSlice:function(x,y,radius,startAngle,endAngle,context){context.beginPath();context.moveTo(x,y);context.arc(x,y,radius,startAngle,endAngle,false);context.lineTo(x,y);context.closePath()},hit:function(options){var data=options.data[0],args=options.args,index=options.index,mouse=args[0],n=args[1],slice=this.slices[index],x=mouse.relX-options.width/2,y=mouse.relY-options.height/2,r=Math.sqrt(x*x+y*y),theta=Math.atan(y/x),circle=Math.PI*2,explode=slice.explode||options.explode,start=slice.start%circle,end=slice.end%circle,epsilon=options.epsilon;if(x<0){theta+=Math.PI}else if(x>0&&y<0){theta+=circle}if(r<slice.radius+explode&&r>explode){if(theta>start&&theta<end||start>end&&(theta<end||theta>start)||start===end&&(slice.start===slice.end&&Math.abs(theta-start)<epsilon||slice.start!==slice.end&&Math.abs(theta-start)>epsilon)){n.x=data[0];n.y=data[1];n.sAngle=start;n.eAngle=end;n.index=0;n.seriesIndex=index;n.fraction=data[1]/this.total}}},drawHit:function(options){var context=options.context,slice=this.slices[options.args.seriesIndex];context.save();context.translate(options.width/2,options.height/2);this.plotSlice(slice.x,slice.y,slice.radius,slice.start,slice.end,context);context.stroke();context.restore()},clearHit:function(options){var context=options.context,slice=this.slices[options.args.seriesIndex],padding=2*options.lineWidth,radius=slice.radius+padding;context.save();context.translate(options.width/2,options.height/2);context.clearRect(slice.x-radius,slice.y-radius,2*radius+padding,2*radius+padding);context.restore()},extendYRange:function(axis,data){this.total=(this.total||0)+data[0][1]}})})();Flotr.addType("points",{options:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#FFFFFF",fillOpacity:1,hitRadius:null},draw:function(options){var context=options.context,lineWidth=options.lineWidth,shadowSize=options.shadowSize;context.save();if(shadowSize>0){context.lineWidth=shadowSize/2;context.strokeStyle="rgba(0,0,0,0.1)";this.plot(options,shadowSize/2+context.lineWidth/2);context.strokeStyle="rgba(0,0,0,0.2)";this.plot(options,context.lineWidth/2)}context.lineWidth=options.lineWidth;context.strokeStyle=options.color;if(options.fill)context.fillStyle=options.fillStyle;this.plot(options);context.restore()},plot:function(options,offset){var data=options.data,context=options.context,xScale=options.xScale,yScale=options.yScale,i,x,y;for(i=data.length-1;i>-1;--i){y=data[i][1];if(y===null)continue;x=xScale(data[i][0]);y=yScale(y);if(x<0||x>options.width||y<0||y>options.height)continue;context.beginPath();if(offset){context.arc(x,y+offset,options.radius,0,Math.PI,false)}else{context.arc(x,y,options.radius,0,2*Math.PI,true);if(options.fill)context.fill()}context.stroke();context.closePath()}}});Flotr.addType("radar",{options:{show:false,lineWidth:2,fill:true,fillOpacity:.4,radiusRatio:.9,sensibility:2},draw:function(options){var context=options.context,shadowSize=options.shadowSize;context.save();context.translate(options.width/2,options.height/2);context.lineWidth=options.lineWidth;context.fillStyle="rgba(0,0,0,0.05)";context.strokeStyle="rgba(0,0,0,0.05)";this.plot(options,shadowSize/2);context.strokeStyle="rgba(0,0,0,0.1)";this.plot(options,shadowSize/4);context.strokeStyle=options.color;context.fillStyle=options.fillStyle;this.plot(options);context.restore()},plot:function(options,offset){var data=options.data,context=options.context,radius=Math.min(options.height,options.width)*options.radiusRatio/2,step=2*Math.PI/data.length,angle=-Math.PI/2,i,ratio;offset=offset||0;context.beginPath();for(i=0;i<data.length;++i){ratio=data[i][1]/this.max;context[i===0?"moveTo":"lineTo"](Math.cos(i*step+angle)*radius*ratio+offset,Math.sin(i*step+angle)*radius*ratio+offset)}context.closePath();if(options.fill)context.fill();context.stroke()},getGeometry:function(point,options){var radius=Math.min(options.height,options.width)*options.radiusRatio/2,step=2*Math.PI/options.data.length,angle=-Math.PI/2,ratio=point[1]/this.max;return{x:Math.cos(point[0]*step+angle)*radius*ratio+options.width/2,y:Math.sin(point[0]*step+angle)*radius*ratio+options.height/2}},hit:function(options){var args=options.args,mouse=args[0],n=args[1],relX=mouse.relX,relY=mouse.relY,distance,geometry,dx,dy;for(var i=0;i<n.series.length;i++){var serie=n.series[i];var data=serie.data;for(var j=data.length;j--;){geometry=this.getGeometry(data[j],options);dx=geometry.x-relX;dy=geometry.y-relY;distance=Math.sqrt(dx*dx+dy*dy);if(distance<options.sensibility*2){n.x=data[j][0];n.y=data[j][1];n.index=j;n.seriesIndex=i;return n}}}},drawHit:function(options){var step=2*Math.PI/options.data.length;var angle=-Math.PI/2;var radius=Math.min(options.height,options.width)*options.radiusRatio/2;var s=options.args.series;var point_radius=s.points.hitRadius||s.points.radius||s.mouse.radius;var context=options.context;context.translate(options.width/2,options.height/2);var j=options.args.index;var ratio=options.data[j][1]/this.max;var x=Math.cos(j*step+angle)*radius*ratio;var y=Math.sin(j*step+angle)*radius*ratio;context.beginPath();context.arc(x,y,point_radius,0,2*Math.PI,true);context.closePath();context.stroke()},clearHit:function(options){var step=2*Math.PI/options.data.length;var angle=-Math.PI/2;var radius=Math.min(options.height,options.width)*options.radiusRatio/2;var context=options.context;var s=options.args.series,lw=s.points?s.points.lineWidth:1;offset=(s.points.hitRadius||s.points.radius||s.mouse.radius)+lw;context.translate(options.width/2,options.height/2);var j=options.args.index;var ratio=options.data[j][1]/this.max;var x=Math.cos(j*step+angle)*radius*ratio;var y=Math.sin(j*step+angle)*radius*ratio;context.clearRect(x-offset,y-offset,offset*2,offset*2)},extendYRange:function(axis,data){this.max=Math.max(axis.max,this.max||-Number.MAX_VALUE)}});(function(){function isLeftClick(e,type){return e.which?e.which===1:e.button===0||e.button===1}function boundX(x,graph){return Math.min(Math.max(0,x),graph.plotWidth-1)}function boundY(y,graph){return Math.min(Math.max(0,y),graph.plotHeight)}var D=Flotr.DOM,E=Flotr.EventAdapter,_=Flotr._;Flotr.addPlugin("selection",{options:{pinchOnly:null,mode:null,color:"#B6D9FF",fps:20},callbacks:{"flotr:mouseup":function(event){var options=this.options.selection,selection=this.selection,pointer=this.getEventPosition(event);if(!options||!options.mode)return;if(selection.interval)clearInterval(selection.interval);if(this.multitouches){selection.updateSelection()}else if(!options.pinchOnly){selection.setSelectionPos(selection.selection.second,pointer)}selection.clearSelection();if(selection.selecting&&selection.selectionIsSane()){selection.drawSelection();selection.fireSelectEvent();this.ignoreClick=true}},"flotr:mousedown":function(event){var options=this.options.selection,selection=this.selection,pointer=this.getEventPosition(event);if(!options||!options.mode)return;if(!options.mode||!isLeftClick(event)&&_.isUndefined(event.touches))return;if(!options.pinchOnly)selection.setSelectionPos(selection.selection.first,pointer);if(selection.interval)clearInterval(selection.interval);this.lastMousePos.pageX=null;selection.selecting=false;selection.interval=setInterval(_.bind(selection.updateSelection,this),1e3/options.fps)},"flotr:destroy":function(event){clearInterval(this.selection.interval)}},getArea:function(){var s=this.selection.selection,a=this.axes,first=s.first,second=s.second,x1,x2,y1,y2;x1=a.x.p2d(s.first.x);x2=a.x.p2d(s.second.x);y1=a.y.p2d(s.first.y);y2=a.y.p2d(s.second.y);return{x1:Math.min(x1,x2),y1:Math.min(y1,y2),x2:Math.max(x1,x2),y2:Math.max(y1,y2),xfirst:x1,xsecond:x2,yfirst:y1,ysecond:y2}},selection:{first:{x:-1,y:-1},second:{x:-1,y:-1}},prevSelection:null,interval:null,fireSelectEvent:function(name){var area=this.selection.getArea();name=name||"select";area.selection=this.selection.selection;E.fire(this.el,"flotr:"+name,[area,this])},setSelection:function(area,preventEvent){var options=this.options,xa=this.axes.x,ya=this.axes.y,vertScale=ya.scale,hozScale=xa.scale,selX=options.selection.mode.indexOf("x")!=-1,selY=options.selection.mode.indexOf("y")!=-1,s=this.selection.selection;this.selection.clearSelection();s.first.y=boundY(selX&&!selY?0:(ya.max-area.y1)*vertScale,this);s.second.y=boundY(selX&&!selY?this.plotHeight-1:(ya.max-area.y2)*vertScale,this);s.first.x=boundX(selY&&!selX?0:(area.x1-xa.min)*hozScale,this);s.second.x=boundX(selY&&!selX?this.plotWidth:(area.x2-xa.min)*hozScale,this);this.selection.drawSelection();if(!preventEvent)this.selection.fireSelectEvent()},setSelectionPos:function(pos,pointer){var mode=this.options.selection.mode,selection=this.selection.selection;if(mode.indexOf("x")==-1){pos.x=pos==selection.first?0:this.plotWidth}else{pos.x=boundX(pointer.relX,this)}if(mode.indexOf("y")==-1){pos.y=pos==selection.first?0:this.plotHeight-1}else{pos.y=boundY(pointer.relY,this)}},drawSelection:function(){this.selection.fireSelectEvent("selecting");var s=this.selection.selection,octx=this.octx,options=this.options,plotOffset=this.plotOffset,prevSelection=this.selection.prevSelection;if(prevSelection&&s.first.x==prevSelection.first.x&&s.first.y==prevSelection.first.y&&s.second.x==prevSelection.second.x&&s.second.y==prevSelection.second.y){return}octx.save();octx.strokeStyle=this.processColor(options.selection.color,{opacity:.8});octx.lineWidth=1;octx.lineJoin="miter";octx.fillStyle=this.processColor(options.selection.color,{opacity:.4});this.selection.prevSelection={first:{x:s.first.x,y:s.first.y},second:{x:s.second.x,y:s.second.y}};var x=Math.min(s.first.x,s.second.x),y=Math.min(s.first.y,s.second.y),w=Math.abs(s.second.x-s.first.x),h=Math.abs(s.second.y-s.first.y);octx.fillRect(x+plotOffset.left+.5,y+plotOffset.top+.5,w,h);octx.strokeRect(x+plotOffset.left+.5,y+plotOffset.top+.5,w,h);octx.restore()},updateSelection:function(){if(!this.lastMousePos.pageX)return;this.selection.selecting=true;if(this.multitouches){this.selection.setSelectionPos(this.selection.selection.first,this.getEventPosition(this.multitouches[0]));this.selection.setSelectionPos(this.selection.selection.second,this.getEventPosition(this.multitouches[1]))}else if(this.options.selection.pinchOnly){return}else{this.selection.setSelectionPos(this.selection.selection.second,this.lastMousePos)}this.selection.clearSelection();if(this.selection.selectionIsSane()){this.selection.drawSelection()}},clearSelection:function(){if(!this.selection.prevSelection)return;var prevSelection=this.selection.prevSelection,lw=1,plotOffset=this.plotOffset,x=Math.min(prevSelection.first.x,prevSelection.second.x),y=Math.min(prevSelection.first.y,prevSelection.second.y),w=Math.abs(prevSelection.second.x-prevSelection.first.x),h=Math.abs(prevSelection.second.y-prevSelection.first.y);this.octx.clearRect(x+plotOffset.left-lw+.5,y+plotOffset.top-lw,w+2*lw+.5,h+2*lw+.5);this.selection.prevSelection=null},selectionIsSane:function(){var s=this.selection.selection;return Math.abs(s.second.x-s.first.x)>=5||Math.abs(s.second.y-s.first.y)>=5}})})();(function(){var D=Flotr.DOM,_=Flotr._;Flotr.addPlugin("legend",{options:{show:true,noColumns:1,labelFormatter:function(v){return v},labelBoxBorderColor:"#CCCCCC",labelBoxWidth:14,labelBoxHeight:10,labelBoxMargin:5,container:null,position:"nw",margin:5,backgroundColor:"#F0F0F0",backgroundOpacity:.85},callbacks:{"flotr:afterinit":function(){this.legend.insertLegend()},"flotr:destroy":function(){var markup=this.legend.markup;if(markup){this.legend.markup=null;D.remove(markup)}}},insertLegend:function(){if(!this.options.legend.show)return;var series=this.series,plotOffset=this.plotOffset,options=this.options,legend=options.legend,fragments=[],rowStarted=false,ctx=this.ctx,itemCount=_.filter(series,function(s){return s.label&&!s.hide}).length,p=legend.position,m=legend.margin,opacity=legend.backgroundOpacity,i,label,color;if(itemCount){var lbw=legend.labelBoxWidth,lbh=legend.labelBoxHeight,lbm=legend.labelBoxMargin,offsetX=plotOffset.left+m,offsetY=plotOffset.top+m,labelMaxWidth=0,style={size:options.fontSize*1.1,color:options.grid.color};for(i=series.length-1;i>-1;--i){if(!series[i].label||series[i].hide)continue;label=legend.labelFormatter(series[i].label);labelMaxWidth=Math.max(labelMaxWidth,this._text.measureText(label,style).width)}var legendWidth=Math.round(lbw+lbm*3+labelMaxWidth),legendHeight=Math.round(itemCount*(lbm+lbh)+lbm);if(!opacity&&opacity!==0){opacity=.1}if(!options.HtmlText&&this.textEnabled&&!legend.container){if(p.charAt(0)=="s")offsetY=plotOffset.top+this.plotHeight-(m+legendHeight);if(p.charAt(0)=="c")offsetY=plotOffset.top+this.plotHeight/2-(m+legendHeight/2);if(p.charAt(1)=="e")offsetX=plotOffset.left+this.plotWidth-(m+legendWidth);color=this.processColor(legend.backgroundColor,{opacity:opacity});ctx.fillStyle=color;ctx.fillRect(offsetX,offsetY,legendWidth,legendHeight);ctx.strokeStyle=legend.labelBoxBorderColor;ctx.strokeRect(Flotr.toPixel(offsetX),Flotr.toPixel(offsetY),legendWidth,legendHeight);var x=offsetX+lbm;var y=offsetY+lbm;for(i=0;i<series.length;i++){if(!series[i].label||series[i].hide)continue;label=legend.labelFormatter(series[i].label);ctx.fillStyle=series[i].color;ctx.fillRect(x,y,lbw-1,lbh-1);ctx.strokeStyle=legend.labelBoxBorderColor;ctx.lineWidth=1;ctx.strokeRect(Math.ceil(x)-1.5,Math.ceil(y)-1.5,lbw+2,lbh+2);Flotr.drawText(ctx,label,x+lbw+lbm,y+lbh,style);y+=lbh+lbm}}else{for(i=0;i<series.length;++i){if(!series[i].label||series[i].hide)continue;if(i%legend.noColumns===0){fragments.push(rowStarted?"</tr><tr>":"<tr>");rowStarted=true}var s=series[i],boxWidth=legend.labelBoxWidth,boxHeight=legend.labelBoxHeight;label=legend.labelFormatter(s.label);color="background-color:"+(s.bars&&s.bars.show&&s.bars.fillColor&&s.bars.fill?s.bars.fillColor:s.color)+";";fragments.push('<td class="flotr-legend-color-box">','<div style="border:1px solid ',legend.labelBoxBorderColor,';padding:1px">','<div style="width:',boxWidth-1,"px;height:",boxHeight-1,"px;border:1px solid ",series[i].color,'">','<div style="width:',boxWidth,"px;height:",boxHeight,"px;",color,'"></div>',"</div>","</div>","</td>",'<td class="flotr-legend-label">',label,"</td>")}if(rowStarted)fragments.push("</tr>");if(fragments.length>0){var table='<table style="font-size:smaller;color:'+options.grid.color+'">'+fragments.join("")+"</table>";
if(legend.container){table=D.node(table);this.legend.markup=table;D.insert(legend.container,table)}else{var styles={position:"absolute",zIndex:"2",border:"1px solid "+legend.labelBoxBorderColor};if(p.charAt(0)=="n"){styles.top=m+plotOffset.top+"px";styles.bottom="auto"}else if(p.charAt(0)=="c"){styles.top=m+(this.plotHeight-legendHeight)/2+"px";styles.bottom="auto"}else if(p.charAt(0)=="s"){styles.bottom=m+plotOffset.bottom+"px";styles.top="auto"}if(p.charAt(1)=="e"){styles.right=m+plotOffset.right+"px";styles.left="auto"}else if(p.charAt(1)=="w"){styles.left=m+plotOffset.left+"px";styles.right="auto"}var div=D.create("div"),size;div.className="flotr-legend";D.setStyles(div,styles);D.insert(div,table);D.insert(this.el,div);if(!opacity)return;var c=legend.backgroundColor||options.grid.backgroundColor||"#ffffff";_.extend(styles,D.size(div),{backgroundColor:c,zIndex:"",border:""});styles.width+="px";styles.height+="px";div=D.create("div");div.className="flotr-legend-bg";D.setStyles(div,styles);D.opacity(div,opacity);D.insert(div," ");D.insert(this.el,div)}}}}}})})();(function(){var D=Flotr.DOM,_=Flotr._,flotr=Flotr,S_MOUSETRACK="opacity:0.7;background-color:#000;color:#fff;position:absolute;padding:2px 8px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;";Flotr.addPlugin("hit",{callbacks:{"flotr:mousemove":function(e,pos){this.hit.track(pos)},"flotr:click":function(pos){var hit=this.hit.track(pos);if(hit&&!_.isUndefined(hit.index))pos.hit=hit},"flotr:mouseout":function(e){if(e.relatedTarget!==this.mouseTrack){this.hit.clearHit()}},"flotr:destroy":function(){if(this.options.mouse.container){D.remove(this.mouseTrack)}this.mouseTrack=null}},track:function(pos){if(this.options.mouse.track||_.any(this.series,function(s){return s.mouse&&s.mouse.track})){return this.hit.hit(pos)}},executeOnType:function(s,method,args){var success=false,options;if(!_.isArray(s))s=[s];function e(s,index){_.each(_.keys(flotr.graphTypes),function(type){if(s[type]&&s[type].show&&this[type][method]){options=this.getOptions(s,type);options.fill=!!s.mouse.fillColor;options.fillStyle=this.processColor(s.mouse.fillColor||"#ffffff",{opacity:s.mouse.fillOpacity});options.color=s.mouse.lineColor;options.context=this.octx;options.index=index;if(args)options.args=args;this[type][method].call(this[type],options);success=true}},this)}_.each(s,e,this);return success},drawHit:function(n){var octx=this.octx,s=n.series;if(s.mouse.lineColor){octx.save();octx.lineWidth=s.points?s.points.lineWidth:1;octx.strokeStyle=s.mouse.lineColor;octx.fillStyle=this.processColor(s.mouse.fillColor||"#ffffff",{opacity:s.mouse.fillOpacity});octx.translate(this.plotOffset.left,this.plotOffset.top);if(!this.hit.executeOnType(s,"drawHit",n)){var xa=n.xaxis,ya=n.yaxis;octx.beginPath();octx.arc(xa.d2p(n.x),ya.d2p(n.y),s.points.hitRadius||s.points.radius||s.mouse.radius,0,2*Math.PI,true);octx.fill();octx.stroke();octx.closePath()}octx.restore();this.clip(octx)}this.prevHit=n},clearHit:function(){var prev=this.prevHit,octx=this.octx,plotOffset=this.plotOffset;octx.save();octx.translate(plotOffset.left,plotOffset.top);if(prev){if(!this.hit.executeOnType(prev.series,"clearHit",this.prevHit)){var s=prev.series,lw=s.points?s.points.lineWidth:1;offset=(s.points.hitRadius||s.points.radius||s.mouse.radius)+lw;octx.clearRect(prev.xaxis.d2p(prev.x)-offset,prev.yaxis.d2p(prev.y)-offset,offset*2,offset*2)}D.hide(this.mouseTrack);this.prevHit=null}octx.restore()},hit:function(mouse){var options=this.options,prevHit=this.prevHit,closest,sensibility,dataIndex,seriesIndex,series,value,xaxis,yaxis,n;if(this.series.length===0)return;n={relX:mouse.relX,relY:mouse.relY,absX:mouse.absX,absY:mouse.absY,series:this.series};if(options.mouse.trackY&&!options.mouse.trackAll&&this.hit.executeOnType(this.series,"hit",[mouse,n])&&!_.isUndefined(n.seriesIndex)){series=this.series[n.seriesIndex];n.series=series;n.mouse=series.mouse;n.xaxis=series.xaxis;n.yaxis=series.yaxis}else{closest=this.hit.closest(mouse);if(closest){closest=options.mouse.trackY?closest.point:closest.x;seriesIndex=closest.seriesIndex;series=this.series[seriesIndex];xaxis=series.xaxis;yaxis=series.yaxis;sensibility=2*series.mouse.sensibility;if(options.mouse.trackAll||closest.distanceX<sensibility/xaxis.scale&&(!options.mouse.trackY||closest.distanceY<sensibility/yaxis.scale)){n.series=series;n.xaxis=series.xaxis;n.yaxis=series.yaxis;n.mouse=series.mouse;n.x=closest.x;n.y=closest.y;n.dist=closest.distance;n.index=closest.dataIndex;n.seriesIndex=seriesIndex}}}if(!prevHit||prevHit.index!==n.index||prevHit.seriesIndex!==n.seriesIndex){this.hit.clearHit();if(n.series&&n.mouse&&n.mouse.track){this.hit.drawMouseTrack(n);this.hit.drawHit(n);Flotr.EventAdapter.fire(this.el,"flotr:hit",[n,this])}}return n},closest:function(mouse){var series=this.series,options=this.options,relX=mouse.relX,relY=mouse.relY,compare=Number.MAX_VALUE,compareX=Number.MAX_VALUE,closest={},closestX={},check=false,serie,data,distance,distanceX,distanceY,mouseX,mouseY,x,y,i,j;function setClosest(o){o.distance=distance;o.distanceX=distanceX;o.distanceY=distanceY;o.seriesIndex=i;o.dataIndex=j;o.x=x;o.y=y;check=true}for(i=0;i<series.length;i++){serie=series[i];data=serie.data;mouseX=serie.xaxis.p2d(relX);mouseY=serie.yaxis.p2d(relY);for(j=data.length;j--;){x=data[j][0];y=data[j][1];if(x===null||y===null)continue;if(x<serie.xaxis.min||x>serie.xaxis.max)continue;distanceX=Math.abs(x-mouseX);distanceY=Math.abs(y-mouseY);distance=distanceX*distanceX+distanceY*distanceY;if(distance<compare){compare=distance;setClosest(closest)}if(distanceX<compareX){compareX=distanceX;setClosest(closestX)}}}return check?{point:closest,x:closestX}:false},drawMouseTrack:function(n){var pos="",s=n.series,p=n.mouse.position,m=n.mouse.margin,x=n.x,y=n.y,elStyle=S_MOUSETRACK,mouseTrack=this.mouseTrack,plotOffset=this.plotOffset,left=plotOffset.left,right=plotOffset.right,bottom=plotOffset.bottom,top=plotOffset.top,decimals=n.mouse.trackDecimals,options=this.options,container=options.mouse.container,oTop=0,oLeft=0,offset,size,content;if(!mouseTrack){mouseTrack=D.node('<div class="flotr-mouse-value" style="'+elStyle+'"></div>');this.mouseTrack=mouseTrack;D.insert(container||this.el,mouseTrack)}if(!decimals||decimals<0)decimals=0;if(x&&x.toFixed)x=x.toFixed(decimals);if(y&&y.toFixed)y=y.toFixed(decimals);content=n.mouse.trackFormatter({x:x,y:y,series:n.series,index:n.index,nearest:n,fraction:n.fraction});if(_.isNull(content)||_.isUndefined(content)){D.hide(mouseTrack);return}else{mouseTrack.innerHTML=content;D.show(mouseTrack)}if(container)return;size=D.size(mouseTrack);if(container){offset=D.position(this.el);oTop=offset.top;oLeft=offset.left}if(!n.mouse.relative){pos+="top:";if(p.charAt(0)=="n")pos+=oTop+m+top;else if(p.charAt(0)=="s")pos+=oTop-m+top+this.plotHeight-size.height;pos+="px;bottom:auto;left:";if(p.charAt(1)=="e")pos+=oLeft-m+left+this.plotWidth-size.width;else if(p.charAt(1)=="w")pos+=oLeft+m+left;pos+="px;right:auto;"}else if(s.pie&&s.pie.show){var center={x:this.plotWidth/2,y:this.plotHeight/2},radius=Math.min(this.canvasWidth,this.canvasHeight)*s.pie.sizeRatio/2,bisection=n.sAngle<n.eAngle?(n.sAngle+n.eAngle)/2:(n.sAngle+n.eAngle+2*Math.PI)/2;pos+="bottom:"+(m-top-center.y-Math.sin(bisection)*radius/2+this.canvasHeight)+"px;top:auto;";pos+="left:"+(m+left+center.x+Math.cos(bisection)*radius/2)+"px;right:auto;"}else{pos+="top:";if(/n/.test(p))pos+=oTop-m+top+n.yaxis.d2p(n.y)-size.height;else pos+=oTop+m+top+n.yaxis.d2p(n.y);pos+="px;bottom:auto;left:";if(/w/.test(p))pos+=oLeft-m+left+n.xaxis.d2p(n.x)-size.width;else pos+=oLeft+m+left+n.xaxis.d2p(n.x);pos+="px;right:auto;"}mouseTrack.style.cssText=elStyle+pos;if(n.mouse.relative){if(!/[ew]/.test(p)){mouseTrack.style.left=oLeft+left+n.xaxis.d2p(n.x)-D.size(mouseTrack).width/2+"px"}else if(!/[ns]/.test(p)){mouseTrack.style.top=oTop+top+n.yaxis.d2p(n.y)-D.size(mouseTrack).height/2+"px"}}}})})();(function(){var D=Flotr.DOM;Flotr.addPlugin("labels",{callbacks:{"flotr:afterdraw":function(){this.labels.draw()}},draw:function(){var axis,tick,left,top,xBoxWidth,radius,sides,coeff,angle,div,i,html="",noLabels=0,options=this.options,ctx=this.ctx,a=this.axes,style={size:options.fontSize};for(i=0;i<a.x.ticks.length;++i){if(a.x.ticks[i].label){++noLabels}}xBoxWidth=this.plotWidth/noLabels;if(options.grid.circular){ctx.save();ctx.translate(this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+this.plotHeight/2);radius=this.plotHeight*options.radar.radiusRatio/2+options.fontSize;sides=this.axes.x.ticks.length;coeff=2*(Math.PI/sides);angle=-Math.PI/2;drawLabelCircular(this,a.x,false);drawLabelCircular(this,a.x,true);drawLabelCircular(this,a.y,false);drawLabelCircular(this,a.y,true);ctx.restore()}if(!options.HtmlText&&this.textEnabled){drawLabelNoHtmlText(this,a.x,"center","top");drawLabelNoHtmlText(this,a.x2,"center","bottom");drawLabelNoHtmlText(this,a.y,"right","middle");drawLabelNoHtmlText(this,a.y2,"left","middle")}else if((a.x.options.showLabels||a.x2.options.showLabels||a.y.options.showLabels||a.y2.options.showLabels)&&!options.grid.circular){html="";drawLabelHtml(this,a.x);drawLabelHtml(this,a.x2);drawLabelHtml(this,a.y);drawLabelHtml(this,a.y2);ctx.stroke();ctx.restore();div=D.create("div");D.setStyles(div,{fontSize:"smaller",color:options.grid.color});div.className="flotr-labels";D.insert(this.el,div);D.insert(div,html)}function drawLabelCircular(graph,axis,minorTicks){var ticks=minorTicks?axis.minorTicks:axis.ticks,isX=axis.orientation===1,isFirst=axis.n===1,style,offset;style={color:axis.options.color||options.grid.color,angle:Flotr.toRad(axis.options.labelsAngle),textBaseline:"middle"};for(i=0;i<ticks.length&&(minorTicks?axis.options.showMinorLabels:axis.options.showLabels);++i){tick=ticks[i];tick.label+="";if(!tick.label||!tick.label.length){continue}x=Math.cos(i*coeff+angle)*radius;y=Math.sin(i*coeff+angle)*radius;style.textAlign=isX?Math.abs(x)<.1?"center":x<0?"right":"left":"left";Flotr.drawText(ctx,tick.label,isX?x:3,isX?y:-(axis.ticks[i].v/axis.max)*(radius-options.fontSize),style)}}function drawLabelNoHtmlText(graph,axis,textAlign,textBaseline){var isX=axis.orientation===1,isFirst=axis.n===1,style,offset;style={color:axis.options.color||options.grid.color,textAlign:textAlign,textBaseline:textBaseline,angle:Flotr.toRad(axis.options.labelsAngle)};style=Flotr.getBestTextAlign(style.angle,style);for(i=0;i<axis.ticks.length&&continueShowingLabels(axis);++i){tick=axis.ticks[i];if(!tick.label||!tick.label.length){continue}offset=axis.d2p(tick.v);if(offset<0||offset>(isX?graph.plotWidth:graph.plotHeight)){continue}Flotr.drawText(ctx,tick.label,leftOffset(graph,isX,isFirst,offset),topOffset(graph,isX,isFirst,offset),style);if(!isX&&!isFirst){ctx.save();ctx.strokeStyle=style.color;ctx.beginPath();ctx.moveTo(graph.plotOffset.left+graph.plotWidth-8,graph.plotOffset.top+axis.d2p(tick.v));ctx.lineTo(graph.plotOffset.left+graph.plotWidth,graph.plotOffset.top+axis.d2p(tick.v));ctx.stroke();ctx.restore()}}function continueShowingLabels(axis){return axis.options.showLabels&&axis.used}function leftOffset(graph,isX,isFirst,offset){return graph.plotOffset.left+(isX?offset:isFirst?-options.grid.labelMargin:options.grid.labelMargin+graph.plotWidth)}function topOffset(graph,isX,isFirst,offset){return graph.plotOffset.top+(isX?options.grid.labelMargin:offset)+(isX&&isFirst?graph.plotHeight:0)}}function drawLabelHtml(graph,axis){var isX=axis.orientation===1,isFirst=axis.n===1,name="",left,style,top,offset=graph.plotOffset;if(!isX&&!isFirst){ctx.save();ctx.strokeStyle=axis.options.color||options.grid.color;ctx.beginPath()}if(axis.options.showLabels&&(isFirst?true:axis.used)){for(i=0;i<axis.ticks.length;++i){tick=axis.ticks[i];if(!tick.label||!tick.label.length||(isX?offset.left:offset.top)+axis.d2p(tick.v)<0||(isX?offset.left:offset.top)+axis.d2p(tick.v)>(isX?graph.canvasWidth:graph.canvasHeight)){continue}top=offset.top+(isX?(isFirst?1:-1)*(graph.plotHeight+options.grid.labelMargin):axis.d2p(tick.v)-axis.maxLabel.height/2);left=isX?offset.left+axis.d2p(tick.v)-xBoxWidth/2:0;name="";if(i===0){name=" first"}else if(i===axis.ticks.length-1){name=" last"}name+=isX?" flotr-grid-label-x":" flotr-grid-label-y";html+=['<div style="position:absolute; text-align:'+(isX?"center":"right")+"; ","top:"+top+"px; ",(!isX&&!isFirst?"right:":"left:")+left+"px; ","width:"+(isX?xBoxWidth:(isFirst?offset.left:offset.right)-options.grid.labelMargin)+"px; ",axis.options.color?"color:"+axis.options.color+"; ":" ",'" class="flotr-grid-label'+name+'">'+tick.label+"</div>"].join(" ");if(!isX&&!isFirst){ctx.moveTo(offset.left+graph.plotWidth-8,offset.top+axis.d2p(tick.v));ctx.lineTo(offset.left+graph.plotWidth,offset.top+axis.d2p(tick.v))}}}}}})})();(function(){var D=Flotr.DOM,_=Flotr._;Flotr.addPlugin("legend",{options:{show:true,noColumns:1,labelFormatter:function(v){return v},labelBoxBorderColor:"#CCCCCC",labelBoxWidth:14,labelBoxHeight:10,labelBoxMargin:5,container:null,position:"nw",margin:5,backgroundColor:"#F0F0F0",backgroundOpacity:.85},callbacks:{"flotr:afterinit":function(){this.legend.insertLegend()},"flotr:destroy":function(){var markup=this.legend.markup;if(markup){this.legend.markup=null;D.remove(markup)}}},insertLegend:function(){if(!this.options.legend.show)return;var series=this.series,plotOffset=this.plotOffset,options=this.options,legend=options.legend,fragments=[],rowStarted=false,ctx=this.ctx,itemCount=_.filter(series,function(s){return s.label&&!s.hide}).length,p=legend.position,m=legend.margin,opacity=legend.backgroundOpacity,i,label,color;if(itemCount){var lbw=legend.labelBoxWidth,lbh=legend.labelBoxHeight,lbm=legend.labelBoxMargin,offsetX=plotOffset.left+m,offsetY=plotOffset.top+m,labelMaxWidth=0,style={size:options.fontSize*1.1,color:options.grid.color};for(i=series.length-1;i>-1;--i){if(!series[i].label||series[i].hide)continue;label=legend.labelFormatter(series[i].label);labelMaxWidth=Math.max(labelMaxWidth,this._text.measureText(label,style).width)}var legendWidth=Math.round(lbw+lbm*3+labelMaxWidth),legendHeight=Math.round(itemCount*(lbm+lbh)+lbm);if(!opacity&&opacity!==0){opacity=.1}if(!options.HtmlText&&this.textEnabled&&!legend.container){if(p.charAt(0)=="s")offsetY=plotOffset.top+this.plotHeight-(m+legendHeight);if(p.charAt(0)=="c")offsetY=plotOffset.top+this.plotHeight/2-(m+legendHeight/2);if(p.charAt(1)=="e")offsetX=plotOffset.left+this.plotWidth-(m+legendWidth);color=this.processColor(legend.backgroundColor,{opacity:opacity});ctx.fillStyle=color;ctx.fillRect(offsetX,offsetY,legendWidth,legendHeight);ctx.strokeStyle=legend.labelBoxBorderColor;ctx.strokeRect(Flotr.toPixel(offsetX),Flotr.toPixel(offsetY),legendWidth,legendHeight);var x=offsetX+lbm;var y=offsetY+lbm;for(i=0;i<series.length;i++){if(!series[i].label||series[i].hide)continue;label=legend.labelFormatter(series[i].label);ctx.fillStyle=series[i].color;ctx.fillRect(x,y,lbw-1,lbh-1);ctx.strokeStyle=legend.labelBoxBorderColor;ctx.lineWidth=1;ctx.strokeRect(Math.ceil(x)-1.5,Math.ceil(y)-1.5,lbw+2,lbh+2);Flotr.drawText(ctx,label,x+lbw+lbm,y+lbh,style);y+=lbh+lbm}}else{for(i=0;i<series.length;++i){if(!series[i].label||series[i].hide)continue;if(i%legend.noColumns===0){fragments.push(rowStarted?"</tr><tr>":"<tr>");rowStarted=true}var s=series[i],boxWidth=legend.labelBoxWidth,boxHeight=legend.labelBoxHeight;label=legend.labelFormatter(s.label);color="background-color:"+(s.bars&&s.bars.show&&s.bars.fillColor&&s.bars.fill?s.bars.fillColor:s.color)+";";fragments.push('<td class="flotr-legend-color-box">','<div style="border:1px solid ',legend.labelBoxBorderColor,';padding:1px">','<div style="width:',boxWidth-1,"px;height:",boxHeight-1,"px;border:1px solid ",series[i].color,'">','<div style="width:',boxWidth,"px;height:",boxHeight,"px;",color,'"></div>',"</div>","</div>","</td>",'<td class="flotr-legend-label">',label,"</td>")}if(rowStarted)fragments.push("</tr>");if(fragments.length>0){var table='<table style="font-size:smaller;color:'+options.grid.color+'">'+fragments.join("")+"</table>";if(legend.container){table=D.node(table);this.legend.markup=table;D.insert(legend.container,table)}else{var styles={position:"absolute",zIndex:"2",border:"1px solid "+legend.labelBoxBorderColor};if(p.charAt(0)=="n"){styles.top=m+plotOffset.top+"px";styles.bottom="auto"}else if(p.charAt(0)=="c"){styles.top=m+(this.plotHeight-legendHeight)/2+"px";styles.bottom="auto"}else if(p.charAt(0)=="s"){styles.bottom=m+plotOffset.bottom+"px";styles.top="auto"}if(p.charAt(1)=="e"){styles.right=m+plotOffset.right+"px";styles.left="auto"}else if(p.charAt(1)=="w"){styles.left=m+plotOffset.left+"px";styles.right="auto"}var div=D.create("div"),size;div.className="flotr-legend";D.setStyles(div,styles);D.insert(div,table);D.insert(this.el,div);if(!opacity)return;var c=legend.backgroundColor||options.grid.backgroundColor||"#ffffff";_.extend(styles,D.size(div),{backgroundColor:c,zIndex:"",border:""});styles.width+="px";styles.height+="px";div=D.create("div");div.className="flotr-legend-bg";D.setStyles(div,styles);D.opacity(div,opacity);D.insert(div," ");D.insert(this.el,div)}}}}}})})();(function(){var D=Flotr.DOM;Flotr.addPlugin("titles",{callbacks:{"flotr:afterdraw":function(){this.titles.drawTitles()}},drawTitles:function(){var html,options=this.options,margin=options.grid.labelMargin,ctx=this.ctx,a=this.axes;if(!options.HtmlText&&this.textEnabled){var style={size:options.fontSize,color:options.grid.color,textAlign:"center"};if(options.subtitle){Flotr.drawText(ctx,options.subtitle,this.plotOffset.left+this.plotWidth/2,this.titleHeight+this.subtitleHeight-2,style)}style.weight=1.5;style.size*=1.5;if(options.title){Flotr.drawText(ctx,options.title,this.plotOffset.left+this.plotWidth/2,this.titleHeight-2,style)}style.weight=1.8;style.size*=.8;if(a.x.options.title&&a.x.used){style.textAlign=a.x.options.titleAlign||"center";style.textBaseline="top";style.angle=Flotr.toRad(a.x.options.titleAngle);style=Flotr.getBestTextAlign(style.angle,style);Flotr.drawText(ctx,a.x.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+a.x.maxLabel.height+this.plotHeight+2*margin,style)}if(a.x2.options.title&&a.x2.used){style.textAlign=a.x2.options.titleAlign||"center";style.textBaseline="bottom";style.angle=Flotr.toRad(a.x2.options.titleAngle);style=Flotr.getBestTextAlign(style.angle,style);Flotr.drawText(ctx,a.x2.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top-a.x2.maxLabel.height-2*margin,style)}if(a.y.options.title&&a.y.used){style.textAlign=a.y.options.titleAlign||"right";style.textBaseline="middle";style.angle=Flotr.toRad(a.y.options.titleAngle);style=Flotr.getBestTextAlign(style.angle,style);Flotr.drawText(ctx,a.y.options.title,this.plotOffset.left-a.y.maxLabel.width-2*margin,this.plotOffset.top+this.plotHeight/2,style)}if(a.y2.options.title&&a.y2.used){style.textAlign=a.y2.options.titleAlign||"left";style.textBaseline="middle";style.angle=Flotr.toRad(a.y2.options.titleAngle);style=Flotr.getBestTextAlign(style.angle,style);Flotr.drawText(ctx,a.y2.options.title,this.plotOffset.left+this.plotWidth+a.y2.maxLabel.width+2*margin,this.plotOffset.top+this.plotHeight/2,style)}}else{html=[];if(options.title)html.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;font-size:1em;font-weight:bold;text-align:center;width:",this.plotWidth,'px;" class="flotr-title">',options.title,"</div>");if(options.subtitle)html.push('<div style="position:absolute;top:',this.titleHeight,"px;left:",this.plotOffset.left,"px;font-size:smaller;text-align:center;width:",this.plotWidth,'px;" class="flotr-subtitle">',options.subtitle,"</div>");html.push("</div>");html.push('<div class="flotr-axis-title" style="font-weight:bold;">');if(a.x.options.title&&a.x.used)html.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight+options.grid.labelMargin+a.x.titleSize.height,"px;left:",this.plotOffset.left,"px;width:",this.plotWidth,"px;text-align:",a.x.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-x1">',a.x.options.title,"</div>");if(a.x2.options.title&&a.x2.used)html.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;width:",this.plotWidth,"px;text-align:",a.x2.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-x2">',a.x2.options.title,"</div>");if(a.y.options.title&&a.y.used)html.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-a.y.titleSize.height/2,"px;left:0;text-align:",a.y.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-y1">',a.y.options.title,"</div>");if(a.y2.options.title&&a.y2.used)html.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-a.y.titleSize.height/2,"px;right:0;text-align:",a.y2.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-y2">',a.y2.options.title,"</div>");html=html.join("");var div=D.create("div");D.setStyles({color:options.grid.color});div.className="flotr-titles";D.insert(this.el,div);D.insert(div,html)}}})})();(function(){var D=Flotr.DOM;Flotr.addPlugin("handles",{options:{show:false,drag:true,scroll:true},callbacks:{"flotr:afterinit":init,"flotr:select":handleSelect,"flotr:mousedown":reset,"flotr:mousemove":mouseMoveHandler}});function init(){var options=this.options,handles=this.handles,el=this.el,scroll,left,right,container;if(!options.selection.mode||!options.handles.show||"ontouchstart"in el)return;handles.initialized=true;container=D.node('<div class="flotr-handles"></div>');options=options.handles;if(options.drag){right=D.node('<div class="flotr-handles-handle flotr-handles-drag flotr-handles-right"></div>');left=D.node('<div class="flotr-handles-handle flotr-handles-drag flotr-handles-left"></div>');D.insert(container,right);D.insert(container,left);D.hide(left);D.hide(right);handles.left=left;handles.right=right;this.observe(left,"mousedown",function(){handles.moveHandler=leftMoveHandler});this.observe(right,"mousedown",function(){handles.moveHandler=rightMoveHandler})}if(options.scroll){scroll=D.node('<div class="flotr-handles-handle flotr-handles-scroll"></div>');D.insert(container,scroll);D.hide(scroll);handles.scroll=scroll;this.observe(scroll,"mousedown",function(){handles.moveHandler=scrollMoveHandler})}this.observe(document,"mouseup",function(){handles.moveHandler=null});D.insert(el,container)}function handleSelect(selection){if(!this.handles.initialized)return;var handles=this.handles,options=this.options.handles,left=handles.left,right=handles.right,scroll=handles.scroll;if(options){if(options.drag){positionDrag(this,left,selection.x1);positionDrag(this,right,selection.x2)}if(options.scroll){positionScroll(this,scroll,selection.x1,selection.x2)}}}function positionDrag(graph,handle,x){D.show(handle);var size=D.size(handle),l=Math.round(graph.axes.x.d2p(x)-size.width/2),t=(graph.plotHeight-size.height)/2;D.setStyles(handle,{left:l+"px",top:t+"px"})}function positionScroll(graph,handle,x1,x2){D.show(handle);var size=D.size(handle),l=Math.round(graph.axes.x.d2p(x1)),t=graph.plotHeight-size.height/2,w=graph.axes.x.d2p(x2)-graph.axes.x.d2p(x1);D.setStyles(handle,{left:l+"px",top:t+"px",width:w+"px"})}function reset(){if(!this.handles.initialized)return;var handles=this.handles;if(handles){D.hide(handles.left);D.hide(handles.right);D.hide(handles.scroll)}}function mouseMoveHandler(e,position){if(!this.handles.initialized)return;if(!this.handles.moveHandler)return;var delta=position.x-this.lastMousePos.x,selection=this.selection.selection,area=this.selection.getArea(),handles=this.handles;handles.moveHandler(area,delta);checkSwap(area,handles);this.selection.setSelection(area)}function checkSwap(area,handles){var moveHandler=handles.moveHandler;if(area.x1>area.x2){if(moveHandler==leftMoveHandler){moveHandler=rightMoveHandler}else if(moveHandler==rightMoveHandler){moveHandler=leftMoveHandler}handles.moveHandler=moveHandler}}function leftMoveHandler(area,delta){area.x1+=delta}function rightMoveHandler(area,delta){area.x2+=delta}function scrollMoveHandler(area,delta){area.x1+=delta;area.x2+=delta}})();(function(){var E=Flotr.EventAdapter,_=Flotr._;Flotr.addPlugin("graphGrid",{callbacks:{"flotr:beforedraw":function(){this.graphGrid.drawGrid()},"flotr:afterdraw":function(){this.graphGrid.drawOutline()}},drawGrid:function(){var ctx=this.ctx,options=this.options,grid=options.grid,verticalLines=grid.verticalLines,horizontalLines=grid.horizontalLines,minorVerticalLines=grid.minorVerticalLines,minorHorizontalLines=grid.minorHorizontalLines,plotHeight=this.plotHeight,plotWidth=this.plotWidth,a,v,i,j;if(verticalLines||minorVerticalLines||horizontalLines||minorHorizontalLines){E.fire(this.el,"flotr:beforegrid",[this.axes.x,this.axes.y,options,this])}ctx.save();ctx.lineWidth=1;ctx.strokeStyle=grid.tickColor;function circularHorizontalTicks(ticks){for(i=0;i<ticks.length;++i){var ratio=ticks[i].v/a.max;for(j=0;j<=sides;++j){ctx[j===0?"moveTo":"lineTo"](Math.cos(j*coeff+angle)*radius*ratio,Math.sin(j*coeff+angle)*radius*ratio)}}}function drawGridLines(ticks,callback){_.each(_.pluck(ticks,"v"),function(v){if(v<=a.min||v>=a.max||(v==a.min||v==a.max)&&grid.outlineWidth)return;callback(Math.floor(a.d2p(v))+ctx.lineWidth/2)})}function drawVerticalLines(x){ctx.moveTo(x,0);ctx.lineTo(x,plotHeight)}function drawHorizontalLines(y){ctx.moveTo(0,y);ctx.lineTo(plotWidth,y)}if(grid.circular){ctx.translate(this.plotOffset.left+plotWidth/2,this.plotOffset.top+plotHeight/2);var radius=Math.min(plotHeight,plotWidth)*options.radar.radiusRatio/2,sides=this.axes.x.ticks.length,coeff=2*(Math.PI/sides),angle=-Math.PI/2;ctx.beginPath();a=this.axes.y;if(horizontalLines){circularHorizontalTicks(a.ticks)}if(minorHorizontalLines){circularHorizontalTicks(a.minorTicks)}if(verticalLines){_.times(sides,function(i){ctx.moveTo(0,0);ctx.lineTo(Math.cos(i*coeff+angle)*radius,Math.sin(i*coeff+angle)*radius)})}ctx.stroke()}else{ctx.translate(this.plotOffset.left,this.plotOffset.top);if(grid.backgroundColor){ctx.fillStyle=this.processColor(grid.backgroundColor,{x1:0,y1:0,x2:plotWidth,y2:plotHeight});ctx.fillRect(0,0,plotWidth,plotHeight)}ctx.beginPath();a=this.axes.x;if(verticalLines)drawGridLines(a.ticks,drawVerticalLines);if(minorVerticalLines)drawGridLines(a.minorTicks,drawVerticalLines);a=this.axes.y;if(horizontalLines)drawGridLines(a.ticks,drawHorizontalLines);if(minorHorizontalLines)drawGridLines(a.minorTicks,drawHorizontalLines);ctx.stroke()}ctx.restore();if(verticalLines||minorVerticalLines||horizontalLines||minorHorizontalLines){E.fire(this.el,"flotr:aftergrid",[this.axes.x,this.axes.y,options,this])}},drawOutline:function(){var that=this,options=that.options,grid=options.grid,outline=grid.outline,ctx=that.ctx,backgroundImage=grid.backgroundImage,plotOffset=that.plotOffset,leftOffset=plotOffset.left,topOffset=plotOffset.top,plotWidth=that.plotWidth,plotHeight=that.plotHeight,v,img,src,left,top,globalAlpha;if(!grid.outlineWidth)return;ctx.save();if(grid.circular){ctx.translate(leftOffset+plotWidth/2,topOffset+plotHeight/2);var radius=Math.min(plotHeight,plotWidth)*options.radar.radiusRatio/2,sides=this.axes.x.ticks.length,coeff=2*(Math.PI/sides),angle=-Math.PI/2;ctx.beginPath();ctx.lineWidth=grid.outlineWidth;ctx.strokeStyle=grid.color;ctx.lineJoin="round";for(i=0;i<=sides;++i){ctx[i===0?"moveTo":"lineTo"](Math.cos(i*coeff+angle)*radius,Math.sin(i*coeff+angle)*radius)}ctx.stroke()}else{ctx.translate(leftOffset,topOffset);var lw=grid.outlineWidth,orig=.5-lw+(lw+1)%2/2,lineTo="lineTo",moveTo="moveTo";ctx.lineWidth=lw;ctx.strokeStyle=grid.color;ctx.lineJoin="miter";ctx.beginPath();ctx.moveTo(orig,orig);plotWidth=plotWidth-lw/2%1;plotHeight=plotHeight+lw/2;ctx[outline.indexOf("n")!==-1?lineTo:moveTo](plotWidth,orig);ctx[outline.indexOf("e")!==-1?lineTo:moveTo](plotWidth,plotHeight);ctx[outline.indexOf("s")!==-1?lineTo:moveTo](orig,plotHeight);ctx[outline.indexOf("w")!==-1?lineTo:moveTo](orig,orig);ctx.stroke();ctx.closePath()}ctx.restore();if(backgroundImage){src=backgroundImage.src||backgroundImage;left=(parseInt(backgroundImage.left,10)||0)+plotOffset.left;top=(parseInt(backgroundImage.top,10)||0)+plotOffset.top;img=new Image;img.onload=function(){ctx.save();if(backgroundImage.alpha)ctx.globalAlpha=backgroundImage.alpha;ctx.globalCompositeOperation="destination-over";ctx.drawImage(img,0,0,img.width,img.height,left,top,plotWidth,plotHeight);ctx.restore()};img.src=src}}})})();!function(a,b){typeof define=="function"?define(b):typeof module!="undefined"?module.exports=b():this[a]=b()}("bonzo",function(){function x(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function y(a,b,c){for(var d=0,e=a.length;d<e;d++)b.call(c||a[d],a[d],d,a);return a}function z(a){return a.replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function A(a){return a&&a.nodeName&&a.nodeType==1}function B(a,b,c,d){for(d=0,j=a.length;d<j;++d)if(b.call(c,a[d],d,a))return!0;return!1}function D(a,b,c){var d=0,g=b||this,h=[],i=f&&typeof a=="string"&&a.charAt(0)!="<"?function(b){return(b=f(a))&&(b.selected=1)&&b}():a;return y(J(i),function(a){y(g,function(b){var f=!b[e]||b[e]&&!b[e][e]?function(){var a=b.cloneNode(!0);return g.$&&g.cloneEvents&&g.$(a).cloneEvents(b),a}():b;c(a,f),h[d]=f,d++})},this),y(h,function(a,b){g[b]=a}),g.length=d,g}function E(a,b,c){var d=N(a),e=d.css("position"),f=d.offset(),g="relative",h=e==g,i=[parseInt(d.css("left"),10),parseInt(d.css("top"),10)];e=="static"&&(d.css("position",g),e=g),isNaN(i[0])&&(i[0]=h?0:a.offsetLeft),isNaN(i[1])&&(i[1]=h?0:a.offsetTop),b!=null&&(a.style.left=b-f.left+i[0]+q),c!=null&&(a.style.top=c-f.top+i[1]+q)}function F(a,b){return x(b).test(a.className)}function G(a,b){a.className=w(a.className+" "+b)}function H(a,b){a.className=w(a.className.replace(x(b)," "))}function I(a){this.length=0;if(a){a=typeof a!="string"&&!a.nodeType&&typeof a.length!="undefined"?a:[a],this.length=a.length;for(var b=0;b<a.length;b++)this[b]=a[b]}}function J(a){return typeof a=="string"?N.create(a):A(a)?[a]:a}function K(a,c,d){var e=this[0];return a==null&&c==null?(L(e)?M():{x:e.scrollLeft,y:e.scrollTop})[d]:(L(e)?b.scrollTo(a,c):(a!=null&&(e.scrollLeft=a),c!=null&&(e.scrollTop=c)),this)}function L(a){return a===b||/^(?:body|html)$/i.test(a.tagName)}function M(){return{x:b.pageXOffset||d.scrollLeft,y:b.pageYOffset||d.scrollTop}}function N(a,b){return new I(a,b)}var a=this,b=window,c=b.document,d=c.documentElement,e="parentNode",f=null,g=/^checked|value|selected$/,h=/select|fieldset|table|tbody|tfoot|td|tr|colgroup/i,i="table",k={thead:i,tbody:i,tfoot:i,tr:"tbody",th:"tr",td:"tr",fieldset:"form",option:"select"},l=/^checked|selected$/,m=/msie/i.test(navigator.userAgent),n=[],o=0,p=/^-?[\d\.]+$/,q="px",r="setAttribute",s="getAttribute",t=/(^\s*|\s*$)/g,u={lineHeight:1,zoom:1,zIndex:1,opacity:1},v=function(){var a=["webkitTransform","MozTransform","OTransform","msTransform","Transform"],b;for(b=0;b<a.length;b++)if(a[b]in c.createElement("a").style)return a[b]}(),w=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(t,"")},C=c.defaultView&&c.defaultView.getComputedStyle?function(a,b){b=b=="transform"?v:b,b=b=="transform-origin"?v+"Origin":b;var d=null;b=="float"&&(b="cssFloat");var e=c.defaultView.getComputedStyle(a,"");return e&&(d=e[z(b)]),a.style[b]||d}:m&&d.currentStyle?function(a,b){b=z(b),b=b=="float"?"styleFloat":b;if(b=="opacity"){var c=100;try{c=a.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(d){try{c=a.filters("alpha").opacity}catch(e){}}return c/100}var f=a.currentStyle?a.currentStyle[b]:null;return a.style[b]||f}:function(a,b){return a.style[z(b)]};I.prototype={get:function(a){return this[a]},each:function(a,b){return y(this,a,b)},map:function(a,b){var c=[],d,e;for(e=0;e<this.length;e++)d=a.call(this,this[e],e),b?b(d)&&c.push(d):c.push(d);return c},first:function(){return N(this[0])},last:function(){return N(this[this.length-1])},html:function(a,b){function f(b){while(b.firstChild)b.removeChild(b.firstChild);y(J(a),function(a){b.appendChild(a)})}var c=b?d.textContent===null?"innerText":"textContent":"innerHTML",e;
return typeof a!="undefined"?this.each(function(b){(e=b.tagName.match(h))?f(b,e[0]):b[c]=a}):this[0]?this[0][c]:""},text:function(a){return this.html(a,1)},addClass:function(a){return this.each(function(b){F(b,a)||G(b,a)})},removeClass:function(a){return this.each(function(b){F(b,a)&&H(b,a)})},hasClass:function(a){return B(this,function(b){return F(b,a)})},toggleClass:function(a,b){return this.each(function(c){typeof b!="undefined"?b?G(c,a):H(c,a):F(c,a)?H(c,a):G(c,a)})},show:function(a){return this.each(function(b){b.style.display=a||""})},hide:function(a){return this.each(function(a){a.style.display="none"})},append:function(a){return this.each(function(b){y(J(a),function(a){b.appendChild(a)})})},prepend:function(a){return this.each(function(b){var c=b.firstChild;y(J(a),function(a){b.insertBefore(a,c)})})},appendTo:function(a,b){return D.call(this,a,b,function(a,b){a.appendChild(b)})},prependTo:function(a,b){return D.call(this,a,b,function(a,b){a.insertBefore(b,a.firstChild)})},next:function(){return this.related("nextSibling")},previous:function(){return this.related("previousSibling")},related:function(a){return this.map(function(b){b=b[a];while(b&&b.nodeType!==1)b=b[a];return b||0},function(a){return a})},before:function(a){return this.each(function(b){y(N.create(a),function(a){b[e].insertBefore(a,b)})})},after:function(a){return this.each(function(b){y(N.create(a),function(a){b[e].insertBefore(a,b.nextSibling)})})},insertBefore:function(a,b){return D.call(this,a,b,function(a,b){a[e].insertBefore(b,a)})},insertAfter:function(a,b){return D.call(this,a,b,function(a,b){var c=a.nextSibling;c?a[e].insertBefore(b,c):a[e].appendChild(b)})},css:function(a,d,e){function g(a,b,c){for(var d in f)f.hasOwnProperty(d)&&(c=f[d],(b=z(d))&&p.test(c)&&!(b in u)&&(c+=q),b=b=="transform"?v:b,b=b=="transformOrigin"?v+"Origin":b,a.style[b]=c)}if(d===undefined&&typeof a=="string")return d=this[0],d?d==c||d==b?(e=d==c?N.doc():N.viewport(),a=="width"?e.width:a=="height"?e.height:""):C(d,a):null;var f=a;typeof a=="string"&&(f={},f[a]=d),m&&f.opacity&&(f.filter="alpha(opacity="+f.opacity*100+")",f.zoom=a.zoom||1,delete f.opacity);if(d=f["float"])m?f.styleFloat=d:f.cssFloat=d,delete f["float"];return this.each(g)},offset:function(a,b){if(typeof a=="number"||typeof b=="number")return this.each(function(c){E(c,a,b)});var c=this[0],d=c.offsetWidth,e=c.offsetHeight,f=c.offsetTop,g=c.offsetLeft;while(c=c.offsetParent)f=f+c.offsetTop,g=g+c.offsetLeft;return{top:f,left:g,height:e,width:d}},attr:function(a,b){var c=this[0];if(typeof a=="string"||a instanceof String)return typeof b=="undefined"?g.test(a)?l.test(a)&&typeof c[a]=="string"?!0:c[a]:c[s](a):this.each(function(c){g.test(a)?c[a]=b:c[r](a,b)});for(var d in a)a.hasOwnProperty(d)&&this.attr(d,a[d]);return this},val:function(a){return typeof a=="string"?this.attr("value",a):this[0].value},removeAttr:function(a){return this.each(function(b){l.test(a)?b[a]=!1:b.removeAttribute(a)})},data:function(a,b){var c=this[0];if(typeof b=="undefined"){c[s]("data-node-uid")||c[r]("data-node-uid",++o);var d=c[s]("data-node-uid");return n[d]||(n[d]={}),n[d][a]}return this.each(function(c){c[s]("data-node-uid")||c[r]("data-node-uid",++o);var d=c[s]("data-node-uid"),e=n[d]||(n[d]={});e[a]=b})},remove:function(){return this.each(function(a){a[e]&&a[e].removeChild(a)})},empty:function(){return this.each(function(a){while(a.firstChild)a.removeChild(a.firstChild)})},detach:function(){return this.map(function(a){return a[e].removeChild(a)})},scrollTop:function(a){return K.call(this,null,a,"y")},scrollLeft:function(a){return K.call(this,a,null,"x")},toggle:function(a){return this.each(function(a){a.style.display=a.offsetWidth||a.offsetHeight?"none":"block"}),a&&a(),this}},N.setQueryEngine=function(a){f=a,delete N.setQueryEngine},N.aug=function(a,b){for(var c in a)a.hasOwnProperty(c)&&((b||I.prototype)[c]=a[c])},N.create=function(a){return typeof a=="string"?function(){var b=/^<([^\s>]+)/.exec(a),d=c.createElement(b&&k[b[1].toLowerCase()]||"div"),e=[];d.innerHTML=a;var f=d.childNodes;d=d.firstChild,e.push(d);while(d=d.nextSibling)d.nodeType==1&&e.push(d);return e}():A(a)?[a.cloneNode(!0)]:[]},N.doc=function(){var a=this.viewport();return{width:Math.max(c.body.scrollWidth,d.scrollWidth,a.width),height:Math.max(c.body.scrollHeight,d.scrollHeight,a.height)}},N.firstChild=function(a){for(var b=a.childNodes,c=0,d=b&&b.length||0,e;c<d;c++)b[c].nodeType===1&&(e=b[d=c]);return e},N.viewport=function(){return{width:m?d.clientWidth:self.innerWidth,height:m?d.clientHeight:self.innerHeight}},N.isAncestor="compareDocumentPosition"in d?function(a,b){return(a.compareDocumentPosition(b)&16)==16}:"contains"in d?function(a,b){return a!==b&&a.contains(b)}:function(a,b){while(b=b[e])if(b===a)return!0;return!1};var O=a.bonzo;return N.noConflict=function(){return a.bonzo=O,this},N});var envision={_:Flotr._,bean:Flotr.bean,bonzo:bonzo,noConflict:function(root){var previous=root.envision;return function(){root.envision=previous;return this}}(this)};(function(){var CN_FIRST="envision-first",CN_LAST="envision-last",T_VISUALIZATION='<div class="envision-visualization"></div>';T_COMPONENT_CONTAINER='<div class="envision-component-container"></div>';function Visualization(options){this.options=options||{};this.components=[];this.node=null;this.rendered=false}Visualization.prototype={render:function(element){var options=this.options;element=element||options.element;if(!element)throw"No element to render within.";this.node=bonzo.create(T_VISUALIZATION)[0];bonzo(this.node).addClass(options.name||"");this.container=element;bonzo(element).append(this.node);bonzo(element).data("envision",this);_.each(this.components,function(component){this._renderComponent(component)},this);this._updateClasses();this.rendered=true;return this},add:function(component){this.components.push(component);if(this.rendered){this._renderComponent(component);this._updateClasses()}return this},remove:function(component){var components=this.components,index=this.indexOf(component);if(index!==-1){components.splice(index,1);bonzo(component.container).remove();this._updateClasses()}return this},setPosition:function(component,newIndex){var components=this.components;if(newIndex>=0&&newIndex<components.length&&this.remove(component)){if(this.rendered){if(newIndex===components.length)this.node.appendChild(component.container);else this.node.insertBefore(component.container,components[newIndex].container)}components.splice(newIndex,0,component);this._updateClasses()}return this},indexOf:function(component){return _.indexOf(this.components,component)},getComponent:function(index){var components=this.components;if(index<components.length)return components[index]},isFirst:function(component){return this.indexOf(component)===0?true:false},isLast:function(component){return this.indexOf(component)===this.components.length-1?true:false},destroy:function(){_.each(this.components,function(component){component.destroy()});bonzo(this.container).empty()},_renderComponent:function(component){var container=bonzo.create(T_COMPONENT_CONTAINER)[0];bonzo(this.node).append(container);component.render(container)},_updateClasses:function(){var components=this.components,first=0,last=components.length-1,node;_.each(components,function(component,index){node=bonzo(component.container);if(index===first)node.addClass(CN_FIRST);else node.removeClass(CN_FIRST);if(index===last)node.addClass(CN_LAST);else node.removeClass(CN_LAST)})}};envision.Visualization=Visualization})();(function(){var V=envision,CN_COMPONENT="envision-component",T_COMPONENT='<div class="'+CN_COMPONENT+'"></div>';function Component(options){options=options||{};var node=bonzo.create(T_COMPONENT)[0];this.options=options;this.node=node;if(options.adapter){this.api=options.adapter}else if(options.adapterConstructor){this.api=new options.adapterConstructor(options.config)}else if(options.adapterCallback){this.api=options.adapterCallback.call(null,options.config)}else if(options.config){this.api=new V.adapters.flotr.Child(options.config||{})}this.preprocessors=[]}Component.prototype={render:function(element){var node=this.node,options=this.options;element=element||options.element;if(!element)throw"No element to render within.";bonzo(element).addClass(options.name||"").append(this.node);this._setDimension("width");this._setDimension("height");this.container=element;this.draw(options.data,options.config)},draw:function(data,config){var api=this.api,options=this.options,preprocessors=this.preprocessors,clientData;clientData=data=data||options.data;config=config||options.config;if(!options.skipPreprocess&&data){clientData=[];_.each(api.getDataArray(data),function(d,index){var preprocessor=preprocessors[index]||new V.Preprocessor,isArray=_.isArray(d),isFunction=_.isFunction(d),unprocessed=isArray?d:isFunction?d:d.data,processData=options.processData,range=api.range(config),min=range.min,max=range.max,resolution=this.node.clientWidth,dataArray=d,processed,objectData;if(!isFunction&&!isArray){dataArray=d.data;objectData=_.extend({},d)}if(isFunction){processed=data(min,max,resolution)}else{if(dataArray!==preprocessor.data){preprocessor.setData(dataArray)}else{preprocessor.reset()}if(processData){processData.apply(this,[{preprocessor:preprocessor,min:min,max:max,resolution:resolution}]);processed=preprocessor.getData()}else{processed=preprocessor.bound(min,max).subsampleMinMax(resolution).getData()}}if(api.transformData){processed=api.transformData(processed)}if(objectData){objectData.data=processed;clientData.push(objectData)}else{clientData.push(processed)}},this)}if(api)api.draw(clientData,config,this.node)},trigger:function(){this.api.trigger.apply(this.api,Array.prototype.concat.apply([this],arguments))},attach:function(){this.api.attach.apply(this.api,Array.prototype.concat.apply([this],arguments))},detach:function(){this.api.detach.apply(this.api,Array.prototype.concat.apply([this],arguments))},destroy:function(){if(this.api&&this.api.destroy)this.api.destroy();bonzo(this.container).empty()},_setDimension:function(attribute){var node=this.node,options=this.options;if(options[attribute]){bonzo(node).css(attribute,options[attribute])}else{options[attribute]=node.clientWidth}this[attribute]=options[attribute]}};V.Component=Component})();(function(){var H=envision;function Interaction(options){this.options=options=options||{};this.actions=[];this.actionOptions=[];this.followers=[];this.leaders=[];this.prevent={};if(options.leader){this.leader(options.leader)}}Interaction.prototype={leader:function(component){this.leaders.push(component);_.each(this.actions,function(action,i){this._bindLeader(component,action,this.actionOptions[i])},this);return this},follower:function(component){this.followers.push(component);return this},group:function(components){if(!_.isArray(components))components=[components];_.each(components,function(component){this.leader(component);this.follower(component)},this);return this},add:function(action,options){this.actions.push(action);this.actionOptions.push(options);_.each(this.leaders,function(leader){this._bindLeader(leader,action,options)},this);return this},_bindLeader:function(leader,action,options){_.each(action.events,function(e){var handler=e.handler||e,consumer=e.consumer||e;leader.attach(handler,_.bind(function(leader,result){if(this.prevent[name])return;if(options&&options.callback){options.callback.call(this,result)}this.prevent[name]=true;try{_.each(this.followers,function(follower){if(leader===follower)return;follower.trigger(consumer,result)},this)}catch(e){this.prevent[name]=false;throw e}this.prevent[name]=false},this))},this)}};H.Interaction=Interaction})();(function(){function Preprocessor(options){options=options||{};this.getData=function(){if(this.bounded)bound(this);return this.processing};this.reset=function(){this.processing=this.data;return this};this.setData=function(data){var i,length;if(!_.isArray(data))throw new Error("Array expected.");if(data.length<2)throw new Error("Data must contain at least two dimensions.");length=data[0].length;for(i=data.length;i--;){if(!_.isArray(data[i]))throw new Error("Data dimensions must be arrays.");if(data[i].length!==length)throw new Error("Data dimensions must contain the same number of points.")}this.processing=data;this.data=data;return this};if(options.data)this.setData(options.data)}function getStartIndex(data,min){var i=_.sortedIndex(data,min);if(data[i]>min&&i>0)i--;return i}function getEndIndex(data,max){return _.sortedIndex(data,max)}function bound(that){delete that.bounded;var data=that.processing,length=that.length(),x=data[0],y=data[1],min=that.min||0,max=that.max||length,start=getStartIndex(x,min),end=getEndIndex(x,max);that.processing=[x.slice(start,end+1),y.slice(start,end+1)];that.start=start;that.end=end}Preprocessor.prototype={length:function(){return this.getData()[0].length},bound:function(min,max){if(!_.isNumber(min)||!_.isNumber(max))return this;this.min=min;this.max=max;this.bounded=true;return this},subsampleMinMax:function(resolution){var bounded=this.bounded;delete this.bounded;var data=this.processing,length=this.length(),x=data[0],y=data[1],start=bounded?getStartIndex(x,this.min):0,end=bounded?getEndIndex(x,this.max):length-1,count=(resolution-2)/2,newX=[],newY=[],min=Number.MAX_VALUE,max=-Number.MAX_VALUE,minI=1,maxI=1,unit=(end-start)/count,position,datum,i,j;if(end-start+1>resolution){newX.push(x[start]);newY.push(y[start]);position=start+unit;for(i=start;i<end;i++){if(i===Math.round(position)){position+=unit;j=Math.min(maxI,minI);newX.push(x[j]);newY.push(y[j]);j=Math.max(maxI,minI);newX.push(x[j]);newY.push(y[j]);minI=i;min=y[minI];maxI=i;max=y[maxI]}else{if(y[i]>max){max=y[i];maxI=i}if(y[i]<min){min=y[i];minI=i}}}if(i<position){newX.push(x[minI]);newY.push(min);newX.push(x[maxI]);newY.push(max)}newX.push(x[end]);newY.push(y[end]);this.processing=[newX,newY];this.start=start;this.end=end}else{this.bounded=bounded}return this},subsample:function(resolution){var bounded=this.bounded;delete this.bounded;var data=this.processing,length=this.length(),x=data[0],y=data[1],start=bounded?getStartIndex(x,this.min):0,end=bounded?getEndIndex(x,this.max):length-1,unit=(end-start+1)/resolution,newX=[],newY=[],i,index;if(end-start+1>resolution){newX.push(x[start]);newY.push(y[start]);for(i=1;i<resolution;i++){if(i*unit>=end-unit)break;index=Math.round(i*unit)+start;newX.push(x[index]);newY.push(y[index])}newX.push(x[end]);newY.push(y[end]);this.processing=[newX,newY];this.start=start;this.end=end}else{this.bounded=bounded}return this},interpolate:function(resolution){var bounded=this.bounded;delete this.bounded;var data=this.processing,length=this.length(),x=data[0],y=data[1],start=bounded?getStartIndex(x,this.min):0,end=bounded?getEndIndex(x,this.max):length-1,unit=(x[end]-x[start])/resolution,newX=[],newY=[],i,j,delta;newX.push(x[start]);newY.push(y[start]);if(end-start+1<resolution){for(i=start;i<end;i++){delta=x[i+1]-x[i];newX.push(x[i]);newY.push(y[i]);for(j=x[i+0]+unit;j<x[i+1];j+=unit){newX.push(j);newY.push(cubicHermiteSpline(j,x[i-1],y[i-1],x[i+0],y[i+0],x[i+1],y[i+1],x[i+2],y[i+2]))}}this.processing=[newX,newY];this.start=start;this.end=end}return this}};function cubicHermiteSpline(x,tk0,pk0,tk1,pk1,tk2,pk2,tk3,pk3){var t=(x-tk1)/(tk2-tk1),t1=1-t,h00=(1+2*t)*t1*t1,h10=t*t1*t1,h01=t*t*(3-2*t),h11=t*t*(t-1),mk=(pk2-pk1)/(2*(tk2-tk1))+(typeof pk0==="undefined"?0:(pk1-pk0)/(2*(tk1-tk0))),mk1=(typeof pk3==="undefined"?0:(pk3-pk2)/(2*(tk3-tk2)))+(pk2-pk1)/(2*(tk2-tk1)),px=h00*pk1+h10*(tk2-tk1)*mk+h01*pk2+h11*(tk2-tk1)*mk1;return px}envision.Preprocessor=Preprocessor})();envision.actions=envision.actions||{};envision.actions.hit={events:["hit","mouseout"]};envision.actions.selection={events:[{handler:"select",consumer:"zoom"},{handler:"click",consumer:"reset"}]};envision.actions.zoom={events:[{handler:"select",consumer:"zoom"},"zoom","reset"]};envision.adapters=envision.adapters||{};envision.adapters.flotr={};envision.adapters.defaultOptions={grid:{outlineWidth:0,labelMargin:0,horizontalLines:false,verticalLines:false},bars:{show:false,barWidth:.5,fill:true,lineWidth:1,fillOpacity:1},lines:{lineWidth:1},xaxis:{margin:false,tickDecimals:0,showLabels:false},yaxis:{margin:false,showLabels:false},shadowSize:false};(function(){var V=envision,A=envision.adapters,E=Flotr.EventAdapter,DEFAULTS=A.defaultOptions;function Child(options){this.options=options||{};this.flotr=null;this._flotrDefaultOptions()}Child.prototype={destroy:function(){this.flotr.destroy()},draw:function(data,flotr,node){var options=this.options;data=this.getDataArray(data||options.data);if(flotr){flotr=Flotr.merge(flotr,Flotr.clone(options))}else{flotr=options}options.data=data;if(!flotr)throw"No graph submitted.";this.flotr=Flotr.draw(node,data,flotr)},range:function(flotr){var axis=flotr.xaxis;return{min:axis.min,max:axis.max}},transformData:function(data){var length=data[0].length,dimension=data.length,transformed=[],point,i,j;for(i=0;i<length;i++){point=[];for(j=0;j<dimension;j++){point.push(data[j][i])}transformed.push(point)}return transformed},getDataArray:function(data){if(data[0]&&(!_.isArray(data[0])||!data[0].length||data[0][0]&&_.isArray(data[0][0])))return data;else return[data]},_flotrDefaultOptions:function(options){var o=options||this.options,i;for(i in DEFAULTS){if(DEFAULTS.hasOwnProperty(i)){if(_.isUndefined(o[i])){o[i]=DEFAULTS[i]}else{_.defaults(o[i],DEFAULTS[i])}}}},attach:function(component,name,callback){var event=this.events[name]||{},handler=event.handler||false;name=event.name||false;if(handler){return E.observe(component.node,name,function(){var args=[component].concat(Array.prototype.slice.call(arguments)),result=handler.apply(this,args);return callback.apply(null,[component,result])})}else{return false}},detach:function(component,name,callback){return E.stopObserve(component.node,name,handler)},trigger:function(component,name,options){var event=this.events[name],consumer=event.consumer||false;return consumer?consumer.apply(this,[component,options]):false},events:{hit:{name:"flotr:hit",handler:function(component,hit){var x=hit.x,y=hit.y,graph=component.api.flotr,options;options={data:{index:hit.index,x:x,y:y},x:graph.axes.x.d2p(x),y:graph.axes.y.d2p(y)};return options},consumer:function(component,hit){var graph=component.api.flotr,o;o={x:hit.data.x,y:hit.data.y||1,relX:hit.x,relY:hit.y||1};graph.hit.hit(o)}},select:{name:"flotr:selecting",handler:selectHandler,consumer:function(component,selection){var graph=component.api.flotr,axes=graph.axes,data=selection.data||{},options={},x=selection.x,y=selection.y;if(!x&&data.x){x=data.x;options.x1=x.min;options.x2=x.max}else if(x){options.x1=axes.x.p2d(x.min);options.x2=axes.x.p2d(x.max)}if(!y&&data.y){y=data.y;options.y1=y.min;options.y2=y.max}else if(y){options.y1=axes.y.d2p(y.min);options.y2=axes.y.d2p(y.max)}graph.selection.setSelection(options)}},zoom:{name:"flotr:select",handler:function(component,selection){var options=selectHandler(component,selection);component.trigger("zoom",options);return options},consumer:function(component,selection){var x=selection.data.x,y=selection.data.y,options={};if(x){options.xaxis={min:x.min,max:x.max}}if(y){options.yaxis={min:y.min,max:y.max}}component.draw(null,options)}},mouseout:{name:"flotr:mouseout",handler:function(component){},consumer:function(component){component.api.flotr.hit.clearHit()}},reset:{name:"flotr:click",handler:function(component){component.draw()},consumer:function(component){component.draw()}},click:{name:"flotr:click",handler:function(component){var min=component.api.flotr.axes.x.min,max=component.api.flotr.axes.x.max;return{data:{x:{min:min,max:max}},x:{min:component.api.flotr.axes.x.d2p(min),max:component.api.flotr.axes.x.d2p(max)}}},consumer:function(component,selection){var x=selection.data.x,y=selection.data.y,options={};if(x){options.xaxis={min:x.min,max:x.max}}if(y){options.yaxis={min:y.min,max:y.max}}component.draw(null,options)}}}};function selectHandler(component,selection){var mode=component.options.config.selection.mode,axes=component.api.flotr.axes,datax,datay,x,y,options;if(mode.indexOf("x")!==-1){datax={};datax.min=selection.x1;datax.max=selection.x2;x={};x.min=axes.x.d2p(selection.x1);x.max=axes.x.d2p(selection.x2)}if(mode.indexOf("y")!==-1){datay={};datay.min=selection.y1;datay.max=selection.y2;y={};y.min=axes.y.d2p(selection.y1);y.max=axes.y.d2p(selection.y2)}options={data:{x:datax,y:datay},x:x,y:y};return options}A.flotr.Child=Child})();Flotr.addType("lite-lines",{options:{show:false,lineWidth:2,fill:false,fillBorder:false,fillColor:null,fillOpacity:.4},draw:function(options){var context=options.context,lineWidth=options.lineWidth,shadowSize=options.shadowSize,offset;context.save();context.lineCap="butt";context.lineWidth=lineWidth;context.strokeStyle=options.color;this.plot(options);context.restore()},plot:function(options){var context=options.context,xScale=options.xScale,yScale=options.yScale,data=options.data,length=data.length-1,zero=yScale(0),x0,y0;if(length<1)return;x0=xScale(data[0][0]);y0=yScale(data[0][1]);context.beginPath();context.moveTo(x0,y0);for(i=0;i<length;++i){context.lineTo(xScale(data[i+1][0]),yScale(data[i+1][1]))}if(!options.fill||options.fill&&!options.fillBorder)context.stroke();if(options.fill){x0=xScale(data[0][0]);context.fillStyle=options.fillStyle;context.lineTo(xScale(data[length][0]),zero);context.lineTo(x0,zero);context.lineTo(x0,yScale(data[0][1]));context.fill();if(options.fillBorder){context.stroke()}}},extendYRange:function(axis,data,options,lines){var o=axis.options;if(!o.max&&o.max!==0||!o.min&&o.min!==0){axis.max+=options.lineWidth*.01;axis.min-=options.lineWidth*.01}}});Flotr.addType("whiskers",{options:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,fillOpacity:.4,horizontal:false,stacked:false,centered:true},stack:{positive:[],negative:[],_positive:[],_negative:[]},draw:function(options){var context=options.context;context.save();context.lineJoin="miter";context.lineCap="butt";context.lineWidth=options.lineWidth;context.strokeStyle=options.color;if(options.fill)context.fillStyle=options.fillStyle;this.plot(options);context.restore()},plot:function(options){var data=options.data,context=options.context,shadowSize=options.shadowSize,xScale=options.xScale,yScale=options.yScale,zero=yScale(0),i,x;if(data.length<1)return;context.translate(-options.lineWidth,0);context.beginPath();for(i=0;i<data.length;i++){x=xScale(data[i][0]);context.moveTo(x,zero);context.lineTo(x,yScale(data[i][1]))}context.closePath();context.stroke()},drawHit:function(options){var args=options.args,context=options.context,shadowSize=options.shadowSize,xScale=options.xScale,yScale=options.yScale,zero=yScale(0),x=xScale(args.x),y=yScale(args.y);context.save();context.translate(-options.lineWidth,0);context.beginPath();context.moveTo(x,zero);context.lineTo(x,y);context.closePath();context.stroke();context.restore()},clearHit:function(options){var args=options.args,context=options.context,shadowSize=options.shadowSize,xScale=options.xScale,yScale=options.yScale,lineWidth=options.lineWidth,zero=yScale(0),x=xScale(args.x),y=yScale(args.y);context.save();context.clearRect(x-2*lineWidth,y-lineWidth,4*lineWidth,zero-y+lineWidth);context.restore()}});envision.components=envision.components||{};(function(){function QuadraticDrawing(options){this.options=options||{}}QuadraticDrawing.prototype={height:null,width:null,rendered:false,render:function(node){var canvas=document.createElement("canvas"),offset=bonzo(node).offset();this.height=offset.height;this.width=offset.width;bonzo(canvas).attr("height",offset.height).attr("width",offset.width).css({position:"absolute",top:"0px",left:"0px"});node.appendChild(canvas);bonzo(node).css({position:"relative"});if(typeof FlashCanvas!=="undefined")FlashCanvas.initElement(canvas);this.context=canvas.getContext("2d");this.rendered=true},draw:function(data,options,node){if(!this.rendered)this.render(node);var context=this.context,height=this.height,width=this.width,half=Math.round(height/2)-.5,min,max;options=options||{min:width/2,max:width/2};min=options.min+.5;max=options.max+.5;context.clearRect(0,0,width,height);if(min||max){context.save();context.strokeStyle=this.options.strokeStyle||"#B6D9FF";context.fillStyle=this.options.fillStyle||"rgba(182, 217, 255, .4)";context.beginPath();if(min<=1){context.moveTo(0,height);context.lineTo(0,-.5)}else{context.moveTo(min,height);context.quadraticCurveTo(min,half,Math.max(min-half,min/2),half);context.lineTo(Math.min(half,min/2),half);context.quadraticCurveTo(0,half,.5,-.5)}context.lineTo(width-.5,-.5);if(max>=width-1){context.lineTo(max,height)}else{context.quadraticCurveTo(width,half,Math.max(width-half,width-(width-max)/2),half);context.lineTo(Math.min(max+half,width-(width-max)/2),half);context.quadraticCurveTo(max,half,max,height)}context.stroke();context.closePath();context.fill();context.restore()}},trigger:function(component,name,options){if(name==="zoom"){this.zoom(component,options)}else if(name==="reset"){this.reset(component)}},zoom:function(component,options){var x=options.x||{},min=x.min,max=x.max,api=component.api;component.draw(null,{min:min,max:max})},reset:function(component){component.draw(null,{min:component.width/2,max:component.width/2})}};envision.components.QuadraticDrawing=QuadraticDrawing})();envision.templates=envision.templates||{};(function(){var V=envision;function processData(options){var resolution=options.resolution;options.preprocessor.bound(options.min,options.max).subsampleMinMax(resolution+Math.round(resolution/3))}function getDefaults(){return{price:{name:"envision-finance-price",config:{"lite-lines":{lineWidth:1,show:true,fill:true,fillOpacity:.2},mouse:{track:true,trackY:false,trackAll:true,sensibility:1,trackDecimals:4,position:"ne"},yaxis:{autoscale:true,autoscaleMargin:.05,noTicks:4,showLabels:true,min:0}},processData:processData},volume:{name:"envision-finance-volume",config:{whiskers:{show:true,lineWidth:2},mouse:{track:true,trackY:false,trackAll:true},yaxis:{autoscale:true,autoscaleMargin:.5}},processData:processData},summary:{name:"envision-finance-summary",config:{"lite-lines":{show:true,lineWidth:1,fill:true,fillOpacity:.2,fillBorder:true},xaxis:{noTicks:5,showLabels:true},yaxis:{autoscale:true,autoscaleMargin:.1},handles:{show:true},selection:{mode:"x"},grid:{verticalLines:false}}},connection:{name:"envision-finance-connection",adapterConstructor:V.components.QuadraticDrawing}}}function Finance(options){var data=options.data,defaults=getDefaults(),vis=new V.Visualization({name:"envision-finance"}),selection=new V.Interaction,hit=new V.Interaction,price,volume,connection,summary;if(options.defaults){defaults=Flotr.merge(options.defaults,defaults)}defaults.price.data=data.price;defaults.volume.data=data.volume;defaults.summary.data=data.summary;defaults.price.config.mouse.trackFormatter=options.trackFormatter||function(o){var index=o.index,value;if(price.api.preprocessor){index+=price.api.preprocessor.start}value="Price: $"+data.price[1][index]+", Vol: "+data.volume[1][index];return value};if(options.xTickFormatter){defaults.summary.config.xaxis.tickFormatter=options.xTickFormatter}defaults.price.config.yaxis.tickFormatter=options.yTickFormatter||function(n){return"$"+n};price=new V.Component(defaults.price);volume=new V.Component(defaults.volume);connection=new V.Component(defaults.connection);summary=new V.Component(defaults.summary);vis.add(price).add(volume).add(connection).add(summary).render(options.container);selection.follower(price).follower(volume).follower(connection).leader(summary).add(V.actions.selection,options.selectionCallback?{callback:options.selectionCallback}:null);hit.group([price,volume]).add(V.actions.hit);if(options.selection){summary.trigger("select",options.selection)}this.vis=vis;this.selection=selection;this.hit=hit;this.price=price;this.volume=volume;this.summary=summary}V.templates.Finance=Finance})();(function(){var V=envision;function getDefaults(){return{detail:{name:"envision-timeseries-detail",config:{"lite-lines":{lineWidth:1,show:true}}},summary:{name:"envision-timeseries-summary",config:{"lite-lines":{lineWidth:1,show:true},handles:{show:true},selection:{mode:"x"},yaxis:{autoscale:true,autoscaleMargin:.1}}},connection:{name:"envision-timeseries-connection",adapterConstructor:V.components.QuadraticDrawing}}}function TimeSeries(options){var data=options.data,defaults=getDefaults(),vis=new V.Visualization({name:"envision-timeseries"}),selection=new V.Interaction,detail,summary,connection;if(options.defaults){defaults=Flotr.merge(options.defaults,defaults)}defaults.detail.data=data.detail;defaults.summary.data=data.summary;detail=new V.Component(defaults.detail);connection=new V.Component(defaults.connection);summary=new V.Component(defaults.summary);vis.add(detail).add(connection).add(summary).render(options.container);selection.follower(detail).follower(connection).leader(summary).add(V.actions.selection,options.selectionCallback?{callback:options.selectionCallback}:null);if(options.selection){summary.trigger("select",options.selection)}this.vis=vis;this.selection=selection;this.detail=detail;this.summary=summary}V.templates.TimeSeries=TimeSeries})();(function(){var V=envision,Zoom;function defaultsZoom(){return{name:"zoom"}}function defaultsSummary(){return{name:"summary",config:{handles:{show:true},selection:{mode:"x"}}}}function getDefaults(options,defaults){var o=_.defaults(options,defaults);o.flotr=_.defaults(o.flotr,defaults.flotr);return o}Zoom=function(options){var vis=new V.Visualization,zoom=new V.Component(getDefaults(options.zoom||{},defaultsZoom())),summary=new V.Component(getDefaults(options.summary||{},defaultsSummary())),interaction=new V.Interaction({leader:summary});vis.add(zoom).add(summary);interaction.add(V.actions.selection);interaction.follower(zoom);this.vis=vis;this.interaction=interaction;if(options.container){this.render(options.container)}};Zoom.prototype={render:function(container){this.vis.render(container)}};V.templates.Zoom=Zoom})();(function(){function a(a){return a.target}function b(a){return a.source}function c(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function d(a){var b=-1,c=a.length,d=[];while(++b<c)d.push(a[b]);return d}function e(a){return Array.prototype.slice.call(a)}function f(){}function g(a){return a}function h(){return!0}function i(a){return typeof a=="function"?a:function(){return a}}function j(a,b,c){return function(){var d=c.apply(b,arguments);return arguments.length?a:d}}function k(a){return a!=null&&!isNaN(a)}function l(a){return a.length}function m(a){return a.trim().replace(/\s+/g," ")}function n(a){var b=1;while(a*b%1)b*=10;return b}function o(a){return a.length===1?function(b,c){a(b==null?c:null)}:a}function p(a){return a.responseText}function q(a){return JSON.parse(a.responseText)}function r(a){var b=document.createRange();return b.selectNode(document.body),b.createContextualFragment(a.responseText)}function s(a){return a.responseXML}function t(){}function u(a){function b(){var b=c,d=-1,e=b.length,f;while(++d<e)(f=b[d].on)&&f.apply(this,arguments);return a}var c=[],d=new f;return b.on=function(b,e){var f=d.get(b),g;return arguments.length<2?f&&f.on:(f&&(f.on=null,c=c.slice(0,g=c.indexOf(f)).concat(c.slice(g+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function v(a,b){return b-(a?1+Math.floor(Math.log(a+Math.pow(10,1+Math.floor(Math.log(a)/Math.LN10)-b))/Math.LN10):1)}function w(a){return a+""}function x(a,b){var c=Math.pow(10,Math.abs(8-b)*3);return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function y(a){return function(b){return b<=0?0:b>=1?1:a(b)}}function z(a){return function(b){return 1-a(1-b)}}function A(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function B(a){return a*a}function C(a){return a*a*a}function D(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;
return 4*(a<.5?c:3*(a-b)+c-.75)}function E(a){return function(b){return Math.pow(b,a)}}function F(a){return 1-Math.cos(a*kd/2)}function G(a){return Math.pow(2,10*(a-1))}function H(a){return 1-Math.sqrt(1-a*a)}function I(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/(2*kd)*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,10*-d)*Math.sin((d-c)*2*kd/b)}}function J(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function K(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function L(){d3.event.stopPropagation(),d3.event.preventDefault()}function M(){var a=d3.event,b;while(b=a.sourceEvent)a=b;return a}function N(a){var b=new t,c=0,d=arguments.length;while(++c<d)b[arguments[c]]=u(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=d3.event;e.target=a,d3.event=e,b[e.type].apply(c,d)}finally{d3.event=f}}},b}function O(a){var b=[a.a,a.b],c=[a.c,a.d],d=Q(b),e=P(b,c),f=Q(R(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*nd,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*nd:0}function P(a,b){return a[0]*b[0]+a[1]*b[1]}function Q(a){var b=Math.sqrt(P(a,a));return b&&(a[0]/=b,a[1]/=b),b}function R(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function S(a){return a=="transform"?d3.interpolateTransform:d3.interpolate}function T(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function U(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function V(){}function W(a,b,c){return new X(a,b,c)}function X(a,b,c){this.r=a,this.g=b,this.b=c}function Y(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function Z(a,b,c){var d=0,e=0,f=0,g,h,i;g=/([a-z]+)\((.*)\)/i.exec(a);if(g){h=g[2].split(",");switch(g[1]){case"hsl":return c(parseFloat(h[0]),parseFloat(h[1])/100,parseFloat(h[2])/100);case"rgb":return b(bb(h[0]),bb(h[1]),bb(h[2]))}}return(i=Hd.get(a))?b(i.r,i.g,i.b):(a!=null&&a.charAt(0)==="#"&&(a.length===4?(d=a.charAt(1),d+=d,e=a.charAt(2),e+=e,f=a.charAt(3),f+=f):a.length===7&&(d=a.substring(1,3),e=a.substring(3,5),f=a.substring(5,7)),d=parseInt(d,16),e=parseInt(e,16),f=parseInt(f,16)),b(d,e,f))}function $(a,b,c){var d=Math.min(a/=255,b/=255,c/=255),e=Math.max(a,b,c),f=e-d,g,h,i=(e+d)/2;return f?(h=i<.5?f/(e+d):f/(2-e-d),a==e?g=(b-c)/f+(b<c?6:0):b==e?g=(c-a)/f+2:g=(a-b)/f+4,g*=60):h=g=0,cb(g,h,i)}function _(a,b,c){a=ab(a),b=ab(b),c=ab(c);var d=nb((.4124564*a+.3575761*b+.1804375*c)/Ld),e=nb((.2126729*a+.7151522*b+.072175*c)/Md),f=nb((.0193339*a+.119192*b+.9503041*c)/Nd);return ib(116*e-16,500*(d-e),200*(e-f))}function ab(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function bb(a){var b=parseFloat(a);return a.charAt(a.length-1)==="%"?Math.round(b*2.55):b}function cb(a,b,c){return new db(a,b,c)}function db(a,b,c){this.h=a,this.s=b,this.l=c}function eb(a,b,c){function d(a){return a>360?a-=360:a<0&&(a+=360),a<60?f+(g-f)*a/60:a<180?g:a<240?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(d(a)*255)}var f,g;return a%=360,a<0&&(a+=360),b=b<0?0:b>1?1:b,c=c<0?0:c>1?1:c,g=c<=.5?c*(1+b):c+b-c*b,f=2*c-g,W(e(a+120),e(a),e(a-120))}function fb(a,b,c){return new gb(a,b,c)}function gb(a,b,c){this.h=a,this.c=b,this.l=c}function hb(a,b,c){return ib(c,Math.cos(a*=md)*b,Math.sin(a)*b)}function ib(a,b,c){return new jb(a,b,c)}function jb(a,b,c){this.l=a,this.a=b,this.b=c}function kb(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=mb(e)*Ld,d=mb(d)*Md,f=mb(f)*Nd,W(ob(3.2404542*e-1.5371385*d-.4985314*f),ob(-.969266*e+1.8760108*d+.041556*f),ob(.0556434*e-.2040259*d+1.0572252*f))}function lb(a,b,c){return fb(Math.atan2(c,b)/kd*180,Math.sqrt(b*b+c*c),a)}function mb(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function nb(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function ob(a){return Math.round(255*(a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function pb(a){return qd(a,Ud),a}function qb(a){return function(){return Pd(a,this)}}function rb(a){return function(){return Qd(a,this)}}function sb(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);c==null?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);c==null?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=d3.ns.qualify(a),b==null?a.local?d:c:typeof b=="function"?a.local?h:g:a.local?f:e}function tb(a){return new RegExp("(?:^|\\s+)"+d3.requote(a)+"(?:\\s+|$)","g")}function ub(a,b){function c(){var c=-1;while(++c<e)a[c](this,b)}function d(){var c=-1,d=b.apply(this,arguments);while(++c<e)a[c](this,d)}a=a.trim().split(/\s+/).map(vb);var e=a.length;return typeof b=="function"?d:c}function vb(a){var b=tb(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.className,f=e.baseVal!=null,g=f?e.baseVal:e;d?(b.lastIndex=0,b.test(g)||(g=m(g+" "+a),f?e.baseVal=g:c.className=g)):g&&(g=m(g.replace(b," ")),f?e.baseVal=g:c.className=g)}}function wb(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);d==null?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return b==null?d:typeof b=="function"?f:e}function xb(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);c==null?delete this[a]:this[a]=c}return b==null?c:typeof b=="function"?e:d}function yb(a){return{__data__:a}}function zb(a){return function(){return Td(this,a)}}function Ab(a){return arguments.length||(a=d3.ascending),function(b,c){return a(b&&b.__data__,c&&c.__data__)}}function Bb(a,b,c){function d(){var b=this[f];b&&(this.removeEventListener(a,b,b.$),delete this[f])}function e(){function e(a){var c=d3.event;d3.event=a,h[0]=g.__data__;try{b.apply(g,h)}finally{d3.event=c}}var g=this,h=od(arguments);d.call(this),this.addEventListener(a,this[f]=e,e.$=c),e._=b}var f="__on"+a,g=a.indexOf(".");return g>0&&(a=a.substring(0,g)),b?e:d}function Cb(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=a[c],f=0,g=e.length,h;f<g;f++)(h=e[f])&&b(h,f,c);return a}function Db(a){return qd(a,Wd),a}function Eb(a,b){return qd(a,Xd),a.id=b,a}function Fb(a,b,c,d){var e=a.__transition__||(a.__transition__={active:0,count:0}),g=e[c];if(!g){var h=d.time;return g=e[c]={tween:new f,event:d3.dispatch("start","end"),time:h,ease:d.ease,delay:d.delay,duration:d.duration},++e.count,d3.timer(function(d){function f(d){return e.active>c?j():(e.active=c,m.start.call(a,k,b),g.tween.forEach(function(c,d){(d=d.call(a,k,b))&&p.push(d)}),i(d)||d3.timer(i,0,h),1)}function i(d){if(e.active!==c)return j();var f=(d-n)/o,g=l(f),h=p.length;while(h>0)p[--h].call(a,g);if(f>=1)return j(),m.end.call(a,k,b),1}function j(){return--e.count?delete e[c]:delete a.__transition__,1}var k=a.__data__,l=g.ease,m=g.event,n=g.delay,o=g.duration,p=[];return n<=d?f(d):d3.timer(f,n,h),1},0,h),g}}function Gb(a){return a==null&&(a=""),function(){this.textContent=a}}function Hb(a,b,c,d){var e=a.id;return Cb(a,typeof c=="function"?function(a,f,g){a.__transition__[e].tween.set(b,d(c.call(a,a.__data__,f,g)))}:(c=d(c),function(a){a.__transition__[e].tween.set(b,c)}))}function Ib(){var a,b=Date.now(),c=be;while(c)a=b-c.then,a>=c.delay&&(c.flush=c.callback(a)),c=c.next;var d=Jb()-b;d>24?(isFinite(d)&&(clearTimeout(de),de=setTimeout(Ib,d)),ce=0):(ce=1,ee(Ib))}function Jb(){var a=null,b=be,c=Infinity;while(b)b.flush?(delete ae[b.callback.id],b=a?a.next=b.next:be=b.next):(c=Math.min(c,b.then+b.delay),b=(a=b).next);return c}function Kb(a,b){var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(fe<0&&(window.scrollX||window.scrollY)){c=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var e=c[0][0].getScreenCTM();fe=!e.f&&!e.e,c.remove()}return fe?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var f=a.getBoundingClientRect();return[b.clientX-f.left-a.clientLeft,b.clientY-f.top-a.clientTop]}function Lb(){}function Mb(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function Nb(a){return a.rangeExtent?a.rangeExtent():Mb(a.range())}function Ob(a,b){var c=0,d=a.length-1,e=a[c],f=a[d],g;f<e&&(g=c,c=d,d=g,g=e,e=f,f=g);if(b=b(f-e))a[c]=b.floor(e),a[d]=b.ceil(f);return a}function Pb(){return Math}function Qb(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Xb:Wb,i=d?U:T;return g=e(a,b,i,c),h=e(b,a,i,d3.interpolate),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(d3.interpolateRound)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return Ub(a,b)},f.tickFormat=function(b){return Vb(a,b)},f.nice=function(){return Ob(a,Sb),e()},f.copy=function(){return Qb(a,b,c,d)},e()}function Rb(a,b){return d3.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Sb(a){return a=Math.pow(10,Math.round(Math.log(a)/Math.LN10)-1),a&&{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}}function Tb(a,b){var c=Mb(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return f<=.15?e*=10:f<=.35?e*=5:f<=.75&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+e*.5,c[2]=e,c}function Ub(a,b){return d3.range.apply(d3,Tb(a,b))}function Vb(a,b){return d3.format(",."+Math.max(0,-Math.floor(Math.log(Tb(a,b)[2])/Math.LN10+.01))+"f")}function Wb(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Xb(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());while(++g<=h)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=d3.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function Yb(a,b){function c(c){return a(b(c))}var d=b.pow;return c.invert=function(b){return d(a.invert(b))},c.domain=function(e){return arguments.length?(b=e[0]<0?$b:Zb,d=b.pow,a.domain(e.map(b)),c):a.domain().map(d)},c.nice=function(){return a.domain(Ob(a.domain(),Pb)),c},c.ticks=function(){var c=Mb(a.domain()),e=[];if(c.every(isFinite)){var f=Math.floor(c[0]),g=Math.ceil(c[1]),h=d(c[0]),i=d(c[1]);if(b===$b){e.push(d(f));for(;f++<g;)for(var j=9;j>0;j--)e.push(d(f)*j)}else{for(;f<g;f++)for(var j=1;j<10;j++)e.push(d(f)*j);e.push(d(f))}for(f=0;e[f]<h;f++);for(g=e.length;e[g-1]>i;g--);e=e.slice(f,g)}return e},c.tickFormat=function(a,e){arguments.length<2&&(e=ge);if(!arguments.length)return e;var f=Math.max(.1,a/c.ticks().length),g=b===$b?(h=-1e-12,Math.floor):(h=1e-12,Math.ceil),h;return function(a){return a/d(g(b(a)+h))<=f?e(a):""}},c.copy=function(){return Yb(a.copy(),b)},Rb(c,a)}function Zb(a){return Math.log(a<0?0:a)/Math.LN10}function $b(a){return-Math.log(a>0?0:-a)/Math.LN10}function _b(a,b){function c(b){return a(d(b))}var d=ac(b),e=ac(1/b);return c.invert=function(b){return e(a.invert(b))},c.domain=function(b){return arguments.length?(a.domain(b.map(d)),c):a.domain().map(e)},c.ticks=function(a){return Ub(c.domain(),a)},c.tickFormat=function(a){return Vb(c.domain(),a)},c.nice=function(){return c.domain(Ob(c.domain(),Sb))},c.exponent=function(a){if(!arguments.length)return b;var f=c.domain();return d=ac(b=a),e=ac(1/b),c.domain(f)},c.copy=function(){return _b(a.copy(),b)},Rb(c,a)}function ac(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function bc(a,b){function c(b){return g[((e.get(b)||e.set(b,a.push(b)))-1)%g.length]}function d(b,c){return d3.range(a.length).map(function(a){return b+c*a})}var e,g,h;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new f;var g=-1,h=d.length,i;while(++g<h)e.has(i=d[g])||e.set(i,a.push(i));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(g=a,h=0,b={t:"range",a:arguments},c):g},c.rangePoints=function(e,f){arguments.length<2&&(f=0);var i=e[0],j=e[1],k=(j-i)/(Math.max(1,a.length-1)+f);return g=d(a.length<2?(i+j)/2:i+k*f/2,k),h=0,b={t:"rangePoints",a:arguments},c},c.rangeBands=function(e,f,i){arguments.length<2&&(f=0),arguments.length<3&&(i=f);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-f+2*i);return g=d(k+m*i,m),j&&g.reverse(),h=m*(1-f),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,f,i){arguments.length<2&&(f=0),arguments.length<3&&(i=f);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-f+2*i)),n=l-k-(a.length-f)*m;return g=d(k+Math.round(n/2),m),j&&g.reverse(),h=Math.round(m*(1-f)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return h},c.rangeExtent=function(){return Mb(b.a[0])},c.copy=function(){return bc(a,b)},c.domain(a)}function cc(a,b){function c(){var c=0,f=b.length;e=[];while(++c<f)e[c-1]=d3.quantile(a,c/f);return d}function d(a){return isNaN(a=+a)?NaN:b[d3.bisect(e,a)]}var e;return d.domain=function(b){return arguments.length?(a=b.filter(function(a){return!isNaN(a)}).sort(d3.ascending),c()):a},d.range=function(a){return arguments.length?(b=a,c()):b},d.quantiles=function(){return e},d.copy=function(){return cc(a,b)},c()}function dc(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.copy=function(){return dc(a,b,c)},e()}function ec(a,b){function c(c){return b[d3.bisect(a,c)]}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.copy=function(){return ec(a,b)},c}function fc(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return Ub(a,b)},b.tickFormat=function(b){return Vb(a,b)},b.copy=function(){return fc(a)},b}function gc(a){var b=a.source,c=a.target,d=ic(b,c),e=[b];while(b!==d)b=b.parent,e.push(b);var f=e.length;while(c!==d)e.splice(f,0,c),c=c.parent;return e}function hc(a){var b=[],c=a.parent;while(c!=null)b.push(a),a=c,c=c.parent;return b.push(a),b}function ic(a,b){if(a===b)return a;var c=hc(a),d=hc(b),e=c.pop(),f=d.pop(),g=null;while(e===f)g=e,e=c.pop(),f=d.pop();return g}function jc(a){a.fixed|=2}function kc(a){a.fixed&=1}function lc(a){a.fixed|=4,a.px=a.x,a.py=a.y}function mc(a){a.fixed&=3}function nc(a,b,c){var d=0,e=0;a.charge=0;if(!a.leaf){var f=a.nodes,g=f.length,h=-1,i;while(++h<g){i=f[h];if(i==null)continue;nc(i,b,c),a.charge+=i.charge,d+=i.charge*i.cx,e+=i.charge*i.cy}}if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function oc(){return 20}function pc(){return 1}function qc(a){return a.x}function rc(a){return a.y}function sc(a,b,c){a.y0=b,a.y=c}function tc(a){return d3.range(a.length)}function uc(a){var b=-1,c=a[0].length,d=[];while(++b<c)d[b]=0;return d}function vc(a){var b=1,c=0,d=a[0][1],e,f=a.length;for(;b<f;++b)(e=a[b][1])>d&&(c=b,d=e);return c}function wc(a){return a.reduce(xc,0)}function xc(a,b){return a+b[1]}function yc(a,b){return zc(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function zc(a,b){var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];while(++c<=b)f[c]=e*c+d;return f}function Ac(a){return[d3.min(a),d3.max(a)]}function Bc(a,b){return d3.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=Fc,a}function Cc(a){return a.children}function Dc(a){return a.value}function Ec(a,b){return b.value-a.value}function Fc(a){return d3.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function Gc(a,b){return a.value-b.value}function Hc(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function Ic(a,b){a._pack_next=b,b._pack_prev=a}function Jc(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return e*e-c*c-d*d>.001}function Kc(a){function b(a){d=Math.min(a.x-a.r,d),e=Math.max(a.x+a.r,e),f=Math.min(a.y-a.r,f),g=Math.max(a.y+a.r,g)}if(!(c=a.children)||!(n=c.length))return;var c,d=Infinity,e=-Infinity,f=Infinity,g=-Infinity,h,i,j,k,l,m,n;c.forEach(Lc),h=c[0],h.x=-h.r,h.y=0,b(h);if(n>1){i=c[1],i.x=i.r,i.y=0,b(i);if(n>2){j=c[2],Oc(h,i,j),b(j),Hc(h,j),h._pack_prev=j,Hc(j,i),i=h._pack_next;for(k=3;k<n;k++){Oc(h,i,j=c[k]);var o=0,p=1,q=1;for(l=i._pack_next;l!==i;l=l._pack_next,p++)if(Jc(l,j)){o=1;break}if(o==1)for(m=h._pack_prev;m!==l._pack_prev;m=m._pack_prev,q++)if(Jc(m,j))break;o?(p<q||p==q&&i.r<h.r?Ic(h,i=l):Ic(h=m,i),k--):(Hc(h,j),i=j,b(j))}}}var r=(d+e)/2,s=(f+g)/2,t=0;for(k=0;k<n;k++)j=c[k],j.x-=r,j.y-=s,t=Math.max(t,j.r+Math.sqrt(j.x*j.x+j.y*j.y));a.r=t,c.forEach(Mc)}function Lc(a){a._pack_next=a._pack_prev=a}function Mc(a){delete a._pack_next,delete a._pack_prev}function Nc(a,b,c,d){var e=a.children;a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d;if(e){var f=-1,g=e.length;while(++f<g)Nc(e[f],b,c,d)}}function Oc(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function Pc(a){return 1+d3.max(a,function(a){return a.y})}function Qc(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Rc(a){var b=a.children;return b&&b.length?Rc(b[0]):a}function Sc(a){var b=a.children,c;return b&&(c=b.length)?Sc(b[c-1]):a}function Tc(a,b){return a.parent==b.parent?1:2}function Uc(a){var b=a.children;return b&&b.length?b[0]:a._tree.thread}function Vc(a){var b=a.children,c;return b&&(c=b.length)?b[c-1]:a._tree.thread}function Wc(a,b){var c=a.children;if(c&&(e=c.length)){var d,e,f=-1;while(++f<e)b(d=Wc(c[f],b),a)>0&&(a=d)}return a}function Xc(a,b){return a.x-b.x}function Yc(a,b){return b.x-a.x}function Zc(a,b){return a.depth-b.depth}function $c(a,b){function c(a,d){var e=a.children;if(e&&(i=e.length)){var f,g=null,h=-1,i;while(++h<i)f=e[h],c(f,g),g=f}b(a,d)}c(a,null)}function _c(a){var b=0,c=0,d=a.children,e=d.length,f;while(--e>=0)f=d[e]._tree,f.prelim+=b,f.mod+=b,b+=f.shift+(c+=f.change)}function ad(a,b,c){a=a._tree,b=b._tree;var d=c/(b.number-a.number);a.change+=d,b.change-=d,b.shift+=c,b.prelim+=c,b.mod+=c}function bd(a,b,c){return a._tree.ancestor.parent==b.parent?a._tree.ancestor:c}function cd(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function dd(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return e<0&&(c+=e/2,e=0),f<0&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}var ed=".",fd=",",gd=[3,3];Date.now||(Date.now=function(){return+new Date});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(hd){var id=CSSStyleDeclaration.prototype,jd=id.setProperty;id.setProperty=function(a,b,c){jd.call(this,a,b+"",c)}}d3={version:"3.0.2"};var kd=Math.PI,ld=1e-6,md=kd/180,nd=180/kd,od=e;try{od(document.documentElement.childNodes)[0].nodeType}catch(pd){od=d}var qd=[].__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]};d3.map=function(a){var b=new f;for(var c in a)b.set(c,a[c]);return b},c(f,{has:function(a){return rd+a in this},get:function(a){return this[rd+a]},set:function(a,b){return this[rd+a]=b},remove:function(a){return a=rd+a,a in this&&delete this[a]},keys:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},forEach:function(a){for(var b in this)b.charCodeAt(0)===sd&&a.call(this,b.substring(1),this[b])}});var rd="\x00",sd=rd.charCodeAt(0);d3.functor=i,d3.rebind=function(a,b){var c=1,d=arguments.length,e;while(++c<d)a[e=arguments[c]]=j(a,b,b[e]);return a},d3.ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},d3.mean=function(a,b){var c=a.length,d,e=0,f=-1,g=0;if(arguments.length===1)while(++f<c)k(d=a[f])&&(e+=(d-e)/++g);else while(++f<c)k(d=b.call(a,a[f],f))&&(e+=(d-e)/++g);return g?e:undefined},d3.median=function(a,b){return arguments.length>1&&(a=a.map(b)),a=a.filter(k),a.length?d3.quantile(a.sort(d3.ascending),.5):undefined},d3.min=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&e>f&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&e>f&&(e=f)}return e},d3.max=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&f>e&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&f>e&&(e=f)}return e},d3.extent=function(a,b){var c=-1,d=a.length,e,f,g;if(arguments.length===1){while(++c<d&&((e=g=a[c])==null||e!=e))e=g=undefined;while(++c<d)(f=a[c])!=null&&(e>f&&(e=f),g<f&&(g=f))}else{while(++c<d&&((e=g=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&(e>f&&(e=f),g<f&&(g=f))}return[e,g]},d3.random={normal:function(a,b){var c=arguments.length;return c<2&&(b=1),c<1&&(a=0),function(){var c,d,e;do c=Math.random()*2-1,d=Math.random()*2-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(a,b){var c=arguments.length;c<2&&(b=1),c<1&&(a=0);var d=d3.random.normal();return function(){return Math.exp(a+b*d())}},irwinHall:function(a){return function(){for(var b=0,c=0;c<a;c++)b+=Math.random();return b/a}}},d3.sum=function(a,b){var c=0,d=a.length,e,f=-1;if(arguments.length===1)while(++f<d)isNaN(e=+a[f])||(c+=e);else while(++f<d)isNaN(e=+b.call(a,a[f],f))||(c+=e);return c},d3.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},d3.shuffle=function(a){var b=a.length,c,d;while(b)d=Math.random()*b--|0,c=a[b],a[b]=a[d],a[d]=c;return a},d3.transpose=function(a){return d3.zip.apply(d3,a)},d3.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,b=d3.min(arguments,l),c=new Array(b);++a<b;)for(var d=-1,e,f=c[a]=new Array(e);++d<e;)f[d]=arguments[d][a];return c},d3.bisector=function(a){return{left:function(b,c,d,e){arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);while(d<e){var f=d+e>>>1;a.call(b,b[f],f)<c?d=f+1:e=f}return d},right:function(b,c,d,e){arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);while(d<e){var f=d+e>>>1;c<a.call(b,b[f],f)?e=f:d=f+1}return d}}};var td=d3.bisector(function(a){return a});d3.bisectLeft=td.left,d3.bisect=d3.bisectRight=td.right,d3.nest=function(){function a(b,e){if(e>=d.length)return h?h.call(c,b):g?b.sort(g):b;var i=-1,j=b.length,k=d[e++],l,m,n=new f,o,p={};while(++i<j)(o=n.get(l=k(m=b[i])))?o.push(m):n.set(l,[m]);return n.forEach(function(b,c){p[b]=a(c,e)}),p}function b(a,c){if(c>=d.length)return a;var f=[],g=e[c++],h;for(h in a)f.push({key:h,values:b(a[h],c)});return g&&f.sort(function(a,b){return g(a.key,b.key)}),f}var c={},d=[],e=[],g,h;return c.map=function(b){return a(b,0)},c.entries=function(c){return b(a(c,0),0)},c.key=function(a){return d.push(a),c},c.sortKeys=function(a){return e[d.length-1]=a,c},c.sortValues=function(a){return g=a,c},c.rollup=function(a){return h=a,c},c},d3.keys=function(a){var b=[];for(var c in a)b.push(c);return b},d3.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},d3.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},d3.permute=function(a,b){var c=[],d=-1,e=b.length;while(++d<e)c[d]=a[b[d]];return c},d3.merge=function(a){return Array.prototype.concat.apply([],a)},d3.range=function(a,b,c){arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0));if((b-a)/c===Infinity)throw new Error("infinite range");var d=[],e=n(Math.abs(c)),f=-1,g;a*=e,b*=e,c*=e;if(c<0)while((g=a+c*++f)>b)d.push(g/e);else while((g=a+c*++f)<b)d.push(g/e);return d},d3.requote=function(a){return a.replace(ud,"\\$&")};var ud=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)},d3.xhr=function(a,b,c){function d(){var a=j.status;!a&&j.responseText||a>=200&&a<300||a===304?f.load.call(e,i.call(e,j)):f.error.call(e,j)}var e={},f=d3.dispatch("progress","load","error"),h={},i=g,j=new(window.XDomainRequest&&/^(http(s)?:)?\/\//.test(a)?XDomainRequest:XMLHttpRequest);return"onload"in j?j.onload=j.onerror=d:j.onreadystatechange=function(){j.readyState>3&&d()},j.onprogress=function(a){var b=d3.event;d3.event=a;try{f.progress.call(e,j)}finally{d3.event=b}},e.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(b==null?delete h[a]:h[a]=b+"",e)},e.mimeType=function(a){return arguments.length?(b=a==null?null:a+"",e):b},e.response=function(a){return i=a,e},["get","post"].forEach(function(a){e[a]=function(){return e.send.apply(e,[a].concat(od(arguments)))}}),e.send=function(c,d,f){arguments.length===2&&typeof d=="function"&&(f=d,d=null),j.open(c,a,!0),b!=null&&!("accept"in h)&&(h.accept=b+",*/*");if(j.setRequestHeader)for(var g in h)j.setRequestHeader(g,h[g]);return b!=null&&j.overrideMimeType&&j.overrideMimeType(b),f!=null&&e.on("error",f).on("load",function(a){f(null,a)}),j.send(d==null?null:d),e},e.abort=function(){return j.abort(),e},d3.rebind(e,f,"on"),arguments.length===2&&typeof b=="function"&&(c=b,b=null),c==null?e:e.get(o(c))},d3.text=function(){return d3.xhr.apply(d3,arguments).response(p)},d3.json=function(a,b){return d3.xhr(a,"application/json",b).response(q)},d3.html=function(a,b){return d3.xhr(a,"text/html",b).response(r)},d3.xml=function(){return d3.xhr.apply(d3,arguments).response(s)};var vd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:vd,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),vd.hasOwnProperty(c)?{space:vd[c],local:a}:a}},d3.dispatch=function(){var a=new t,b=-1,c=arguments.length;while(++b<c)a[arguments[b]]=u(a);return a},t.prototype.on=function(a,b){var c=a.indexOf("."),d="";return c>0&&(d=a.substring(c+1),a=a.substring(0,c)),arguments.length<2?this[a].on(d):this[a].on(d,b)},d3.format=function(a){var b=wd.exec(a),c=b[1]||" ",d=b[2]||">",e=b[3]||"",f=b[4]||"",g=b[5],h=+b[6],i=b[7],j=b[8],k=b[9],l=1,m="",n=!1;j&&(j=+j.substring(1));if(g||c==="0"&&d==="=")g=c="0",d="=",i&&(h-=Math.floor((h-1)/4));switch(k){case"n":i=!0,k="g";break;case"%":l=100,m="%",k="f";break;case"p":l=100,m="%",k="r";break;case"b":case"o":case"x":case"X":f&&(f="0"+k.toLowerCase());case"c":case"d":n=!0,j=0;break;case"s":l=-1,k="r"}f==="#"&&(f=""),k=="r"&&!j&&(k="g"),k=xd.get(k)||w;var o=g&&i;return function(a){if(n&&a%1)return"";var b=a<0||a===0&&1/a<0?(a=-a,"-"):e;if(l<0){var p=d3.formatPrefix(a,j);a=p.scale(a),m=p.symbol}else a*=l;a=k(a,j),!g&&i&&(a=yd(a));var q=f.length+a.length+(o?0:b.length),r=q<h?new Array(q=h-q+1).join(c):"";return o&&(a=yd(r+a)),ed&&a.replace(".",ed),b+=f,(d==="<"?b+a+r:d===">"?r+b+a:d==="^"?r.substring(0,q>>=1)+b+a+r.substring(q):b+(o?a:r+a))+m}};var wd=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,xd=d3.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return d3.round(a,b=v(a,b)).toFixed(Math.max(0,Math.min(20,b)))}}),yd=g;if(gd){var zd=gd.length;yd=function(a){var b=a.lastIndexOf("."),c=b>=0?"."+a.substring(b+1):(b=a.length,""),d=[],e=0,f=gd[0];while(b>0&&f>0)d.push(a.substring(b-=f,b+f)),f=gd[e=(e+1)%zd];return d.reverse().join(fd||"")+c}}var Ad=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(x);d3.formatPrefix=function(a,b){var c=0;return a&&(a<0&&(a*=-1),b&&(a=d3.round(a,v(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,Math.floor((c<=0?c+1:c-1)/3)*3))),Ad[8+c/3]};var Bd=function(){return g},Cd=d3.map({linear:Bd,poly:E,quad:function(){return B},cubic:function(){return C},sin:function(){return F},exp:function(){return G},circle:function(){return H},elastic:I,back:J,bounce:function(){return K}}),Dd=d3.map({"in":g,out:z,"in-out":A,"out-in":function(a){return A(z(a))}});d3.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return c=Cd.get(c)||Bd,d=Dd.get(d)||g,y(d(c.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(a){var b=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate();return new O(c?c.matrix:Ed)})(a)},O.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Ed={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(a,b){var c=d3.interpolators.length,d;while(--c>=0&&!(d=d3.interpolators[c](a,b)));return d},d3.interpolateNumber=function(a,b){return b-=a,function(c){return a+b*c}},d3.interpolateRound=function(a,b){return b-=a,function(c){return Math.round(a+b*c)}},d3.interpolateString=function(a,b){var c,d,e,f=0,g=0,h=[],i=[],j,k;Fd.lastIndex=0;for(d=0;c=Fd.exec(b);++d)c.index&&h.push(b.substring(f,g=c.index)),i.push({i:h.length,x:c[0]}),h.push(null),f=Fd.lastIndex;f<b.length&&h.push(b.substring(f));for(d=0,j=i.length;(c=Fd.exec(a))&&d<j;++d){k=i[d];if(k.x==c[0]){if(k.i)if(h[k.i+1]==null){h[k.i-1]+=k.x,h.splice(k.i,1);for(e=d+1;e<j;++e)i[e].i--}else{h[k.i-1]+=k.x+h[k.i+1],h.splice(k.i,2);for(e=d+1;e<j;++e)i[e].i-=2}else if(h[k.i+1]==null)h[k.i]=k.x;else{h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1);for(e=d+1;e<j;++e)i[e].i--}i.splice(d,1),j--,d--}else k.x=d3.interpolateNumber(parseFloat(c[0]),parseFloat(k.x))}while(d<j)k=i.pop(),h[k.i+1]==null?h[k.i]=k.x:(h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1)),j--;return h.length===1?h[0]==null?i[0].x:function(){return b}:function(a){for(d=0;d<j;++d)h[(k=i[d]).i]=k.x(a);return h.join("")}},d3.interpolateTransform=function(a,b){var c=[],d=[],e,f=d3.transform(a),g=d3.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(c.push("translate(",null,",",null,")"),d.push({i:1,x:d3.interpolateNumber(h[0],i[0])},{i:3,x:d3.interpolateNumber(h[1],i[1])})):i[0]||i[1]?c.push("translate("+i+")"):c.push(""),j!=k?(j-k>180?k+=360:k-j>180&&(j+=360),d.push({i:c.push(c.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(j,k)})):k&&c.push(c.pop()+"rotate("+k+")"),l!=m?d.push({i:c.push(c.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(l,m)}):m&&c.push(c.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(e=c.push(c.pop()+"scale(",null,",",null,")"),d.push({i:e-4,x:d3.interpolateNumber(n[0],o[0])},{i:e-2,x:d3.interpolateNumber(n[1],o[1])})):(o[0]!=1||o[1]!=1)&&c.push(c.pop()+"scale("+o+")"),e=d.length,function(a){var b=-1,f;while(++b<e)c[(f=d[b]).i]=f.x(a);return c.join("")}},d3.interpolateRgb=function(a,b){a=d3.rgb(a),b=d3.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+Y(Math.round(c+f*a))+Y(Math.round(d+g*a))+Y(Math.round(e+h*a))}},d3.interpolateHsl=function(a,b){a=d3.hsl(a),b=d3.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return f>180?f-=360:f<-180&&(f+=360),function(a){return eb(c+f*a,d+g*a,e+h*a)+""}},d3.interpolateLab=function(a,b){a=d3.lab(a),b=d3.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return kb(c+f*a,d+g*a,e+h*a)+""
}},d3.interpolateHcl=function(a,b){a=d3.hcl(a),b=d3.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return f>180?f-=360:f<-180&&(f+=360),function(a){return hb(c+f*a,d+g*a,e+h*a)+""}},d3.interpolateArray=function(a,b){var c=[],d=[],e=a.length,f=b.length,g=Math.min(a.length,b.length),h;for(h=0;h<g;++h)c.push(d3.interpolate(a[h],b[h]));for(;h<e;++h)d[h]=a[h];for(;h<f;++h)d[h]=b[h];return function(a){for(h=0;h<g;++h)d[h]=c[h](a);return d}},d3.interpolateObject=function(a,b){var c={},d={},e;for(e in a)e in b?c[e]=S(e)(a[e],b[e]):d[e]=a[e];for(e in b)e in a||(d[e]=b[e]);return function(a){for(e in c)d[e]=c[e](a);return d}};var Fd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(a,b){return b instanceof Array&&d3.interpolateArray(a,b)},function(a,b){return(typeof a=="string"||typeof b=="string")&&d3.interpolateString(a+"",b+"")},function(a,b){return(typeof b=="string"?Hd.has(b)||/^(#|rgb\(|hsl\()/.test(b):b instanceof V)&&d3.interpolateRgb(a,b)},function(a,b){return!isNaN(a=+a)&&!isNaN(b=+b)&&d3.interpolateNumber(a,b)}],V.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(a,b,c){return arguments.length===1?a instanceof X?W(a.r,a.g,a.b):Z(""+a,W,eb):W(~~a,~~b,~~c)};var Gd=X.prototype=new V;Gd.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return!b&&!c&&!d?W(e,e,e):(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),W(Math.min(255,Math.floor(b/a)),Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a))))},Gd.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),W(Math.floor(a*this.r),Math.floor(a*this.g),Math.floor(a*this.b))},Gd.hsl=function(){return $(this.r,this.g,this.b)},Gd.toString=function(){return"#"+Y(this.r)+Y(this.g)+Y(this.b)};var Hd=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});Hd.forEach(function(a,b){Hd.set(a,Z(b,W,eb))}),d3.hsl=function(a,b,c){return arguments.length===1?a instanceof db?cb(a.h,a.s,a.l):Z(""+a,$,cb):cb(+a,+b,+c)};var Id=db.prototype=new V;Id.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),cb(this.h,this.s,this.l/a)},Id.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),cb(this.h,this.s,a*this.l)},Id.rgb=function(){return eb(this.h,this.s,this.l)},d3.hcl=function(a,b,c){return arguments.length===1?a instanceof gb?fb(a.h,a.c,a.l):a instanceof jb?lb(a.l,a.a,a.b):lb((a=_((a=d3.rgb(a)).r,a.g,a.b)).l,a.a,a.b):fb(+a,+b,+c)};var Jd=gb.prototype=new V;Jd.brighter=function(a){return fb(this.h,this.c,Math.min(100,this.l+Kd*(arguments.length?a:1)))},Jd.darker=function(a){return fb(this.h,this.c,Math.max(0,this.l-Kd*(arguments.length?a:1)))},Jd.rgb=function(){return hb(this.h,this.c,this.l).rgb()},d3.lab=function(a,b,c){return arguments.length===1?a instanceof jb?ib(a.l,a.a,a.b):a instanceof gb?hb(a.l,a.c,a.h):_((a=d3.rgb(a)).r,a.g,a.b):ib(+a,+b,+c)};var Kd=18,Ld=.95047,Md=1,Nd=1.08883,Od=jb.prototype=new V;Od.brighter=function(a){return ib(Math.min(100,this.l+Kd*(arguments.length?a:1)),this.a,this.b)},Od.darker=function(a){return ib(Math.max(0,this.l-Kd*(arguments.length?a:1)),this.a,this.b)},Od.rgb=function(){return kb(this.l,this.a,this.b)};var Pd=function(a,b){return b.querySelector(a)},Qd=function(a,b){return b.querySelectorAll(a)},Rd=document.documentElement,Sd=Rd.matchesSelector||Rd.webkitMatchesSelector||Rd.mozMatchesSelector||Rd.msMatchesSelector||Rd.oMatchesSelector,Td=function(a,b){return Sd.call(a,b)};typeof Sizzle=="function"&&(Pd=function(a,b){return Sizzle(a,b)[0]||null},Qd=function(a,b){return Sizzle.uniqueSort(Sizzle(a,b))},Td=Sizzle.matchesSelector);var Ud=[];d3.selection=function(){return Vd},d3.selection.prototype=Ud,Ud.select=function(a){var b=[],c,d,e,f;typeof a!="function"&&(a=qb(a));for(var g=-1,h=this.length;++g<h;){b.push(c=[]),c.parentNode=(e=this[g]).parentNode;for(var i=-1,j=e.length;++i<j;)(f=e[i])?(c.push(d=a.call(f,f.__data__,i)),d&&"__data__"in f&&(d.__data__=f.__data__)):c.push(null)}return pb(b)},Ud.selectAll=function(a){var b=[],c,d;typeof a!="function"&&(a=rb(a));for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)if(d=g[h])b.push(c=od(a.call(d,d.__data__,h))),c.parentNode=d;return pb(b)},Ud.attr=function(a,b){if(arguments.length<2){if(typeof a=="string"){var c=this.node();return a=d3.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(sb(b,a[b]));return this}return this.each(sb(a,b))},Ud.classed=function(a,b){if(arguments.length<2){if(typeof a=="string"){var c=this.node(),d=(a=a.trim().split(/^|\s+/g)).length,e=-1;if(b=c.classList){while(++e<d)if(!b.contains(a[e]))return!1}else{b=c.className,b.baseVal!=null&&(b=b.baseVal);while(++e<d)if(!tb(a[e]).test(b))return!1}return!0}for(b in a)this.each(ub(b,a[b]));return this}return this.each(ub(a,b))},Ud.style=function(a,b,c){var d=arguments.length;if(d<3){if(typeof a!="string"){d<2&&(b="");for(c in a)this.each(wb(c,a[c],b));return this}if(d<2)return getComputedStyle(this.node(),null).getPropertyValue(a);c=""}return this.each(wb(a,b,c))},Ud.property=function(a,b){if(arguments.length<2){if(typeof a=="string")return this.node()[a];for(b in a)this.each(xb(b,a[b]));return this}return this.each(xb(a,b))},Ud.text=function(a){return arguments.length?this.each(typeof a=="function"?function(){var b=a.apply(this,arguments);this.textContent=b==null?"":b}:a==null?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},Ud.html=function(a){return arguments.length?this.each(typeof a=="function"?function(){var b=a.apply(this,arguments);this.innerHTML=b==null?"":b}:a==null?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},Ud.append=function(a){function b(){return this.appendChild(document.createElementNS(this.namespaceURI,a))}function c(){return this.appendChild(document.createElementNS(a.space,a.local))}return a=d3.ns.qualify(a),this.select(a.local?c:b)},Ud.insert=function(a,b){function c(){return this.insertBefore(document.createElementNS(this.namespaceURI,a),Pd(b,this))}function d(){return this.insertBefore(document.createElementNS(a.space,a.local),Pd(b,this))}return a=d3.ns.qualify(a),this.select(a.local?d:c)},Ud.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},Ud.data=function(a,b){function c(a,c){var d,e=a.length,g=c.length,h=Math.min(e,g),l=Math.max(e,g),m=[],n=[],o=[],p,q;if(b){var r=new f,s=[],t,u=c.length;for(d=-1;++d<e;)t=b.call(p=a[d],p.__data__,d),r.has(t)?o[u++]=p:r.set(t,p),s.push(t);for(d=-1;++d<g;)t=b.call(c,q=c[d],d),r.has(t)?(m[d]=p=r.get(t),p.__data__=q,n[d]=o[d]=null):(n[d]=yb(q),m[d]=o[d]=null),r.remove(t);for(d=-1;++d<e;)r.has(s[d])&&(o[d]=a[d])}else{for(d=-1;++d<h;)p=a[d],q=c[d],p?(p.__data__=q,m[d]=p,n[d]=o[d]=null):(n[d]=yb(q),m[d]=o[d]=null);for(;d<g;++d)n[d]=yb(c[d]),m[d]=o[d]=null;for(;d<l;++d)o[d]=a[d],n[d]=m[d]=null}n.update=m,n.parentNode=m.parentNode=o.parentNode=a.parentNode,i.push(n),j.push(m),k.push(o)}var d=-1,e=this.length,g,h;if(!arguments.length){a=new Array(e=(g=this[0]).length);while(++d<e)if(h=g[d])a[d]=h.__data__;return a}var i=Db([]),j=pb([]),k=pb([]);if(typeof a=="function")while(++d<e)c(g=this[d],a.call(g,g.parentNode.__data__,d));else while(++d<e)c(g=this[d],a);return j.enter=function(){return i},j.exit=function(){return k},j},Ud.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},Ud.filter=function(a){var b=[],c,d,e;typeof a!="function"&&(a=zb(a));for(var f=0,g=this.length;f<g;f++){b.push(c=[]),c.parentNode=(d=this[f]).parentNode;for(var h=0,i=d.length;h<i;h++)(e=d[h])&&a.call(e,e.__data__,h)&&c.push(e)}return pb(b)},Ud.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c=this[a],d=c.length-1,e=c[d],f;--d>=0;)if(f=c[d])e&&e!==f.nextSibling&&e.parentNode.insertBefore(f,e),e=f;return this},Ud.sort=function(a){a=Ab.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},Ud.on=function(a,b,c){var d=arguments.length;if(d<3){if(typeof a!="string"){d<2&&(b=!1);for(c in a)this.each(Bb(c,a[c],b));return this}if(d<2)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(Bb(a,b,c))},Ud.each=function(a){return Cb(this,function(b,c,d){a.call(b,b.__data__,c,d)})},Ud.call=function(a){var b=od(arguments);return a.apply(b[0]=this,b),this},Ud.empty=function(){return!this.node()},Ud.node=function(){for(var a=0,b=this.length;a<b;a++)for(var c=this[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f)return f}return null},Ud.transition=function(){var a=Zd||++Yd,b=[],c,d,e=Object.create($d);e.time=Date.now();for(var f=-1,g=this.length;++f<g;){b.push(c=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(d=h[i])&&Fb(d,i,a,e),c.push(d)}return Eb(b,a)};var Vd=pb([[document]]);Vd[0].parentNode=Rd,d3.select=function(a){return typeof a=="string"?Vd.select(a):pb([[a]])},d3.selectAll=function(a){return typeof a=="string"?Vd.selectAll(a):pb([od(a)])};var Wd=[];d3.selection.enter=Db,d3.selection.enter.prototype=Wd,Wd.append=Ud.append,Wd.insert=Ud.insert,Wd.empty=Ud.empty,Wd.node=Ud.node,Wd.select=function(a){var b=[],c,d,e,f,g;for(var h=-1,i=this.length;++h<i;){e=(f=this[h]).update,b.push(c=[]),c.parentNode=f.parentNode;for(var j=-1,k=f.length;++j<k;)(g=f[j])?(c.push(e[j]=d=a.call(f.parentNode,g.__data__,j)),d.__data__=g.__data__):c.push(null)}return pb(b)};var Xd=[],Yd=0,Zd,$d={ease:D,delay:0,duration:250};Xd.call=Ud.call,Xd.empty=Ud.empty,Xd.node=Ud.node,d3.transition=function(a){return arguments.length?Zd?a.transition():a:Vd.transition()},d3.transition.prototype=Xd,Xd.select=function(a){var b=this.id,c=[],d,e,f;typeof a!="function"&&(a=qb(a));for(var g=-1,h=this.length;++g<h;){c.push(d=[]);for(var i=this[g],j=-1,k=i.length;++j<k;)(f=i[j])&&(e=a.call(f,f.__data__,j))?("__data__"in f&&(e.__data__=f.__data__),Fb(e,j,b,f.__transition__[b]),d.push(e)):d.push(null)}return Eb(c,b)},Xd.selectAll=function(a){var b=this.id,c=[],d,e,f,g,h;typeof a!="function"&&(a=rb(a));for(var i=-1,j=this.length;++i<j;)for(var k=this[i],l=-1,m=k.length;++l<m;)if(f=k[l]){h=f.__transition__[b],e=a.call(f,f.__data__,l),c.push(d=[]);for(var n=-1,o=e.length;++n<o;)Fb(g=e[n],n,b,h),d.push(g)}return Eb(c,b)},Xd.filter=function(a){var b=[],c,d,e;typeof a!="function"&&(a=zb(a));for(var f=0,g=this.length;f<g;f++){b.push(c=[]);for(var d=this[f],h=0,i=d.length;h<i;h++)(e=d[h])&&a.call(e,e.__data__,h)&&c.push(e)}return Eb(b,this.id,this.time).ease(this.ease())},Xd.attr=function(a,b){function c(){this.removeAttribute(f)}function d(){this.removeAttributeNS(f.space,f.local)}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var e=S(a),f=d3.ns.qualify(a);return Hb(this,"attr."+a,b,function(a){function b(){var b=this.getAttribute(f),c;return b!==a&&(c=e(b,a),function(a){this.setAttribute(f,c(a))})}function g(){var b=this.getAttributeNS(f.space,f.local),c;return b!==a&&(c=e(b,a),function(a){this.setAttributeNS(f.space,f.local,c(a))})}return a==null?f.local?d:c:(a+="",f.local?g:b)})},Xd.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=d3.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Xd.style=function(a,b,c){function d(){this.style.removeProperty(a)}var e=arguments.length;if(e<3){if(typeof a!="string"){e<2&&(b="");for(c in a)this.style(c,a[c],b);return this}c=""}var f=S(a);return Hb(this,"style."+a,b,function(b){function e(){var d=getComputedStyle(this,null).getPropertyValue(a),e;return d!==b&&(e=f(d,b),function(b){this.style.setProperty(a,e(b),c)})}return b==null?d:(b+="",e)})},Xd.styleTween=function(a,b,c){return arguments.length<3&&(c=""),this.tween("style."+a,function(d,e){var f=b.call(this,d,e,getComputedStyle(this,null).getPropertyValue(a));return f&&function(b){this.style.setProperty(a,f(b),c)}})},Xd.text=function(a){return Hb(this,"text",a,Gb)},Xd.remove=function(){return this.each("end.transition",function(){var a;!this.__transition__&&(a=this.parentNode)&&a.removeChild(this)})},Xd.ease=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].ease:(typeof a!="function"&&(a=d3.ease.apply(d3,arguments)),Cb(this,function(c){c.__transition__[b].ease=a}))},Xd.delay=function(a){var b=this.id;return Cb(this,typeof a=="function"?function(c,d,e){c.__transition__[b].delay=a.call(c,c.__data__,d,e)|0}:(a|=0,function(c){c.__transition__[b].delay=a}))},Xd.duration=function(a){var b=this.id;return Cb(this,typeof a=="function"?function(c,d,e){c.__transition__[b].duration=Math.max(1,a.call(c,c.__data__,d,e)|0)}:(a=Math.max(1,a|0),function(c){c.__transition__[b].duration=a}))},Xd.each=function(a,b){var c=this.id;if(arguments.length<2){var d=$d,e=Zd;Zd=c,Cb(this,function(b,d,e){$d=b.__transition__[c],a.call(b,b.__data__,d,e)}),$d=d,Zd=e}else Cb(this,function(d){d.__transition__[c].event.on(a,b)});return this},Xd.transition=function(){var a=this.id,b=++Yd,c=[],d,e,f,g;for(var h=0,i=this.length;h<i;h++){c.push(d=[]);for(var e=this[h],j=0,k=e.length;j<k;j++){if(f=e[j])g=Object.create(f.__transition__[a]),g.delay+=g.duration,Fb(f,j,b,g);d.push(f)}}return Eb(c,b)},Xd.tween=function(a,b){var c=this.id;return arguments.length<2?this.node().__transition__[c].tween.get(a):Cb(this,b==null?function(b){b.__transition__[c].tween.remove(a)}:function(d){d.__transition__[c].tween.set(a,b)})};var _d=0,ae={},be=null,ce,de;d3.timer=function(a,b,c){if(arguments.length<3){if(arguments.length<2)b=0;else if(!isFinite(b))return;c=Date.now()}var d=ae[a.id];d&&d.callback===a?(d.then=c,d.delay=b):ae[a.id=++_d]=be={callback:a,then:c,delay:b,next:be},ce||(de=clearTimeout(de),ce=1,ee(Ib))},d3.timer.flush=function(){var a,b=Date.now(),c=be;while(c)a=b-c.then,c.delay||(c.flush=c.callback(a)),c=c.next;Jb()};var ee=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,17)};d3.mouse=function(a){return Kb(a,M())};var fe=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(a,b){return arguments.length<2&&(b=M().touches),b?od(b).map(function(b){var c=Kb(a,b);return c.identifier=b.identifier,c}):[]},d3.scale={},d3.scale.linear=function(){return Qb([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Yb(d3.scale.linear(),Zb)};var ge=d3.format(".0e");Zb.pow=function(a){return Math.pow(10,a)},$b.pow=function(a){return-Math.pow(10,-a)},d3.scale.pow=function(){return _b(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return bc([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(he)},d3.scale.category20=function(){return d3.scale.ordinal().range(ie)},d3.scale.category20b=function(){return d3.scale.ordinal().range(je)},d3.scale.category20c=function(){return d3.scale.ordinal().range(ke)};var he=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],ie=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],je=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],ke=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return cc([],[])},d3.scale.quantize=function(){return dc(0,1,[0,1])},d3.scale.threshold=function(){return ec([.5],[0,1])},d3.scale.identity=function(){return fc([0,1])},d3.layout={},d3.layout.bundle=function(){return function(a){var b=[],c=-1,d=a.length;while(++c<d)b.push(gc(a[c]));return b}},d3.layout.chord=function(){function a(){var a={},c=[],l=d3.range(g),m=[],n,o,p,q,r;d=[],e=[],n=0,q=-1;while(++q<g){o=0,r=-1;while(++r<g)o+=f[q][r];c.push(o),m.push(d3.range(g)),n+=o}i&&l.sort(function(a,b){return i(c[a],c[b])}),j&&m.forEach(function(a,b){a.sort(function(a,c){return j(f[b][a],f[b][c])})}),n=(2*kd-h*g)/n,o=0,q=-1;while(++q<g){p=o,r=-1;while(++r<g){var s=l[q],t=m[s][r],u=f[s][t],v=o,w=o+=u*n;a[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}e[s]={index:s,startAngle:p,endAngle:o,value:(o-p)/n},o+=h}q=-1;while(++q<g){r=q-1;while(++r<g){var x=a[q+"-"+r],y=a[r+"-"+q];(x.value||y.value)&&d.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}}k&&b()}function b(){d.sort(function(a,b){return k((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c={},d,e,f,g,h=0,i,j,k;return c.matrix=function(a){return arguments.length?(g=(f=a)&&f.length,d=e=null,c):f},c.padding=function(a){return arguments.length?(h=a,d=e=null,c):h},c.sortGroups=function(a){return arguments.length?(i=a,d=e=null,c):i},c.sortSubgroups=function(a){return arguments.length?(j=a,d=null,c):j},c.sortChords=function(a){return arguments.length?(k=a,d&&b(),c):k},c.chords=function(){return d||a(),d},c.groups=function(){return e||a(),e},c},d3.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=1/Math.sqrt(f*f+g*g);if((e-c)*h<o){var i=b.charge*h*h;return a.px-=f*i,a.py-=g*i,!0}if(b.point&&isFinite(h)){var i=b.pointCharge*h*h;a.px-=f*i,a.py-=g*i}}return!b.charge}}function b(a){a.px=d3.event.x,a.py=d3.event.y,c.resume()}var c={},d=d3.dispatch("start","tick","end"),e=[1,1],f,h,j=.9,k=oc,l=pc,m=-30,n=.1,o=.8,p=[],q=[],r,s,t;return c.tick=function(){if((h*=.99)<.005)return d.end({type:"end",alpha:h=0}),!0;var b=p.length,c=q.length,f,g,i,k,l,o,u,v,w;for(g=0;g<c;++g){i=q[g],k=i.source,l=i.target,v=l.x-k.x,w=l.y-k.y;if(o=v*v+w*w)o=h*s[g]*((o=Math.sqrt(o))-r[g])/o,v*=o,w*=o,l.x-=v*(u=k.weight/(l.weight+k.weight)),l.y-=w*u,k.x+=v*(u=1-u),k.y+=w*u}if(u=h*n){v=e[0]/2,w=e[1]/2,g=-1;if(u)while(++g<b)i=p[g],i.x+=(v-i.x)*u,i.y+=(w-i.y)*u}if(m){nc(f=d3.geom.quadtree(p),h,t),g=-1;while(++g<b)(i=p[g]).fixed||f.visit(a(i))}g=-1;while(++g<b)i=p[g],i.fixed?(i.x=i.px,i.y=i.py):(i.x-=(i.px-(i.px=i.x))*j,i.y-=(i.py-(i.py=i.y))*j);d.tick({type:"tick",alpha:h})},c.nodes=function(a){return arguments.length?(p=a,c):p},c.links=function(a){return arguments.length?(q=a,c):q},c.size=function(a){return arguments.length?(e=a,c):e},c.linkDistance=function(a){return arguments.length?(k=i(a),c):k},c.distance=c.linkDistance,c.linkStrength=function(a){return arguments.length?(l=i(a),c):l},c.friction=function(a){return arguments.length?(j=a,c):j},c.charge=function(a){return arguments.length?(m=typeof a=="function"?a:+a,c):m},c.gravity=function(a){return arguments.length?(n=a,c):n},c.theta=function(a){return arguments.length?(o=a,c):o},c.alpha=function(a){return arguments.length?(h?a>0?h=a:h=0:a>0&&(d.start({type:"start",alpha:h=a}),d3.timer(c.tick)),c):h},c.start=function(){function a(a,c){var e=b(d),f=-1,g=e.length,h;while(++f<g)if(!isNaN(h=e[f][a]))return h;return Math.random()*c}function b(){if(!n){n=[];for(f=0;f<g;++f)n[f]=[];for(f=0;f<h;++f){var a=q[f];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}return n[d]}var d,f,g=p.length,h=q.length,i=e[0],j=e[1],n,o;for(d=0;d<g;++d)(o=p[d]).index=d,o.weight=0;r=[],s=[];for(d=0;d<h;++d)o=q[d],typeof o.source=="number"&&(o.source=p[o.source]),typeof o.target=="number"&&(o.target=p[o.target]),r[d]=k.call(this,o,d),s[d]=l.call(this,o,d),++o.source.weight,++o.target.weight;for(d=0;d<g;++d)o=p[d],isNaN(o.x)&&(o.x=a("x",i)),isNaN(o.y)&&(o.y=a("y",j)),isNaN(o.px)&&(o.px=o.x),isNaN(o.py)&&(o.py=o.y);t=[];if(typeof m=="function")for(d=0;d<g;++d)t[d]=+m.call(this,p[d],d);else for(d=0;d<g;++d)t[d]=m;return c.resume()},c.resume=function(){return c.alpha(.1)},c.stop=function(){return c.alpha(0)},c.drag=function(){f||(f=d3.behavior.drag().origin(g).on("dragstart",jc).on("drag",b).on("dragend",kc)),this.on("mouseover.force",lc).on("mouseout.force",mc).call(f)},d3.rebind(c,d,"on")},d3.layout.partition=function(){function a(b,c,d,e){var f=b.children;b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e;if(f&&(h=f.length)){var g=-1,h,i,j;d=b.value?d/b.value:0;while(++g<h)a(i=f[g],c,j=i.value*d,e),c+=j}}function b(a){var c=a.children,d=0;if(c&&(f=c.length)){var e=-1,f;while(++e<f)d=Math.max(d,b(c[e]))}return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=d3.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},Bc(c,d)},d3.layout.pie=function(){function a(f){var g=f.map(function(c,d){return+b.call(a,c,d)}),h=+(typeof d=="function"?d.apply(this,arguments):d),i=((typeof e=="function"?e.apply(this,arguments):e)-d)/d3.sum(g),j=d3.range(f.length);c!=null&&j.sort(c===le?function(a,b){return g[b]-g[a]}:function(a,b){return c(f[a],f[b])});var k=[];return j.forEach(function(a){var b;k[a]={data:f[a],value:b=g[a],startAngle:h,endAngle:h+=b*i}}),k}var b=Number,c=le,d=0,e=2*kd;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a};var le={};d3.layout.stack=function(){function a(g,i){var j=g.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),h.call(a,b,c)]})}),l=c.call(a,k,i);j=d3.permute(j,l),k=d3.permute(k,l);var m=d.call(a,k,i),n=j.length,o=j[0].length,p,q,r;for(q=0;q<o;++q){e.call(a,j[0][q],r=m[q],k[0][q][1]);for(p=1;p<n;++p)e.call(a,j[p][q],r+=k[p-1][q][1],k[p][q][1])}return g}var b=g,c=tc,d=uc,e=sc,f=qc,h=rc;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c=typeof b=="function"?b:me.get(b)||tc,a):c},a.offset=function(b){return arguments.length?(d=typeof b=="function"?b:ne.get(b)||uc,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(h=b,a):h},a.out=function(b){return arguments.length?(e=b,a):e},a};var me=d3.map({"inside-out":function(a){var b=a.length,c,d,e=a.map(vc),f=a.map(wc),g=d3.range(b).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(c=0;c<b;++c)d=g[c],h<i?(h+=f[d],j.push(d)):(i+=f[d],k.push(d));return k.reverse().concat(j)},reverse:function(a){return d3.range(a.length).reverse()},"default":tc}),ne=d3.map({silhouette:function(a){var b=a.length,c=a[0].length,d=[],e=0,f,g,h,i=[];for(g=0;g<c;++g){for(f=0,h=0;f<b;f++)h+=a[f][g][1];h>e&&(e=h),d.push(h)}for(g=0;g<c;++g)i[g]=(e-d[g])/2;return i},wiggle:function(a){var b=a.length,c=a[0],d=c.length,e,f,g,h,i,j,k,l,m,n=[];n[0]=l=m=0;for(f=1;f<d;++f){for(e=0,h=0;e<b;++e)h+=a[e][f][1];for(e=0,i=0,k=c[f][0]-c[f-1][0];e<b;++e){for(g=0,j=(a[e][f][1]-a[e][f-1][1])/(2*k);g<e;++g)j+=(a[g][f][1]-a[g][f-1][1])/k;i+=j*a[e][f][1]}n[f]=l-=h?i/h*k:0,l<m&&(m=l)}for(f=0;f<d;++f)n[f]-=m;return n},expand:function(a){var b=a.length,c=a[0].length,d=1/b,e,f,g,h=[];for(f=0;f<c;++f){for(e=0,g=0;e<b;e++)g+=a[e][f][1];if(g)for(e=0;e<b;e++)a[e][f][1]/=g;else for(e=0;e<b;e++)a[e][f][1]=d}for(f=0;f<c;++f)h[f]=0;return h},zero:uc});d3.layout.histogram=function(){function a(a,f){var g=[],h=a.map(c,this),i=d.call(this,h,f),j=e.call(this,i,h,f),k,f=-1,l=h.length,m=j.length-1,n=b?1:1/l,o;while(++f<m)k=g[f]=[],k.dx=j[f+1]-(k.x=j[f]),k.y=0;if(m>0){f=-1;while(++f<l)o=h[f],o>=i[0]&&o<=i[1]&&(k=g[d3.bisect(j,o,1,m)-1],k.y+=n,k.push(a[f]))}return g}var b=!0,c=Number,d=Ac,e=yc;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=i(b),a):d},a.bins=function(b){return arguments.length?(e=typeof b=="number"?function(a){return zc(a,b)}:i(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},d3.layout.hierarchy=function(){function a(b,g,h){var i=e.call(c,b,g);b.depth=g,h.push(b);if(i&&(k=i.length)){var j=-1,k,l=b.children=[],m=0,n=g+1,o;while(++j<k)o=a(i[j],n,h),o.parent=b,l.push(o),m+=o.value;d&&l.sort(d),f&&(b.value=m)}else f&&(b.value=+f.call(c,b,g)||0);return b}function b(a,d){var e=a.children,g=0;if(e&&(i=e.length)){var h=-1,i,j=d+1;while(++h<i)g+=b(e[h],j)}else f&&(g=+f.call(c,a,d)||0);return f&&(a.value=g),g}function c(b){var c=[];return a(b,0,c),c}var d=Ec,e=Cc,f=Dc;return c.sort=function(a){return arguments.length?(d=a,c):d},c.children=function(a){return arguments.length?(e=a,c):e},c.value=function(a){return arguments.length?(f=a,c):f},c.revalue=function(a){return b(a,0),a},c},d3.layout.pack=function(){function a(a,e){var f=b.call(this,a,e),g=f[0];g.x=0,g.y=0,$c(g,function(a){a.r=Math.sqrt(a.value)}),$c(g,Kc);var h=d[0],i=d[1],j=Math.max(2*g.r/h,2*g.r/i);if(c>0){var k=c*j/2;$c(g,function(a){a.r+=k}),$c(g,Kc),$c(g,function(a){a.r-=k}),j=Math.max(2*g.r/h,2*g.r/i)}return Nc(g,h/2,i/2,1/j),f}var b=d3.layout.hierarchy().sort(Gc),c=0,d=[1,1];return a.size=function(b){return arguments.length?(d=b,a):d},a.padding=function(b){return arguments.length?(c=+b,a):c},Bc(a,b)},d3.layout.cluster=function(){function a(a,e){var f=b.call(this,a,e),g=f[0],h,i=0;$c(g,function(a){var b=a.children;b&&b.length?(a.x=Qc(b),a.y=Pc(b)):(a.x=h?i+=c(a,h):0,a.y=0,h=a)});var j=Rc(g),k=Sc(g),l=j.x-c(j,k)/2,m=k.x+c(k,j)/2;return $c(g,function(a){a.x=(a.x-l)/(m-l)*d[0],a.y=(1-(g.y?a.y/g.y:1))*d[1]}),f}var b=d3.layout.hierarchy().sort(null).value(null),c=Tc,d=[1,1];return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(d=b,a):d},Bc(a,b)},d3.layout.tree=function(){function a(a,e){function f(a,b){var d=a.children,e=a._tree;if(d&&(g=d.length)){var g,i=d[0],j,k=i,l,m=-1;while(++m<g)l=d[m],f(l,j),k=h(l,j,k),j=l;_c(a);var n=.5*(i._tree.prelim+l._tree.prelim);b?(e.prelim=b._tree.prelim+c(a,b),e.mod=e.prelim-n):e.prelim=n}else b&&(e.prelim=b._tree.prelim+c(a,b))}function g(a,b){a.x=a._tree.prelim+b;var c=a.children;if(c&&(e=c.length)){var d=-1,e;b+=a._tree.mod;while(++d<e)g(c[d],b)}}function h(a,b,d){if(b){var e=a,f=a,g=b,h=a.parent.children[0],i=e._tree.mod,j=f._tree.mod,k=g._tree.mod,l=h._tree.mod,m;while(g=Vc(g),e=Uc(e),g&&e)h=Uc(h),f=Vc(f),f._tree.ancestor=a,m=g._tree.prelim+k-e._tree.prelim-i+c(g,e),m>0&&(ad(bd(g,a,d),a,m),i+=m,j+=m),k+=g._tree.mod,i+=e._tree.mod,l+=h._tree.mod,j+=f._tree.mod;g&&!Vc(f)&&(f._tree.thread=g,f._tree.mod+=k-j),e&&!Uc(h)&&(h._tree.thread=e,h._tree.mod+=i-l,d=a)}return d}var i=b.call(this,a,e),j=i[0];$c(j,function(a,b){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:b?b._tree.number+1:0}}),f(j),g(j,-j._tree.prelim);var k=Wc(j,Yc),l=Wc(j,Xc),m=Wc(j,Zc),n=k.x-c(k,l)/2,o=l.x+c(l,k)/2,p=m.depth||1;return $c(j,function(a){a.x=(a.x-n)/(o-n)*d[0],a.y=a.depth/p*d[1],delete a._tree}),i}var b=d3.layout.hierarchy().sort(null).value(null),c=Tc,d=[1,1];return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(d=b,a):d},Bc(a,b)},d3.layout.treemap=function(){function a(a,b){var c=-1,d=a.length,e,f;while(++c<d)f=(e=a[c]).value*(b<0?0:b),e.area=isNaN(f)||f<=0?0:f}function b(c){var f=c.children;if(f&&f.length){var g=k(c),h=[],i=f.slice(),j,l=Infinity,m,o=n==="slice"?g.dx:n==="dice"?g.dy:n==="slice-dice"?c.depth&1?g.dy:g.dx:Math.min(g.dx,g.dy),p;a(i,g.dx*g.dy/c.value),h.area=0;while((p=i.length)>0)h.push(j=i[p-1]),h.area+=j.area,n!=="squarify"||(m=d(h,o))<=l?(i.pop(),l=m):(h.area-=h.pop().area,e(h,o,g,!1),o=Math.min(g.dx,g.dy),h.length=h.area=0,l=Infinity);h.length&&(e(h,o,g,!0),h.length=h.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f=k(b),g=d.slice(),h,i=[];a(g,f.dx*f.dy/b.value),i.area=0;while(h=g.pop())i.push(h),i.area+=h.area,h.z!=null&&(e(i,h.z?f.dx:f.dy,f,!g.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){var c=a.area,d,e=0,f=Infinity,g=-1,h=a.length;while(++g<h){if(!(d=a[g].area))continue;d<f&&(f=d),d>e&&(e=d)}return c*=c,b*=b,c?Math.max(b*e*o/c,c/(b*f*o)):Infinity}function e(a,b,c,d){var e=-1,f=a.length,g=c.x,i=c.y,j=b?h(a.area/b):0,k;if(b==c.dx){if(d||j>c.dy)j=c.dy;while(++e<f)k=a[e],k.x=g,k.y=i,k.dy=j,g+=k.dx=Math.min(c.x+c.dx-g,j?h(k.area/j):0);k.z=!0,k.dx+=c.x+c.dx-g,c.y+=j,c.dy-=j}else{if(d||j>c.dx)j=c.dx;while(++e<f)k=a[e],k.x=g,k.y=i,k.dx=j,i+=k.dy=Math.min(c.y+c.dy-i,j?h(k.area/j):0);k.z=!1,k.dy+=c.y+c.dy-i,c.x+=j,c.dx-=j}}function f(d){var e=m||g(d),f=e[0];return f.x=0,f.y=0,f.dx=i[0],f.dy=i[1],m&&g.revalue(f),a([f],f.dx*f.dy/f.value),(m?c:b)(f),l&&(m=e),e}var g=d3.layout.hierarchy(),h=Math.round,i=[1,1],j=null,k=cd,l=!1,m,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(i=a,f):i},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return c==null?cd(b):dd(b,typeof c=="number"?[c,c,c,c]:c)}function c(b){return dd(b,a)}if(!arguments.length)return j;var d;return k=(j=a)==null?cd:(d=typeof a)==="function"?b:d==="number"?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(h=a?Math.round:Number,f):h!=Number},f.sticky=function(a){return arguments.length?(l=a,m=null,f):l},f.ratio=function(a){return arguments.length?(o=a,f):o
},f.mode=function(a){return arguments.length?(n=a+"",f):n},Bc(f,g)}})();(function($,window,document,undefined){function Coords(obj){if(obj[0]&&$.isPlainObject(obj[0])){this.data=obj[0]}else{this.el=obj}this.isCoords=true;this.coords={};this.init();return this}var fn=Coords.prototype;fn.init=function(){this.set();this.original_coords=this.get()};fn.set=function(update,not_update_offsets){var el=this.el;if(el&&!update){this.data=el.offset();this.data.width=el.width();this.data.height=el.height()}if(el&&update&&!not_update_offsets){var offset=el.offset();this.data.top=offset.top;this.data.left=offset.left}var d=this.data;this.coords.x1=d.left;this.coords.y1=d.top;this.coords.x2=d.left+d.width;this.coords.y2=d.top+d.height;this.coords.cx=d.left+d.width/2;this.coords.cy=d.top+d.height/2;this.coords.width=d.width;this.coords.height=d.height;this.coords.el=el||false;return this};fn.update=function(data){if(!data&&!this.el){return this}if(data){var new_data=$.extend({},this.data,data);this.data=new_data;return this.set(true,true)}this.set(true);return this};fn.get=function(){return this.coords};$.fn.coords=function(){if(this.data("coords")){return this.data("coords")}var ins=new Coords(this,arguments[0]);this.data("coords",ins);return ins}})(jQuery,window,document);(function($,window,document,undefined){var defaults={colliders_context:document.body};function Collision(el,colliders,options){this.options=$.extend(defaults,options);this.$element=el;this.last_colliders=[];this.last_colliders_coords=[];if(typeof colliders==="string"||colliders instanceof jQuery){this.$colliders=$(colliders,this.options.colliders_context).not(this.$element)}else{this.colliders=$(colliders)}this.init()}var fn=Collision.prototype;fn.init=function(){this.find_collisions()};fn.overlaps=function(a,b){var x=false;var y=false;if(b.x1>=a.x1&&b.x1<=a.x2||b.x2>=a.x1&&b.x2<=a.x2||a.x1>=b.x1&&a.x2<=b.x2){x=true}if(b.y1>=a.y1&&b.y1<=a.y2||b.y2>=a.y1&&b.y2<=a.y2||a.y1>=b.y1&&a.y2<=b.y2){y=true}return x&&y};fn.detect_overlapping_region=function(a,b){var regionX="";var regionY="";if(a.y1>b.cy&&a.y1<b.y2){regionX="N"}if(a.y2>b.y1&&a.y2<b.cy){regionX="S"}if(a.x1>b.cx&&a.x1<b.x2){regionY="W"}if(a.x2>b.x1&&a.x2<b.cx){regionY="E"}return regionX+regionY||"C"};fn.calculate_overlapped_area_coords=function(a,b){var x1=Math.max(a.x1,b.x1);var y1=Math.max(a.y1,b.y1);var x2=Math.min(a.x2,b.x2);var y2=Math.min(a.y2,b.y2);return $({left:x1,top:y1,width:x2-x1,height:y2-y1}).coords().get()};fn.calculate_overlapped_area=function(coords){return coords.width*coords.height};fn.manage_colliders_start_stop=function(new_colliders_coords,start_callback,stop_callback){var last=this.last_colliders_coords;for(var i=0,il=last.length;i<il;i++){if($.inArray(last[i],new_colliders_coords)===-1){start_callback.call(this,last[i])}}for(var j=0,jl=new_colliders_coords.length;j<jl;j++){if($.inArray(new_colliders_coords[j],last)===-1){stop_callback.call(this,new_colliders_coords[j])}}};fn.find_collisions=function(player_data_coords){var self=this;var colliders_coords=[];var colliders_data=[];var $colliders=this.colliders||this.$colliders;var count=$colliders.length;var player_coords=self.$element.coords().update(player_data_coords||false).get();while(count--){var $collider=self.$colliders?$($colliders[count]):$colliders[count];var $collider_coords_ins=$collider.isCoords?$collider:$collider.coords();var collider_coords=$collider_coords_ins.get();var overlaps=self.overlaps(player_coords,collider_coords);if(!overlaps){continue}var region=self.detect_overlapping_region(player_coords,collider_coords);if(region==="C"){var area_coords=self.calculate_overlapped_area_coords(player_coords,collider_coords);var area=self.calculate_overlapped_area(area_coords);var collider_data={area:area,area_coords:area_coords,region:region,coords:collider_coords,player_coords:player_coords,el:$collider};if(self.options.on_overlap){self.options.on_overlap.call(this,collider_data)}colliders_coords.push($collider_coords_ins);colliders_data.push(collider_data)}}if(self.options.on_overlap_stop||self.options.on_overlap_start){this.manage_colliders_start_stop(colliders_coords,self.options.on_overlap_stop,self.options.on_overlap_start)}this.last_colliders_coords=colliders_coords;return colliders_data};fn.get_closest_colliders=function(player_data_coords){var colliders=this.find_collisions(player_data_coords);colliders.sort(function(a,b){if(a.region==="C"&&b.region==="C"){if(a.coords.y1<b.coords.y1||a.coords.x1<b.coords.x1){return-1}else{return 1}}if(a.area<b.area){return 1}return 1});return colliders};$.fn.collision=function(collider,options){return new Collision(this,collider,options)}})(jQuery,window,document);(function(window,undefined){window.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};if(immediate&&!timeout)func.apply(context,args);clearTimeout(timeout);timeout=setTimeout(later,wait)}};window.throttle=function(func,wait){var context,args,timeout,throttling,more,result;var whenDone=debounce(function(){more=throttling=false},wait);return function(){context=this;args=arguments;var later=function(){timeout=null;if(more)func.apply(context,args);whenDone()};if(!timeout)timeout=setTimeout(later,wait);if(throttling){more=true}else{result=func.apply(context,args)}whenDone();throttling=true;return result}}})(window);(function($,window,document,undefined){var defaults={items:".gs_w",distance:1,limit:true,offset_left:0,autoscroll:true,ignore_dragging:["INPUT","TEXTAREA","SELECT","BUTTON"],handle:null};var $window=$(window);var isTouch=!!("ontouchstart"in window);var pointer_events={start:isTouch?"touchstart":"mousedown.draggable",move:isTouch?"touchmove":"mousemove.draggable",end:isTouch?"touchend":"mouseup.draggable"};function Draggable(el,options){this.options=$.extend({},defaults,options);this.$body=$(document.body);this.$container=$(el);this.$dragitems=$(this.options.items,this.$container);this.is_dragging=false;this.player_min_left=0+this.options.offset_left;this.init()}var fn=Draggable.prototype;fn.init=function(){this.calculate_positions();this.$container.css("position","relative");this.disabled=false;this.events();$(window).bind("resize",throttle($.proxy(this.calculate_positions,this),200))};fn.events=function(){this.$container.on("selectstart",$.proxy(this.on_select_start,this));this.$container.on(pointer_events.start,this.options.items,$.proxy(this.drag_handler,this));this.$body.on(pointer_events.end,$.proxy(function(e){this.is_dragging=false;if(this.disabled){return}this.$body.off(pointer_events.move);if(this.drag_start){this.on_dragstop(e)}},this))};fn.get_actual_pos=function($el){var pos=$el.position();return pos};fn.get_mouse_pos=function(e){if(isTouch){var oe=e.originalEvent;e=oe.touches.length?oe.touches[0]:oe.changedTouches[0]}return{left:e.clientX,top:e.clientY}};fn.get_offset=function(e){e.preventDefault();var mouse_actual_pos=this.get_mouse_pos(e);var diff_x=Math.round(mouse_actual_pos.left-this.mouse_init_pos.left);var diff_y=Math.round(mouse_actual_pos.top-this.mouse_init_pos.top);var left=Math.round(this.el_init_offset.left+diff_x-this.baseX);var top=Math.round(this.el_init_offset.top+diff_y-this.baseY+this.scrollOffset);if(this.options.limit){if(left>this.player_max_left){left=this.player_max_left}else if(left<this.player_min_left){left=this.player_min_left}}return{left:left,top:top,mouse_left:mouse_actual_pos.left,mouse_top:mouse_actual_pos.top}};fn.manage_scroll=function(offset){var nextScrollTop;var scrollTop=$window.scrollTop();var min_window_y=scrollTop;var max_window_y=min_window_y+this.window_height;var mouse_down_zone=max_window_y-50;var mouse_up_zone=min_window_y+50;var abs_mouse_left=offset.mouse_left;var abs_mouse_top=min_window_y+offset.mouse_top;var max_player_y=this.doc_height-this.window_height+this.player_height;if(abs_mouse_top>=mouse_down_zone){nextScrollTop=scrollTop+30;if(nextScrollTop<max_player_y){$window.scrollTop(nextScrollTop);this.scrollOffset=this.scrollOffset+30}}if(abs_mouse_top<=mouse_up_zone){nextScrollTop=scrollTop-30;if(nextScrollTop>0){$window.scrollTop(nextScrollTop);this.scrollOffset=this.scrollOffset-30}}};fn.calculate_positions=function(e){this.window_height=$window.height()};fn.drag_handler=function(e){var node=e.target.nodeName;if(this.disabled||e.which!==1&&!isTouch){return}if(this.ignore_drag(e)){return}var self=this;var first=true;this.$player=$(e.currentTarget);this.el_init_pos=this.get_actual_pos(this.$player);this.mouse_init_pos=this.get_mouse_pos(e);this.offsetY=this.mouse_init_pos.top-this.el_init_pos.top;this.$body.on(pointer_events.move,function(mme){var mouse_actual_pos=self.get_mouse_pos(mme);var diff_x=Math.abs(mouse_actual_pos.left-self.mouse_init_pos.left);var diff_y=Math.abs(mouse_actual_pos.top-self.mouse_init_pos.top);if(!(diff_x>self.options.distance||diff_y>self.options.distance)){return false}if(first){first=false;self.on_dragstart.call(self,mme);return false}if(self.is_dragging===true){self.on_dragmove.call(self,mme)}return false});return false};fn.on_dragstart=function(e){e.preventDefault();this.drag_start=true;this.is_dragging=true;var offset=this.$container.offset();this.baseX=Math.round(offset.left);this.baseY=Math.round(offset.top);this.doc_height=$(document).height();if(this.options.helper==="clone"){this.$helper=this.$player.clone().appendTo(this.$container).addClass("helper");this.helper=true}else{this.helper=false}this.scrollOffset=0;this.el_init_offset=this.$player.offset();this.player_width=this.$player.width();this.player_height=this.$player.height();this.player_max_left=this.$container.width()-this.player_width+this.options.offset_left;if(this.options.start){this.options.start.call(this.$player,e,{helper:this.helper?this.$helper:this.$player})}return false};fn.on_dragmove=function(e){var offset=this.get_offset(e);this.options.autoscroll&&this.manage_scroll(offset);(this.helper?this.$helper:this.$player).css({position:"absolute",left:offset.left,top:offset.top});var ui={position:{left:offset.left,top:offset.top}};if(this.options.drag){this.options.drag.call(this.$player,e,ui)}return false};fn.on_dragstop=function(e){var offset=this.get_offset(e);this.drag_start=false;var ui={position:{left:offset.left,top:offset.top}};if(this.options.stop){this.options.stop.call(this.$player,e,ui)}if(this.helper){this.$helper.remove()}return false};fn.on_select_start=function(e){if(this.disabled){return}if(this.ignore_drag(e)){return}return false};fn.enable=function(){this.disabled=false};fn.disable=function(){this.disabled=true};fn.destroy=function(){this.disable();$.removeData(this.$container,"drag")};fn.ignore_drag=function(event){if(this.options.handle){return!$(event.target).is(this.options.handle)}return $.inArray(event.target.nodeName,this.options.ignore_dragging)>=0};$.fn.drag=function(options){return this.each(function(){if(!$.data(this,"drag")){$.data(this,"drag",new Draggable(this,options))}})}})(jQuery,window,document);(function($,window,document,undefined){var defaults={namespace:"",widget_selector:"li",widget_margins:[10,10],widget_base_dimensions:[400,225],extra_rows:0,extra_cols:0,min_cols:1,min_rows:15,max_size_x:6,autogenerate_stylesheet:true,avoid_overlapped_widgets:true,serialize_params:function($w,wgd){return{col:wgd.col,row:wgd.row,size_x:wgd.size_x,size_y:wgd.size_y}},collision:{},draggable:{distance:4}};function Gridster(el,options){this.options=$.extend(true,defaults,options);this.$el=$(el);this.$wrapper=this.$el.parent();this.$widgets=this.$el.children(this.options.widget_selector).addClass("gs_w");this.widgets=[];this.$changed=$([]);this.wrapper_width=this.$wrapper.width();this.min_widget_width=this.options.widget_margins[0]*2+this.options.widget_base_dimensions[0];this.min_widget_height=this.options.widget_margins[1]*2+this.options.widget_base_dimensions[1];this.init()}Gridster.generated_stylesheets=[];var fn=Gridster.prototype;fn.init=function(){this.generate_grid_and_stylesheet();this.get_widgets_from_DOM();this.set_dom_grid_height();this.$wrapper.addClass("ready");this.draggable();$(window).bind("resize",throttle($.proxy(this.recalculate_faux_grid,this),200))};fn.disable=function(){this.$wrapper.find(".player-revert").removeClass("player-revert");this.drag_api.disable();return this};fn.enable=function(){this.drag_api.enable();return this};fn.add_widget=function(html,size_x,size_y,col,row){var pos;size_x||(size_x=1);size_y||(size_y=1);if(!col&!row){pos=this.next_position(size_x,size_y)}else{pos={col:col,row:row};this.empty_cells(col,row,size_x,size_y)}var $w=$(html).attr({"data-col":pos.col,"data-row":pos.row,"data-sizex":size_x,"data-sizey":size_y}).addClass("gs_w").appendTo(this.$el).hide();this.$widgets=this.$widgets.add($w);this.register_widget($w);this.add_faux_rows(pos.size_y);this.set_dom_grid_height();return $w.fadeIn()};fn.resize_widget=function($widget,size_x,size_y){var wgd=$widget.coords().grid;size_x||(size_x=wgd.size_x);size_y||(size_y=wgd.size_y);if(size_x>this.cols){size_x=this.cols}var old_cells_occupied=this.get_cells_occupied(wgd);var old_size_x=wgd.size_x;var old_size_y=wgd.size_y;var old_col=wgd.col;var new_col=old_col;var wider=size_x>old_size_x;var taller=size_y>old_size_y;if(old_col+size_x-1>this.cols){var diff=old_col+(size_x-1)-this.cols;var c=old_col-diff;new_col=Math.max(1,c)}var new_grid_data={col:new_col,row:wgd.row,size_x:size_x,size_y:size_y};var new_cells_occupied=this.get_cells_occupied(new_grid_data);var empty_cols=[];$.each(old_cells_occupied.cols,function(i,col){if($.inArray(col,new_cells_occupied.cols)===-1){empty_cols.push(col)}});var occupied_cols=[];$.each(new_cells_occupied.cols,function(i,col){if($.inArray(col,old_cells_occupied.cols)===-1){occupied_cols.push(col)}});var empty_rows=[];$.each(old_cells_occupied.rows,function(i,row){if($.inArray(row,new_cells_occupied.rows)===-1){empty_rows.push(row)}});var occupied_rows=[];$.each(new_cells_occupied.rows,function(i,row){if($.inArray(row,old_cells_occupied.rows)===-1){occupied_rows.push(row)}});this.remove_from_gridmap(wgd);if(occupied_cols.length){var cols_to_empty=[new_col,wgd.row,size_x,Math.min(old_size_y,size_y),$widget];this.empty_cells.apply(this,cols_to_empty)}if(occupied_rows.length){var rows_to_empty=[new_col,wgd.row,size_x,size_y,$widget];this.empty_cells.apply(this,rows_to_empty)}wgd.col=new_col;wgd.size_x=size_x;wgd.size_y=size_y;this.add_to_gridmap(new_grid_data,$widget);$widget.data("coords").update({width:size_x*this.options.widget_base_dimensions[0]+(size_x-1)*this.options.widget_margins[0]*2,height:size_y*this.options.widget_base_dimensions[1]+(size_y-1)*this.options.widget_margins[1]*2});if(size_y>old_size_y){this.add_faux_rows(size_y-old_size_y)}if(size_x>old_size_x){this.add_faux_cols(size_x-old_size_x)}$widget.attr({"data-col":new_col,"data-sizex":size_x,"data-sizey":size_y});if(empty_cols.length){var cols_to_remove_holes=[empty_cols[0],wgd.row,empty_cols.length,Math.min(old_size_y,size_y),$widget];this.remove_empty_cells.apply(this,cols_to_remove_holes)}if(empty_rows.length){var rows_to_remove_holes=[new_col,wgd.row,size_x,size_y,$widget];this.remove_empty_cells.apply(this,rows_to_remove_holes)}return $widget};fn.empty_cells=function(col,row,size_x,size_y,$exclude){var $nexts=this.widgets_below({col:col,row:row-size_y,size_x:size_x,size_y:size_y});$nexts.not($exclude).each($.proxy(function(i,w){var wgd=$(w).coords().grid;if(!(wgd.row<=row+size_y-1)){return}var diff=row+size_y-wgd.row;this.move_widget_down($(w),diff)},this));this.set_dom_grid_height();return this};fn.remove_empty_cells=function(col,row,size_x,size_y,exclude){var $nexts=this.widgets_below({col:col,row:row,size_x:size_x,size_y:size_y});$nexts.not(exclude).each($.proxy(function(i,widget){this.move_widget_up($(widget),size_y)},this));this.set_dom_grid_height();return this};fn.next_position=function(size_x,size_y){size_x||(size_x=1);size_y||(size_y=1);var ga=this.gridmap;var cols_l=ga.length;var valid_pos=[];var rows_l;for(var c=1;c<cols_l;c++){rows_l=ga[c].length;for(var r=1;r<=rows_l;r++){var can_move_to=this.can_move_to({size_x:size_x,size_y:size_y},c,r);if(can_move_to){valid_pos.push({col:c,row:r,size_y:size_y,size_x:size_x})}}}if(valid_pos.length){return this.sort_by_row_and_col_asc(valid_pos)[0]}return false};fn.remove_widget=function(el,silent,callback){var $el=el instanceof jQuery?el:$(el);var wgd=$el.coords().grid;if($.isFunction(silent)){callback=silent;silent=false}this.cells_occupied_by_placeholder={};this.$widgets=this.$widgets.not($el);var $nexts=this.widgets_below($el);this.remove_from_gridmap(wgd);$el.fadeOut($.proxy(function(){$el.remove();if(!silent){$nexts.each($.proxy(function(i,widget){this.move_widget_up($(widget),wgd.size_y)},this))}this.set_dom_grid_height();if(callback){callback.call(this,el)}},this))};fn.remove_all_widgets=function(callback){this.$widgets.each($.proxy(function(i,el){this.remove_widget(el,true,callback)},this));return this};fn.serialize=function($widgets){$widgets||($widgets=this.$widgets);var result=[];$widgets.each($.proxy(function(i,widget){result.push(this.options.serialize_params($(widget),$(widget).coords().grid))},this));return result};fn.serialize_changed=function(){return this.serialize(this.$changed)};fn.register_widget=function($el){var wgd={col:parseInt($el.attr("data-col"),10),row:parseInt($el.attr("data-row"),10),size_x:parseInt($el.attr("data-sizex"),10),size_y:parseInt($el.attr("data-sizey"),10),el:$el};if(this.options.avoid_overlapped_widgets&&!this.can_move_to({size_x:wgd.size_x,size_y:wgd.size_y},wgd.col,wgd.row)){wgd=this.next_position(wgd.size_x,wgd.size_y);wgd.el=$el;$el.attr({"data-col":wgd.col,"data-row":wgd.row,"data-sizex":wgd.size_x,"data-sizey":wgd.size_y})}$el.data("coords",$el.coords());$el.data("coords").grid=wgd;this.add_to_gridmap(wgd,$el);return this};fn.update_widget_position=function(grid_data,value){this.for_each_cell_occupied(grid_data,function(col,row){if(!this.gridmap[col]){return this}this.gridmap[col][row]=value});return this};fn.remove_from_gridmap=function(grid_data){return this.update_widget_position(grid_data,false)};fn.add_to_gridmap=function(grid_data,value){this.update_widget_position(grid_data,value||grid_data.el);if(grid_data.el){var $widgets=this.widgets_below(grid_data.el);$widgets.each($.proxy(function(i,widget){this.move_widget_up($(widget))},this))}};fn.draggable=function(){var self=this;var draggable_options=$.extend(true,{},this.options.draggable,{offset_left:this.options.widget_margins[0],start:function(event,ui){self.$widgets.filter(".player-revert").removeClass("player-revert");self.$player=$(this);self.$helper=self.options.draggable.helper==="clone"?$(ui.helper):self.$player;self.helper=!self.$helper.is(self.$player);self.on_start_drag.call(self,event,ui);self.$el.trigger("gridster:dragstart")},stop:function(event,ui){self.on_stop_drag.call(self,event,ui);self.$el.trigger("gridster:dragstop")},drag:throttle(function(event,ui){self.on_drag.call(self,event,ui);self.$el.trigger("gridster:drag")},60)});this.drag_api=this.$el.drag(draggable_options).data("drag");return this};fn.on_start_drag=function(event,ui){this.$helper.add(this.$player).add(this.$wrapper).addClass("dragging");this.$player.addClass("player");this.player_grid_data=this.$player.coords().grid;this.placeholder_grid_data=$.extend({},this.player_grid_data);this.$el.css("height",this.$el.height()+this.player_grid_data.size_y*this.min_widget_height);var colliders=this.faux_grid;var coords=this.$player.data("coords").coords;this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data);this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data);this.last_cols=[];this.last_rows=[];this.collision_api=this.$helper.collision(colliders,this.options.collision);this.$preview_holder=$("<li />",{"class":"preview-holder","data-row":this.$player.attr("data-row"),"data-col":this.$player.attr("data-col"),css:{width:coords.width,height:coords.height}}).appendTo(this.$el);if(this.options.draggable.start){this.options.draggable.start.call(this,event,ui)}};fn.on_drag=function(event,ui){if(this.$player===null){return false}var abs_offset={left:ui.position.left+this.baseX,top:ui.position.top+this.baseY};this.colliders_data=this.collision_api.get_closest_colliders(abs_offset);this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column);this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row);if(this.helper&&this.$player){this.$player.css({left:ui.position.left,top:ui.position.top})}if(this.options.draggable.drag){this.options.draggable.drag.call(this,event,ui)}};fn.on_stop_drag=function(event,ui){this.$helper.add(this.$player).add(this.$wrapper).removeClass("dragging");ui.position.left=ui.position.left+this.baseX;ui.position.top=ui.position.top+this.baseY;this.colliders_data=this.collision_api.get_closest_colliders(ui.position);this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column);this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row);this.$player.addClass("player-revert").removeClass("player").attr({"data-col":this.placeholder_grid_data.col,"data-row":this.placeholder_grid_data.row}).css({left:"",top:""});this.$changed=this.$changed.add(this.$player);this.cells_occupied_by_player=this.get_cells_occupied(this.placeholder_grid_data);this.set_cells_player_occupies(this.placeholder_grid_data.col,this.placeholder_grid_data.row);this.$player.coords().grid.row=this.placeholder_grid_data.row;this.$player.coords().grid.col=this.placeholder_grid_data.col;if(this.options.draggable.stop){this.options.draggable.stop.call(this,event,ui)}this.$preview_holder.remove();this.$player=null;this.$helper=null;this.placeholder_grid_data={};this.player_grid_data={};this.cells_occupied_by_placeholder={};this.cells_occupied_by_player={};this.set_dom_grid_height()};fn.on_overlapped_column_change=function(start_callback,stop_callback){if(!this.colliders_data.length){return}var cols=this.get_targeted_columns(this.colliders_data[0].el.data.col);var last_n_cols=this.last_cols.length;var n_cols=cols.length;var i;for(i=0;i<n_cols;i++){if($.inArray(cols[i],this.last_cols)===-1){(start_callback||$.noop).call(this,cols[i])}}for(i=0;i<last_n_cols;i++){if($.inArray(this.last_cols[i],cols)===-1){(stop_callback||$.noop).call(this,this.last_cols[i])}}this.last_cols=cols;return this};fn.on_overlapped_row_change=function(start_callback,end_callback){if(!this.colliders_data.length){return}var rows=this.get_targeted_rows(this.colliders_data[0].el.data.row);var last_n_rows=this.last_rows.length;var n_rows=rows.length;var i;for(i=0;i<n_rows;i++){if($.inArray(rows[i],this.last_rows)===-1){(start_callback||$.noop).call(this,rows[i])}}for(i=0;i<last_n_rows;i++){if($.inArray(this.last_rows[i],rows)===-1){(end_callback||$.noop).call(this,this.last_rows[i])}}this.last_rows=rows};fn.set_player=function(col,row,no_player){var self=this;if(!no_player){this.empty_cells_player_occupies()}var cell=!no_player?self.colliders_data[0].el.data:{col:col};var to_col=cell.col;var to_row=row||cell.row;this.player_grid_data={col:to_col,row:to_row,size_y:this.player_grid_data.size_y,size_x:this.player_grid_data.size_x};this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data);var $overlapped_widgets=this.get_widgets_overlapped(this.player_grid_data);var constraints=this.widgets_constraints($overlapped_widgets);this.manage_movements(constraints.can_go_up,to_col,to_row);this.manage_movements(constraints.can_not_go_up,to_col,to_row);if(!$overlapped_widgets.length){var pp=this.can_go_player_up(this.player_grid_data);if(pp!==false){to_row=pp}this.set_placeholder(to_col,to_row)}return{col:to_col,row:to_row}};fn.widgets_constraints=function($widgets){var $widgets_can_go_up=$([]);var $widgets_can_not_go_up;var wgd_can_go_up=[];var wgd_can_not_go_up=[];$widgets.each($.proxy(function(i,w){var $w=$(w);var wgd=$w.coords().grid;if(this.can_go_widget_up(wgd)){$widgets_can_go_up=$widgets_can_go_up.add($w);wgd_can_go_up.push(wgd)}else{wgd_can_not_go_up.push(wgd)}},this));$widgets_can_not_go_up=$widgets.not($widgets_can_go_up);return{can_go_up:this.sort_by_row_asc(wgd_can_go_up),can_not_go_up:this.sort_by_row_desc(wgd_can_not_go_up)}};fn.sort_by_row_asc=function(widgets){widgets=widgets.sort(function(a,b){if(!a.row){a=$(a).coords().grid;b=$(b).coords().grid}if(a.row>b.row){return 1}return-1});return widgets};fn.sort_by_row_and_col_asc=function(widgets){widgets=widgets.sort(function(a,b){if(a.row>b.row||a.row===b.row&&a.col>b.col){return 1}return-1});return widgets};fn.sort_by_col_asc=function(widgets){widgets=widgets.sort(function(a,b){if(a.col>b.col){return 1}return-1});return widgets};fn.sort_by_row_desc=function(widgets){widgets=widgets.sort(function(a,b){if(a.row+a.size_y<b.row+b.size_y){return 1}return-1});return widgets};fn.manage_movements=function($widgets,to_col,to_row){$.each($widgets,$.proxy(function(i,w){var wgd=w;var $w=wgd.el;var can_go_widget_up=this.can_go_widget_up(wgd);if(can_go_widget_up){this.move_widget_to($w,can_go_widget_up);this.set_placeholder(to_col,can_go_widget_up+wgd.size_y)}else{var can_go_player_up=this.can_go_player_up(this.player_grid_data);if(!can_go_player_up){var y=to_row+this.player_grid_data.size_y-wgd.row;this.move_widget_down($w,y);this.set_placeholder(to_col,to_row)}}},this));return this};fn.is_player=function(col_or_el,row){if(row&&!this.gridmap[col_or_el]){return false}var $w=row?this.gridmap[col_or_el][row]:col_or_el;return $w&&($w.is(this.$player)||$w.is(this.$helper))};fn.is_player_in=function(col,row){var c=this.cells_occupied_by_player||{};return $.inArray(col,c.cols)>=0&&$.inArray(row,c.rows)>=0};fn.is_placeholder_in=function(col,row){var c=this.cells_occupied_by_placeholder||{};return this.is_placeholder_in_col(col)&&$.inArray(row,c.rows)>=0};fn.is_placeholder_in_col=function(col){var c=this.cells_occupied_by_placeholder||[];return $.inArray(col,c.cols)>=0};fn.is_empty=function(col,row){if(typeof this.gridmap[col]!=="undefined"&&typeof this.gridmap[col][row]!=="undefined"&&this.gridmap[col][row]===false){return true}return false};fn.is_occupied=function(col,row){if(!this.gridmap[col]){return false}if(this.gridmap[col][row]){return true}return false};fn.is_widget=function(col,row){var cell=this.gridmap[col];if(!cell){return false}cell=cell[row];if(cell){return cell}return false};fn.is_widget_under_player=function(col,row){if(this.is_widget(col,row)){return this.is_player_in(col,row)}return false};fn.get_widgets_under_player=function(cells){cells||(cells=this.cells_occupied_by_player||{cols:[],rows:[]});var $widgets=$([]);$.each(cells.cols,$.proxy(function(i,col){$.each(cells.rows,$.proxy(function(i,row){if(this.is_widget(col,row)){$widgets=$widgets.add(this.gridmap[col][row])}},this))},this));return $widgets};fn.set_placeholder=function(col,row){var phgd=$.extend({},this.placeholder_grid_data);var $nexts=this.widgets_below({col:phgd.col,row:phgd.row,size_y:phgd.size_y,size_x:phgd.size_x});var right_col=col+phgd.size_x-1;if(right_col>this.cols){col=col-(right_col-col)}var moved_down=this.placeholder_grid_data.row<row;var changed_column=this.placeholder_grid_data.col!==col;this.placeholder_grid_data.col=col;this.placeholder_grid_data.row=row;this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data);this.$preview_holder.attr({"data-row":row,"data-col":col});if(moved_down||changed_column){$nexts.each($.proxy(function(i,widget){this.move_widget_up($(widget),this.placeholder_grid_data.col-col+phgd.size_y)},this))}var $widgets_under_ph=this.get_widgets_under_player(this.cells_occupied_by_placeholder);if($widgets_under_ph.length){$widgets_under_ph.each($.proxy(function(i,widget){var $w=$(widget);this.move_widget_down($w,row+phgd.size_y-$w.data("coords").grid.row)},this))}};fn.can_go_player_up=function(widget_grid_data){var p_bottom_row=widget_grid_data.row+widget_grid_data.size_y-1;var result=true;var upper_rows=[];var min_row=1e4;var $widgets_under_player=this.get_widgets_under_player();this.for_each_column_occupied(widget_grid_data,function(tcol){var grid_col=this.gridmap[tcol];var r=p_bottom_row+1;upper_rows[tcol]=[];while(--r>0){if(this.is_empty(tcol,r)||this.is_player(tcol,r)||this.is_widget(tcol,r)&&grid_col[r].is($widgets_under_player)){upper_rows[tcol].push(r);min_row=r<min_row?r:min_row}else{break}}if(upper_rows[tcol].length===0){result=false;return true}upper_rows[tcol].sort()});if(!result){return false}return this.get_valid_rows(widget_grid_data,upper_rows,min_row)};fn.can_go_widget_up=function(widget_grid_data){var p_bottom_row=widget_grid_data.row+widget_grid_data.size_y-1;var result=true;var upper_rows=[];var min_row=1e4;this.for_each_column_occupied(widget_grid_data,function(tcol){var grid_col=this.gridmap[tcol];upper_rows[tcol]=[];var r=p_bottom_row+1;while(--r>0){if(this.is_widget(tcol,r)&&!this.is_player_in(tcol,r)){if(!grid_col[r].is(widget_grid_data.el)){break}}if(!this.is_player(tcol,r)&&!this.is_placeholder_in(tcol,r)&&!this.is_player_in(tcol,r)){upper_rows[tcol].push(r)}if(r<min_row){min_row=r}}if(upper_rows[tcol].length===0){result=false;return true}upper_rows[tcol].sort()});if(!result){return false}return this.get_valid_rows(widget_grid_data,upper_rows,min_row)};fn.get_valid_rows=function(widget_grid_data,upper_rows,min_row){var p_top_row=widget_grid_data.row;var p_bottom_row=widget_grid_data.row+widget_grid_data.size_y-1;var size_y=widget_grid_data.size_y;var r=min_row-1;var valid_rows=[];while(++r<=p_bottom_row){var common=true;$.each(upper_rows,function(col,rows){if($.isArray(rows)&&$.inArray(r,rows)===-1){common=false}});if(common===true){valid_rows.push(r);if(valid_rows.length===size_y){break}}}var new_row=false;if(size_y===1){if(valid_rows[0]!==p_top_row){new_row=valid_rows[0]||false}}else{if(valid_rows[0]!==p_top_row){new_row=this.get_consecutive_numbers_index(valid_rows,size_y)}}return new_row};fn.get_consecutive_numbers_index=function(arr,size_y){var max=arr.length;var result=[];var first=true;var prev=-1;for(var i=0;i<max;i++){if(first||arr[i]===prev+1){result.push(i);if(result.length===size_y){break}first=false}else{result=[];first=true}prev=arr[i]}return result.length>=size_y?arr[result[0]]:false};fn.get_widgets_overlapped=function(){var $w;var $widgets=$([]);var used=[];var rows_from_bottom=this.cells_occupied_by_player.rows.slice(0);rows_from_bottom.reverse();$.each(this.cells_occupied_by_player.cols,$.proxy(function(i,col){$.each(rows_from_bottom,$.proxy(function(i,row){if(!this.gridmap[col]){return true}var $w=this.gridmap[col][row];if(this.is_occupied(col,row)&&!this.is_player($w)&&$.inArray($w,used)===-1){$widgets=$widgets.add($w);used.push($w)}},this))},this));return $widgets};fn.on_start_overlapping_column=function(col){this.set_player(col,false)};fn.on_start_overlapping_row=function(row){this.set_player(false,row)};fn.on_stop_overlapping_column=function(col){this.set_player(col,false);var self=this;this.for_each_widget_below(col,this.cells_occupied_by_player.rows[0],function(tcol,trow){self.move_widget_up(this,self.player_grid_data.size_y)})};fn.on_stop_overlapping_row=function(row){this.set_player(false,row);var self=this;var cols=this.cells_occupied_by_player.cols;for(var c=0,cl=cols.length;c<cl;c++){this.for_each_widget_below(cols[c],row,function(tcol,trow){self.move_widget_up(this,self.player_grid_data.size_y)})}};fn.move_widget_to=function($widget,row){var self=this;var widget_grid_data=$widget.coords().grid;var diff=row-widget_grid_data.row;var $next_widgets=this.widgets_below($widget);var can_move_to_new_cell=this.can_move_to(widget_grid_data,widget_grid_data.col,row,$widget);if(can_move_to_new_cell===false){return false}this.remove_from_gridmap(widget_grid_data);widget_grid_data.row=row;this.add_to_gridmap(widget_grid_data);$widget.attr("data-row",row);this.$changed=this.$changed.add($widget);$next_widgets.each(function(i,widget){var $w=$(widget);
var wgd=$w.coords().grid;var can_go_up=self.can_go_widget_up(wgd);if(can_go_up&&can_go_up!==wgd.row){self.move_widget_to($w,can_go_up)}});return this};fn.move_widget_up=function($widget,y_units){var el_grid_data=$widget.coords().grid;var actual_row=el_grid_data.row;var moved=[];var can_go_up=true;y_units||(y_units=1);if(!this.can_go_up($widget)){return false}this.for_each_column_occupied(el_grid_data,function(col){if($.inArray($widget,moved)===-1){var widget_grid_data=$widget.coords().grid;var next_row=actual_row-y_units;next_row=this.can_go_up_to_row(widget_grid_data,col,next_row);if(!next_row){return true}var $next_widgets=this.widgets_below($widget);this.remove_from_gridmap(widget_grid_data);widget_grid_data.row=next_row;this.add_to_gridmap(widget_grid_data);$widget.attr("data-row",widget_grid_data.row);this.$changed=this.$changed.add($widget);moved.push($widget);$next_widgets.each($.proxy(function(i,widget){this.move_widget_up($(widget),y_units)},this))}})};fn.move_widget_down=function($widget,y_units){var el_grid_data=$widget.coords().grid;var actual_row=el_grid_data.row;var moved=[];var y_diff=y_units;if(!$widget){return false}if($.inArray($widget,moved)===-1){var widget_grid_data=$widget.coords().grid;var next_row=actual_row+y_units;var $next_widgets=this.widgets_below($widget);this.remove_from_gridmap(widget_grid_data);$next_widgets.each($.proxy(function(i,widget){var $w=$(widget);var wd=$w.coords().grid;var tmp_y=this.displacement_diff(wd,widget_grid_data,y_diff);if(tmp_y>0){this.move_widget_down($w,tmp_y)}},this));widget_grid_data.row=next_row;this.update_widget_position(widget_grid_data,$widget);$widget.attr("data-row",widget_grid_data.row);this.$changed=this.$changed.add($widget);moved.push($widget)}};fn.can_go_up_to_row=function(widget_grid_data,col,row){var ga=this.gridmap;var result=true;var urc=[];var actual_row=widget_grid_data.row;var r;this.for_each_column_occupied(widget_grid_data,function(tcol){var grid_col=ga[tcol];urc[tcol]=[];r=actual_row;while(r--){if(this.is_empty(tcol,r)&&!this.is_placeholder_in(tcol,r)){urc[tcol].push(r)}else{break}}if(!urc[tcol].length){result=false;return true}});if(!result){return false}r=row;for(r=1;r<actual_row;r++){var common=true;for(var uc=0,ucl=urc.length;uc<ucl;uc++){if(urc[uc]&&$.inArray(r,urc[uc])===-1){common=false}}if(common===true){result=r;break}}return result};fn.displacement_diff=function(widget_grid_data,parent_bgd,y_units){var actual_row=widget_grid_data.row;var diffs=[];var parent_max_y=parent_bgd.row+parent_bgd.size_y;this.for_each_column_occupied(widget_grid_data,function(col){var temp_y_units=0;for(var r=parent_max_y;r<actual_row;r++){if(this.is_empty(col,r)){temp_y_units=temp_y_units+1}}diffs.push(temp_y_units)});var max_diff=Math.max.apply(Math,diffs);y_units=y_units-max_diff;return y_units>0?y_units:0};fn.widgets_below=function($el){var el_grid_data=$.isPlainObject($el)?$el:$el.coords().grid;var self=this;var ga=this.gridmap;var next_row=el_grid_data.row+el_grid_data.size_y-1;var $nexts=$([]);this.for_each_column_occupied(el_grid_data,function(col){self.for_each_widget_below(col,next_row,function(tcol,trow){if(!self.is_player(this)&&$.inArray(this,$nexts)===-1){$nexts=$nexts.add(this);return true}})});return this.sort_by_row_asc($nexts)};fn.set_cells_player_occupies=function(col,row){this.remove_from_gridmap(this.placeholder_grid_data);this.placeholder_grid_data.col=col;this.placeholder_grid_data.row=row;this.add_to_gridmap(this.placeholder_grid_data,this.$player);return this};fn.empty_cells_player_occupies=function(){this.remove_from_gridmap(this.placeholder_grid_data);return this};fn.can_go_up=function($el){var el_grid_data=$el.coords().grid;var initial_row=el_grid_data.row;var prev_row=initial_row-1;var ga=this.gridmap;var upper_rows_by_column=[];var result=true;if(initial_row===1){return false}this.for_each_column_occupied(el_grid_data,function(col){var $w=this.is_widget(col,prev_row);if(this.is_occupied(col,prev_row)||this.is_player(col,prev_row)||this.is_placeholder_in(col,prev_row)||this.is_player_in(col,prev_row)){result=false;return true}});return result};fn.can_move_to=function(widget_grid_data,col,row,max_row){var ga=this.gridmap;var $w=widget_grid_data.el;var future_wd={size_y:widget_grid_data.size_y,size_x:widget_grid_data.size_x,col:col,row:row};var result=true;var right_col=col+widget_grid_data.size_x-1;if(right_col>this.cols){return false}if(max_row&&max_row<row+widget_grid_data.size_y-1){return false}this.for_each_cell_occupied(future_wd,function(tcol,trow){var $tw=this.is_widget(tcol,trow);if($tw&&(!widget_grid_data.el||$tw.is($w))){result=false}});return result};fn.get_targeted_columns=function(from_col){var max=(from_col||this.player_grid_data.col)+(this.player_grid_data.size_x-1);var cols=[];for(var col=from_col;col<=max;col++){cols.push(col)}return cols};fn.get_targeted_rows=function(from_row){var max=(from_row||this.player_grid_data.row)+(this.player_grid_data.size_y-1);var rows=[];for(var row=from_row;row<=max;row++){rows.push(row)}return rows};fn.get_cells_occupied=function(el_grid_data){var cells={cols:[],rows:[]};var i;if(arguments[1]instanceof jQuery){el_grid_data=arguments[1].coords().grid}for(i=0;i<el_grid_data.size_x;i++){var col=el_grid_data.col+i;cells.cols.push(col)}for(i=0;i<el_grid_data.size_y;i++){var row=el_grid_data.row+i;cells.rows.push(row)}return cells};fn.for_each_cell_occupied=function(grid_data,callback){this.for_each_column_occupied(grid_data,function(col){this.for_each_row_occupied(grid_data,function(row){callback.call(this,col,row)})});return this};fn.for_each_column_occupied=function(el_grid_data,callback){for(var i=0;i<el_grid_data.size_x;i++){var col=el_grid_data.col+i;callback.call(this,col,el_grid_data)}};fn.for_each_row_occupied=function(el_grid_data,callback){for(var i=0;i<el_grid_data.size_y;i++){var row=el_grid_data.row+i;callback.call(this,row,el_grid_data)}};fn._traversing_widgets=function(type,direction,col,row,callback){var ga=this.gridmap;if(!ga[col]){return}var cr,max;var action=type+"/"+direction;if(arguments[2]instanceof jQuery){var el_grid_data=arguments[2].coords().grid;col=el_grid_data.col;row=el_grid_data.row;callback=arguments[3]}var matched=[];var trow=row;var methods={"for_each/above":function(){while(trow--){if(trow>0&&this.is_widget(col,trow)&&$.inArray(ga[col][trow],matched)===-1){cr=callback.call(ga[col][trow],col,trow);matched.push(ga[col][trow]);if(cr){break}}}},"for_each/below":function(){for(trow=row+1,max=ga[col].length;trow<max;trow++){if(this.is_widget(col,trow)&&$.inArray(ga[col][trow],matched)===-1){cr=callback.call(ga[col][trow],col,trow);matched.push(ga[col][trow]);if(cr){break}}}}};if(methods[action]){methods[action].call(this)}};fn.for_each_widget_above=function(col,row,callback){this._traversing_widgets("for_each","above",col,row,callback);return this};fn.for_each_widget_below=function(col,row,callback){this._traversing_widgets("for_each","below",col,row,callback);return this};fn.get_highest_occupied_cell=function(){var r;var gm=this.gridmap;var rows=[];var row_in_col=[];for(var c=gm.length-1;c>=1;c--){for(r=gm[c].length-1;r>=1;r--){if(this.is_widget(c,r)){rows.push(r);row_in_col[r]=c;break}}}var highest_row=Math.max.apply(Math,rows);this.highest_occupied_cell={col:row_in_col[highest_row],row:highest_row};return this.highest_occupied_cell};fn.get_widgets_from=function(col,row){var ga=this.gridmap;var $widgets=$();if(col){$widgets=$widgets.add(this.$widgets.filter(function(){var tcol=$(this).attr("data-col");return tcol===col||tcol>col}))}if(row){$widgets=$widgets.add(this.$widgets.filter(function(){var trow=$(this).attr("data-row");return trow===row||trow>row}))}return $widgets};fn.set_dom_grid_height=function(){var r=this.get_highest_occupied_cell().row;this.$el.css("height",r*this.min_widget_height);return this};fn.generate_stylesheet=function(opts){var styles="";var max_size_x=this.options.max_size_x;var max_rows=0;var max_cols=0;var i;var rules;opts||(opts={});opts.cols||(opts.cols=this.cols);opts.rows||(opts.rows=this.rows);opts.namespace||(opts.namespace=this.options.namespace);opts.widget_base_dimensions||(opts.widget_base_dimensions=this.options.widget_base_dimensions);opts.widget_margins||(opts.widget_margins=this.options.widget_margins);opts.min_widget_width=opts.widget_margins[0]*2+opts.widget_base_dimensions[0];opts.min_widget_height=opts.widget_margins[1]*2+opts.widget_base_dimensions[1];var serialized_opts=$.param(opts);if($.inArray(serialized_opts,Gridster.generated_stylesheets)>=0){return false}Gridster.generated_stylesheets.push(serialized_opts);for(i=opts.cols;i>=0;i--){styles+=opts.namespace+' [data-col="'+(i+1)+'"] { left:'+(i*opts.widget_base_dimensions[0]+i*opts.widget_margins[0]+(i+1)*opts.widget_margins[0])+"px;} "}for(i=opts.rows;i>=0;i--){styles+=opts.namespace+' [data-row="'+(i+1)+'"] { top:'+(i*opts.widget_base_dimensions[1]+i*opts.widget_margins[1]+(i+1)*opts.widget_margins[1])+"px;} "}for(var y=1;y<=opts.rows;y++){styles+=opts.namespace+' [data-sizey="'+y+'"] { height:'+(y*opts.widget_base_dimensions[1]+(y-1)*opts.widget_margins[1]*2)+"px;}"}for(var x=1;x<=max_size_x;x++){styles+=opts.namespace+' [data-sizex="'+x+'"] { width:'+(x*opts.widget_base_dimensions[0]+(x-1)*opts.widget_margins[0]*2)+"px;}"}return this.add_style_tag(styles)};fn.add_style_tag=function(css){var d=document;var tag=d.createElement("style");d.getElementsByTagName("head")[0].appendChild(tag);tag.setAttribute("type","text/css");if(tag.styleSheet){tag.styleSheet.cssText=css}else{tag.appendChild(document.createTextNode(css))}return this};fn.generate_faux_grid=function(rows,cols){this.faux_grid=[];this.gridmap=[];var col;var row;for(col=cols;col>0;col--){this.gridmap[col]=[];for(row=rows;row>0;row--){this.add_faux_cell(row,col)}}return this};fn.add_faux_cell=function(row,col){var coords=$({left:this.baseX+(col-1)*this.min_widget_width,top:this.baseY+(row-1)*this.min_widget_height,width:this.min_widget_width,height:this.min_widget_height,col:col,row:row,original_col:col,original_row:row}).coords();if(!$.isArray(this.gridmap[col])){this.gridmap[col]=[]}this.gridmap[col][row]=false;this.faux_grid.push(coords);return this};fn.add_faux_rows=function(rows){var actual_rows=this.rows;var max_rows=actual_rows+(rows||1);for(var r=max_rows;r>actual_rows;r--){for(var c=this.cols;c>=1;c--){this.add_faux_cell(r,c)}}this.rows=max_rows;if(this.options.autogenerate_stylesheet){this.generate_stylesheet()}return this};fn.add_faux_cols=function(cols){var actual_cols=this.cols;var max_cols=actual_cols+(cols||1);for(var c=actual_cols;c<max_cols;c++){for(var r=this.rows;r>=1;r--){this.add_faux_cell(r,c)}}this.cols=max_cols;if(this.options.autogenerate_stylesheet){this.generate_stylesheet()}return this};fn.recalculate_faux_grid=function(){var aw=this.$wrapper.width();this.baseX=($(window).width()-aw)/2;this.baseY=this.$wrapper.offset().top;$.each(this.faux_grid,$.proxy(function(i,coords){this.faux_grid[i]=coords.update({left:this.baseX+(coords.data.col-1)*this.min_widget_width,top:this.baseY+(coords.data.row-1)*this.min_widget_height})},this));return this};fn.get_widgets_from_DOM=function(){this.$widgets.each($.proxy(function(i,widget){this.register_widget($(widget))},this));return this};fn.generate_grid_and_stylesheet=function(){var aw=this.$wrapper.width();var ah=this.$wrapper.height();var cols=Math.floor(aw/this.min_widget_width)+this.options.extra_cols;var actual_cols=this.$widgets.map(function(){return $(this).attr("data-col")});actual_cols=Array.prototype.slice.call(actual_cols,0);actual_cols.length||(actual_cols=[0]);var min_cols=Math.max.apply(Math,actual_cols);var max_rows=this.options.extra_rows;this.$widgets.each(function(i,w){max_rows+=+$(w).attr("data-sizey")});this.cols=Math.max(min_cols,cols,this.options.min_cols);this.rows=Math.max(max_rows,this.options.min_rows);this.baseX=($(window).width()-aw)/2;this.baseY=this.$wrapper.offset().top;if(this.options.autogenerate_stylesheet){this.generate_stylesheet()}return this.generate_faux_grid(this.rows,this.cols)};$.fn.gridster=function(options){return this.each(function(){if(!$(this).data("gridster")){$(this).data("gridster",new Gridster(this,options))}})};$.Gridster=fn})(jQuery,window,document);(function(){var V=envision,global_data={};function getDefaultsMarkers(option,markers,dates){var mark="";if(!markers||markers.length===0)return mark;for(var i=0;i<markers.date.length;i++){if(markers.date[i]==dates[option.index]){mark=markers.marks[i]}}return mark}function getEnvisionDefaultsGraph(name,gconfig){var graph={name:name,config:{colors:gconfig.colors,grid:{verticalLines:false,horizontalLines:false},mouse:{track:true,trackY:false,position:"ne"},yaxis:{min:0,autoscale:true},legend:{show:false,backgroundColor:"#FFFFFF",backgroundOpacity:0}}};if(gconfig.gtype==="whiskers")graph.config.whiskers={show:true,lineWidth:2};else graph.config["lite-lines"]={lineWidth:2,show:true,fill:false,fillOpacity:.5};if(gconfig.y_labels)graph.config.yaxis={showLabels:true,min:0};if(gconfig.show_markers)graph.config.markers={show:true,position:"ct",labelFormatter:function(o){return getDefaultsMarkers(o,gconfig.markers,gconfig.dates)}};return graph}function getDefaultsMetrics(DS,viz,metrics,default_config){var all_metrics=Report.getAllMetrics();var label=null;$.each(metrics,function(metric,value){config=default_config;if(value.envision)config=DataProcess.mergeConfig(default_config,value.envision);if($.inArray(metric,global_data.envision_hide)===-1){viz[metric]=getEnvisionDefaultsGraph("report-"+DS.getName()+"-"+metric,config);label=metric;if(all_metrics[metric])label=all_metrics[metric].name;viz[metric].config.subtitle=label;if(DS.getMainMetric()==metric){viz[metric+"_relative"]=getEnvisionDefaultsGraph("report-"+DS.getName()+"-"+metric+"_relative",config);viz[metric].config["lite-lines"]={show:false};viz[metric].config.lines={lineWidth:1,show:true,stacked:true,fill:true,fillOpacity:1}}}})}function getDefaults(ds){var defaults_colors=["#ffa500","#00A8F0","#C0D800","#ffff00","#00ff00","#4DA74D","#9440ED"];var default_config={colors:defaults_colors,dates:global_data.dates,g_type:"",markers:global_data.markers,y_labels:false};var data_sources=Report.getDataSources();var viz={};var metrics={};if(!ds){$.each(data_sources,function(i,DS){metrics=DS.getMetrics();getDefaultsMetrics(DS,viz,metrics,default_config)})}else{$.each(data_sources,function(i,DS){if($.inArray(DS.getName(),ds)>-1){metrics=DS.getMetrics();getDefaultsMetrics(DS,viz,metrics,default_config)}})}config=default_config;viz.summary=getEnvisionDefaultsGraph("report-summary",config);viz.summary.config.xaxis={noTickets:10,showLabels:true};viz.summary.config.handles={show:true};viz.summary.config.selection={mode:"x"};viz.summary.config.mouse={};viz.connection={name:"report-connection",adapterConstructor:V.components.QuadraticDrawing};return viz}function getOrderedDataSources(ds_list,main_metric){var ordered=[];var main_DS=null;$.each(ds_list,function(i,DS){if(DS.getMetrics()[main_metric]){main_DS=DS;return false}});ordered.push(main_DS);$.each(ds_list,function(i,DS){if(DS===main_DS)return;ordered.push(DS)});return ordered}function Envision_Report(options,data_sources){var main_metric=options.data.main_metric;global_data=options.data;if(!data_sources)data_sources=Report.getDataSources();data_sources=getOrderedDataSources(data_sources,main_metric);var ds=[];for(var i=0;i<data_sources.length;i++){if(data_sources[i].getData().length===0)continue;ds.push(data_sources[i].getName())}var data=options.data,defaults=getDefaults(ds),vis=new V.Visualization({name:"report-"+ds.join(",")}),selection=new V.Interaction,hit=new V.Interaction;var metrics={};$.each(data_sources,function(i,DS){if(DS.getData().length===0)return;metrics=$.extend(metrics,DS.getMetrics())});$.each(metrics,function(metric,value){if($.inArray(metric,data.envision_hide)!==-1)return;if(data[metric]===undefined)return;defaults[metric].data=data[metric];if(defaults[metric].data.length<Report.getProjectsList().length)defaults[metric].config.legend.show=true;if(data[metric+"_relative"])defaults[metric].data=data[metric+"_relative"]});defaults.summary.data=data.summary;defaults[main_metric].config.legend.show=true;if(options.legend_show===false)defaults[main_metric].config.legend.show=false;defaults[main_metric].config.mouse.trackFormatter=options.trackFormatter;if(options.xTickFormatter){defaults.summary.config.xaxis.tickFormatter=options.xTickFormatter}defaults[main_metric].config.yaxis.tickFormatter=options.yTickFormatter||function(n){return"$"+n};var components={};$.each(metrics,function(metric,value){if(data[metric]===undefined)return;if($.inArray(metric,data.envision_hide)===-1){components[metric]=new V.Component(defaults[metric])}});connection=new V.Component(defaults.connection);summary=new V.Component(defaults.summary);$.each(components,function(component,value){vis.add(value)});vis.add(connection).add(summary).render(options.container);$.each(components,function(component,value){selection.follower(value)});selection.follower(connection).leader(summary).add(V.actions.selection,options.selectionCallback?{callback:options.selectionCallback}:null);var hit_group=[];$.each(components,function(component,value){hit_group.push(value)});hit.group(hit_group).add(V.actions.hit);if(options.selection){summary.trigger("select",options.selection)}}V.templates.Envision_Report=Envision_Report})();if(Loader===undefined)var Loader={};(function(){var data_callbacks=[];var data_global_callbacks=[];var data_repos_callbacks=[];var check_companies=false,check_repos=false,check_countries=false;var ds_not_supported_company_top=["scr","irc","mediawiki"];var ds_supporting_top_repos=["scm","mls","its"];Loader.data_ready=function(callback){data_callbacks.push(callback)};Loader.data_ready_global=function(callback){data_global_callbacks.push(callback)};function fillProjectInfo(data,dir){if(data.project_name===undefined){data.project_name=dir.replace("data/json","").replace(/\.\.\//g,"")}var projects_data=Report.getProjectsData();projects_data[data.project_name]={dir:dir,url:data.project_url}}Loader.data_load=function(){if(Report.getConfig()!==null&&Report.getConfig().project_info!==undefined){Report.setProjectData(Report.getConfig().project_info);if(Report.getConfig().markers)data_load_file(Report.getMarkersFile(),function(data,self){Report.setMarkers(data)})}else{data_load_file(Report.getProjectFile(),function(data,self){Report.setProjectData(data)});data_load_file(Report.getMarkersFile(),function(data,self){Report.setMarkers(data)})}var projects_dirs=Report.getProjectsDirs();for(var i=0;i<projects_dirs.length;i++){var data_dir=projects_dirs[i];var prj_file=Report.getDataDir()+"/project-info.json";data_load_file(prj_file,fillProjectInfo,data_dir)}data_load_file(Report.getProjectsHierarchyFile(),Report.setProjectsHierarchy);data_load_file(Report.getMenuElementsFile(),Report.setMenuElements);data_load_file(Report.getVizConfigFile(),function(data,self){Report.setVizConfig(data)});data_load_metrics_definition();data_load_metrics();data_load_tops("authors");data_load_time_to_fix();data_load_time_to_attention();data_load_demographics();data_load_markov_table();if(Report.getConfig()!==null&&Report.getConfig().reports!==undefined){var active_reports=Report.getConfig().reports;if($.inArray("companies",active_reports)>-1)data_load_companies();if($.inArray("repositories",active_reports)>-1)data_load_repos();if($.inArray("countries",active_reports)>-1)data_load_countries();if($.inArray("domains",active_reports)>-1)data_load_domains();if($.inArray("projects",active_reports)>-1)data_load_projects();if($.inArray("people",active_reports)>-1){data_load_people();data_load_people_identities()}}else{data_load_companies();data_load_repos();data_load_countries();data_load_domains();data_load_projects();data_load_people();data_load_people_identities()}};Loader.get_file_data_div=function(file,cb,div){$.when($.getJSON(file)).done(function(history){cb(div,file,history)}).fail(function(){cb(file,null)})};function data_load_file(file,fn_data_set,self){$.when($.getJSON(file)).done(function(history){fn_data_set(history,self);end_data_load()}).fail(function(){fn_data_set([],self);end_data_load()})}function data_load_companies(){var ds_not_supported=["irc","mediawiki"];var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if($.inArray(DS.getName(),ds_not_supported)>-1)DS.setCompaniesData([]);else data_load_file(DS.getCompaniesDataFile(),DS.setCompaniesData,DS)})}function data_load_repos(){var ds_not_supported=["mediawiki"];var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if($.inArray(DS.getName(),ds_not_supported)>-1){DS.setReposData([])}else{data_load_file(DS.getReposDataFile(),DS.setReposData,DS)}});data_load_file(Report.getReposMapFile(),Report.setReposMap)}function data_load_countries(){var ds_not_supported=["irc","mediawiki"];var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if($.inArray(DS.getName(),ds_not_supported)>-1)DS.setCountriesData([]);else data_load_file(DS.getCountriesDataFile(),DS.setCountriesData,DS)})}function data_load_domains(){var ds_not_supported=["irc","mediawiki"];var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if($.inArray(DS.getName(),ds_not_supported)>-1)DS.setDomainsData([]);else data_load_file(DS.getDomainsDataFile(),DS.setDomainsData,DS)})}function data_load_projects(){var ds_not_supported=["irc","mediawiki"];var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if($.inArray(DS.getName(),ds_not_supported)>-1)DS.setProjectsData([]);else data_load_file(DS.getProjectsDataFile(),DS.setProjectsData,DS)})}function data_load_time_to_fix(){var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if(DS.getName()==="its")data_load_file(DS.getTimeToFixDataFile(),DS.setTimeToFixData,DS)})}function data_load_markov_table(){var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if(DS.getName()==="its")data_load_file(DS.getMarkovTableDataFile(),DS.setMarkovTableData,DS)})}function data_load_time_to_attention(){var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){if(DS.getName()==="mls")data_load_file(DS.getTimeToAttentionDataFile(),DS.setTimeToAttentionData,DS)})}function data_load_demographics(){var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){data_load_file(DS.getDemographicsAgingFile(),DS.setDemographicsAgingData,DS);data_load_file(DS.getDemographicsBirthFile(),DS.setDemographicsBirthData,DS)})}function data_load_tops(metric){var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){var file_all=DS.getTopDataFile();$.when($.getJSON(file_all)).done(function(history){DS.setGlobalTopData(history);end_data_load()}).fail(function(){DS.setGlobalTopData([],DS);end_data_load()})})}Loader.check_filters_page=function(page){var check=true;var filters=["repos","companies","countries"];$.each(filters,function(index,filter){if(!Loader.check_filter_page(page,filter)){check=false;return false}});return check};Loader.check_filter_page=function(page,filter){var check=true;if(page===undefined)page=1;var start=Report.getPageSize()*(page-1);var end=start+Report.getPageSize();$.each(Report.getDataSources(),function(index,DS){var total=0;if(filter==="repos")total=DS.getReposData().length;if(filter==="companies")total=DS.getCompaniesData().length;if(filter==="countries")total=DS.getCountriesData().length;if(filter==="domains")total=DS.getDomainsData().length;if(filter==="projects")total=DS.getProjectsData().length;if(end>total)end=total;for(var i=start;i<end;i++){var item;if(filter==="repos"){item=DS.getReposData()[i];if(DS.getReposGlobalData()[item]===undefined||DS.getReposMetricsData()[item]===undefined){check=false;return false}}if(filter==="companies"){item=DS.getCompaniesData()[i];if(DS.getCompaniesGlobalData()[item]===undefined||DS.getCompaniesMetricsData()[item]===undefined){check=false;return false}}if(filter==="countries"){item=DS.getCountriesData()[i];if(DS.getCountriesGlobalData()[item]===undefined||DS.getCountriesMetricsData()[item]===undefined){check=false;return false}}if(filter==="domains"){item=DS.getDomainsData()[i];if(DS.getDomainsGlobalData()[item]===undefined||DS.getDomainsMetricsData()[item]===undefined){check=false;return false}}if(filter==="projects"){item=DS.getProjectsData()[i];if(DS.getProjectsGlobalData()[item]===undefined||DS.getProjectsMetricsData()[item]===undefined){check=false;return false}}}end=start+Report.getPageSize()});return check};function getItemDS(item,filter){var ds=null;$.each(Report.getDataSources(),function(index,DS){if(filter=="repos"){if($.inArray(item,DS.getReposData())>-1){ds=DS;return false}}if(filter=="companies"){if($.inArray(item,DS.getCompaniesData())>-1){ds=DS;return false}}if(filter=="countries"){if($.inArray(item,DS.getCountriesData())>-1){ds=DS;return false}}if(filter=="domains"){if($.inArray(item,DS.getDomainsData())>-1){ds=DS;return false}}if(filter=="projects"){if($.inArray(item,DS.getProjectsData())>-1){ds=DS;return false}}});return ds}Loader.filterTopCheck=function(item,filter){var check=true;if(filter==="repos"){if(Loader.check_item(item,filter,"top")===false){ds=getItemDS(item,filter);if(ds===null){Report.log("Can't find data source for "+item);return true}if($.inArray(ds.getName(),ds_supporting_top_repos)>=0){Loader.data_load_item_top(item,ds,null,Convert.convertFilterTop,filter,"top")}return false}}return check};Loader.FilterItemCheck=function(item,filter){var check=true,ds;var map=Report.getReposMap();if(filter==="repos"){if(Loader.check_item(item,filter)===false){ds=getItemDS(item,filter);if(ds===null){Report.log("Can't find data source for "+item);return true}Loader.data_load_item(item,ds,null,Convert.convertFilterStudyItem,filter,null);if($.inArray(ds.getName(),ds_supporting_top_repos)>=0){Loader.data_load_item_top(item,ds,null,Convert.convertFilterStudyItem,filter)}return false}if(map!==undefined&&map.length!==0){var items_map=[];$.each(Report.getDataSources(),function(index,DS){var itmap=Convert.getRealItem(DS,filter,item);if(itmap!==undefined&&itmap!==null)items_map.push(itmap)});if(Loader.check_items(items_map,filter)===false){for(var i=0;i<items_map.length;i++){if(Loader.check_item(items_map[i],filter)===false){ds=getItemDS(items_map[i],filter);if(ds===null){Report.log("Can't find "+items_map[i]);Report.log("Check repos-map.json");continue}Loader.data_load_item(items_map[i],ds,null,Convert.convertFilterStudyItem,filter,items_map)}}check=false}}}else{$.each(Report.getDataSources(),function(index,DS){if(Loader.check_item(item,filter)===false){check=false;Loader.data_load_item(item,DS,null,Convert.convertFilterStudyItem,filter,null);if(filter==="companies"){if($.inArray(DS.getName(),ds_not_supported_company_top)===-1)Loader.data_load_item_top(item,DS,null,Convert.convertFilterStudyItem,filter)}}})}return check};Loader.check_item=function(item,filter,optional_filter){var check=false;$.each(Report.getDataSources(),function(index,DS){if(filter==="repos"){if(optional_filter==="top"){if($.inArray(DS.getName(),ds_supporting_top_repos)>=0&&$.inArray(item,DS.getReposData())>=0&&DS.getRepositoriesTopData()[item]!==undefined){check=true;return false}}else{if(DS.getReposGlobalData()[item]!==undefined&&DS.getReposMetricsData()[item]!==undefined){check=true;return false}}}else if(filter==="companies"){var companies=DS.getCompaniesData();if(companies.length===0)check=true;else if($.inArray(item,companies)===-1)check=true;else if(DS.getCompaniesGlobalData()[item]===undefined||DS.getCompaniesMetricsData()[item]===undefined){check=false;return false}else if($.inArray(DS.getName(),ds_not_supported_company_top)===-1&&DS.getCompaniesTopData()[item]===undefined){check=false;return false}else check=true}else if(filter==="countries"){var countries=DS.getCountriesData();if(countries.length===0)check=true;else if($.inArray(item,countries)===-1)check=true;else if(DS.getCountriesGlobalData()[item]===undefined||DS.getCountriesMetricsData()[item]===undefined){check=false;return false}else check=true}else if(filter==="domains"){var domains=DS.getDomainsData();if(domains.length===0)check=true;else if($.inArray(item,domains)===-1)check=true;else if(DS.getDomainsGlobalData()[item]===undefined||DS.getDomainsMetricsData()[item]===undefined){check=false;return false}else check=true}else if(filter==="projects"){var projects=DS.getProjectsData();if(projects.length===0)check=true;else if($.inArray(item,projects)===-1)check=true;else if(DS.getProjectsGlobalData()[item]===undefined||DS.getProjectsMetricsData()[item]===undefined){check=false;return false}else check=true}});return check};Loader.check_items=function(items,filter){var check=true;$.each(items,function(id,item){if(Loader.check_item(item,filter)===false){check=false;return false}});return check};Loader.data_load_items_page=function(DS,page,cb,filter){if(page===undefined)page=1;if(filter==="repos")if(DS.getReposData()===null)return false;if(filter==="companies")if(DS.getCompaniesData()===null)return false;if(filter==="countries")if(DS.getCountriesData()===null)return false;if(filter==="domains")if(DS.getDomainsData()===null)return false;if(filter==="projects")if(DS.getProjectsData()===null)return false;var total=0;if(filter==="repos")total=DS.getReposData().length;if(filter==="companies")total=DS.getCompaniesData().length;if(filter==="countries")total=DS.getCountriesData().length;if(filter==="domains")total=DS.getDomainsData().length;if(filter==="projects")total=DS.getProjectsData().length;if(total===0)return true;var start=Report.getPageSize()*(page-1);var end=start+Report.getPageSize();if(end>total)end=total;for(var i=start;i<end;i++){if(filter==="repos"){var repo=DS.getReposData()[i];Loader.data_load_item(repo,DS,page,cb,"repos")}else if(filter==="companies"){var company=DS.getCompaniesData()[i];Loader.data_load_item(company,DS,page,cb,"companies")}else if(filter==="countries"){var country=DS.getCountriesData()[i];Loader.data_load_item(country,DS,page,cb,"countries")}else if(filter==="domains"){var domain=DS.getDomainsData()[i];Loader.data_load_item(domain,DS,page,cb,"domains")}else if(filter==="projects"){var project=DS.getProjectsData()[i];Loader.data_load_item(project,DS,page,cb,"projects")}}};Loader.check_people_item=function(item){var check=true;$.each(Report.getDataSources(),function(index,DS){if(DS.getPeopleGlobalData()[item]===undefined||DS.getPeopleMetricsData()[item]===undefined){check=false;return false}});return check};Loader.data_load_people_item=function(upeople_id,DS,cb){var file=DS.getDataDir()+"/people-"+upeople_id+"-"+DS.getName();var file_evo=file+"-evolutionary.json";var file_static=file+"-static.json";$.when($.getJSON(file_evo),$.getJSON(file_static)).done(function(evo,global){DS.addPeopleMetricsData(upeople_id,evo[0],DS);DS.addPeopleGlobalData(upeople_id,global[0],DS);if(Loader.check_people_item(upeople_id))cb(upeople_id)}).fail(function(){DS.addPeopleMetricsData(upeople_id,[],DS);DS.addPeopleGlobalData(upeople_id,[],DS);if(Loader.check_people_item(upeople_id))cb(upeople_id)})};function getFilterSuffix(filter){var filter_suffix="";if(filter==="repos"){filter_suffix="rep"}else if(filter==="companies"){filter_suffix="com"}else if(filter==="countries"){filter_suffix="cou"}else if(filter==="domains"){filter_suffix="dom"}else if(filter==="projects"){filter_suffix="prj"}return filter_suffix}Loader.data_load_item_top=function(item,DS,page,cb,filter,optional_filter){var file_top=DS.getDataDir()+"/"+item+"-"+DS.getName();file_top+="-"+getFilterSuffix(filter)+"-top-";if(DS.getName()==="scm")file_top+="authors";else if(DS.getName()==="its")file_top+="closers";else if(DS.getName()==="mls")file_top+="senders";else return;file_top+=".json";$.when($.getJSON(file_top)).done(function(top){if(filter==="companies"){DS.addCompanyTopData(item,top)}else if(filter==="repos"){DS.addRepositoryTopData(item,top)}}).fail(function(){if(filter==="companies"){DS.addCompanyTopData(item,[])
}else if(filter==="repos"){DS.addRepositoryTopData(item,[])}}).always(function(){if(Loader.check_item(item,filter,optional_filter)){if(!cb.called_item)cb(filter);cb.called_item=true}})};Loader.data_load_item=function(item,DS,page,cb,filter,items_map){var ds_not_supported_countries=["irc","mediawiki"];var ds_not_supported_companies=["irc","mediawiki"];var ds_not_supported_domains=["irc","mediawiki"];var ds_not_supported_repos=["mediawiki"];var ds_not_supported_projects=["irc","mediawiki"];if(filter==="repos"){if($.inArray(DS.getName(),ds_not_supported_repos)>-1){DS.addRepoMetricsData(item,[],DS);DS.addRepoGlobalData(item,[],DS);return}}else if(filter==="companies"){if($.inArray(DS.getName(),ds_not_supported_companies)>-1){DS.addCompanyMetricsData(item,[],DS);DS.addCompanyGlobalData(item,[],DS);return}}else if(filter==="countries"){if($.inArray(DS.getName(),ds_not_supported_countries)>-1){DS.addCountryMetricsData(item,[],DS);DS.addCountryGlobalData(item,[],DS);return}}else if(filter==="domains"){if($.inArray(DS.getName(),ds_not_supported_domains)>-1){DS.addDomainMetricsData(item,[],DS);DS.addDomainGlobalData(item,[],DS);return}}else if(filter==="projects"){if($.inArray(DS.getName(),ds_not_supported_projects)>-1){DS.addDomainMetricsData(item,[],DS);DS.addDomainGlobalData(item,[],DS);return}}else return;var item_uri=encodeURIComponent(item);var file=DS.getDataDir()+"/"+item_uri+"-";file+=DS.getName()+"-"+getFilterSuffix(filter);var file_evo=file+"-evolutionary.json";var file_static=file+"-static.json";$.when($.getJSON(file_evo),$.getJSON(file_static)).done(function(evo,global){if(filter==="repos"){DS.addRepoMetricsData(item,evo[0],DS);DS.addRepoGlobalData(item,global[0],DS)}else if(filter==="companies"){DS.addCompanyMetricsData(item,evo[0],DS);DS.addCompanyGlobalData(item,global[0],DS)}else if(filter==="countries"){DS.addCountryMetricsData(item,evo[0],DS);DS.addCountryGlobalData(item,global[0],DS)}else if(filter==="domains"){DS.addDomainMetricsData(item,evo[0],DS);DS.addDomainGlobalData(item,global[0],DS)}else if(filter==="projects"){DS.addProjectMetricsData(item,evo[0],DS);DS.addProjectGlobalData(item,global[0],DS)}}).always(function(){if(page!==null){if(Loader.check_filter_page(page,filter)){if(cb.called_page===undefined){cb.called_page={};cb.called_page[filter]=true;cb(filter)}else if(!cb.called_page[filter]){cb(filter);cb.called_page[filter]=true}}}else if(items_map!==null){if(Loader.check_items(items_map,filter)){if(cb.called_map===undefined){cb.called_map={};cb.called_map[filter]=true;cb(filter)}else if(!cb.called_map[filter]){cb(filter);cb.called_map[filter]=true}}}else{if(Loader.check_item(item,filter)){if(cb.called_item===undefined){cb.called_item={};cb.called_item[filter]=true;cb(filter,item)}else if(!cb.called_item[filter]){cb(filter,item);cb.called_item[filter]=true}}}})};function data_load_metrics(){var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){data_load_file(DS.getDataFile(),DS.setData,DS);data_load_file(DS.getGlobalDataFile(),DS.setGlobalData,DS);if(DS instanceof MLS){data_load_file(DS.getListsFile(),DS.setListsData,DS)}})}function data_load_metrics_definition(){data_load_file("VizGrimoireJS/data/metrics.json",Report.setMetricsDefinition)}function data_load_people(){var data_sources=Report.getDataSources();$.each(data_sources,function(i,DS){data_load_file(DS.getPeopleDataFile(),DS.setPeopleData,DS)})}function data_load_people_identities(){data_load_file(Report.getDataDir()+"/people.json",Report.setPeopleIdentities)}function check_companies_loaded(DS){if(DS.getCompaniesData()===null)return false;return true}function check_repos_loaded(DS){if(DS.getReposData()===null)return false;return true}function check_countries_loaded(DS){if(DS.getCountriesData()===null)return false;return true}function check_domains_loaded(DS){if(DS.getDomainsData()===null)return false;return true}function check_projects_loaded(DS){if(DS.getProjectsData()===null)return false;return true}function check_meta_projects_loaded(){var projects_loaded=0;var projects_data=Report.getProjectsData();var projects_dirs=Report.getProjectsDirs();for(var key in projects_data){projects_loaded++}if(projects_loaded<projects_dirs.length)return false;return true}function check_data_loaded_global(){var check=true;if(Report.getProjectData()===null||Report.getVizConfig()===null)return false;if(Report.getConfig()===null)if(Report.getMarkers()===null)return false;if(Report.getReposMap()===null)return false;if(Report.getConfig()===null)if(!check_meta_projects_loaded())return false;var data_sources=Report.getDataSources();$.each(data_sources,function(index,DS){if(DS.getData()===null){check=false;return false}if(DS.getGlobalData()===null){check=false;return false}if(DS.getGlobalTopData()===null){check=false;return false}if(DS.getDemographicsData().aging===undefined||DS.getDemographicsData().birth===undefined){check=false;return false}if(DS.getName()==="its")if(DS.getTimeToFixData()===null){check=false;return false}if(DS.getName()==="mls")if(DS.getTimeToAttentionData()===null){check=false;return false}});return check}Loader.check_data_loaded=function(){var check=true;if(!check_data_loaded_global())return false;var data_sources=Report.getDataSources();var active_reports=["companies","repositories","countries","domains","projects"];if(Report.getConfig()!==null&&Report.getConfig().reports!==undefined)active_reports=Report.getConfig().reports;$.each(data_sources,function(index,DS){if(DS.getPeopleData()===null){check=false;return false}if($.inArray("companies",active_reports)>-1)if(!check_companies_loaded(DS)){check=false;return false}if($.inArray("repositories",active_reports)>-1)if(!check_repos_loaded(DS)){check=false;return false}if($.inArray("countries",active_reports)>-1)if(!check_countries_loaded(DS)){check=false;return false}if($.inArray("domains",active_reports)>-1)if(!check_domains_loaded(DS)){check=false;return false}if($.inArray("projects",active_reports)>-1)if(!check_projects_loaded(DS)){check=false;return false}if(DS instanceof MLS){if(DS.getListsData()===null){check=false;return false}}});return check};function end_data_load(){if(check_data_loaded_global()){for(var i=0;i<data_global_callbacks.length;i++){data_global_callbacks[i]()}data_global_callbacks=[]}if(Loader.check_data_loaded()){for(var j=0;j<data_callbacks.length;j++){if(data_callbacks[j].called!==true)data_callbacks[j]();data_callbacks[j].called=true}}}})();var DataProcess={};(function(){DataProcess.info=function(){};DataProcess.paginate=function(data,page){if(page===undefined||page===0||isNaN(page))return data;var page_items=[];var psize=Report.getPageSize();var start=(page-1)*psize;for(var i=start;i<psize*page;i++){if(data[i])page_items.push(data[i])}return page_items};DataProcess.convert=function(data,convert,metric_ids){if(convert==="aggregate"){data=DataProcess.aggregate(data,metric_ids)}else if(convert==="substract"){data=DataProcess.substract(data,metric_ids[0],metric_ids[1]);metric_ids=["substract"]}else if(convert==="substract-aggregate"){data=DataProcess.substract(data,metric_ids[0],metric_ids[1]);metric_ids=["substract"];data=DataProcess.aggregate(data,metric_ids)}else if(convert==="divide"){data=DataProcess.divide(data,metric_ids[0],metric_ids[1]);metric_ids=["divide"]}return data};DataProcess.sortGlobal=function(ds,metric_id,kind){if(metric_id===undefined)metric_id="scm_commits";var metric=[];var data=[],sorted={};sorted.name=[];sorted[metric_id]=[];var metrics_data=null;if(kind==="companies"){data=ds.getCompaniesData();metrics_data=ds.getCompaniesDataFull()}else if(kind==="repos"){data=ds.getReposData();metrics_data=ds.getReposDataFull()}else if(kind==="countries"){data=ds.getCountriesData()}else if(kind==="domains"){data=ds.getDomainsData();metrics_data=ds.getDomainsDataFull()}else if(kind==="projects"){data=ds.getProjectsData()}if(data===null)return[];if(metrics_data===null)return data;if(metrics_data instanceof Array||metric_id in metrics_data===false)return data;for(var i=0;i<metrics_data[metric_id].length;i++){var value=metrics_data[metric_id][i];if(value==="NA")value=0;metric.push([metrics_data.name[i],value])}metric.sort(function(a,b){return b[1]-a[1]});$.each(metric,function(id,value){sorted.name.push(value[0]);sorted[metric_id].push(value[1])});return sorted.name};DataProcess.orderItems=function(filter_order){$.each($("[class^='FilterItems']"),function(id,div){order_by=$(this).data("order-by");if(order_by!==undefined){ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;var filter=$(this).data("filter");if(filter===undefined)return;if(filter!==filter_order)return;Report.log("Ordering with "+order_by+" "+ds+" for "+filter);var data=DataProcess.sortGlobal(DS,order_by,filter);if(filter==="companies")DS.setCompaniesData(data);if(filter==="repos")DS.setReposData(data);if(filter==="countries")DS.setCountriesData(data);if(filter==="domains")DS.setDomainsData(data);return false}})};DataProcess.mergeConfig=function(config1,config2){var new_config={};$.each(config1,function(entry,value){new_config[entry]=value});$.each(config2,function(entry,value){new_config[entry]=value});return new_config};DataProcess.hideEmail=function(email){var clean=email;if(typeof email=="string"&&email.indexOf("@")>-1){clean=email.split("@")[0]}return clean};DataProcess.selectPersonName=function(person){var name="",cname,ctype;for(var i=0;i<person.identity.length;i++){cname=person.identity[i];ctype=person.type[i];if(ctype==="name"){if(cname.length>name.length)name=cname}}return name};DataProcess.selectPersonEmail=function(person){var email="",cemail,ctype;for(var i=0;i<person.identity.length;i++){cemail=person.identity[i];ctype=person.type[i];if(ctype==="email"){email=cemail}}return email};DataProcess.frameTime=function(history,metrics){var new_history={};var offset_start=-1;var offset_end=-1;var new_offset=0;if(metrics.length===0)return history;var total=history[metrics[0]].length;var i=0;$.each(metrics,function(id,metric){new_offset=0;for(i=0;i<history[metric].length;i++){if(history[metric][i]===0)new_offset++;else{if(offset_start===-1)offset_start=new_offset;if(new_offset<offset_start)offset_start=new_offset;break}}});$.each(metrics,function(id,metric){new_offset=0;for(i=history[metric].length-1;i>=0;i--){if(history[metric][i]===0)new_offset++;else{if(offset_end===-1)offset_end=new_offset;if(new_offset<offset_end)offset_end=new_offset;break}}});for(var key in history){new_history[key]=[];for(i=0;i<history[key].length;i++){if(i<offset_start)continue;if(i>=total-offset_end)continue;new_history[key].push(history[key][i])}}return new_history};DataProcess.filterDates=function(start_id,end_id,history){var history_dates={};$.each(history,function(name,data){history_dates[name]=[];$.each(data,function(i,value){var id=history.unixtime[i];if(id>start_id)if(!end_id||end_id&&id<=end_id)history_dates[name].push(value)})});return history_dates};DataProcess.filterYear=function(year,history){year=parseInt(year,null);var min_id=new Date(year.toString()).getTime();var max_id=new Date((year+1).toString()).getTime();var history_year=filterDates(min_id,max_id,history);return history_year};DataProcess.fillDates=function(dates_orig,more_dates){if(dates_orig[0].length===0)return more_dates;var new_dates=[[],[]];var i=0;if(dates_orig[0][0]>more_dates[0][0]){for(i=0;i<more_dates[0].length;i++){new_dates[0][i]=more_dates[0][i];new_dates[1][i]=more_dates[1][i]}}for(i=0;i<dates_orig[0].length;i++){pos=new_dates[0].indexOf(dates_orig[0][i]);if(pos===-1){new_dates[0].push(dates_orig[0][i]);new_dates[1].push(dates_orig[1][i])}}if(dates_orig[0][dates_orig[0].length-1]<more_dates[0][more_dates[0].length-1]){for(i=0;i<more_dates[0].length;i++){pos=new_dates[0].indexOf(more_dates[0][i]);if(pos===-1){new_dates[0].push(more_dates[0][i]);new_dates[1].push(more_dates[1][i])}}}return new_dates};DataProcess.fillHistory=function(hist_complete_id,hist_partial){var new_history=[[],[]];for(var i=0;i<hist_complete_id.length;i++){pos=hist_partial[0].indexOf(hist_complete_id[i]);new_history[0][i]=hist_complete_id[i];if(pos!=-1){new_history[1][i]=hist_partial[1][pos]}else{new_history[1][i]=0}}return new_history};DataProcess.fillHistoryLines=function(hist_complete_id,hist_partial){var old_history=[[],[]];var new_history=[[],[]];var lines_history=[];for(var i=0;i<hist_partial.length;i++){old_history[0].push(hist_partial[i][0]);old_history[1].push(hist_partial[i][1])}new_history=DataProcess.fillHistory(hist_complete_id,old_history);for(i=0;i<hist_complete_id.length;i++){lines_history.push([new_history[0][i],new_history[1][i]])}return lines_history};DataProcess.addRelativeValues=function(metrics_data,metric){if(metrics_data[metric]===undefined)return;metrics_data[metric+"_relative"]=[];var added_values=[];$.each(metrics_data[metric],function(index,pdata){var metric_values=pdata.data[1];for(var i=0;i<metric_values.length;i++){if(added_values[i]===undefined)added_values[i]=0;added_values[i]+=metric_values[i]}});$.each(metrics_data[metric],function(index,pdata){var val_relative=[];for(var i=0;i<pdata.data[0].length;i++){if(added_values[i]===0)val_relative[i]=0;else{var rel_val=pdata.data[1][i]/added_values[i]*100;val_relative[i]=rel_val}}metrics_data[metric+"_relative"].push({label:pdata.label,data:[pdata.data[0],val_relative]})})};DataProcess.aggregate=function(data,metrics){var new_data={};if(!(metrics instanceof Array))metrics=[metrics];$.each(data,function(metric,mdata){if($.inArray(metric,metrics)>-1){var metric_agg=[];metric_agg[0]=data[metric][0];for(var i=1;i<data[metric].length;i++){metric_agg[i]=metric_agg[i-1]+data[metric][i]}new_data[metric]=metric_agg}else{new_data[metric]=data[metric]}});return new_data};DataProcess.substract=function(data,metric1,metric2){var new_data={};var substract=[];for(var i=0;i<data[metric1].length;i++){substract[i]=data[metric1][i]-data[metric2][i]}$.each(data,function(metric,mdata){new_data[metric]=data[metric]});new_data.substract=substract;return new_data};DataProcess.divide=function(data,metric1,metric2){var new_data={};var divide=[];for(var i=0;i<data[metric1].length;i++){if(data[metric1][i]===0||data[metric2][i]===0)divide[i]=0;else divide[i]=parseInt(data[metric1][i]/data[metric2][i],null)}$.each(data,function(metric,mdata){new_data[metric]=data[metric]});new_data.divide=divide;return new_data};DataProcess.revomeLastPoint=function(data){var new_data={};$.each(data,function(key,value){new_data[key]=[];for(var i=0;i<data[key].length-1;i++){new_data[key].push(data[key][i])}});return new_data}})();var Convert={};(function(){Convert.convertMicrodashText=function(){var divs=$(".MicrodashText");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var metric=$(this).data("metric");var show_name=$(this).data("name");var ds=Report.getMetricDS(metric)[0];if(ds===undefined)return;var total=ds.getGlobalData()[metric];var html='<div class="row">';if(show_name){html+='<div class="col-md-3">';html+='<span class="dayschange">'+ds.basic_metrics[metric].name+"</span>";html+="</div>"}$.each([365,30,7],function(index,period){var column=ds.getMetrics()[metric].column;var value=ds.getGlobalData()[metric+"_"+period];var netvalue=ds.getGlobalData()["diff_net"+column+"_"+period];var percentagevalue=ds.getGlobalData()["percentage_"+column+"_"+period];percentagevalue=Math.round(percentagevalue*10)/10;if(value===undefined)return;var str_percentagevalue="";if(percentagevalue===0){str_percentagevalue=Math.abs(percentagevalue)}else if(netvalue>0){str_percentagevalue="+"+percentagevalue}else if(netvalue<0){str_percentagevalue="-"+Math.abs(percentagevalue)}if(show_name){html+='<div class="col-md-3">'}else{html+='<div class="col-md-4">'}html+='<span class="dayschange">Last '+period+" days:</span>";html+=" "+Report.formatValue(value)+"<br>";if(percentagevalue===0){html+='<i class="fa fa-arrow-circle-right"></i> <span class="zeropercent">&nbsp;'+str_percentagevalue+"%</span>&nbsp;"}else if(netvalue>0){html+='<i class="fa fa-arrow-circle-up"></i> <span class="pospercent">&nbsp;'+str_percentagevalue+"%</span>&nbsp;"}else if(netvalue<0){html+='<i class="fa fa-arrow-circle-down"></i> <span class="negpercent">&nbsp;'+str_percentagevalue+"%</span>&nbsp;"}html+="</div><!--col-md-4-->"});html+="</div><!--row-->";$(div).append(html)})}};Convert.convertMicrodash=function(){var divs=$(".Microdash");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var metric=$(this).data("metric");var text=$(this).data("text");var ds=Report.getMetricDS(metric)[0];var total=ds.getGlobalData()[metric];var html="<div>";html+='<div style="float:left">';html+='<span class="medium-fp-number">'+Report.formatValue(total);html+="</span> "+ds.getMetrics()[metric].name;html+="</div>";html+='<div id="Microdash" '+'class="MetricsEvol" data-data-source="'+ds.getName()+'" data-metrics="'+metric+'" data-min=true style="margin-left:10px; float:left;width:100px; height:25px;"></div>';html+='<div style="clear:both"></div><div>';$.each([365,30,7],function(index,period){var column=ds.getMetrics()[metric].column;var netvalue=ds.getGlobalData()["diff_net"+column+"_"+period];var percentagevalue=ds.getGlobalData()["percentage_"+column+"_"+period];var value=ds.getGlobalData()[metric+"_"+period];if(value===undefined)return;html+="<span class='dayschange'>"+period+" Days Change</span>:"+Report.formatValue(value)+"&nbsp;";if(netvalue===0){html+=""}else if(netvalue>0){html+='<i class="icon-circle-arrow-up"></i>';html+="<small>(+"+percentagevalue+"%)</small>&nbsp;"}else if(netvalue<0){html+='<i class="icon-circle-arrow-down"></i>';html+="<small>(-"+Math.abs(percentagevalue)+"%)</small>&nbsp;"}});html+="</div>";html+="<div>";$(div).append(html)})}};function getProjectTitle(project_id,hierarchy){if(hierarchy.hasOwnProperty(project_id)&&hierarchy[project_id].title){return hierarchy[project_id].title}else{return undefined}}function compareProjectTitles(a,b){if(a.project_id<b.project_id){return-1}else if(a.project_id>b.project_id){return 1}else{return 0}}function getParentProjects(project_id,hierarchy){var parent=[];var iterate_p=project_id;var parent_id="";var aux={};while(hierarchy[iterate_p].hasOwnProperty("parent_project")){parent_id=hierarchy[iterate_p].parent_project;aux=hierarchy[parent_id];aux.project_id=parent_id;parent.push(aux);iterate_p=parent_id}return parent.reverse()}function getChildrenProjects(project_id,hierarchy){var children=[];var aux={};$.each(hierarchy,function(id,p){if(hierarchy[id].parent_project===project_id){aux=hierarchy[id];aux.project_id=id;children.push(aux)}});children.sort(compareProjectTitles);return children}function composePBreadcrumbsHTMLlast(project_id,children,hierarchy){var html="";var clen=children.length;if(clen>0){html+='<li class="dropdown">';html+='<span data-toggle="tooltip" title="Project name"> '+getProjectTitle(project_id,hierarchy)+"</span>";html+='&nbsp;<a class="dropdown-toggle" data-toggle="dropdown" href="#">';html+='<span data-toggle="tooltip" title="Select subproject" class="badge"> '+clen+" Subprojects </span></a>";html+='<ul class="dropdown-menu scrollable-menu">';$.each(children,function(id,value){gchildren=getChildrenProjects(value.project_id,hierarchy);if(gchildren.length>0){html+='<li><a href="project.html?project='+value.project_id+'">'+value.title+'&nbsp;&nbsp;<span data-toggle="tooltip" title="Number of suprojects" class="badge">'+gchildren.length+'&nbsp;<i class="fa fa-rocket"></i></span></a></li>'}else{html+='<li><a href="project.html?project='+value.project_id+'">'+value.title+"</a></li>"}});html+='<li class="divider"></li>';html+='<li><a href="./project_map.html"><i class="fa fa-icon fa-sitemap"></i> Projects treemap</a></li>';html+="</ul></li>"}else{html+="<li>"+getProjectTitle(project_id,hierarchy)+"</li>"}return html}function composeProjectBreadcrumbs(project_id){var html='<ol class="breadcrumbtitle">';var hierarchy=Report.getProjectsHierarchy();if(hierarchy.length===0){return""}if(project_id===undefined){project_id="root"}var children=getChildrenProjects(project_id,hierarchy);var parents=getParentProjects(project_id,hierarchy);if(parents.length>0){$.each(parents,function(id,value){if(value.parent_project){html+='<li><a href="project.html?project='+value.project_id+'">'+value.title+"</a></li>"}else{html+='<li><a href="./">'+value.title+"</a></li>"}})}html+=composePBreadcrumbsHTMLlast(project_id,children,hierarchy);html+="</ol>";return html}function escapeString(string){var aux="";aux=string.replace(" ","_");aux=aux.toLowerCase();return aux}function composeHTMLNestedProjects(project_id,children,hierarchy){var html="";var clen=children.length;var epid=escapeString(project_id);if(clen>0){html+="<li>";html+='<a href="project.html?project='+epid+'">'+getProjectTitle(project_id,hierarchy)+"</a>";html+='&nbsp;<a data-toggle="collapse" data-parent="#accordion" href="#collapse'+epid+'"><span class="badge">'+clen+'&nbsp;subprojects</span></a><div id="collapse'+epid+'" class="panel-collapse collapse"><ul>';$.each(children,function(id,value){gchildren=getChildrenProjects(value.project_id,hierarchy);html+=composeHTMLNestedProjects(value.project_id,gchildren,hierarchy)});html+="</ul></li>"}else{html+='<li><a href="project.html?project='+project_id+'">'+getProjectTitle(project_id,hierarchy)+"</a></li>"}return html}function composeProjectMap(){var html="<ul>";var hierarchy=Report.getProjectsHierarchy();if(hierarchy.length===0){return""}project_id="root";var children=getChildrenProjects(project_id,hierarchy);var parents=getParentProjects(project_id,hierarchy);$.each(children,function(id,value){grandchildren=getChildrenProjects(value.project_id,hierarchy);html+=composeHTMLNestedProjects(value.project_id,grandchildren,hierarchy)});html+="</ul>";return html}function getSectionName(){var result=[];var sections={mls:"MLS overview",irc:"IRC overview",its:"ITS overview",qaforums:"QA Forums overview",scr:"Code Review overview",scm:"SCM overview",wiki:"Wiki overview",people:"Contributor",company:"Company",country:"Country",repository:"Repository",data_sources:"Data sources",project_map:"Project map"};var filters={companies:"Activity by companies",contributors:"Activity by contributors",countries:"Activity by companies",domains:"Activity by domains",projects:"Activity by project",repos:"Activity by repositories",states:"Activity by states",tags:"Activity by tags"};var url_tokens=document.URL.split("/");var section=url_tokens[url_tokens.length-1].split(".")[0];if(section==="project"||section==="index"||section===""){return[]}else{var s_tokens=section.split("-");if(sections.hasOwnProperty(s_tokens[0])){result.push([s_tokens[0],sections[s_tokens[0]]]);if(s_tokens.length>0){if(filters.hasOwnProperty(s_tokens[1])){result.push([s_tokens[0],filters[s_tokens[1]]])}}}else{return[["#","Unavailable section name"]]}return result}}function composeSBSectionLinks(icon_text,title,ds_name,elements){text={companies:"Companies","companies-summary":"Companies summary",contributors:"Contributors",countries:"Countries",domains:"Domains",projects:"Projects",repos:"Repositories",tags:"Tags",states:"States"};html="";html+='<li class="dropdown">';html+='<a href="#" class="dropdown-toggle" data-toggle="dropdown">';html+='<i class="fa '+icon_text+'"></i>&nbsp;'+title+' <b class="caret"></b></a>';html+='<ul class="dropdown-menu navmenu-nav">';html+='<li><a href="'+ds_name+'.html">&nbsp;Overview</a></li>';$.each(elements,function(id,value){if(text.hasOwnProperty(value)){var label=text[value];if(value==="repos"){var DS=Report.getDataSourceByName(ds_name);label=DS.getLabelForRepositories();label=label.charAt(0).toUpperCase()+label.slice(1)}html+='<li><a href="'+ds_name+"-"+value+'.html">&nbsp;'+label+"</a></li>"}else{html+='<li><a href="'+ds_name+"-"+value+'.html">&nbsp;'+value+"</a></li>"}});html+="</ul></li>";return html}function composeSideBar(project_id){if(project_id===undefined){project_id="root"}var html="";var html_extra="";html+='<ul class="nav navmenu-nav">';var mele=Report.getMenuElements();html+='<li><a href="./"><i class="fa fa-home"></i> Home</a></li>';if(project_id==="root"){if(mele.hasOwnProperty("scm")){aux=mele.scm;aux_html=composeSBSectionLinks("fa-code","Source code management","scm",aux);html+=aux_html}if(mele.hasOwnProperty("scr")){aux=mele.scr;aux_html=composeSBSectionLinks("fa-check","Code review","scr",aux);html+=aux_html}if(mele.hasOwnProperty("its")){aux=mele.its;aux_html=composeSBSectionLinks("fa-ticket","Tickets","its",aux);html+=aux_html}if(mele.hasOwnProperty("mls")){aux=mele.mls;aux_html=composeSBSectionLinks("fa-envelope-o","Mailing lists","mls",aux);html+=aux_html}if(mele.hasOwnProperty("qaforums")){aux=mele.qaforums;aux_html=composeSBSectionLinks("fa-question","Q&A Forums","qaforums",aux);html+=aux_html}if(mele.hasOwnProperty("irc")){aux=mele.irc;aux_html=composeSBSectionLinks("fa-comment-o","IRC","irc",aux);html+=aux_html}if(mele.hasOwnProperty("downloads")){aux=mele.downloads;aux_html=composeSBSectionLinks("fa-download","Downloads","downloads",aux);html+=aux_html}if(mele.hasOwnProperty("wiki")){aux=mele.wiki;aux_html=composeSBSectionLinks("fa-pencil-square-o","Wiki","wiki",aux);html+=aux_html}if(mele.hasOwnProperty("studies")){aux=mele.studies;html+='<li class="dropdown">';html+='<a href="#" class="dropdown-toggle" data-toggle="dropdown">';html+='<i class="fa fa-lightbulb-o"></i>&nbsp;Studies <b class="caret"></b></a>';html+='<ul class="dropdown-menu navmenu-nav">';if(aux.indexOf("demographics")>=0){html+='<li><a href="demographics.html">&nbsp;Demographics</a></li>'}html+="</ul></li>"}}html+='<li><a href="data_sources.html"><i class="fa fa-database"></i> Data sources</a></li>';html+='<li><a href="project_map.html"><i class="fa fa-icon fa-sitemap"></i> Project map</a></li>';if(mele.hasOwnProperty("extra")){aux=mele.extra;html_extra+='<li class="sidemenu-divider"></li>';html_extra+='<li class="sidemenu-smallheader">More links:</li>';$.each(aux,function(id,value){html_extra+='<li><a href="'+value[1]+'">&nbsp;'+value[0]+"</a></li>"})}html+=html_extra;html+="</ul>";return html}Convert.convertSideBar=function(project_id){var divs=$(".SideNavBar");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();if(!div.id)div.id="SideNavBar";var label;if(project_id){label=Report.cleanLabel(project_id)}var htmlaux=composeSideBar(label);$("#"+div.id).append(htmlaux);data=Report.getProjectData();$(".report_name").text(data.project_name)})}};Convert.convertProjectNavBar=function(project_id){var divs=$(".ProjectNavBar");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();if(!div.id)div.id="ProjectNavBar";var label;if(project_id){label=Report.cleanLabel(project_id)}var htmlaux=composeProjectBreadcrumbs(label);$("#"+div.id).append(htmlaux)})}};Convert.convertNavbar=function(){$.get(Report.getHtmlDir()+"navbar.html",function(navigation){$("#Navbar").html(navigation);var project_id=Report.getParameterByName("project");Convert.convertProjectNavBar(project_id);Convert.convertSideBar(project_id)})};function composeSectionBreadCrumb(project_id){var html='<ol class="breadcrumb">';if(project_id===undefined){var subsects=getSectionName();if(subsects.length>0){html+='<li><a href="./">Project Overview</a></li>';var cont=1;$.each(subsects,function(id,value){if(subsects.length===cont){html+='<li class="active">'+value[1]+"</li>"}else{html+='<li><a href="'+value[0]+'.html">'+value[1]+"</a></li>"}cont+=1})}else{html+='<li class="active">Project Overview</li>'}}else{html+="<li> "+getSectionName()+"</li>"}html+="</ol>";return html}Convert.convertSectionBreadcrumb=function(project_id){var divs=$(".SectionBreadcrumb");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();if(!div.id)div.id="SectionBreadcrumb";var label;if(project_id){label=Report.cleanLabel(project_id)}var htmlaux=composeSectionBreadCrumb(label);$("#"+div.id).append(htmlaux)})}};Convert.convertProjectMap=function(){var divs=$(".ProjectMap");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();if(!div.id)div.id="ProjectMap";var label;var htmlaux=composeProjectMap();$("#"+div.id).append(htmlaux)})}};Convert.convertFooter=function(){$.get(Report.getHtmlDir()+"footer.html",function(footer){$("#Footer").html(footer);$("#vizjs-lib-version").append(vizjslib_git_tag)})};Convert.convertSummary=function(){div_param="Summary";var divs=$("."+div_param);if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var ds=$(this).data("data-source");var DS=Report.getDataSourceByName(ds);if(DS===null)return;div.id=ds+"-Summary";DS.displayGlobalSummary(div.id)})}};function composeDropDownRepo(DS){var repository=Report.getParameterByName("repository");if(repository&&$.inArray(repository,DS.getReposData())<0)return"";var dsname=DS.getName();var section="";var label_repo=DS.getLabelForRepository();var label_repo_plural=DS.getLabelForRepositories();if(repository!==undefined){section=repository}else{section="All "+label_repo_plural}html='<div class="row"><span class="col-md-12">';html='<ol class="filterbar"><li>Filtered by '+label_repo+":&nbsp;&nbsp;</li>";html+='<li><div class="dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"> '+section+' <span class="caret"></span></button>';html+='<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">';if(repository){html+='<li role="presentation"><a role="menuitem" tabindex="-1" href="'+dsname+'-contributors.html">';html+="All "+label_repo_plural;html+="</a></li>"}$.each(DS.getReposData(),function(id,value){if(value===repository)return;html+='<li role="presentation"><a role="menuitem" tabindex="-1" href="?repository=';html+=value;html+='">';html+=value;html+="</a></li>"});html+="</ul></div></li></ol>";html+="</span></div>";return html}Convert.convertRepositorySelector=function(){var divs=$(".repository-selector");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var ds=$(this).data("data-source");var DS=Report.getDataSourceByName(ds);if(DS===null)return;div.id=ds+"-repository-selector";var htmlaux=composeDropDownRepo(DS);$("#"+div.id).append(htmlaux)})}};function displayReportData(){data=Report.getProjectData();document.title=data.project_name+" Report by Bitergia";if(data.title)document.title=data.title;$(".report_date").text(data.date);$(".report_name").text(data.project_name);str=data.blog_url;if(str&&str.length>0){$("#blogEntry").html("<br><a href='"+str+"'>Blog post with some more details</a>");$(".blog_url").attr("href",data.blog_url)}else{$("#more_info").hide()}str=data.producer;if(str&&str.length>0){$("#producer").html(str)}else{$("#producer").html("<a href='http://bitergia.com'>Bitergia</a>")}$(".project_name").text(data.project_name);$("#project_url").attr("href",data.project_url)}Convert.convertRefcard=function(){$.when($.get(Report.getHtmlDir()+"refcard.html"),$.get(Report.getHtmlDir()+"project-card.html")).done(function(res1,res2){refcard=res1[0];projcard=res2[0];$("#Refcard").html(refcard);displayReportData();$.each(Report.getProjectsData(),function(prj_name,prj_data){var new_div="card-"+prj_name.replace(".","").replace(" ","");$("#Refcard #projects_info").append(projcard);$("#Refcard #projects_info #new_card").attr("id",new_div);$.each(Report.getDataSources(),function(i,DS){if(DS.getProject()!==prj_name){$("#"+new_div+" ."+DS.getName()+"-info").hide();return}DS.displayData(new_div)});$("#"+new_div+" #project_name").text(prj_name);if(Report.getProjectsDirs.length>1)$("#"+new_div+" .project_info").append(' <a href="VizGrimoireJS/browser/index.html?data_dir=../../'+prj_data.dir+'">Report</a>');$("#"+new_div+" #project_url").attr("href",prj_data.url)})})};Convert.convertGlobalData=function(){var divs=$(".GlobalData");if(divs.length>0){$.each(divs,function(id,div){ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;var data=DS.getGlobalData();var key=$(this).data("field");$(this).text(Report.formatValue(data[key],key))})}};Convert.convertProjectData=function(){var divs=$(".ProjectData");var p=Report.getParameterByName("project");if(divs.length>0){$.each(divs,function(id,div){ds=$(this).data("data-source");
DS=Report.getDataSourceByName(ds);if(DS===null)return;var data=DS.getProjectsGlobalData()[p];var key=$(this).data("field");$(this).text(Report.formatValue(data[key],key))})}};Convert.convertRadarActivity=function(){var div_param="RadarActivity";var divs=$("#"+div_param);if(divs.length>0){$.each(divs,function(id,div){$(this).empty()});Viz.displayRadarActivity(div_param)}};Convert.convertRadarCommunity=function(){var div_param="RadarCommunity";var divs=$("#"+div_param);if(divs.length>0){$.each(divs,function(id,div){$(this).empty()});Viz.displayRadarCommunity("RadarCommunity")}};Convert.convertTreemap=function(){var div_param="Treemap";var divs=$("#"+div_param);if(divs.length>0){$.each(divs,function(id,div){$(this).empty()});var file=$("#Treemap").data("file");$("#Treemap").empty();Viz.displayTreeMap("Treemap",file)}};Convert.convertBubbles=function(){div_param="Bubbles";var divs=$("."+div_param);if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var ds=$(this).data("data-source");var DS=Report.getDataSourceByName(ds);if(DS===null)return;if(DS.getData().length===0)return;var radius=$(this).data("radius");div.id=ds+"-Bubbles";DS.displayBubbles(div.id,radius)})}};function loadHTMLEvolParameters(htmldiv,config_viz){config_viz.help=true;var help=$(htmldiv).data("help");if(help!==undefined)config_viz.help=help;config_viz.show_legend=false;if($(htmldiv).data("frame-time"))config_viz.frame_time=true;config_viz.graph=$(htmldiv).data("graph");if($(htmldiv).data("min")){config_viz.show_legend=false;config_viz.show_labels=true;config_viz.show_grid=true;config_viz.help=false}if($(htmldiv).data("legend"))config_viz.show_legend=true;config_viz.ligth_style=false;if($(htmldiv).data("light-style")){config_viz.light_style=true}if($(htmldiv).data("custom-title")){config_viz.custom_title=$(htmldiv).data("custom-title")}if(config_viz.help&&$(htmldiv).data("custom-help")){config_viz.custom_help=$(htmldiv).data("custom-help")}else{config_viz.custom_help=""}var start=$(htmldiv).data("start");if(start)config_viz.start_time=start;var end=$(htmldiv).data("end");if(end)config_viz.end_time=end;var remove_last_point=$(htmldiv).data("remove-last-point");if(remove_last_point)config_viz.remove_last_point=true;return config_viz}Convert.convertMetricsEvol=function(){var config_metric={};config_metric.show_desc=false;config_metric.show_title=true;config_metric.show_labels=true;var config=Report.getVizConfig();if(config){$.each(config,function(key,value){config_metric[key]=value})}var div_param="MetricsEvol";var divs=$("."+div_param);if(divs.length>0){$.each(divs,function(id,div){var config_viz={};$.each(config_metric,function(key,value){config_viz[key]=value});$(this).empty();var metrics=$(this).data("metrics");var ds=$(this).data("data-source");var DS=Report.getDataSourceByName(ds);if(DS===null)return;config_viz=loadHTMLEvolParameters(div,config_viz);div.id=metrics.replace(/,/g,"-")+"-"+ds+"-metrics-evol-"+this.id;div.id=div.id.replace(/\n|\s/g,"");DS.displayMetricsEvol(metrics.split(","),div.id,config_viz,$(this).data("convert"))})}};Convert.convertMetricsEvolSelector=function(){var config_metric={};config_metric.show_desc=false;config_metric.show_title=true;config_metric.show_labels=true;var config=Report.getVizConfig();if(config){$.each(config,function(key,value){config_metric[key]=value})}var div_param="MetricsEvol";var divs=$("."+div_param);if(divs.length>0){$.each(divs,function(id,div){var config_viz={};$.each(config_metric,function(key,value){config_viz[key]=value});$(this).empty();var metrics=$(this).data("metrics");var ds=$(this).data("data-source");var DS=Report.getDataSourceByName(ds);if(DS===null)return;var repository=Report.getParameterByName("repository");config_viz=loadHTMLEvolParameters(div,config_viz);div.id=metrics.replace(/,/g,"-")+"-"+ds+"-metrics-evol-"+this.id;div.id=div.id.replace(/\n|\s/g,"");DS.displayMetricsEvol(metrics.split(","),div.id,config_viz,$(this).data("convert"),repository)})}};Convert.convertMetricsEvolSet=function(){div_param="MetricsEvolSet";var divs=$("."+div_param);if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var all=$(this).data("all");var relative=$(this).data("relative");var summary_graph=$(this).data("summary-graph");var legend=$(this).data("legend-show");div.id=ds+"-MetricsEvolSet-"+this.id;if(all===true){div.id=ds+"-All";Viz.displayEnvisionAll(div.id,relative,legend,summary_graph);return false}var ds=$(this).data("data-source");var DS=Report.getDataSourceByName(ds);if(DS===null)return;DS.displayEnvision(div.id,relative,legend,summary_graph)})}};Convert.convertTimeTo=function(){var div_tt="TimeTo";divs=$("."+div_tt);if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var ds=$(this).data("data-source");var DS=Report.getDataSourceByName(ds);if(DS===null)return;var quantil=$(this).data("quantil");var type=$(this).data("type");div.id=ds+"-time-to-"+type+"-"+quantil;if(type==="fix")DS.displayTimeToFix(div.id,quantil);if(type==="attention")DS.displayTimeToAttention(div.id,quantil)})}};Convert.convertMarkovTable=function(){var div_id_mt="MarkovTable";var divs=$("."+div_id_mt);var DS,ds;if(divs.length>0){$.each(divs,function(id,div){$(this).empty();ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(DS.getData().length===0)return;var title=$(this).data("title");div.id=ds+"-markov-table";DS.displayMarkovTable(div.id,title)})}};Convert.convertLastActivity=function(){var all_metrics=Report.getAllMetrics();function activityInfo(div,period,label){var html="<h4>Last "+label+"</h4>";$.each(Report.getDataSources(),function(index,DS){var data=DS.getGlobalData();$.each(data,function(key,val){var suffix="_"+period;if(key.indexOf(suffix,key.length-suffix.length)!==-1){var metric=key.substring(0,key.length-suffix.length);label=metric;if(all_metrics[metric])label=all_metrics[metric].name;html+=label+":"+data[key]+"<br>"}})});$(div).append(html)}var divs=$(".LastActivity");var period=null;var days={Week:7,Month:30,Quarter:90,Year:365};if(divs.length>0)$.each(divs,function(id,div){period=$(div).data("period");activityInfo(div,days[period],period)})};Convert.convertTop=function(){var div_id_top="Top";var divs=$("."+div_id_top);var DS,ds;if(divs.length>0){var unique=0;$.each(divs,function(id,div){$(this).empty();ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(DS.getData().length===0)return;var show_all=false;if($(this).data("show_all"))show_all=true;var top_metric=$(this).data("metric");var limit=$(this).data("limit");var graph=$(this).data("graph");var people_links=$(this).data("people_links");var threads_links=$(this).data("threads_links");var period=$(this).data("period");var period_all=$(this).data("period_all");var repository=Report.getParameterByName("repository");div.id=ds+"-"+div_id_top+unique++;if(graph){div.id+="-"+graph}if(period===undefined&&period_all===undefined){period_all=true}if(limit===undefined){limit=10}DS.displayTop(div.id,show_all,top_metric,period,period_all,graph,limit,people_links,threads_links,repository)})}};Convert.convertPersonMetrics=function(upeople_id,upeople_identifier){var config_metric={};config_metric.show_desc=false;config_metric.show_title=false;config_metric.show_labels=true;divs=$(".PersonMetrics");if(divs.length){$.each(divs,function(id,div){$(this).empty();ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;var metrics=$(this).data("metrics");config_metric.show_legend=false;if($(this).data("legend"))config_metric.show_legend=true;if($(this).data("person_id"))upeople_id=$(this).data("person_id");if($(this).data("person_name"))upeople_identifier=$(this).data("person_name");div.id=metrics.replace(/,/g,"-")+"-people-metrics";DS.displayMetricsPeople(upeople_id,upeople_identifier,metrics.split(","),div.id,config_metric)})}};function getRandomId(){return Math.floor(Math.random()*1e3+1)}Convert.convertPersonData=function(upeople_id,upeople_identifier){var divs=$(".PersonData"),name,email;if(divs.length>0){$.each(divs,function(id,div){$(this).empty();if($(this).data("person_id"))upeople_id=$(this).data("person_id");if(!div.id)div.id="PersonData"+"-"+upeople_id+"-"+getRandomId();var data=Report.getPeopleIdentities()[upeople_id];if(data){name=DataProcess.selectPersonName(data);email=DataProcess.selectPersonEmail(data);email="("+DataProcess.hideEmail(email)+")"}else{if(upeople_identifier!==undefined)name=upeople_identifier;else name=upeople_id;email=""}$("#"+div.id).append("<h2>"+name+" "+email+"</h2>")})}};Convert.convertPersonSummary=function(upeople_id,upeople_identifier){var divs=$(".PersonSummary");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if($(this).data("person_id"))upeople_id=$(this).data("person_id");if($(this).data("person_name"))upeople_identifier=$(this).data("person_name");div.id=ds+"-refcard-people";DS.displayPeopleSummary(div.id,upeople_id,upeople_identifier,DS)})}};Convert.convertPeople=function(upeople_id,upeople_identifier){if(upeople_id===undefined)upeople_id=Report.getParameterByName("id");if(upeople_identifier===undefined)upeople_identifier=Report.getParameterByName("name");if(upeople_id===undefined)return;if(Loader.check_people_item(upeople_id)===false){$.each(Report.getDataSources(),function(index,DS){Loader.data_load_people_item(upeople_id,DS,Convert.convertPeople)});return}Convert.convertPersonData(upeople_id,upeople_identifier);Convert.convertPersonSummary(upeople_id,upeople_identifier);Convert.convertPersonMetrics(upeople_id,upeople_identifier);Convert.activateHelp()};Convert.convertDemographics=function(){var divs=$(".Demographics");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;var period=$(this).data("period");div.id="Demographics"+"-"+ds+"-"+"-"+period;DS.displayDemographics(div.id,period)})}};function filterItemsConfig(){var config_metric={};config_metric.show_desc=false;config_metric.show_title=false;config_metric.show_labels=true;config_metric.show_legend=false;return config_metric}Convert.getRealItem=function(ds,filter,item){var map=Report.getReposMap();if(map===undefined||map.length===0){if($.inArray(item,ds.getReposData())>-1)return item;else return null}var map_item=null;if(filter==="repos"){var rdata=ds.getReposMetricsData()[item];if(rdata===undefined){$.each(map,function(id,repos){$.each(Report.getDataSources(),function(index,DS){if(repos[DS.getName()]===item){map_item=repos[ds.getName()];return false}});if(map_item!==null)return false})}else map_item=item}else map_item=item;return map_item};Convert.convertFilterItemsSummary=function(filter){var divlabel="FilterItemsSummary";divs=$("."+divlabel);if(divs.length>0){$.each(divs,function(id,div){ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;div.id=ds+"-"+divlabel;$(this).empty();if(filter==="repos")DS.displayReposSummary(div.id,DS);if(filter==="countries")DS.displayCountriesSummary(div.id,DS);if(filter==="companies")DS.displayCompaniesSummary(div.id,DS);if(filter==="domains")DS.displayDomainsSummary(div.id,DS);if(filter==="projects")DS.displayProjectsSummary(div.id,DS)})}};Convert.convertFilterItemsGlobal=function(filter){var config_metric=filterItemsConfig();var divlabel="FilterItemsGlobal";divs=$("."+divlabel);if(divs.length>0){$.each(divs,function(id,div){ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;var metric=$(this).data("metric");var show_others=$(this).data("show-others");var order_by=$(this).data("order-by");config_metric.show_legend=$(this).data("legend");if($("#"+$(this).data("legend-div")).length>0){config_metric.legend={container:$(this).data("legend-div")}}else config_metric.legend={container:null};config_metric.graph=$(this).data("graph");div.id=metric+"-"+divlabel;$(this).empty();if(filter==="repos")DS.displayMetricReposStatic(metric,div.id,config_metric,order_by,show_others);if(filter==="countries")DS.displayMetricCountriesStatic(metric,div.id,config_metric,order_by,show_others);if(filter==="companies")DS.displayMetricCompaniesStatic(metric,div.id,config_metric,order_by,show_others);if(filter==="domains")DS.displayMetricDomainsStatic(metric,div.id,config_metric,order_by,show_others);if(filter==="projects")DS.displayMetricProjectsStatic(metric,div.id,config_metric,order_by,show_others)})}};Convert.convertFilterItemsNav=function(filter,page){var divlabel="FilterItemsNav";divs=$("."+divlabel);if(divs.length>0){$.each(divs,function(id,div){ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;if($(this).data("page"))page=$(this).data("page");order_by=$(this).data("order-by");div.id=ds+"-"+divlabel;$(this).empty();if(filter==="repos")DS.displayItemsNav(div.id,filter,page,order_by);else if(filter==="countries")DS.displayItemsNav(div.id,filter,page);else if(filter==="companies")DS.displayItemsNav(div.id,filter,page);else if(filter==="domains")DS.displayItemsNav(div.id,filter,page);else if(filter==="projects")DS.displayItemsNav(div.id,filter,page)})}};Convert.convertFilterItemsMetricsEvol=function(filter){var config_metric=filterItemsConfig();var divlabel="FilterItemsMetricsEvol";divs=$("."+divlabel);if(divs.length>0){$.each(divs,function(id,div){ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;var metric=$(this).data("metric");var stacked=false;if($(this).data("stacked"))stacked=true;if($(this).data("min")){config_viz.show_legend=false;config_viz.show_labels=true;config_viz.show_grid=true;config_viz.help=false}var start=$(this).data("start");var end=$(this).data("end");config_metric.lines={stacked:stacked};if($("#"+$(this).data("legend-div")).length>0){config_metric.legend={container:$(this).data("legend-div")}}else config_metric.legend={container:null};config_metric.show_legend=$(this).data("legend");config_metric.mouse_tracker=$(this).data("mouse_tracker");var remove_last_point=$(this).data("remove-last-point");if(remove_last_point)config_metric.remove_last_point=true;div.id=metric+"-"+divlabel;$(this).empty();if(filter==="companies")DS.displayMetricCompanies(metric,div.id,config_metric,start,end);else if(filter==="repos")DS.displayMetricRepos(metric,div.id,config_metric,start,end);else if(filter==="domains")DS.displayMetricDomains(metric,div.id,config_metric,start,end);else if(filter==="projects")DS.displayMetricProjects(metric,div.id,config_metric,start,end)})}};Convert.convertFilterItemsMiniCharts=function(filter,page){var config_metric=filterItemsConfig();var divlabel="FilterItemsMiniCharts";divs=$("."+divlabel);if(divs.length>0){$.each(divs,function(id,div){ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;if($(this).data("page"))page=$(this).data("page");var metrics=$(this).data("metrics");var order_by=$(this).data("order-by");var show_links=true;if($(this).data("show_links")!==undefined)show_links=$(this).data("show_links");var start=$(this).data("start");var end=$(this).data("end");var convert=$(this).data("convert");var remove_last_point=$(this).data("remove-last-point");if(remove_last_point)config_metric.remove_last_point=true;div.id=metrics.replace(/,/g,"-")+"-"+filter+"-"+divlabel;$(this).empty();if(filter==="repos")DS.displayReposList(metrics.split(","),div.id,config_metric,order_by,page,show_links,start,end,convert);else if(filter==="countries")DS.displayCountriesList(metrics.split(","),div.id,config_metric,order_by,page,show_links,start,end,convert);else if(filter==="companies")DS.displayCompaniesList(metrics.split(","),div.id,config_metric,order_by,page,show_links,start,end,convert);else if(filter==="domains")DS.displayDomainsList(metrics.split(","),div.id,config_metric,order_by,page,show_links,start,end,convert);else if(filter==="projects")DS.displayProjectsList(metrics.split(","),div.id,config_metric,order_by,page,show_links,start,end,convert)})}};Convert.convertFilterItemData=function(filter,item){var divs=$(".FilterItemData");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var label=Report.cleanLabel(item);if(!div.id)div.id="FilterItemData"+getRandomId();$("#"+div.id).append("<h2>"+label+"</h2>")})}};Convert.convertFilterItemSummary=function(filter,item){var divlabel="FilterItemSummary";divs=$("."+divlabel);if(item!==null&&divs.length>0){$.each(divs,function(id,div){var real_item=item;ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;if($(this).data("item"))real_item=$(this).data("item");div.id=ds+"-"+filter+"-"+divlabel;$(this).empty();if(filter==="repos"){real_item=Convert.getRealItem(DS,filter,real_item);if(real_item)DS.displayRepoSummary(div.id,real_item,DS)}else if(filter==="countries")DS.displayCountrySummary(div.id,real_item,DS);else if(filter==="companies")DS.displayCompanySummary(div.id,real_item,DS);else if(filter==="domains")DS.displayDomainSummary(div.id,real_item,DS);else if(filter==="projects")DS.displayProjectSummary(div.id,real_item,DS)})}};Convert.convertFilterItemMicrodashText=function(filter,item){var divs=$(".FilterItemMicrodashText");if(divs.length>0){$.each(divs,function(id,div){$(this).empty();var real_item=item;var metric=$(this).data("metric");var show_name=$(this).data("name");var ds=Report.getMetricDS(metric)[0];if(ds===undefined)return;if(filter==="projects")var global_data=ds.getProjectsGlobalData()[item];else return;var html='<div class="row">';if(show_name){html+='<div class="col-md-3">';html+='<span class="dayschange">'+ds.basic_metrics[metric].name+"</span>";html+="</div>"}$.each([365,30,7],function(index,period){var column=ds.getMetrics()[metric].column;var value=global_data[metric+"_"+period];var netvalue=global_data["diff_net"+column+"_"+period];var percentagevalue=global_data["percentage_"+column+"_"+period];percentagevalue=Math.round(percentagevalue*10)/10;if(value===undefined)return;var str_percentagevalue="";if(netvalue>0)str_percentagevalue="+"+percentagevalue;if(netvalue<0)str_percentagevalue="-"+Math.abs(percentagevalue);if(show_name){html+='<div class="col-md-3">'}else{html+='<div class="col-md-4">'}html+='<span class="dayschange">Last '+period+" days:</span>";html+=" "+Report.formatValue(value)+"<br>";if(netvalue===0){html+='<i class="fa fa-arrow-circle-right"></i> <span class="zeropercent">&nbsp;'+str_percentagevalue+"%</span>&nbsp;"}else if(netvalue>0){html+='<i class="fa fa-arrow-circle-up"></i> <span class="pospercent">&nbsp;'+str_percentagevalue+"%</span>&nbsp;"}else if(netvalue<0){html+='<i class="fa fa-arrow-circle-down"></i> <span class="negpercent">&nbsp;'+str_percentagevalue+"%</span>&nbsp;"}html+="</div><!--col-md-4-->"});html+="</div><!--row-->";$(div).append(html)})}};Convert.convertFilterItemMetricsEvol=function(filter,item){var config_metric=filterItemsConfig();var divlabel="FilterItemMetricsEvol";divs=$("."+divlabel);if(item!==null&&divs.length>0){$.each(divs,function(id,div){var real_item=item;var metrics=$(this).data("metrics");ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;if($(this).data("item"))real_item=$(this).data("item");config_metric=loadHTMLEvolParameters(div,config_metric);div.id=Report.cleanLabel(item).replace(/ /g,"_")+"-";div.id+=metrics.replace(/,/g,"-")+"-"+ds+"-"+filter+"-"+divlabel;$(this).empty();if(filter==="repos"){real_item=Convert.getRealItem(DS,filter,real_item);if(real_item){DS.displayMetricsRepo(real_item,metrics.split(","),div.id,config_metric)}else $(this).hide()}else if(filter==="countries"){DS.displayMetricsCountry(real_item,metrics.split(","),div.id,config_metric)}else if(filter==="companies"){DS.displayMetricsCompany(real_item,metrics.split(","),div.id,config_metric)}else if(filter==="domains"){DS.displayMetricsDomain(real_item,metrics.split(","),div.id,config_metric)}else if(filter==="projects"){DS.displayMetricsProject(real_item,metrics.split(","),div.id,config_metric)}})}};Convert.convertFilterItemTop=function(filter,item){var divlabel="FilterItemTop";divs=$("."+divlabel);if(divs.length>0){$.each(divs,function(id,div){var real_item=item;$(this).empty();ds=$(this).data("data-source");DS=Report.getDataSourceByName(ds);if(DS===null)return;if(filter===undefined)filter=$(this).data("filter");if(filter!==$(this).data("filter"))return;if(!filter)return;if($(this).data("item"))real_item=$(this).data("item");var metric=$(this).data("metric");var period=$(this).data("period");var titles=$(this).data("titles");div.id=metric+"-"+ds+"-"+filter+"-"+divlabel+"-"+getRandomId();$(this).empty();div.className="";if(filter==="companies")DS.displayTopCompany(real_item,div.id,metric,period,titles)})}};Convert.convertFilterStudyItem=function(filter,item){var convertfn=Convert.convertFilterStudyItem;if(convertfn.done===undefined){convertfn.done={}}else if(convertfn.done[filter]===true)return;if(filter==="repositories")filter="repos";if(item===undefined){if(filter==="repos")item=Report.getParameterByName("repository");if(filter==="countries")item=Report.getParameterByName("country");if(filter==="companies")item=Report.getParameterByName("company");if(filter==="domains")item=Report.getParameterByName("domain");if(filter==="projects")item=Report.getParameterByName("project")}if(!item)return;if(Loader.FilterItemCheck(item,filter)===false)return;Convert.convertFilterItemData(filter,item);Convert.convertFilterItemSummary(filter,item);Convert.convertFilterItemMetricsEvol(filter,item);Convert.convertFilterItemTop(filter,item);Convert.convertFilterItemMicrodashText(filter,item);Convert.convertProjectData();Convert.activateHelp();Convert.convertMetricsEvolSelector();convertfn.done[filter]=true};Convert.activateHelp=function(){$(".help").popover({html:true,trigger:"manual"}).click(function(e){$(this).popover("toggle");e.stopPropagation()})};Convert.convertFilterStudy=function(filter){var page=Report.getCurrentPage();if(page===null){page=Report.getParameterByName("page");if(page!==undefined)Report.setCurrentPage(page)}if(page===undefined){if($("[class^='FilterItems']").length>0){page=1;Report.setCurrentPage(page)}else return}if(filter==="repositories")filter="repos";if(Loader.check_filter_page(page,filter)===false){$.each(Report.getDataSources(),function(index,DS){Loader.data_load_items_page(DS,page,Convert.convertFilterStudy,filter)});return}Convert.convertFilterItemsSummary(filter);Convert.convertFilterItemsGlobal(filter);Convert.convertFilterItemsNav(filter,page);Convert.convertFilterItemsMetricsEvol(filter);Convert.convertFilterItemsMiniCharts(filter,page)};Convert.convertDSTable=function(){var dst="DataSourcesTable";var divs=$("."+dst);var DS,ds;if(divs.length>0){var unique=0;$.each(divs,function(id,div){$(this).empty();div.id=dst+unique++;Viz.displayDataSourcesTable(div)})}};Convert.convertBasicDivs=function(){Convert.convertNavbar();Convert.convertSectionBreadcrumb();Convert.convertProjectMap();Convert.convertFooter();Convert.convertDSTable();Convert.convertGlobalData();Convert.convertSummary()};Convert.convertBasicDivsMisc=function(){Convert.convertRadarActivity();Convert.convertRadarCommunity();Convert.convertTreemap();Convert.convertBubbles()};Convert.convertBasicMetrics=function(config){var item=Report.getParameterByName("repository");if(item===undefined)Convert.convertMetricsEvol();Convert.convertTimeTo();Convert.convertMarkovTable()};Convert.convertFilterTop=function(filter){var item=Report.getParameterByName("repository");if(Loader.filterTopCheck(item,filter)===false)return;Convert.convertTop();Convert.convertRepositorySelector()}})();if(Report===undefined)var Report={};(function(){var project_data=null,markers=null,viz_config=null,gridster={},data_sources=[],report_config=null,html_dir="";var data_dir="data/json";var config_dir="config";var default_data_dir="data/json";var default_html_dir="";var projects_dirs=[default_data_dir];var projects_data={};var projects_datasources={};var repos_map;var project_file=config_dir+"/project-info.json",viz_config_file=data_dir+"/viz_cfg.json",markers_file=data_dir+"/markers.json",repos_map_file=data_dir+"/repos-map.json",projects_hierarchy_file=data_dir+"/projects_hierarchy.json";menu_elements_file=config_dir+"/menu-elements.json";var page_size=10,page=null;var project_people_identities={};Report.createDataSources=createDataSources;Report.getAllMetrics=getAllMetrics;Report.getMarkers=getMarkers;Report.getVizConfig=getVizConfig;Report.getProjectsHierarchy=getProjectsHierarchy;Report.getMenuElements=getMenuElements;Report.getMetricDS=getMetricDS;Report.getGridster=getGridster;Report.setGridster=setGridster;Report.getCurrentPage=function(){return page};Report.setCurrentPage=function(current_page){page=current_page};Report.getPageSize=function(){return page_size};Report.setPageSize=function(size){page_size=size};Report.getProjectData=getProjectData;Report.getProjectsData=getProjectsData;Report.convertStudies=convertStudies;Report.getDataSources=function(){return data_sources};Report.registerDataSource=function(backend){data_sources.push(backend)};Report.setHtmlDir=function(dir){html_dir=dir};Report.getHtmlDir=function(){return html_dir};Report.getDataDir=function(){return data_dir};Report.setDataDir=function(dataDir){data_dir=dataDir;project_file=dataDir+"/project-info.json";config_file=dataDir+"/viz_cfg.json";markers_file=dataDir+"/markers.json";repos_mapping_file=data_dir+"/repos-mapping.json";projects_hierarchy_file=data_dir+"/projects_hierarchy.json"};function getMarkers(){return markers}Report.setMarkers=function(data){markers=data};Report.getMarkersFile=function(){return markers_file};Report.getReposMap=function(){return repos_map};Report.setReposMap=function(data){repos_map=data};Report.getReposMapFile=function(){return repos_map_file};function getVizConfig(){return viz_config}Report.setVizConfig=function(cfg){viz_config=cfg};Report.getVizConfigFile=function(){return viz_config_file};function getProjectsHierarchy(){return projects_hierarchy}Report.setProjectsHierarchy=function(data){projects_hierarchy=data};Report.getProjectsHierarchyFile=function(){return projects_hierarchy_file};function getMenuElements(){return menu_elements}Report.setMenuElements=function(data){menu_elements=data};Report.getMenuElementsFile=function(){return menu_elements_file};function getGridster(){return gridster}function setGridster(grid){gridster=grid}function getProjectData(){return project_data}Report.setProjectData=function(data){project_data=data};Report.getProjectFile=function(){return project_file};function getProjectsData(){return projects_data}Report.getProjectsDirs=function(){return projects_dirs};Report.setProjectsDirs=function(dirs){projects_dirs=dirs};Report.getProjectsList=function(){var projects_list=[];$.each(getProjectsData(),function(key,val){projects_list.push(key)});return projects_list};Report.getProjectsDataSources=function(){return projects_datasources};Report.setMetricsDefinition=function(metrics){$.each(Report.getDataSources(),function(i,DS){DS.setMetricsDefinition(metrics[DS.getName()])})};Report.getPeopleIdentities=function(){return project_people_identities};Report.setPeopleIdentities=function(people){project_people_identities=people};Report.cleanLabel=function(item){var label=item;var aux=null;if(item.split("___").length===2){aux=item.split(" ");label=aux[0]}else if(item.lastIndexOf("http")===0||item.split("_").length>3){aux=item.split("_");label=aux.pop();if(label==="")label=aux.pop();label=label.replace("buglist.cgi?product=","");label=label.replace("gmane.comp.sysutils.","")}else if(item.lastIndexOf("<")===0)label=MLS.displayMLSListName(item);return label};function strNumberWithThousands(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return parts.join(".")}Report.formatValue=function(number,field){if(number===undefined)return"-";var date_fields=["last_date","first_date"];var value=number;try{value=parseFloat(number).toFixed(1).toString().replace(/\.0$/,"");value=strNumberWithThousands(value);if(navigator.language==="es"){var parts=value.split(".");parts[0]=parts[0].replace(/,/g,".");value=parts.join(",")}}catch(err){}if(typeof value==="number"&&isNaN(value))value=number.toString();if(field!==undefined&&$.inArray(field,date_fields)>-1)value=number.toString();return value};Report.escapeHtml=function(unsafe){return unsafe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};Report.getParameterByName=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return results===null?undefined:Report.escapeHtml(decodeURIComponent(results[1].replace(/\+/g," ")))};function getMetricDS(metric_id){var ds=[];$.each(Report.getDataSources(),function(i,DS){if(DS.getMetrics()[metric_id]){ds.push(DS)}});return ds}Report.getDataSourceByName=function(ds){var DS=null;$.each(Report.getDataSources(),function(index,DSaux){if(DSaux.getName()===ds){DS=DSaux;return false}});return DS};function getAllMetrics(){var all={};$.each(Report.getDataSources(),function(index,DS){all=$.extend({},all,DS.getMetrics())});return all}Report.displayActiveMenu=function(){var active=window.location.href;var page=active.substr(active.lastIndexOf("/")+1,active.length);page=page.split(".html")[0];if(page.indexOf("scm")===0){$(".scm-menu")[0].className=$(".scm-menu")[0].className+" active"}else if(page.indexOf("its")===0){$(".its-menu")[0].className=$(".its-menu")[0].className+" active"}else if(page.indexOf("mls")===0){$(".mls-menu")[0].className=$(".mls-menu")[0].className+" active"}else if(page.indexOf("scr")===0){$(".scr-menu")[0].className=$(".scr-menu")[0].className+" active"}else if(page.indexOf("irc")===0){$(".irc-menu")[0].className=$(".irc-menu")[0].className+" active"}else if(page.indexOf("qaforum")===0){$(".qaforum-menu")[0].className=$(".qaforum-menu")[0].className+" active"}else if(page.indexOf("studies")===0){$(".studies-menu")[0].className=$(".studies-menu")[0].className+" active"}else if(page.indexOf("wiki")===0){$(".wiki-menu")[0].className=$(".wiki-menu")[0].className+" active"}else if(page.indexOf("downloads")===0){$(".downloads-menu")[0].className=$(".downloads-menu")[0].className+" active"}else if(page.indexOf("projects")===0){$(".listprojects-menu")[0].className=$(".listprojects-menu")[0].className+" active"}else if(page.indexOf("index")===0||page===""){if($(".summary-menu").length===0)return;$(".summary-menu")[0].className=$(".summary-menu")[0].className+" active"}else{if($(".experimental-menu")[0])$(".experimental-menu")[0].className=$(".experimental-menu")[0].className+" active"}};function checkDynamicConfig(){var data_sources=[];function getDataDirs(dirs_config){var full_params=dirs_config.split("&");var dirs_param=$.grep(full_params,function(item,index){return item.indexOf("data_dir=")===0});for(var i=0;i<dirs_param.length;i++){var data_dir=dirs_param[i].split("=")[1];data_sources.push(data_dir);if(i===0)Report.setDataDir(data_dir)}}var querystr=window.location.search.substr(1);if(querystr&&querystr.indexOf("data_dir")>=0){getDataDirs(querystr);if(data_sources.length>0)Report.setProjectsDirs(data_sources)
}}function createDataSources(){checkDynamicConfig();var projects_dirs=Report.getProjectsDirs();var scm,its,mls,scr,irc,mediawiki,people,downloads,qaforums,releases;$.each(projects_dirs,function(i,project){if(Report.getConfig()===null||Report.getConfig()["data-sources"]===undefined){its=new ITS;Report.registerDataSource(its);mls=new MLS;Report.registerDataSource(mls);scm=new SCM;Report.registerDataSource(scm);scr=new SCR;Report.registerDataSource(scr);irc=new IRC;Report.registerDataSource(irc);mediawiki=new MediaWiki;Report.registerDataSource(mediawiki);people=new People;Report.registerDataSource(people);downloads=new Downloads;Report.registerDataSource(downloads);qaforums=new QAForums;Report.registerDataSource(qaforums);releases=new Releases;Report.registerDataSource(releases)}else{var active_ds=Report.getConfig()["data-sources"];$.each(active_ds,function(i,name){if(name==="its"){its=new ITS;Report.registerDataSource(its)}else if(name==="mls"){mls=new MLS;Report.registerDataSource(mls)}else if(name==="scm"){scm=new SCM;Report.registerDataSource(scm)}else if(name==="scr"){scr=new SCR;Report.registerDataSource(scr)}else if(name==="irc"){irc=new IRC;Report.registerDataSource(irc)}else if(name==="mediawiki"){mediawiki=new MediaWiki;Report.registerDataSource(mediawiki)}else if(name==="people"){people=new People;Report.registerDataSource(people)}else if(name==="downloads"){downloads=new Downloads;Report.registerDataSource(downloads)}else if(name==="qaforums"){qaforums=new QAForums;Report.registerDataSource(qaforums)}else if(name==="releases"){releases=new Releases;Report.registerDataSource(releases)}else Report.log("Not support data source "+name)})}if(its)its.setDataDir(project);if(mls)mls.setDataDir(project);if(scm)scm.setDataDir(project);if(scr)scr.setDataDir(project);if(irc)irc.setDataDir(project);if(mediawiki)mediawiki.setDataDir(project);if(people)people.setDataDir(project);if(downloads)downloads.setDataDir(project);if(qaforums)qaforums.setDataDir(project);if(releases)releases.setDataDir(project);if(scm&&its)scm.setITS(its)});return true}Report.addDataDir=function(){var addURL;var querystr=window.location.search.substr(1);if(querystr&&querystr.indexOf("data_dir")!==-1){addURL=window.location.search.substr(1)}return addURL};Report.configDataSources=function(){var prjs_dss=Report.getProjectsDataSources();$.each(Report.getDataSources(),function(index,ds){if(ds.getData()instanceof Array)return;$.each(projects_data,function(name,project){if(project.dir===ds.getDataDir()){if(prjs_dss[name]===undefined)prjs_dss[name]=[];$.each(prjs_dss[name],function(prj,prjds){if(ds.getName()===prjds.getName())return false});ds.setProject(name);prjs_dss[name].push(ds);return false}})})};Report.getConfig=function(){return report_config};Report.setConfig=function(data){report_config=data;if(data){Report.log("Global config file found");if(data["global-html-dir"])Report.setHtmlDir(data["global-html-dir"]);if(data["global-data-dir"]){Report.setDataDir(data["global-data-dir"]);Report.setProjectsDirs([data["global-data-dir"]])}if(data["projects-data-dirs"])Report.setProjectsDirs(data["projects-data-dirs"])}};Report.convertGlobal=function(){Convert.convertMicrodash();Convert.convertMicrodashText();Convert.convertBasicDivs();Convert.convertBasicDivsMisc();Convert.convertBasicMetrics();Convert.convertDemographics();Convert.convertMetricsEvolSet();Convert.convertLastActivity()};Report.getActiveStudies=function(){var activeStudies=[];var reports;var reports_study=["repositories","countries","companies","domains","projects"];if(Report.getConfig()!==null)reports=Report.getConfig().reports;else reports=reports_study;$.each(reports_study,function(i,study){if($.inArray(study,reports)>-1)activeStudies.push(study)});return activeStudies};Report.convertStudiesGlobal=function(){Convert.convertPeople()};function convertStudies(){$.each(Report.getActiveStudies(),function(i,study){var filter=study;if(study==="repositories")filter="repos";DataProcess.orderItems(filter);Convert.convertFilterStudy(study);Convert.convertFilterStudyItem(study)})}var log_on=true;Report.getLog=function(){return log_on};Report.setLog=function(status){log_on=status};Report.log=function(msg){if(Report.getLog()===true)if(window.console)console.log(msg)}})();Loader.data_ready_global(function(){Report.configDataSources();Report.convertGlobal();Report.convertStudiesGlobal()});Loader.data_ready(function(){study="repos";Convert.convertFilterTop(study)});Loader.data_ready(function(){Report.convertStudies();$("body").css("cursor","auto");$("html").click(function(e){$(".help").popover("hide")});Convert.activateHelp()});$(document).ready(function(){var filename="./config.json";$.getJSON(filename,function(data){Report.setConfig(data)}).fail(function(){if(window.console)Report.log("Can't read global config file "+filename)}).always(function(data){Report.createDataSources();Loader.data_load();$("body").css("cursor","progress")})});function resizedw(){Report.convertGlobal();Report.convertStudiesGlobal();Report.convertStudies();Convert.activateHelp()}var resized;$(window).resize(function(){clearTimeout(resized);resized=setTimeout(resizedw,100)});function DataSource(name,basic_metrics){this.top_data_file=this.data_dir+"/"+this.name+"-top.json";this.getTopDataFile=function(){return this.top_data_file};this.getMetrics=function(){return this.basic_metrics};this.setMetrics=function(metrics){this.basic_metrics=metrics};this.setMetricsDefinition=function(metrics){if(metrics===undefined)return;this.setMetrics(metrics)};this.data_file=this.data_dir+"/"+this.name+"-evolutionary.json";this.getDataFile=function(){return this.data_file};this.setDataFile=function(file){this.data_file=file};this.data=null;this.getData=function(){return this.data};function nameSpaceMetrics(plain_metrics,ds){if(plain_metrics instanceof Array)return plain_metrics;var metrics={};$.each(plain_metrics,function(name,value){var basic_name=name;var aux=name.split("_");if(isNaN(aux[aux.length-1])===false)basic_name=aux.slice(0,aux.length-1).join("_");var ns_basic_name=ds.getName()+"_"+basic_name;var ns_name=ds.getName()+"_"+name;if(ds.getMetrics()[ns_basic_name]===undefined)metrics[name]=value;else metrics[ns_name]=value});return metrics}this.setData=function(load_data,self){if(self===undefined)self=this;self.data=nameSpaceMetrics(load_data,self)};this.demographics_aging_file=this.data_dir+"/"+this.name+"-demographics-aging.json";this.demographics_birth_file=this.data_dir+"/"+this.name+"-demographics-birth.json";this.getDemographicsAgingFile=function(){return this.demographics_aging_file};this.getDemographicsBirthFile=function(){return this.demographics_birth_file};this.demographics_data={};this.getDemographicsData=function(){return this.demographics_data};this.setDemographicsAgingData=function(data,self){if(self===undefined)self=this;self.demographics_data.aging=data};this.setDemographicsBirthData=function(data,self){if(self===undefined)self=this;self.demographics_data.birth=data};this.data_dir="data/json";this.getDataDir=function(){return this.data_dir};this.setDataDir=function(dataDir){this.data_dir=dataDir;this.data_file=dataDir+"/"+this.name+"-evolutionary.json";this.demographics_aging_file=dataDir+"/"+this.name+"-demographics-aging.json";this.demographics_birth_file=dataDir+"/"+this.name+"-demographics-birth.json";this.global_data_file=dataDir+"/"+this.name+"-static.json";this.top_data_file=dataDir+"/"+this.name+"-top.json";this.companies_data_file=dataDir+"/"+this.name+"-companies.json";this.repos_data_file=dataDir+"/"+this.name+"-repos.json";this.countries_data_file=dataDir+"/"+this.name+"-countries.json";this.domains_data_file=dataDir+"/"+this.name+"-domains.json";this.projects_data_file=dataDir+"/"+this.name+"-projects.json";this.time_to_fix_data_file=dataDir+"/"+this.name+"-quantiles-month-time_to_fix_hour.json"};this.global_data_file=this.data_dir+"/"+this.name+"-static.json";this.getGlobalDataFile=function(){return this.global_data_file};this.global_data=null;this.getGlobalData=function(){return this.global_data};this.setGlobalData=function(data,self){if(self===undefined)self=this;self.global_data=nameSpaceMetrics(data,self)};this.global_top_data=null;this.getGlobalTopData=function(){return this.global_top_data};this.setGlobalTopData=function(data,self){if(self===undefined)self=this;self.global_top_data=data};this.name=name;this.getName=function(){return this.name};this.people_data_file=this.data_dir+"/"+this.name+"-people.json";this.getPeopleDataFile=function(){return this.people_data_file};this.people=null;this.getPeopleData=function(){return this.people};this.setPeopleData=function(people,self){if(self===undefined)self=this;self.people=people};this.time_to_fix_data_file=this.data_dir+"/"+this.name+"-quantiles-month-time_to_fix_hour.json";this.getTimeToFixDataFile=function(){return this.time_to_fix_data_file};this.time_to_fix_data=null;this.getTimeToFixData=function(){return this.time_to_fix_data};this.setTimeToFixData=function(data,self){if(self===undefined)self=this;self.time_to_fix_data=data};this.time_to_attention_data_file=this.data_dir+"/"+this.name+"-quantiles-month-time_to_attention_hour.json";this.getTimeToAttentionDataFile=function(){return this.time_to_attention_data_file};this.time_to_attention_data=null;this.getTimeToAttentionData=function(){return this.time_to_attention_data};this.setTimeToAttentionData=function(data,self){if(self===undefined)self=this;self.time_to_attention_data=data};this.project=null;this.getProject=function(){return this.project};this.setProject=function(project){this.project=project};this.markov_table_data_file=this.data_dir+"/"+this.name+"-markov.json";this.getMarkovTableDataFile=function(){return this.markov_table_data_file};this.markov_table_data=null;this.getMarkovTableData=function(){return this.markov_table_data};this.setMarkovTableData=function(data,self){if(self===undefined)self=this;self.markov_table_data=data};this.companies_data_file=this.data_dir+"/"+this.name+"-companies.json";this.getCompaniesDataFile=function(){return this.companies_data_file};this.companies=null;this.getCompaniesDataFull=function(){return this.companies};this.getCompaniesData=function(){var items=this.companies;if(items instanceof Array===false){if(this.companies!==null){items=this.companies.name}}return items};this.setCompaniesData=function(companies,self){if(companies===null)companies=[];if(self===undefined)self=this;self.companies=companies};this.companies_metrics_data={};this.addCompanyMetricsData=function(company,data,self){if(self===undefined)self=this;self.companies_metrics_data[company]=nameSpaceMetrics(data,self)};this.getCompaniesMetricsData=function(){return this.companies_metrics_data};this.companies_global_data={};this.addCompanyGlobalData=function(company,data,self){if(self===undefined)self=this;self.companies_global_data[company]=nameSpaceMetrics(data,self)};this.getCompaniesGlobalData=function(){return this.companies_global_data};this.companies_top_data={};this.addCompanyTopData=function(company,data,self){if(self===undefined)self=this;if(self.companies_top_data[company]===undefined)self.companies_top_data[company]={};self.companies_top_data[company]=data};this.getCompaniesTopData=function(){return this.companies_top_data};this.setCompaniesTopData=function(data,self){if(self===undefined)self=this;self.companies_top_data=data};this.repos_data_file=this.data_dir+"/"+this.name+"-repos.json";this.getReposDataFile=function(){return this.repos_data_file};this.repos=null;this.getReposDataFull=function(){return this.repos};this.getReposData=function(){var items=this.repos;if(items instanceof Array===false){if(this.repos!==null){items=this.repos.name}}return items};this.setReposData=function(repos,self){if(self===undefined)self=this;self.repos=repos;if(self.getName()!=="its")return;repos_names=[];if(repos instanceof Array===true){self.repos={};self.repos.name=repos}var filtered_repos=[];for(var i=0;i<self.repos.name.length;i++){filtered_repos.push(self.repos.name[i].replace(/\//g,"_"))}self.repos.name=filtered_repos};this.repos_metrics_data={};this.addRepoMetricsData=function(repo,data,self){if(self===undefined)self=this;self.repos_metrics_data[repo]=nameSpaceMetrics(data,self)};this.getReposMetricsData=function(){return this.repos_metrics_data};this.repos_global_data={};this.addRepoGlobalData=function(repo,data,self){if(self===undefined)self=this;self.repos_global_data[repo]=nameSpaceMetrics(data,self)};this.getReposGlobalData=function(){return this.repos_global_data};this.repositories_top_data={};this.addRepositoryTopData=function(repository,data,self){if(self===undefined)self=this;if(self.repositories_top_data[repository]===undefined)self.repositories_top_data[repository]={};self.repositories_top_data[repository]=data};this.getRepositoriesTopData=function(){return this.repositories_top_data};this.setRepositoriesTopData=function(data,self){if(self===undefined)self=this;self.repositories_top_data=data};this.countries_data_file=this.data_dir+"/"+this.name+"-countries.json";this.getCountriesDataFile=function(){return this.countries_data_file};this.countries=null;this.getCountriesData=function(){return this.countries};this.setCountriesData=function(countries,self){if(self===undefined)self=this;self.countries=countries};this.countries_metrics_data={};this.addCountryMetricsData=function(country,data,self){if(self===undefined)self=this;self.countries_metrics_data[country]=nameSpaceMetrics(data,self)};this.getCountriesMetricsData=function(){return this.countries_metrics_data};this.countries_global_data={};this.addCountryGlobalData=function(country,data,self){if(self===undefined)self=this;self.countries_global_data[country]=nameSpaceMetrics(data,self)};this.getCountriesGlobalData=function(){return this.countries_global_data};this.domains_data_file=this.data_dir+"/"+this.name+"-domains.json";this.getDomainsDataFile=function(){return this.domains_data_file};this.domains=null;this.getDomainsDataFull=function(){return this.domains};this.getDomainsData=function(){var items=this.domains;if(items instanceof Array===false){if(this.domains!==null){items=this.domains.name}}return items};this.setDomainsData=function(domains,self){if(domains===null)domains=[];if(self===undefined)self=this;self.domains=domains};this.domains_metrics_data={};this.addDomainMetricsData=function(domain,data,self){if(self===undefined)self=this;self.domains_metrics_data[domain]=nameSpaceMetrics(data,self)};this.getDomainsMetricsData=function(){return this.domains_metrics_data};this.domains_global_data={};this.addDomainGlobalData=function(domain,data,self){if(self===undefined)self=this;self.domains_global_data[domain]=nameSpaceMetrics(data,self)};this.getDomainsGlobalData=function(){return this.domains_global_data};this.projects_data_file=this.data_dir+"/"+this.name+"-projects.json";this.getProjectsDataFile=function(){return this.projects_data_file};this.projects=null;this.getProjectsData=function(){return this.projects};this.setProjectsData=function(projects,self){if(projects===null)projects=[];if(!(projects instanceof Array))projects=[projects];if(self===undefined)self=this;self.projects=projects};this.projects_metrics_data={};this.addProjectMetricsData=function(project,data,self){if(self===undefined)self=this;self.projects_metrics_data[project]=nameSpaceMetrics(data,self)};this.getProjectsMetricsData=function(){return this.projects_metrics_data};this.projects_global_data={};this.addProjectGlobalData=function(project,data,self){if(self===undefined)self=this;self.projects_global_data[project]=nameSpaceMetrics(data,self)};this.getProjectsGlobalData=function(){return this.projects_global_data};this.people_metrics_data={};this.addPeopleMetricsData=function(id,data,self){if(self===undefined)self=this;self.people_metrics_data[id]=nameSpaceMetrics(data,self)};this.getPeopleMetricsData=function(){return this.people_metrics_data};this.people_global_data={};this.addPeopleGlobalData=function(id,data,self){if(self===undefined)self=this;self.people_global_data[id]=nameSpaceMetrics(data,self)};this.getPeopleGlobalData=function(){return this.people_global_data};this.getCompanyQuery=function(){var company=null;var querystr=window.location.search.substr(1);if(querystr&&querystr.split("&")[0].split("=")[0]==="company")company=querystr.split("&")[0].split("=")[1];return company};this.displayMetricCompanies=function(metric_id,div_target,config,start,end){var companies_data=this.getCompaniesMetricsData();Viz.displayMetricCompanies(metric_id,companies_data,div_target,config,start,end)};this.displayMetricMyCompanies=function(companies,metric_id,div_target,config,start,end){var companies_data={};var self=this;$.each(companies,function(i,name){companies_data[name]=self.getCompaniesMetricsData()[name]});Viz.displayMetricCompanies(metric_id,companies_data,div_target,config,start,end)};this.displayMetricRepos=function(metric_id,div_target,config,start,end){var repos_data=this.getReposMetricsData();Viz.displayMetricRepos(metric_id,repos_data,div_target,config,start,end)};this.displayBasicMetricMyRepos=function(repos,metric_id,div_target,config,start,end){var repos_data={};var reposMap=Report.getReposMap();var self=this;$.each(repos,function(i,name){var metrics=self.getReposMetricsData()[name];if(!metrics){if(reposMap[name]instanceof Object){name=reposMap[name][self.getName()]}else{name=reposMap[name]}metrics=self.getReposMetricsData()[name]}repos_data[name]=metrics});Viz.displayMetricRepos(metric_id,repos_data,div_target,config,start,end)};this.displayMetricDomains=function(metric_id,div_target,config,start,end){var domains_data=this.getDomainsMetricsData();Viz.displayMetricDomains(metric_id,domains_data,div_target,config,start,end)};this.displayMetricProjects=function(metric_id,div_target,config,start,end){var projects_data=this.getProjectsMetricsData();Viz.displayMetricProjects(metric_id,projects_data,div_target,config,start,end)};this.displayMetricCompaniesStatic=function(metric_id,div_target,config,order_by,show_others){this.displayMetricSubReportStatic("companies",metric_id,div_target,config,order_by,show_others)};this.displayMetricReposStatic=function(metric_id,div_target,config,order_by,show_others){this.displayMetricSubReportStatic("repos",metric_id,div_target,config,order_by,show_others)};this.displayMetricCountriesStatic=function(metric_id,div_target,config,order_by,show_others){this.displayMetricSubReportStatic("countries",metric_id,div_target,config,order_by,show_others)};this.displayMetricDomainsStatic=function(metric_id,div_target,config,order_by,show_others){this.displayMetricSubReportStatic("domains",metric_id,div_target,config,order_by,show_others)};this.displayMetricProjectsStatic=function(metric_id,div_target,config,order_by,show_others){this.displayMetricSubReportStatic("projects",metric_id,div_target,config,order_by,show_others)};this.displayMetricSubReportStatic=function(report,metric_id,div_target,config,order_by,show_others){if(order_by===undefined)order_by=metric_id;var data=null;if(report=="companies")data=this.getCompaniesGlobalData();else if(report=="repos")data=this.getReposGlobalData();else if(report=="countries")data=this.getCountriesGlobalData();else if(report=="domains")data=this.getDomainsGlobalData();else if(report=="projects")data=this.getProjectsGlobalData();else return;if($.isEmptyObject(data))return;var order=DataProcess.sortGlobal(this,order_by,report);if(order instanceof Array===false){order=order.name}data_page=DataProcess.paginate(order,Report.getCurrentPage());Viz.displayMetricSubReportStatic(metric_id,data,data_page,div_target,config)};this.displayMetricsCompany=function(company,metrics,div_id,config){var data=this.getCompaniesMetricsData()[company];if(data===undefined){$("#"+div_id).hide();return}Viz.displayMetricsCompany(this,company,metrics,data,div_id,config)};this.displayMetricsRepo=function(repo,metrics,div_id,config){var data=this.getReposMetricsData()[repo];if(data===undefined){$("#"+div_id).hide();return}Viz.displayMetricsRepo(this,repo,metrics,data,div_id,config)};this.displayMetricsCountry=function(country,metrics,div_id,config){var data=this.getCountriesMetricsData()[country];if(data===undefined){$("#"+div_id).hide();return}Viz.displayMetricsCountry(this,country,metrics,data,div_id,config)};this.displayMetricsDomain=function(domain,metrics,div_id,config){var data=this.getDomainsMetricsData()[domain];if(data===undefined)return;Viz.displayMetricsDomain(this,domain,metrics,data,div_id,config)};this.displayMetricsProject=function(project,metrics,div_id,config){var data=this.getProjectsMetricsData()[project];if(data===undefined)return;Viz.displayMetricsProject(this,project,metrics,data,div_id,config)};this.displayMetricsPeople=function(upeople_id,upeople_identifier,metrics,div_id,config){var history=this.getPeopleMetricsData()[upeople_id];if(history===undefined||history instanceof Array){$("#"+div_id).hide();return}Viz.displayMetricsPeople(this,upeople_identifier,metrics,history,div_id,config)};this.displayMetricsEvol=function(metric_ids,div_target,config,convert,repository){var data;if(repository&&$.inArray(repository,this.getReposData())>=0){data=this.getReposMetricsData()[repository]}else{data=this.getData()}if(convert)data=DataProcess.convert(data,convert,metric_ids);Viz.displayMetricsEvol(this,metric_ids,data,div_target,config,repository)};this.isPageDisplayed=function(visited,linked,total,displayed){var window=Math.floor((displayed-3)/2);var lowest_barrier=visited-window;var highest_barrier=visited+window;if(linked===1||linked===total||linked==visited){return true}else if(linked>=lowest_barrier&&linked<visited){return true}else if(linked<=highest_barrier&&linked>visited){return true}else{return false}};this.displayItemsNav=function(div_nav,type,page_str,order_by){var page=parseInt(page_str,null);if(isNaN(page))page=1;var items=null;var title="";var total=0;var displayed_pages=5;if(type==="companies"){items=this.getCompaniesData();title="List of companies"}else if(type==="repos"){items=this.getReposData();if(order_by)items=DataProcess.sortGlobal(this,order_by,type)}else if(type==="countries"){items=this.getCountriesData()}else if(type==="domains"){items=this.getDomainsData()}else if(type==="projects"){items=this.getProjectsData()}else{return}total=items.length;var nav="";var psize=Report.getPageSize();if(page){nav+="<div class='pagination'>";var number_pages=Math.ceil(total/psize);var from_item=(page-1)*psize+1;var to_item=page*psize;if(to_item>total){to_item=total}nav+="<ul class='pagination'>";if(page>1){nav+="<li><a href='?page="+(page-1)+"'>&laquo;</a></li>"}else{nav+="<li class='disabled'><a href='?page="+page+"'>&laquo;</a></li>"}for(var j=0;j*Report.getPageSize()<total;j++){if(this.isPageDisplayed(page,j+1,number_pages,displayed_pages)===true){if(page===j+1){nav+="<li class='active'><a href='?page="+(j+1)+"'>"+(j+1)+"</a></li>"}else{nav+="<li><a href='?page="+(j+1)+"'>"+(j+1)+"</a></li>"}}else{if(j+1+1===number_pages||j+1-1===1){nav+="<li class='disabled'><a href='#'> .. </a></li>"}}}if(page*Report.getPageSize()<items.length){nav+="<li><a href='?page="+(parseInt(page,null)+1)+"'>";nav+="&raquo;</a></li>"}nav+="</ul>";nav+="<span class='pagination-text'> ("+from_item+" - "+to_item+"/"+total+")</span>";nav+="</div>"}if(Report.getPageSize()>10)$.each(items,function(id,item){var label=Report.cleanLabel(item);nav+="<a href='#"+item+"-nav'>"+label+"</a> "});$("#"+div_nav).append(nav)};this.displayCompaniesLinks=function(div_links,limit,sort_metric){var sorted_companies=DataProcess.sortGlobal(this,sort_metric,"companies");var links="";var i=0;$.each(sorted_companies,function(id,company){links+='<a href="company.html?company='+company;if(Report.addDataDir())links+="&"+Report.addDataDir();links+='">'+company+"</a>| ";if(i++>=limit-1)return false});$("#"+div_links).append(links)};this.displayCompaniesList=function(metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert){this.displaySubReportList("companies",metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert)};this.displayReposList=function(metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert){this.displaySubReportList("repos",metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert)};this.displayCountriesList=function(metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert){this.displaySubReportList("countries",metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert)};this.displayDomainsList=function(metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert){this.displaySubReportList("domains",metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert)};this.displayProjectsList=function(metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert){this.displaySubReportList("projects",metrics,div_id,config_metric,sort_metric,page,show_links,start,end,convert)};this.displaySubReportList=function(report,metrics,div_id,config_metric,sort_metric,page_str,show_links,start,end,convert){var page=parseInt(page_str,null);if(isNaN(page))page=1;var list="";var cont=(page-1)*Report.getPageSize()+1;var ds=this;var data=null,sorted=null;if(show_links===undefined)show_links=true;if(report==="companies"){data=this.getCompaniesMetricsData();sorted=DataProcess.sortGlobal(this,sort_metric,report)}else if(report==="repos"){data=this.getReposMetricsData();sorted=DataProcess.sortGlobal(this,sort_metric,report)}else if(report==="countries"){data=this.getCountriesMetricsData();sorted=DataProcess.sortGlobal(this,sort_metric,report)}else if(report==="domains"){data=this.getDomainsMetricsData();sorted=DataProcess.sortGlobal(this,sort_metric,report)}else if(report==="projects"){data=this.getProjectsMetricsData();sorted=DataProcess.sortGlobal(this,sort_metric,report)}else return;sorted=DataProcess.paginate(sorted,page);list+='<table class="table table-hover table-repositories">';list+="<tr><th></th>";$.each(metrics,function(id,metric){if(ds.getMetrics()[metric]){title=ds.getMetrics()[metric].name;list+="<th>"+title+"</th>"}else{list+="<th>"+metric+"</th>"}});list+="</tr>";$.each(sorted,function(id,item){list+="<tr><td class='col-md-2 repository-name'>";list+="#"+cont+"&nbsp;";cont++;var addURL=null;if(Report.addDataDir())addURL=Report.addDataDir();if(show_links){if(report==="companies"){list+="<a href='company.html?company="+item;if(addURL)list+="&"+addURL;list+="'>"}else if(report==="repos"){list+="<a href='";list+="repository.html";list+="?repository="+encodeURIComponent(item);if(addURL)list+="&"+addURL;list+="'>"}else if(report==="countries"){list+="<a href='country.html?country="+item;if(addURL)list+="&"+addURL;list+="'>"}else if(report==="domains"){list+="<a href='domain.html?domain="+item;if(addURL)list+="&"+addURL;list+="'>"}else if(report==="projects"){list+="<a href='project.html?project="+item;if(addURL)list+="&"+addURL;list+="'>"}}list+="<strong>";list+=Report.cleanLabel(item);list+="</strong>";if(show_links)list+="</a>";list+="</td>";$.each(metrics,function(id,metric){list+="<td class='col-md-5'>";list+="<div id='"+report+"-"+item+"-"+metric+"'";list+=" class='subreport-list-item'>"});list+="</td></tr>"});list+="</table>";$("#"+div_id).append(list);var start_items=null,end_items=null,convert_items=null;if(start){if(typeof start==="number")start_items=[start.toString()];else start_items=start.split(",")}if(end){if(typeof end==="number")end_items=[end.toString()];else end_items=end.split(",")}if(convert)convert_items=convert.split(",");$.each(sorted,function(id,item){var i=0;$.each(metrics,function(id,metric){var mstart=null,mend=null,mconvert=null;if(start_items){if(start_items.length==1)mstart=start_items[0];else mstart=start_items[i]}if(end_items){if(end_items.length==1)mend=end_items[0];else mend=end_items[i]}if(convert_items)mconvert=convert_items[i];if(item in data===false)return;var item_data=data[item];if(item_data[metric]===undefined)return;var div_id=report+"-"+item+"-"+metric;var items={};items[item]=item_data;var title="";Viz.displayMetricSubReportLines(div_id,metric,items,title,config_metric,mstart,mend,mconvert);i++})})};this.displayGlobalSummary=function(divid){this.displaySummary(null,divid,null,this)};this.displayCompanySummary=function(divid,company,ds){this.displaySummary("companies",divid,company,ds)};this.displayRepoSummary=function(divid,repo,ds){this.displaySummary("repositories",divid,repo,ds)};this.displayCountrySummary=function(divid,repo,ds){this.displaySummary("countries",divid,repo,ds)};this.displayDomainSummary=function(divid,domain,ds){this.displaySummary("domains",divid,domain,ds)};this.displayProjectSummary=function(divid,project,ds){this.displaySummary("projects",divid,project,ds)};this.displayPeopleSummary=function(divid,upeople_id,upeople_identifier,ds){var history=ds.getPeopleGlobalData()[upeople_id];if(history===undefined||history instanceof Array)return;html="<h6>"+ds.getTitle()+"</h6>";html+="<table class='table-condensed table-hover'>";html+="<tr><td>";html+="Start</td><td>"+history.first_date;html+="</td></tr><tr><td>";html+="End</td><td>"+history.last_date;html+="</td></tr><tr><td>";if(ds.getName()=="scm")html+="Commits</td><td>"+history.scm_commits;else if(ds.getName()=="its")html+="Closed</td><td>"+history.its_closed;else if(ds.getName()=="mls")html+="Sent</td><td>"+history.mls_sent;else if(ds.getName()=="irc")html+="Sent</td><td>"+history.irc_sent;else if(ds.getName()=="scr")html+="Closed</td><td>"+history.scr_closed;html+="</td></tr>";html+="</table>";$("#"+divid).append(html)};this.displayCompaniesSummary=function(divid,ds){var html="";var data=ds.getGlobalData();html+="Total companies: "+data.companies+"<br>";if(data.companies_2006)html+="Companies in 2006: "+data.companies_2006+"<br>";if(data.companies_2009)html+="Companies in 2009: "+data.companies_2009+"<br>";if(data.companies_2012)html+="Companies in 2012: "+data.companies_2012+"<br>";$("#"+divid).append(html)};this.getSummaryLabels=function(){};this.getLabelForRepository=function(){return"repository"};this.getLabelForRepositories=function(){return"repositories"};this.displaySummary=function(report,divid,item,ds){if(!item)item="";var html="<h6>"+ds.getTitle()+"</h6>";var id_label=this.getSummaryLabels();var global_data=null;if(report==="companies")global_data=ds.getCompaniesGlobalData()[item];else if(report==="countries")global_data=ds.getCountriesGlobalData()[item];else if(report==="repositories")global_data=ds.getReposGlobalData()[item];else if(report==="domains")global_data=ds.getDomainsGlobalData()[item];else if(report==="projects")global_data=ds.getProjectsGlobalData()[item];else global_data=ds.getGlobalData();if(!global_data)return;var self=this;html+="<table class='table-condensed table-hover'>";var html_irow="<tr><td>";var html_erow="</td></tr>";$.each(global_data,function(id,value){if(self.getMetrics()[id]){html+=html_irow+self.getMetrics()[id].name+"</td><td>"+Report.formatValue(value)+html_erow}else if(id_label[id]){html+=html_irow+id_label[id]+"</td><td>"+Report.formatValue(value)+html_erow}});html+="</table>";$("#"+divid).append(html)};this.displayReposSummary=function(divid,ds){var html="";var data=ds.getGlobalData();html+="Total repositories: "+data[ds.getName()+"_repositories"]+"<br>";$("#"+divid).append(html)};this.displayCountriesSummary=function(divid,ds){var html="";var data=ds.getGlobalData();html+="Total countries: "+data[ds.getName()+"_countries"]+"<br>";$("#"+divid).append(html)};this.displayDomainsSummary=function(divid,ds){var html="";var data=ds.getGlobalData();html+="Total domains: "+data.domains+"<br>";$("#"+divid).append(html)};this.displayProjectsSummary=function(divid,ds){var html="";var data=ds.getGlobalData();html+="Total projects: "+data.projects+"<br>";$("#"+divid).append(html)};this.displayDemographics=function(divid,period){var data=this.getDemographicsData();Viz.displayDemographicsChart(divid,this,data,period)};this.displayTimeToAttention=function(div_id,column,labels,title){labels=true;
title="Time to Attention "+column;var data=this.getTimeToAttentionData();if(data instanceof Array)return;Viz.displayTimeToAttention(div_id,data,column,labels,title)};this.displayTimeToFix=function(div_id,column,labels,title){labels=true;title="Time to Fix "+column;var data=this.getTimeToFixData();if(data instanceof Array)return;Viz.displayTimeToFix(div_id,this.getTimeToFixData(),column,labels,title)};this.displayMarkovTable=function(div_id,title){var data=this.getMarkovTableData();if(data===undefined){Report.log("No Markov data available");return}Viz.displayMarkovTable(div_id,data,title)};this.displayTop=function(div,all,show_metric,period,period_all,graph,limit,people_links,threads_links,repository){if(all===undefined)all=true;var titles=null;Viz.displayTop(div,this,all,show_metric,period,period_all,null,null,limit,people_links,threads_links,repository)};this.displayTopCompany=function(company,div,metric_id,period,titles){var data=this.getCompaniesTopData()[company];if(data===undefined)return;var metric=this.getMetrics()[metric_id];Viz.displayTopCompany(company,data,div,metric,period,titles)};this.displayTopGlobal=function(div,metric,period,titles){Viz.displayTopGlobal(div,this,metric,period,titles)};this.envisionEvo=function(div_id,history,relative,legend_show,summary_graph){config=Report.getVizConfig();var options=Viz.getEnvisionOptions(div_id,history,this.getName(),Report.getVizConfig()[this.getName()+"_hide"],summary_graph);options.legend_show=legend_show;if(relative)DataProcess.addRelativeValues(options.data,this.getMainMetric());new envision.templates.Envision_Report(options,[this])};this.displayEnvision=function(divid,relative,legend_show,summary_graph){var projects_full_data=Report.getProjectsDataSources();this.envisionEvo(divid,projects_full_data,relative,legend_show,summary_graph)}}if(Viz===undefined)var Viz={};(function(){var bitergiaColor="#ffa500";Viz.displayTop=displayTop;Viz.displayTopCompany=displayTopCompany;Viz.displayTopGlobal=displayTopGlobal;Viz.displayBasicChart=displayBasicChart;Viz.displayMetricCompanies=displayMetricCompanies;Viz.displayMetricSubReportStatic=displayMetricSubReportStatic;Viz.displayMetricsCompany=displayMetricsCompany;Viz.displayMetricsDomain=displayMetricsDomain;Viz.displayMetricsProject=displayMetricsProject;Viz.displayMetricsPeople=displayMetricsPeople;Viz.displayMetricsRepo=displayMetricsRepo;Viz.displayMetricRepos=displayMetricRepos;Viz.displayMetricsCountry=displayMetricsCountry;Viz.displayMetricDomains=displayMetricDomains;Viz.displayMetricProjects=displayMetricProjects;Viz.displayMetricsEvol=displayMetricsEvol;Viz.displayBubbles=displayBubbles;Viz.displayDemographicsChart=displayDemographicsChart;Viz.displayEnvisionAll=displayEnvisionAll;Viz.displayTimeToFix=displayTimeToFix;Viz.displayTimeToAttention=displayTimeToAttention;Viz.displayMetricSubReportLines=displayMetricSubReportLines;Viz.displayRadarActivity=displayRadarActivity;Viz.displayRadarCommunity=displayRadarCommunity;Viz.displayTreeMap=displayTreeMap;Viz.displayMarkovTable=displayMarkovTable;Viz.displayDataSourcesTable=displayDataSourcesTable;Viz.getEnvisionOptions=getEnvisionOptions;Viz.checkBasicConfig=checkBasicConfig;function findMetricDoer(history,metric_id){var doer="";$.each(Report.getAllMetrics(),function(name,metric){if(metric.action===metric_id){doer=metric.column;return false}});return doer}function displayMarkovTable(div_id,data,title){var html="<h4>"+title+"</h4>";var table='<table id="itsmarkovtable" class="table table-striped">';table+="<thead><tr><th>Transition</th><th>Number</th><th>Percent</th></tr></thead><tbody>";$.each(data,function(i,val){subdata=data[i];old_value="old_value";new_value="new_value";percent="f";number="issue";for(var k=0;k<subdata[old_value].length;k++){var value_new=subdata[new_value][k];var value_p=subdata[percent][k];value_p=Math.round(value_p*100)/100;var value_num=subdata[number][k];table+="<tr><td>"+i+" -> "+value_new+"</td>";table+="<td>"+value_num+"</td>";table+="<td>"+value_p+"</td></tr>"}});table+="</tbody></table>";html+=table;div=$("#"+div_id);div.append(html);return}function translate(labels,l){if(labels.hasOwnProperty(l)){return labels[l]}else{return l}}function getTopVarsFromMetric(metric,ds_name){var var_names={};var_names.id="id";if(metric==="senders"&&(ds_name==="mls"||ds_name==="irc")){var_names.name="senders";var_names.action="sent"}if(metric==="authors"&&ds_name==="scm"){var_names.name="authors";var_names.action="commits"}if(metric==="closers"&&ds_name==="its"){var_names.name="closers";var_names.action="closed"}if(ds_name==="scr"){if(metric==="mergers"){var_names.name="mergers";var_names.action="merged"}if(metric==="openers"){var_names.name="openers";var_names.action="opened"}if(metric==="reviewers"){var_names.name="reviewers";var_names.action="reviews"}}if(ds_name==="downloads"){if(metric==="ips"){var_names.name="ips";var_names.action="downloads"}if(metric==="packages"){var_names.name="packages";var_names.action="downloads"}}if(ds_name==="mediawiki"){if(metric==="authors"){var_names.name="authors";var_names.action="reviews"}}if(ds_name==="qaforums"){if(metric==="senders"||metric==="asenders"||metric==="qsenders"){var_names.name="senders";var_names.action="sent"}}if(ds_name==="releases"){if(metric==="authors"){var_names.name="username";var_names.action="releases"}}return var_names}function getSortedPeriods(){return["last month","last year",""]}function composeTopRowsDownloads(dl_data,limit,var_names){var rows_html="";for(var j=0;j<dl_data[var_names.name].length;j++){if(limit&&limit<=j)break;var metric_value=dl_data[var_names.action][j];rows_html+="<tr><td>#"+(j+1)+"</td>";rows_html+="<td>";rows_html+=dl_data[var_names.name][j];rows_html+="</td>";rows_html+="<td>"+metric_value+"</td></tr>"}return rows_html}function composeTopRowsThreads(threads_data,limit,threads_links){var rows_html="";for(var i=0;i<threads_data.subject.length;i++){if(limit&&limit<=i)break;rows_html+="<tr><td>#"+(i+1)+"</td>";rows_html+="<td>";if(threads_links===true){var url="http://www.google.com/search?output=search&q=X&btnI=1";if(threads_data.hasOwnProperty("url")&&threads_data.url[i].length>0){url="http://www.google.com/search?output=search&q=X%20site%3AY&btnI=1";url=url.replace(/Y/g,threads_data.url[i])}url=url.replace(/X/g,threads_data.subject[i]);rows_html+="<td>";rows_html+='<a target="_blank" href="'+url+'">';rows_html+=threads_data.subject[i]+"</a>";rows_html+='&nbsp;<i class="fa fa-external-link"></i></td>'}else{rows_html+="<td>"+threads_data.subject[i]+"</td>"}rows_html+="<td>"+threads_data.initiator_name[i]+"</td>";rows_html+="<td>"+threads_data.length[i]+"</td>";rows_html+="</tr>"}return rows_html}function composeTopRowsPeople(people_data,limit,people_links,var_names){var rows_html="";for(var j=0;j<people_data[var_names.id].length;j++){if(limit&&limit<=j)break;var metric_value=people_data[var_names.action][j];rows_html+="<tr><td>#"+(j+1)+"</td>";rows_html+="<td>";if(people_links){rows_html+='<a href="people.html?id='+people_data[var_names.id][j]+'">';rows_html+=people_data[var_names.name][j]+"</a>"}else{rows_html+=people_data[var_names.name][j]}rows_html+="</td>";rows_html+="<td>"+metric_value+"</td></tr>"}return rows_html}function composeTopTabs(periods,metric,data,ds_name){var tabs_html="";var first=true;tabs_html+='<ul id="myTab" class="nav nav-tabs">';for(var i=0;i<periods.length;i++){var mykey=metric+"."+periods[i];if(data[mykey]){var data_period=periods[i];var data_period_formatted=data_period;if(data_period===""){data_period="all";data_period_formatted="complete history"}var data_period_nows=data_period.replace(/\ /g,"");var html="";if(first===true){html=' class="active"';first=false}tabs_html+="<li"+html+'><a href="#'+ds_name+metric+data_period_nows+'"data-toogle="tab">';tabs_html+=data_period_formatted+"</a></li>"}}tabs_html+="</ul>";return tabs_html}function composeTitle(metric,ds_name,tabs,desc_metrics,selected_period){var key=ds_name+"_"+metric;var desc="";var title="";if(key in desc_metrics){desc=desc_metrics[key].desc;desc=desc.toLowerCase()}if(tabs===true){title+="<h6>Top "+desc+"</h6>"}else{title+="<h6>Top "+desc+" "+selected_period+"</h6>"}return title}function displayTopMetric_new(div_id,data,metric,limit,desc_metrics,people_links,threads_links,selected_period){var tabs="";var tables="";var title="";var gen_tabs=true;var div=$("#"+div_id);var ds_name=div.attr("data-data-source");periods=getSortedPeriods();if(selected_period!==undefined){gen_tabs=false}title+=composeTitle(metric,ds_name,gen_tabs,desc_metrics,selected_period);if(gen_tabs===true){tabs+=composeTopTabs(periods,metric,data,ds_name)}tables+='<div class="tab-content">';var var_names=getTopVarsFromMetric(metric,ds_name);if(gen_tabs===true){var first=true;var html="";for(var k=0;k<periods.length;k++){html="";var key=metric+"."+periods[k];if(data[key]){var data_period=periods[k];if(data_period===""){data_period="all"}var data_period_nows=data_period.replace(/\ /g,"");if(first===true){html=" active in";first=false}tables+='<div class="tab-pane fade'+html+'" id="'+ds_name+metric+data_period_nows+'">';tables+='<table class="table table-striped"><tbody>';if(metric==="threads"){tables+=composeTopRowsThreads(data[key],limit,threads_links)}else if(metric==="packages"||metric==="ips"){tables+=composeTopRowsDownloads(data[key],limit,var_names)}else{tables+=composeTopRowsPeople(data[key],limit,people_links,var_names)}tables+="</tbody></table>";tables+="</div>"}}}else{tables+='<table class="table table-striped"><tbody>';if(metric==="threads"){tables+=composeTopRowsThreads(data,limit,threads_links)}else if(metric==="packages"||metric==="ips"){tables+=composeTopRowsDownloads(data,limit,var_names)}else{tables+=composeTopRowsPeople(data,limit,people_links,var_names)}tables+="</tbody></table>"}tables+="</div>";div.append(title);div.append(tabs);div.append(tables);if(gen_tabs===true){script="<script>$('#myTab a').click(function (e) {e.preventDefault();$(this).tab('show');});</script>";div.append(script)}}function displayTopMetric(div_id,metric,metric_period,history,graph,titles,limit,people_links){var top_metric_id=metric.name;if(!history||$.isEmptyObject(history))return;var metric_id=metric.action;if(limit&&history[metric_id].length<limit){limit=history[metric_id].length;graph=false}var doer=metric.column;if(doer===undefined)doer=findMetricDoer(history,metric_id);var title="Top "+top_metric_id+" "+metric_period;var table=displayTopMetricTable(history,metric_id,doer,limit,people_links,title);var div=null;if(table===undefined)return;if(titles===false){div=$("#"+div_id);div.append(table);return}var div_graph="";var new_div="";if(graph){div_graph="top-"+graph+"-"+doer+"-";div_graph+=metric_id+"-"+metric_period;new_div+="<div id='"+div_graph+"' class='graph' style='float:right'></div>"}new_div+=table;div=$("#"+div_id);div.append(new_div);if(graph){var labels=history[doer];var data=history[metric_id];if(limit){labels=[];data=[];for(var i=0;i<limit;i++){labels.push(history[doer][i]);data.push(history[metric_id][i])}}displayBasicChart(div_graph,labels,data,graph)}}function displayDataSourcesTable(div){dsources=Report.getDataSources();html='<table class="table table-striped">';html+="<thead><th>Data Source</th><th>From</th>";html+="<th>To <small>(Updated on)</small></th></thead><tbody>";$.each(dsources,function(key,ds){if(ds.getName()==="people")return;var gdata=ds.getGlobalData();var ds_name=ds.getTitle();if(ds_name===undefined){ds_name="-"}var last_date=gdata.last_date;if(last_date===undefined){return}var first_date=gdata.first_date;if(first_date===undefined){first_date="-"}var type=gdata.type;html+="<tr><td>"+ds_name;if(type!==undefined){type=type.toLowerCase();type=type.charAt(0).toUpperCase()+type.slice(1);html+=" ("+type+")"}html+="</td>";html+="<td>"+first_date+"</td>";html+="<td>"+last_date+"</td></tr>"});html+="</tbody></table>";$(div).append(html)}function showHelp(div_id,metrics,custom_help){var all_metrics=Report.getAllMetrics();var help='<a href="#" class="help"';var content="";if(custom_help===""){var addContent=function(id,value){if(metrics[i]===id){content+="<strong>"+value.name+"</strong>: "+value.desc+"<br>";return false}};for(var i=0;i<metrics.length;i++){$.each(all_metrics,addContent)}}else{content="<strong>Description</strong>: "+custom_help}help+='data-content="'+content+'" data-html="true">';help+='<img src="qm_15.png"></a>';var old_help=$("#"+div_id).prev()[0];if(old_help&&old_help.className==="help")$("#"+div_id).prev().empty();$("#"+div_id).before(help)}function displayMetricsLines(div_id,metrics,history,title,config){if(!(config&&config.help===false))showHelp(div_id,metrics,config.custom_help);var lines_data=[];if(config.remove_last_point)history=DataProcess.revomeLastPoint(history);if(config.frame_time)history=DataProcess.frameTime(history,metrics);if(config.start_time)history=DataProcess.filterDates(config.start_time,config.end_time,history);$.each(metrics,function(id,metric){if(!history[metric])return;var mdata=[[],[]];$.each(history[metric],function(i,value){mdata[i]=[history.id[i],history[metric][i]]});var label=metric;if(Report.getAllMetrics()[metric])label=Report.getAllMetrics()[metric].name;lines_data.push({label:label,data:mdata})});displayDSLines(div_id,history,lines_data,title,config)}function displayMetricSubReportLines(div_id,metric,items,title,config,start,end,convert,order){var lines_data=[];var history={};$.each(items,function(item,data){if(data===undefined)return false;if(data[metric]===undefined)return false;if(convert)data=DataProcess.convert(data,convert,metric);if(start)data=DataProcess.filterDates(start,end,data);var cdata=[[],[]];for(var i=0;i<data.id.length;i++){cdata[i]=[data.id[i],data[metric][i]]}item=Report.cleanLabel(item);lines_data.push({label:item,data:cdata});history=data});if(lines_data.length===0)return;if(order){var order_lines_data=[];$.each(order,function(i,value_order){$.each(lines_data,function(j,value){if(value_order===value.label){order_lines_data.push(value);return false}})});lines_data=order_lines_data}displayDSLines(div_id,history,lines_data,title,config)}Viz.track_formatter_com_pending=function(o){scr=Report.getDataSourceByName("scr");companies=scr.getCompaniesMetricsData();dhistory=Viz._history;lines_data=Viz._lines_data;var label=dhistory.date[parseInt(o.index,10)];if(label===undefined)label="";else label+="<br>";for(var i=0;i<lines_data.length;i++){var value=lines_data[i].data[o.index][1];if(value===undefined)continue;if(lines_data.length>1){if(lines_data[i].label!==undefined)company_name=lines_data[i].label;label+=lines_data[i].label+":"}label+="<strong>"+Report.formatValue(value)+"</strong>";if(company_name)label+="("+companies[company_name].pending[o.index]+")";label+="<br>"}return label};function getConfLinesChart(title,legend_div,history,lines_data,mouse_tracker_fn){var config={subtitle:title,legend:{show:true,container:legend_div},xaxis:{minorTickFreq:4,mode:"time",timeUnit:"second",timeFormat:"%b %y",margin:true},yaxis:{min:null,noTicks:2,autoscale:true},grid:{verticalLines:false,color:"#000000",outlineWidth:1,outline:"s"},mouse:{container:legend_div,track:true,trackY:false,relative:true,position:"ne",trackFormatter:function(o){var label=history.date[parseInt(o.index,10)];if(label===undefined)label="";else label+="<br>";for(var i=0;i<lines_data.length;i++){var value=lines_data[i].data[o.index][1];if(value===undefined)continue;if(lines_data.length>1){if(lines_data[i].label!==undefined){value_name=lines_data[i].label;label+=value_name.substring(0,9)+":"}}label+="<strong>"+Report.formatValue(value)+"</strong><br>"}return label}},selection:{mode:"x",fps:10},shadowSize:4};if(mouse_tracker_fn){Viz._history=history;Viz._lines_data=lines_data;config.mouse.trackFormatter=Viz[mouse_tracker_fn]}return config}function dropLastLineValue(history,lines_data){if(lines_data.length===0)return lines_data;if(lines_data.length>1){for(var j=0;j<lines_data.length;j++){var last=lines_data[j].data.length-1;lines_data[j].data[last][1]=undefined}}}function lastLineValueToPoint(history,lines_data){if(lines_data.length!==1)return lines_data;var last=lines_data[0].data.length;var dots=[];var utime=0;for(var i=0;i<last-1;i++){utime=parseInt(history.unixtime[i],10);dots.push([utime,undefined])}utime=parseInt(history.unixtime[last-1],10);dots.push([utime,lines_data[0].data[last-1][1]]);var dot_graph={data:dots};dot_graph.points={show:true,radius:3,lineWidth:1,fillColor:null,shadowSize:0};lines_data.push(dot_graph);lines_data[0].data[last-1][1]=undefined;lines_data[1].label=lines_data[0].label;return lines_data}function composeRangeText(former_title,starting_utime,end_utime){var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var date=new Date(parseInt(starting_utime,10)*1e3);var starting_date=months[date.getMonth()]+" "+date.getFullYear();date=new Date(parseInt(end_utime,10)*1e3);var end_date=months[date.getMonth()]+" "+date.getFullYear();return former_title+" ( "+starting_date+" - "+end_date+" )"}function sortBiArray(bi_array){bi_array.sort(function(a,b){return a[1]>b[1]||b[1]===undefined?1:-1});return bi_array}function getMax(multiple_array,from_unixstamp,to_unixstamp){from_unixstamp=Math.round(from_unixstamp);to_unixstamp=Math.round(to_unixstamp);var narrays=multiple_array.length;var aux_array=[];for(var i=0;i<narrays;i++){for(var z=multiple_array[i].data.length-1;z>0;z--){var aux_value=multiple_array[i].data[z][0];var cond=aux_value<from_unixstamp||aux_value>to_unixstamp;if(cond){multiple_array[i].data.splice(z,1)}}}var res=[];for(i=0;i<narrays;i++){aux_array=multiple_array[i].data;aux_array=sortBiArray(aux_array);res.push(aux_array[aux_array.length-1][1])}res.sort(function(a,b){return a-b});return res[res.length-1]}function addEmptyValue(lines_data){var step=lines_data[0].data[1][0]-lines_data[0].data[0][0];var narrays=lines_data.length;var last_date=0;for(var i=0;i<narrays;i++){var mylength=lines_data[i].data.length;last_date=lines_data[i].data[mylength-1][0];lines_data[i].data.push([last_date+step,undefined])}return lines_data}function displayDSLines(div_id,history,lines_data,title,config_metric){var use_stacked=false;if(config_metric){if(config_metric.lines&&config_metric.lines.stacked){use_stacked=true}}if(use_stacked){displayDSLinesStacked(div_id,history,lines_data,title,config_metric)}else if(history.unixtime===undefined){displayDSLinesStacked(div_id,history,lines_data,title,config_metric)}else{displayDSLinesZoom(div_id,history,lines_data,title,config_metric)}}function displayDSLinesStacked(div_id,history,lines_data,title,config_metric){var container=document.getElementById(div_id);var legend_div=null;if(config_metric&&config_metric.legend&&config_metric.legend.container)legend_div=$("#"+config_metric.legend.container);var config={subtitle:title,legend:{show:true,container:legend_div},xaxis:{minorTickFreq:4,tickFormatter:function(x){var index=null;for(var i=0;i<history.id.length;i++){if(parseInt(x,10)===history.id[i]){index=i;break}}return history.date[index]}},yaxis:{min:0,noTicks:2,autoscale:false},grid:{verticalLines:false,color:"#000000",outlineWidth:1,outline:"s"},mouse:{container:legend_div,track:true,trackY:false,trackFormatter:function(o){var label=history.date[parseInt(o.index,10)];if(label===undefined)label="";else label+="<br>";for(var i=0;i<lines_data.length;i++){var value=lines_data[i].data[o.index][1];if(value===undefined)continue;if(lines_data.length>1){if(lines_data[i].label!==undefined)label+=lines_data[i].label+":"}label+=Report.formatValue(value)+"<br>"}return label}}};if(config_metric){if(!config_metric.show_title)config.title="";if("show_legend"in config_metric){if(config_metric.show_legend===true)config.legend.show=true;else config.legend.show=false}if(config_metric.lines&&config_metric.lines.stacked)config.lines={stacked:true,fill:true,fillOpacity:1,fillBorder:true,lineWidth:.01};if(!config_metric.show_labels){config.xaxis.showLabels=false;config.yaxis.showLabels=false}if(config_metric.show_grid===false){config.grid.verticalLines=false;config.grid.horizontalLines=false;config.grid.outlineWidth=0}if(config_metric.show_mouse===false){config.mouse.track=false}if(config_metric.graph==="bars"){config.bars={show:true}}if(config_metric.light_style===true){config.grid.color="#ccc";config.legend.show=false}if(config_metric.custom_title){config.subtitle=config_metric.custom_title}}var showLastPoint=false;if(config_metric.graph!=="bars"&&lines_data.length===1&&lines_data[0].data[0][0]===0){showLastPoint=true}if(showLastPoint){lines_data=lastLineValueToPoint(history,lines_data);var next_id=history.id[history.id.length-1]+1;lines_data[0].data.push([next_id,undefined]);lines_data[1].data.push([next_id,undefined]);history.date.push("");history.id.push(next_id)}graph=Flotr.draw(container,lines_data,config);if(showLastPoint){if(history.date)history.date.pop();if(history.id)history.id.pop()}}function displayDSLinesZoom(div_id,history,lines_data,title,config_metric){if(lines_data.length===0)return;var container=document.getElementById(div_id);var legend_div=null;if(config_metric&&config_metric.legend&&config_metric.legend.container)legend_div=$("#"+config_metric.legend.container);var config=getConfLinesChart(title,legend_div,history,lines_data,config_metric.mouse_tracker);if(config_metric){if(!config_metric.show_title)config.title="";if("show_legend"in config_metric){if(config_metric.show_legend===true)config.legend.show=true;else config.legend.show=false}if(config_metric.lines&&config_metric.lines.stacked){config.lines={stacked:true,fill:true,fillOpacity:1,fillBorder:true,lineWidth:.01}}if(!config_metric.show_labels){config.xaxis.showLabels=false;config.yaxis.showLabels=false}if(config_metric.show_grid===false){config.grid.verticalLines=false;config.grid.horizontalLines=false;config.grid.outlineWidth=0}if(config_metric.show_mouse===false){config.mouse.track=false}if(config_metric.graph==="bars"){config.bars={show:true}}if(config_metric.light_style===true){config.grid.color="#ccc";config.legend.show=false}if(config_metric.custom_title){config.subtitle=config_metric.custom_title}}var number_lines=lines_data.length;var data_length=lines_data[0].data.length;for(var z=0;z<number_lines;z++){for(var i=0;i<data_length;i++){lines_data[z].data[i][0]=parseInt(history.unixtime[i],10)}}var showLastPoint=false;if(config_metric.graph!=="bars"&&lines_data.length===1){showLastPoint=true}if(showLastPoint){lines_data=lastLineValueToPoint(history,lines_data);addEmptyValue(lines_data)}else if(!showLastPoint&&lines_data.length>1){dropLastLineValue(history,lines_data)}function drawGraph(opts){var o=Flotr._.extend(Flotr._.clone(config),opts||{});return Flotr.draw(container,lines_data,o)}graph=drawGraph();Flotr.EventAdapter.observe(container,"flotr:select",function(area){var zoom_options={xaxis:{minorTickFreq:4,mode:"time",timeUnit:"second",timeFormat:"%b %y",min:area.x1,max:area.x2},yaxis:{min:area.y1,autoscale:true},grid:{verticalLines:true,color:"#000000",outlineWidth:1,outline:"s"}};zoom_options.subtitle=composeRangeText(config.subtitle,area.xfirst,area.xsecond);var new_lines_data_object=JSON.parse(JSON.stringify(lines_data));var max_value=getMax(new_lines_data_object,area.x1,area.x2);zoom_options.yaxis.max=max_value+max_value*.2;graph=drawGraph(zoom_options)});Flotr.EventAdapter.observe(container,"flotr:click",function(){drawGraph()})}function displayBasicChart(divid,labels,data,graph,title,config_metric,rotate,fixColor,yformatter){var horizontal=false;if(rotate)horizontal=true;var container=document.getElementById(divid);var legend_div=null;if(config_metric&&config_metric.legend&&config_metric.legend.container)legend_div=$("#"+config_metric.legend.container);var chart_data=[],i;var label="";if(!horizontal){for(i=0;i<data.length;i++){if(labels)label=DataProcess.hideEmail(labels[i]);chart_data.push({data:[[i,data[i]]],label:label})}}else{for(i=0;i<data.length;i++){if(labels)label=DataProcess.hideEmail(labels[i]);chart_data.push({data:[[data[i],i]],label:label})}}var config={title:title,grid:{verticalLines:false,horizontalLines:false,outlineWidth:0},xaxis:{showLabels:false,min:0},yaxis:{showLabels:false,min:0},mouse:{container:legend_div,track:true,trackFormatter:function(o){var i="x";if(horizontal)i="y";var label="";if(labels)label=DataProcess.hideEmail(labels[parseInt(o[i],10)])+": ";return label+data[parseInt(o[i],10)]}},legend:{show:false,position:"se",backgroundColor:"#D2E8FF",container:legend_div}};if(config_metric){if(!config_metric.show_title)config.title="";if(config_metric.show_legend)config.legend.show=true}if(graph==="bars"){config.bars={show:true,horizontal:horizontal};if(fixColor){config.bars.color=fixColor;config.bars.fillColor=fixColor}if(config_metric&&config_metric.show_legend!==false)config.legend={show:true,position:"ne",container:legend_div};config.grid.horizontalLines=true;config.yaxis={showLabels:true,min:0};if(config_metric&&config_metric.xaxis)config.xaxis={showLabels:config_metric.xaxis,min:0};if(yformatter){config.yaxis={showLabels:true,min:0,tickFormatter:yformatter}}}if(graph==="pie"){config.pie={show:true};config.mouse.position="ne"}graph=Flotr.draw(container,chart_data,config)}function displayMultiColumnChart(divid,labels,data,title,config_metric,rotate,yformatter,period_year){var bar_width=.4;var lseries=data[0].length;if(data[1].length>lseries)lseries=data[1].length;var horizontal=false;if(rotate)horizontal=true;var container=document.getElementById(divid);var legend_div=null;if(config_metric&&config_metric.legend&&config_metric.legend.container)legend_div=$("#"+config_metric.legend.container);var serie1=[],i,serie2=[],data_viz=[];for(i=0;i<lseries;i++){var val1,val2;if(data[0].length>i)val1=data[0][i];else val1=undefined;if(data[1].length>i)val2=data[1][i];else val2=undefined;if(!horizontal){serie1.push([i-bar_width/2,val1]);serie2.push([i+bar_width/2,val2])}else{serie1.push([val1,i-bar_width/2]);serie2.push([val2,i+bar_width/2])}}data_viz=[{data:serie1,label:labels[0]},{data:serie2,label:labels[1]}];var config={title:title,bars:{show:true,horizontal:horizontal,barWidth:bar_width},grid:{verticalLines:false,horizontalLines:false,outlineWidth:0},xaxis:{showLabels:false,min:0},yaxis:{showLabels:true,min:0},mouse:{container:legend_div,track:true,trackFormatter:function(o){var index;var i="x";if(horizontal)i="y";var point=parseFloat(o[i],1);var point_down=Math.round((point-.2)*10)/10;var point_up=Math.round((point+.2)*10)/10;if(point_down===parseInt(point,10))index=point_down;else index=point_up;var years=index;if(period_year)years=index*period_year;var label=years+" years: ";var val1,val2;if(serie1[index]===undefined)val1=0;else val1=parseInt(serie1[index][0],10);if(isNaN(val1))val1=0;if(serie2[index]===undefined)val2=0;else val2=parseInt(serie2[index][0],10);if(isNaN(val2))val2=0;label+=val1+" "+labels[0];label+=" , ";label+=val2+" "+labels[1];label+=" ("+parseInt(val1/val2*100,10)+"% )";return label}},legend:{show:true,position:"ne",backgroundColor:"#D2E8FF",container:legend_div}};if(config_metric){if(!config_metric.show_title)config.title="";if(config_metric.show_legend)config.legend.show=true}if(config_metric&&config_metric.show_legend!==false)config.legend={show:true,position:"ne",container:legend_div};config.grid.horizontalLines=true;config.yaxis={showLabels:true,min:0};if(yformatter){config.yaxis={showLabels:true,min:0,tickFormatter:yformatter}}if(config_metric&&config_metric.xaxis)config.xaxis={showLabels:config_metric.xaxis,min:0};graph=Flotr.draw(container,data_viz,config)}function displayBubbles(divid,metric1,metric2,radius){var container=document.getElementById(divid);var DS=Report.getMetricDS(metric1)[0];var DS1=Report.getMetricDS(metric2)[0];var bdata=[];if(DS!=DS1){Report.log("Metrics for bubbles have different data sources");return}var full_data=[];var projects=[];$.each(Report.getDataSources(),function(index,ds){if(ds.getName()===DS.getName()){full_data.push(ds.getData());projects.push(ds.getProject())}});var dates=[[],[]];dates=[full_data[0].id,full_data[0].date];for(var i=0;i<full_data.length;i++){if(full_data[i]instanceof Array)return;dates=DataProcess.fillDates(dates,[full_data[i].id,full_data[i].date])}for(var j=0;j<full_data.length;j++){var serie=[];var data=full_data[j];var data1=DataProcess.fillHistory(dates[0],[data.id,data[metric1]]);var data2=DataProcess.fillHistory(dates[0],[data.id,data[metric2]]);for(i=0;i<dates[0].length;i++){serie.push([dates[0][i],data1[1][i],data2[1][i]])}bdata.push({label:projects[j],data:serie})}var config={bubbles:{show:true,baseRadius:5},mouse:{track:true,trackFormatter:function(o){var value=full_data[0].date[o.index]+": ";value+=o.series.label+" ";value+=o.series.data[o.index][1]+" "+metric1+",";value+=o.series.data[o.index][2]+" "+metric2;return value}},xaxis:{tickFormatter:function(o){return full_data[0].date[parseInt(o,10)-full_data[0].id[0]]}}};if(DS.getName()==="its")$.extend(config.bubbles,{baseRadius:1});if(radius){$.extend(config.bubbles,{baseRadius:radius})}Flotr.draw(container,bdata,config)}function displayDemographicsChart(divid,ds,data,period_year){if(!data)return;if(!period_year)period_year=.25;else period=365*period_year;var period_data_aging=[];var period_data_birth=[];var labels=[],i;var config={show_legend:false,xaxis:true};var age,index;for(i=0;i<data.aging.persons.age.length;i++){age=data.aging.persons.age[i];index=parseInt(age/period,10);if(!period_data_aging[index])period_data_aging[index]=0;period_data_aging[index]+=1}for(i=0;i<data.birth.persons.age.length;i++){age=data.birth.persons.age[i];index=parseInt(age/period,10);if(!period_data_birth[index])period_data_birth[index]=0;period_data_birth[index]+=1}labels=["Retained","Attracted"];yticks=function(val,axisOpts){var period=period_year;var unit="years";val=val*period_year;return val+" "+unit};var period_data=[period_data_aging,period_data_birth];if(data)displayMultiColumnChart(divid,labels,period_data,"",config,true,yticks,period_year)}function displayRadarChart(div_id,ticks,data){var container=document.getElementById(div_id);var max=$("#"+div_id).data("max");var border=.2;if(!max)max=0;for(var j=0;j<data.length;j++){for(var i=0;i<data[j].data.length;i++){var value=data[j].data[i][1];if(value>max){max=value;max=parseInt(max*(1+border),10)}}}(function(){var x=[data,ticks]})();graph=Flotr.draw(container,data,{radar:{show:true},mouse:{track:true,trackFormatter:function(o){var value="";for(var i=0;i<data.length;i++){value+=data[i].label+" ";value+=data[i].data[o.index][1]+" ";value+=ticks[o.index][1]+"<br>"}return value}},grid:{circular:true,minorHorizontalLines:true},yaxis:{min:0,max:max,minorTickFreq:1},xaxis:{ticks:ticks}})}function displayRadar(div_id,metrics){var data=[],ticks=[];var radar_data=[];var projects=[];var i=0,j=0;for(i=0;i<metrics.length;i++){var DS=Report.getMetricDS(metrics[i]);for(j=0;j<DS.length;j++){if(!data[j]){data[j]=[];projects[j]=DS[j].getProject()}data[j].push([i,parseInt(DS[j].getGlobalData()[metrics[i]],10)])}ticks.push([i,DS[0].getMetrics()[metrics[i]].name])}for(j=0;j<data.length;j++){radar_data.push({label:projects[j],data:data[j]})}displayRadarChart(div_id,ticks,radar_data)}function displayRadarCommunity(div_id){var metrics=["scm_committers","scm_authors","its_openers","its_closers","its_changers","mls_senders"];displayRadar(div_id,metrics)}function displayRadarActivity(div_id){var metrics=["scm_commits","scm_files","its_opened","its_closed","its_changed","mls_sent"];displayRadar(div_id,metrics)}function displayTimeToAttention(div_id,ttf_data,column,labels,title){displayTimeTo(div_id,ttf_data,column,labels,title)}function displayTimeToFix(div_id,ttf_data,column,labels,title){displayTimeTo(div_id,ttf_data,column,labels,title)}function displayTimeTo(div_id,ttf_data,column,labels,title){var metrics=column.split(",");var history=ttf_data.data;if(!history[metrics[0]])return;var new_history={};new_history.date=history.date;$.each(history,function(name,data){if($.inArray(name,metrics)===-1)return;new_history[name]=[];for(var i=0;i<data.length;i++){var hours=parseFloat((parseInt(data[i],null)/24).toFixed(2),10);
new_history[name].push(hours)}});new_history.id=[];for(var i=0;i<history[metrics[0]].length;i++){new_history.id.push(i)}var config={show_legend:true,show_labels:true};displayMetricsLines(div_id,metrics,new_history,column,config)}function displayTop(div,ds,all,selected_metric,period,period_all,graph,titles,limit,people_links,threads_links,repository){var desc_metrics=ds.getMetrics();if(all===undefined)all=true;var history;if(repository===undefined){history=ds.getGlobalTopData()}else{history=ds.getRepositoriesTopData()[repository]}if(period_all===true){var filtered_history={};$.each(history,function(key,value){var aux=key.split(".");var data_metric=aux[0];var data_period=aux[1];if(selected_metric&&selected_metric!==data_metric){return true}if(selected_metric&&selected_metric===data_metric){filtered_history[key]=history[key]}});displayTopMetric_new(div,filtered_history,selected_metric,limit,desc_metrics,people_links,threads_links)}else{$.each(history,function(key,value){var aux=key.split(".");var data_metric=aux[0];var data_period=aux[1];if(selected_metric&&selected_metric!==data_metric)return true;if(period!==undefined&&period!==data_period)return true;displayTopMetric_new(div,history[key],selected_metric,limit,desc_metrics,people_links,threads_links,period)})}}function displayTopCompany(company,data,div,metric,period,titles){var graph=null;displayTopMetric(div,metric,period,data,graph,titles)}function displayTopGlobal(div,data_source,metric_id,period,titles){var project=data_source.getProject();var metric=data_source.getMetrics()[metric_id];var graph=null;if(!data_source.getGlobalTopData()[metric_id])return;data=data_source.getGlobalTopData()[metric_id][period];displayTopMetric(div,project,metric,period,data,graph,titles)}function displayTreeMap(divid,data_file,data){if(data===undefined){if(data_file===undefined)return;Loader.get_file_data_div(data_file,Viz.displayTreeMap,divid);return}else if(data===null)return;var color=d3.scale.category20c();var div=d3.select("#"+divid);var width=$("#"+divid).width(),height=$("#"+divid).height();var treemap=d3.layout.treemap().size([width,height]).sticky(true).value(function(d){return d.size});var position=function(){this.style("left",function(d){return d.x+"px"}).style("top",function(d){return d.y+"px"}).style("width",function(d){return Math.max(0,d.dx-1)+"px"}).style("height",function(d){return Math.max(0,d.dy-1)+"px"})};var node=div.datum(data).selectAll(".node").data(treemap.nodes).enter().append("div").attr("class","treemap-node").call(position).style("background",function(d){return d.children?color(d.name):null}).text(function(d){return d.children?null:d.name});d3.selectAll("input").on("change",function change(){var value=this.value==="count"?function(){return 1}:function(d){return d.size};node.data(treemap.value(value).nodes).transition().duration(1500).call(position)})}Viz.getEnvisionOptionsMin=function(div_id,history,hide){var firstMonth=history.id[0],container=document.getElementById(div_id),options;var markers=Report.getMarkers();var basic_metrics=Report.getAllMetrics();options={container:container,xTickFormatter:function(index){var label=history.date[index-firstMonth];if(label==="0")label="";return label},yTickFormatter:function(n){return n+""},selection:{data:{x:{min:history.id[0],max:history.id[history.id.length-1]}}}};options.data={summary:[history.id,history.sent],markers:markers,dates:history.date,envision_hide:hide,main_metric:"sent"};var all_metrics=Report.getAllMetrics();var label=null;for(var metric in history){label=metric;if(all_metrics[metric])label=all_metrics[metric].name;options.data[metric]=[{label:label,data:[history.id,history[metric]]}]}options.trackFormatter=function(o){var sdata=o.series.data,index=sdata[o.index][0]-firstMonth;var value=history.date[index]+":<br>";for(var metric in basic_metrics){if(history[metric]===undefined)continue;value+=history[metric][index]+" "+metric+" , "}return value};return options};function getEnvisionOptions(div_id,projects_data,ds_name,hide,summary_graph){var basic_metrics=null,main_metric="",summary_data=[[],[]];if(ds_name){$.each(Report.getDataSources(),function(i,DS){if(DS.getName()===ds_name){basic_metrics=DS.getMetrics();return false}})}else basic_metrics=Report.getAllMetrics();$.each(Report.getDataSources(),function(i,DS){main_metric=DS.getMainMetric();if(ds_name===null&&DS.getName()==="scm"||ds_name&&DS.getName()==ds_name){summary_data=[DS.getData().id,DS.getData()[main_metric]];if(summary_graph===false)summary_data=[DS.getData().id,[]];return false}});var dates=[[],[]];$.each(projects_data,function(project,data){$.each(data,function(index,DS){if(ds_name&&ds_name!==DS.getName())return;dates=DataProcess.fillDates(dates,[DS.getData().id,DS.getData().date])})});var firstMonth=dates[0][0],container=document.getElementById(div_id),options;var markers=Report.getMarkers();options={container:container,xTickFormatter:function(index){var label=dates[1][index-firstMonth];if(label==="0")label="";return label},yTickFormatter:function(n){return n+""},selection:{data:{x:{min:dates[0][0],max:dates[0][dates[0].length-1]}}}};options.data={summary:DataProcess.fillHistory(dates[0],summary_data),markers:markers,dates:dates[1],envision_hide:hide,main_metric:main_metric};var project=null;var buildProjectInfo=function(index,ds){var data=ds.getData();if(data[metric]===undefined)return;if(options.data[metric]===undefined)options.data[metric]=[];var full_data=DataProcess.fillHistory(dates[0],[data.id,data[metric]]);if(metric===main_metric){options.data[metric].push({label:project,data:full_data});if(data[metric+"_relative"]===undefined)return;if(options.data[metric+"_relative"]===undefined)options.data[metric+"_relative"]=[];full_data=DataProcess.fillHistory(dates[0],[data.id,data[metric+"_relative"]]);options.data[metric+"_relative"].push({label:project,data:full_data})}else{options.data[metric].push({label:project,data:full_data})}};var buildProjectsInfo=function(name,pdata){project=name;$.each(pdata,buildProjectInfo)};for(var metric in basic_metrics){$.each(projects_data,buildProjectsInfo)}options.trackFormatter=function(o){var sdata=o.series.data,index=sdata[o.index][0]-firstMonth;var project_metrics={};var projects=Report.getProjectsList();for(var j=0;j<projects.length;j++){project_metrics[projects[j]]={}}var value=dates[1][index]+":<br>";for(var metric in basic_metrics){if(options.data[metric]===undefined)continue;if($.inArray(metric,options.data.envision_hide)>-1)continue;for(j=0;j<projects.length;j++){if(options.data[metric][j]===undefined)continue;var project_name=options.data[metric][j].label;var pdata=options.data[metric][j].data;value=pdata[1][index];project_metrics[project_name][metric]=value}}value="<table><tr><td align='right'>"+dates[1][index]+"</td></tr>";value+="<tr>";if(projects.length>1)value+="<td></td>";for(metric in basic_metrics){if(options.data[metric]===undefined)continue;if($.inArray(metric,options.data.envision_hide)>-1)continue;value+="<td>"+basic_metrics[metric].name+"</td>"}value+="</tr>";$.each(project_metrics,function(project,metrics){var row="<tr>";for(var metric in basic_metrics){if(options.data[metric]===undefined)continue;if($.inArray(metric,options.data.envision_hide)>-1)continue;mvalue=project_metrics[project][metric];if(mvalue===undefined)mvalue="n/a";row+="<td>"+mvalue+"</td>"}if(projects.length>1)row="<td>"+project+"</td>"+row;row+="</tr>";value+=row});value+="</table>";return value};return options}function checkBasicConfig(config){if(config===undefined)config={};if(config.show_desc===undefined)config.show_desc=true;if(config.show_title===undefined)config.show_title=true;if(config.show_labels===undefined)config.show_labels=true;return config}function getMetricFriendlyName(ds,metrics){var desc_metrics=ds.getMetrics();var title="";for(var i=0;i<metrics.length;i++){if(i!==0){title+=" vs. "}if(metrics[i]in desc_metrics)title+=desc_metrics[metrics[i]].name;else title+=metrics[i]}return title}function displayMetricsEvol(ds,metrics,data,div_target,config){config=checkBasicConfig(config);var title="";if(config.show_title){title=getMetricFriendlyName(ds,metrics)}displayMetricsLines(div_target,metrics,data,title,config)}function displayMetricsCompany(ds,company,metrics,data,div_id,config){config=checkBasicConfig(config);var title=getMetricFriendlyName(ds,metrics);displayMetricsLines(div_id,metrics,data,title,config)}function displayMetricsRepo(ds,repo,metrics,data,div_id,config){config=checkBasicConfig(config);var title=getMetricFriendlyName(ds,metrics);displayMetricsLines(div_id,metrics,data,title,config)}function displayMetricsDomain(ds,domain,metrics,data,div_id,config){config=checkBasicConfig(config);var title=getMetricFriendlyName(ds,metrics);displayMetricsLines(div_id,metrics,data,title,config)}function displayMetricsProject(ds,project,metrics,data,div_id,config){config=checkBasicConfig(config);var title=getMetricFriendlyName(ds,metrics);displayMetricsLines(div_id,metrics,data,title,config)}function displayMetricsPeople(ds,upeople_identifier,metrics,data,div_id,config){config=checkBasicConfig(config);var title=getMetricFriendlyName(ds,metrics);displayMetricsLines(div_id,metrics,data,title,config)}function displayMetricRepos(metric,data,div_target,config,start,end){config=checkBasicConfig(config);if(config.show_legend!==false)config.show_legend=true;var title=metric;displayMetricSubReportLines(div_target,metric,data,title,config,start,end)}function displayMetricsCountry(ds,country,metrics,data,div_id,config){config=checkBasicConfig(config);var title=getMetricFriendlyName(ds,metrics);displayMetricsLines(div_id,metrics,data,title,config)}function displayMetricCompanies(metric,data,div_target,config,start,end,order){config=checkBasicConfig(config);if(config.show_legend!==false)config.show_legend=true;var title=metric;displayMetricSubReportLines(div_target,metric,data,title,config,start,end,null,order)}function displayMetricDomains(metric,data,div_target,config,start,end){config=checkBasicConfig(config);if(config.show_legend!==false)config.show_legend=true;var title=metric;displayMetricSubReportLines(div_target,metric,data,title,config,start,end)}function displayMetricProjects(metric,data,div_target,config,start,end){config=checkBasicConfig(config);if(config.show_legend!==false)config.show_legend=true;var title=metric;displayMetricSubReportLines(div_target,metric,data,title,config,start,end)}function displayMetricSubReportStatic(metric,data,order,div_id,config){config=checkBasicConfig(config);var title=metric;var metric_data=[];var labels=[];var graph="bars";if(config.graph)graph=config.graph;$.each(order,function(i,name){var label=Report.cleanLabel(name);labels.push(label);metric_data.push(data[name][metric])});displayBasicChart(div_id,labels,metric_data,graph,title,config)}function displayEnvisionAll(div_id,relative,legend_show,summary_graph){var projects_full_data=Report.getProjectsDataSources();var config=Report.getVizConfig();var options=Viz.getEnvisionOptions(div_id,projects_full_data,null,config.summary_hide,summary_graph);options.legend_show=legend_show;if(relative){$.each(projects_full_data,function(project,data){$.each(data,function(index,DS){main_metric=DS.getMainMetric()})});DataProcess.addRelativeValues(options.data,main_metric)}new envision.templates.Envision_Report(options)}})();function IRC(){var self=this;this.basic_metrics={irc_sent:{divid:"irc_sent",column:"sent",name:"Sent",desc:"Messages sent"},irc_senders:{divid:"irc_senders",column:"senders",name:"Senders",desc:"Messages senders",action:"sent"},irc_repositories:{divid:"irc_repositories",column:"repositories",name:"Repositories",desc:"Number of active repositories"}};this.getMainMetric=function(){return"irc_sent"};this.getSummaryLabels=function(){var id_label={first_date:"Start",last_date:"End"};return id_label};this.getLabelForRepository=function(){return"channel"};this.getLabelForRepositories=function(){return"channels"};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .irc_info").hide();return}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().irc_url}if(this.global_data.type)$(div_id+" #irc_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #irc_url").attr("href",url);$(div_id+" #irc_name").text("IRC "+this.global_data.type)}else{$(div_id+" #irc_url").attr("href",Report.getProjectData().irc_url);$(div_id+" #irc_name").text(Report.getProjectData().irc_name);$(div_id+" #irc_type").text(Report.getProjectData().irc_type)}var data=this.getGlobalData();$(div_id+" #ircFirst").text(data.first_date);$(div_id+" #ircLast").text(data.last_date);$(div_id+" #ircSent").text(data.irc_sent);$(div_id+" #ircRepositories").text(data.irc_repositories);if(data.repositories===1)$(div_id+" #ircRepositories").hide()};this.displayBubbles=function(divid,radius){if(false)Viz.displayBubbles(divid,"irc_sent","irc_senders",radius)};this.getTitle=function(){return"IRC Messages"}}IRC.prototype=new DataSource("irc");function ITS(){this.basic_metrics={its_opened:{divid:"its_opened",column:"opened",name:"Opened",desc:"Number of opened tickets",envision:{y_labels:true,show_markers:true}},its_openers:{divid:"its_openers",column:"openers",name:"Openers",desc:"Unique identities opening tickets",action:"opened",envision:{gtype:"whiskers"}},its_closed:{divid:"its_closed",column:"closed",name:"Closed",desc:"Number of closed tickets"},its_closers:{divid:"its_closers",column:"closers",name:"Closers",desc:"Number of identities closing tickets",action:"closed",envision:{gtype:"whiskers"}},its_changed:{divid:"its_changed",column:"changed",name:"Changed",desc:"Number of changes to the state of tickets"},its_changers:{divid:"its_changers",column:"changers",name:"Changers",desc:"Number of identities changing the state of tickets",action:"changed",envision:{gtype:"whiskers"}},its_companies:{divid:"its_companies",column:"companies",name:"Companies",desc:"Number of active companies"},its_countries:{divid:"its_countries",column:"countries",name:"Countries",desc:"Number of active countries"},its_repositories:{divid:"its_repositories",column:"repositories",name:"Respositories",desc:"Number of active respositories"},its_domains:{divid:"its_domains",column:"domains",name:"Domains",desc:"Number of active domains"}};this.getMainMetric=function(){return"its_opened"};this.getSummaryLabels=function(){var labels={first_date:"Start",last_date:"End",tickets:"Tickets",trackers:"Trackers"};return labels};this.getLabelForRepository=function(){return"tracker"};this.getLabelForRepositories=function(){return"trackers"};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .its-info").hide();return}$(div_id+" #its_type").text(this.global_data.type);var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().its_url}if(url===undefined)url="";if(this.global_data.type==="allura")url=url.replace("rest/","");else if(this.global_data.type==="github"){url=url.replace("api.","");url=url.replace("repos/","")}$(div_id+" #its_url").attr("href",url);var tracker_str=this.global_data.type.charAt(0).toUpperCase()+this.global_data.type.slice(1);$(div_id+" #its_name").text(tracker_str+" Tickets");var data=this.getGlobalData();$(div_id+" #itsFirst").text(data.first_date);$(div_id+" #itsLast").text(data.last_date);$(div_id+" #itsTickets").text(data.its_opened);$(div_id+" #itsOpeners").text(data.its_openers);$(div_id+" #itsRepositories").text(data.its_repositories);if(data.repositories===1)$(div_id+" #itsRepositories").hide()};this.getTitle=function(){return"Tickets"};this.displayBubbles=function(divid,radius){Viz.displayBubbles(divid,"its_opened","its_openers",radius)}}ITS.prototype=new DataSource("its");function MediaWiki(){var self=this;this.basic_metrics={mediawiki_reviews:{divid:"mediawiki_reviews",column:"reviews",name:"Editions",desc:"Wiki page editions"},mediawiki_authors:{divid:"mediawiki_authors",column:"authors",name:"Editors",desc:"Editors doing editions",action:"reviews"},mediawiki_pages:{divid:"mediawiki_pages",column:"pages",name:"Pages",desc:"Wiki pages"}};this.getMainMetric=function(){return"mediawiki_reviews"};this.getSummaryLabels=function(){var id_label={first_date:"Start",last_date:"End"};return id_label};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .mediawiki_info").hide();return}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().mediawiki_url}if(this.global_data.type)$(div_id+" #mediawiki_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #mediawiki_url").attr("href",url);$(div_id+" #mediawiki_name").text("MediaWiki "+this.global_data.type)}else{$(div_id+" #mediawiki_url").attr("href",Report.getProjectData().mediawiki_url);$(div_id+" #mediawiki_name").text(Report.getProjectData().mediawiki_name);$(div_id+" #mediawiki_type").text(Report.getProjectData().mediawiki_type)}var data=this.getGlobalData();$(div_id+" #mediawikiFirst").text(data.first_date);$(div_id+" #mediawikiLast").text(data.last_date);$(div_id+" #mediawikiSent").text(data.mediawiki_reviews)};this.displayBubbles=function(divid,radius){if(false)Viz.displayBubbles(divid,"mediawiki_reviews","mediawiki_authors",radius)};this.getTitle=function(){return"MediaWiki Reviews"}}MediaWiki.prototype=new DataSource("mediawiki");function MLS(){var self=this;this.basic_metrics={mls_responses:{divid:"mls_responses",column:"responses",name:"Responses",desc:"Number of messages that are responses"},mls_sent:{divid:"mls_sent",column:"sent",name:"Sent",desc:"Number of messages"},mls_senders:{divid:"mls_senders",column:"senders",name:"Senders",desc:"Number of unique message senders",action:"sent"},mls_threads:{divid:"mls_threads",column:"threads",name:"Threads",desc:"Number of messages threads"},mls_companies:{divid:"mls_companies",column:"companies",name:"Companies",desc:"Number of active companies"},mls_countries:{divid:"mls_countries",column:"countries",name:"Countries",desc:"Number of active countries"},mls_repositories:{divid:"mls_repositories",column:"repositories",name:"Respositories",desc:"Number of active respositories"},mls_domains:{divid:"mls_domains",column:"domains",name:"Domains",desc:"Number of active domains"}};this.data_lists_file=this.data_dir+"/mls-lists.json";this.getListsFile=function(){return this.data_lists_file};this.data_lists=null;this.getListsData=function(){return this.data_lists};this.setListsData=function(lists,self){if(self===undefined)self=this;self.data_lists=lists};this.setDataDir=function(dataDir){this.data_dir=dataDir;this.data_lists_file=this.data_dir+"/mls-lists.json";MLS.prototype.setDataDir.call(this,dataDir)};this.getMainMetric=function(){return"mls_sent"};this.getSummaryLabels=function(){var labels={first_date:"Start",last_date:"End"};return labels};this.getLabelForRepository=function(){return"mailing list"};this.getLabelForRepositories=function(){return"mailing lists"};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .mls_info").hide()}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().mls_url}if(this.global_data.type)$(div_id+" #mls_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #mls_url").attr("href",url);$(div_id+" #mls_name").text("MLS "+this.global_data.type)}else{$(div_id+" #mls_url").attr("href",Report.getProjectData().mls_url);$(div_id+" #mls_name").text(Report.getProjectData().mls_name);$(div_id+" #mls_type").text(Report.getProjectData().mls_type)}var data=this.getGlobalData();$(div_id+" #mlsFirst").text(data.first_date);$(div_id+" #mlsLast").text(data.last_date);$(div_id+" #mlsMessages").text(data.mls_sent);$(div_id+" #mlsSenders").text(data.mls_senders);$(div_id+" #mlsRepositories").text(data.mls_repositories);if(data.repositories===1)$(div_id+" #mlsRepositories").hide()};this.displayBubbles=function(divid,radius){Viz.displayBubbles(divid,"mls_sent","mls_senders",radius)};MLS.displayMLSListName=function(listinfo){var list_name_tokens=listinfo.split("_");var list_name="";if(list_name_tokens.length>1){list_name=list_name_tokens[list_name_tokens.length-1];if(list_name==="")list_name=list_name_tokens[list_name_tokens.length-2]}else{list_name=listinfo.replace("<","");list_name=list_name.replace(">","");list_name_tokens=list_name.split(".");list_name=list_name_tokens[0]}return list_name};function getUserLists(){var form=document.getElementById("form_mls_selector");var lists=[];for(var i=0;i<form.elements.length;i++){if(form.elements[i].checked)lists.push(form.elements[i].value)}if(localStorage){localStorage.setItem(getMLSId(),JSON.stringify(lists))}return lists}this.displayBasicUserAll=function(id,all){var form=document.getElementById("form_mls_selector");for(var i=0;i<form.elements.length;i++){if(form.elements[i].type=="checkbox")form.elements[i].checked=all}this.displayBasicUser(id)};this.displayBasicUser=function(div_id){$("#"+div_id).empty();lists=getUserLists();for(var i=0;i<lists.length;i++){var l=lists[i];file_messages=this.getDataDir()+"/mls-";file_messages+=l;file_messages+="-evolutionary.json";displayBasicList(div_id,l,file_messages)}};this.displayBasic=function(div_id,config_metric){var lists=this.getListsData();lists_hide=Report.getConfig().mls_hide_lists;lists=lists.mailing_list;if(lists===undefined)return null;var user_pref=false;if(typeof lists==="string")lists=[lists];if(localStorage){if(localStorage.length&&localStorage.getItem(getMLSId())){lists=JSON.parse(localStorage.getItem(getMLSId()));user_pref=true}}for(var i=0;i<lists.length;i++){var l=lists[i];if(!user_pref)if($.inArray(l,lists_hide)>-1)continue;file_messages=this.getDataDir()+"/mls-";file_messages+=l;file_messages+="-evolutionary.json";displayBasicList(div_id,l,file_messages,config_metric)}};this.getTitle=function(){return"Mailing Lists"};function displayBasicList(div_id,l,mls_file,config_metric){var config=Viz.checkBasicConfig(config_metric);for(var id in basic_metrics){var metric=basic_metrics[id];var title="";if(config.show_title)title=metric.name;if($.inArray(metric.column,Report.getConfig().mls_hide)>-1)continue;var new_div="<div class='info-pill m0-box-div flotr2-"+metric.column+"'>";new_div+="<h4>"+metric.name+" "+MLS.displayMLSListName(l)+"</h4>";new_div+="<div id='"+metric.divid+"_"+l+"' class='m0-box flotr2-"+metric.column+"'></div>";if(config.show_desc)new_div+="<p>"+metric.desc+"</p>";new_div+="</div>";$("#"+div_id).append(new_div);Viz.displayBasicLinesFile(metric.divid+"_"+l,mls_file,metric.column,config.show_labels,title)}}function getReportId(){var project_data=Report.getProjectData();return project_data.date+"_"+project_data.project_name}function getMLSId(){return getReportId()+"_mls_lists"}this.displayEvoListsMain=function(id){if(localStorage){if(localStorage.length&&localStorage.getItem(getMLSId())){lists=JSON.parse(localStorage.getItem(getMLSId()));return this.displayEvoLists(id,lists)}}history=this.getListsData();lists=history.mailing_list;if(lists===undefined)return;var config=Report.getConfig();lists_hide=config.mls_hide_lists;if(typeof lists==="string"){lists=[lists]}var filtered_lists=[];for(var i=0;i<lists.length;i++){if($.inArray(lists[i],lists_hide)==-1)filtered_lists.push(lists[i])}if(localStorage){if(!localStorage.getItem(getMLSId())){localStorage.setItem(getMLSId(),JSON.stringify(filtered_lists))}}this.displayEvoLists(id,filtered_lists)};function cleanLocalStorage(){if(localStorage){if(localStorage.length&&localStorage.getItem(getMLSId())){localStorage.removeItem(getMLSId())}}}this.getDefaultLists=function(){var default_lists=[];var hide_lists=Report.getConfig().mls_hide_lists;$.each(this.getListsData().mailing_list,function(index,list){if($.inArray(list,hide_lists)===-1)default_lists.push(list)});return default_lists};this.displaySelectorCheckDefault=function(){var default_lists=this.getDefaultLists();var form=document.getElementById("form_mls_selector");for(var i=0;i<form.elements.length;i++){if(form.elements[i].type=="checkbox"){var id=form.elements[i].id;l=id.split("_check")[0];if($.inArray(l,default_lists)>-1)form.elements[i].checked=true;else form.elements[i].checked=false}}};this.displayBasicDefault=function(div_id){var obj=self;if(this instanceof MLS)obj=this;cleanLocalStorage();obj.displaySelectorCheckDefault();$("#"+div_id).empty();obj.displayBasic(div_id)};this.displayEvoDefault=function(div_id){var obj=self;if(this instanceof MLS)obj=this;cleanLocalStorage();if(document.getElementById("form_mls_selector"))obj.displaySelectorCheckDefault();$("#"+div_id).empty();obj.displayEvoLists(div_id,obj.getDefaultLists())};this.displayEvoUserAll=function(id,all){var form=document.getElementById("form_mls_selector");for(var i=0;i<form.elements.length;i++){if(form.elements[i].type=="checkbox")form.elements[i].checked=all}this.displayEvoUser(id)};this.displayEvoUser=function(id){$("#"+id).empty();var obj=self;if(this instanceof MLS)obj=this;obj.displayEvoLists(id,getUserLists())};this.displayEvoListSelector=function(div_id_sel,div_id_mls){this.displayEvoBasicListSelector(div_id_sel,div_id_mls,null)};this.displayBasicListSelector=function(div_id_sel,div_id_mls){this.displayEvoBasicListSelector(div_id_sel,null,div_id_mls)};this.displayEvoBasicListSelector=function(div_id_sel,div_id_evo,div_id_basic){var res1=this.getListsData();var lists=res1.mailing_list;var user_lists=[];if(lists===undefined)return;if(localStorage){if(localStorage.length&&localStorage.getItem(getMLSId())){user_lists=JSON.parse(localStorage.getItem(getMLSId()))}}Report.displayBasicUser=this.displayBasicUser;Report.displayBasicUserAll=this.displayBasicUserAll;Report.displayBasicDefault=this.displayBasicDefault;Report.displayEvoDefault=this.displayEvoDefault;Report.displayEvoUser=this.displayEvoUser;Report.displayEvoUserAll=this.displayEvoUserAll;var html="Mailing list selector:";html+="<form id='form_mls_selector'>";if(typeof lists==="string"){lists=[lists]}for(var i=0;i<lists.length;i++){var l=lists[i];html+='<input type=checkbox name="check_list" value="'+l+'" ';html+='onClick="';if(div_id_evo)html+="Report.displayEvoUser('"+div_id_evo+"');";if(div_id_basic)html+="Report.displayBasicUser('"+div_id_basic+"')\";";html+='" ';html+='id="'+l+'_check" ';if($.inArray(l,user_lists)>-1)html+="checked ";html+=">";html+=MLS.displayMLSListName(l);html+="<br>"}html+='<input type=button value="All" ';html+='onClick="';if(div_id_evo)html+="Report.displayEvoUserAll('"+div_id_evo+"',true);";if(div_id_basic)html+="Report.displayBasicUserAll('"+div_id_basic+"',true);";html+='">';html+='<input type=button value="None" ';html+='onClick="';if(div_id_evo)html+="Report.displayEvoUserAll('"+div_id_evo+"',false);";if(div_id_basic)html+="Report.displayBasicUserAll('"+div_id_basic+"',false);";html+='">';html+='<input type=button value="Default" ';html+='onClick="';if(div_id_evo)html+="Report.displayEvoDefault('"+div_id_evo+"');";if(div_id_basic)html+="Report.displayBasicDefault('"+div_id_basic+"')";html+='">';html+="</form>";$("#"+div_id_sel).html(html);if(Report.getProjectsList().length>1){$("#"+div_id_sel).append("Not supported in multiproject");$("#"+div_id_sel+" :input").attr("disabled",true)}};function filterHistory(history){if(typeof history.id==="number"){$.each(history,function(key,value){value=[value]})}return history}this.displayEvoLists=function(id,lists){for(var i=0;i<lists.length;i++){var l=lists[i];file_messages=this.getDataDir()+"/mls-";file_messages+=l;file_messages+="-evolutionary.json";this.displayEvoList(MLS.displayMLSListName(l),id,file_messages)}};this.displayEvoList=function(list_label,id,mls_file){var self=this;$.getJSON(mls_file,function(history){self.envisionEvoList(list_label,id,history)})};this.envisionEvoList=function(list_label,div_id,history){var config=Report.getConfig();var options=Viz.getEnvisionOptionsMin(div_id,history,config.mls_hide);options.data.list_label=MLS.displayMLSListName(list_label);new envision.templates.Envision_Report(options,[this])}}MLS.prototype=new DataSource("mls");function SCM(){this.basic_metrics={scm_commits:{divid:"scm_commits",column:"commits",name:"Commits",desc:"Evolution of the number of commits (aggregating branches)",envision:{y_labels:true,show_markers:true}},scm_committers:{divid:"scm_committers",column:"committers",name:"Committers",desc:"Unique committers making changes to the source code",action:"commits",envision:{gtype:"whiskers"}},scm_authors:{divid:"scm_authors",column:"authors",name:"Authors",desc:"Unique authors making changes to the source code",action:"commits",envision:{gtype:"whiskers"}},scm_branches:{divid:"scm_branches",column:"branches",name:"Branches",desc:"Evolution of the number of branches"},scm_files:{divid:"scm_files",column:"files",name:"Files",desc:"Evolution of the number of unique files handled by the community"},scm_added_lines:{divid:"scm_added_lines",column:"added_lines",name:"Lines Added",desc:"Evolution of the source code lines added"},scm_removed_lines:{divid:"scm_removed_lines",column:"removed_lines",name:"Lines Removed",desc:"Evolution of the source code lines removed"},scm_repositories:{divid:"scm_repositories",column:"repositories",name:"Repositories",desc:"Evolution of the number of repositories",envision:{gtype:"whiskers"}},scm_companies:{divid:"scm_companies",column:"companies",name:"Companies",desc:"Number of active companies"},scm_countries:{divid:"scm_countries",column:"countries",name:"Countries",desc:"Number of active countries"},scm_domains:{divid:"scm_domains",column:"domains",name:"Domains",desc:"Number of active domains"}};this.getMainMetric=function(){return"scm_commits"};this.setITS=function(its){this.its=its};this.getITS=function(its){return this.its};this.getTitle=function(){return"Source Code Management"};this.getSummaryLabels=function(){var id_label={first_date:"Start",last_date:"End"};return id_label};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .scm-info").hide();return}var repo_str=this.global_data.type.charAt(0).toUpperCase()+this.global_data.type.slice(1);$(div_id+" #scm_type").text(repo_str);var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().scm_url}if(this.global_data.type==="git")if(url)url=url.replace("git://","http://");$(div_id+" #scm_url").attr("href",url);$(div_id+" #scm_name").text(repo_str);var data=this.getGlobalData();$(div_id+" #scmFirst").text(data.first_date);$(div_id+" #scmLast").text(data.last_date);$(div_id+" #scmCommits").text(data.scm_commits);$(div_id+" #scmAuthors").text(data.scm_authors);if(data.reviewers)$(div_id+" #scmReviewers").text(data.scm_reviewers);$(div_id+" #scmCommitters").text(data.scm_committers);$(div_id+" #scmRepositories").text(data.scm_repositories);if(data.repositories===1)$(div_id+" #scmRepositories").hide()};this.displayBubbles=function(divid,radius){Viz.displayBubbles(divid,"scm_commits","scm_committers",radius)}}SCM.prototype=new DataSource("scm");function SCR(){var self=this;this.basic_metrics={scr_opened:{divid:"scr_opened",column:"opened",name:"Reviews opened",desc:"Reviews in status new or inprogress"},scr_closed:{divid:"scr_closed",column:"closed",name:"Reviews closed",desc:"Reviews merged or abandoned"},scr_merged:{divid:"scr_merged",column:"merged",name:"Reviews merged",desc:"Reviews merged"},scr_mergers:{divid:"scr_mergers",column:"mergers",name:"Reviews mergers",action:"merged",desc:"People merging reviews"},scr_new:{divid:"scr_new",column:"new",name:"Reviews new",desc:"Reviews in status new"},scr_abandoned:{divid:"scr_abandoned",column:"abandoned",name:"Reviews abandoned",desc:"Reviews abandoned"},scr_pending:{divid:"scr_pending",column:"pending",name:"Reviews pending",desc:"Reviews pending to be attended"},scr_review_time_days_avg:{divid:"scr_review_time_days_avg",column:"review_time_days_avg",name:"Average review time",desc:"Average review time in days"},scr_verified:{divid:"scr_verified",column:"verified",name:"Patches verified",desc:"Patches verified"},scr_approved:{divid:"scr_approved",column:"approved",name:"Patches approved",desc:"Patches approved"},scr_codereview:{divid:"scr_codereview",column:"codereview",name:"Patches codereview",desc:"Patches in code review process"},scr_WaitingForReviewer:{divid:"scr_WaitingForReviewer",column:"WaitingForReviewer",name:"Patches waiting reviewer",desc:"Patches waiting for reviewer"},scr_WaitingForSubmitter:{divid:"scr_WaitingForSubmitter",column:"WaitingForSubmitter",name:"Patches waiting submitter",desc:"Patches waiting for a new version"},scr_submitted:{divid:"scr_submitted",column:"submitted",name:"Reviews submitted",desc:"Reviews submitted"},scr_submitters:{divid:"scr_submitters",column:"submitters",name:"Reviews submitters",desc:"Number of people submitting review processes."},scr_sent:{divid:"scr_sent",column:"sent",name:"Patches Sent",desc:"Patches sent"},scr_companies:{divid:"scr_companies",column:"companies",name:"Companies",desc:"Number of active companies"},scr_countries:{divid:"scr_countries",column:"countries",name:"Countries",desc:"Number of active countries"},scr_repositories:{divid:"scr_repositories",column:"repositories",name:"Respositories",desc:"Number of active respositories"},scr_closers:{divid:"scr_closers",column:"closers",name:"Closers",desc:"Reviews closers",action:"closed"},scr_openers:{divid:"scr_openers",column:"openers",name:"Openers",desc:"Reviews openers",action:"opened"},scr_reviewers:{divid:"scr_reviewers",column:"reviewers",name:"Reviewers",desc:"Number of people reviewing contributions"}};
this.getMainMetric=function(){return"scr_merged"};this.getSummaryLabels=function(){var id_label={first_date:"Start",last_date:"End",review_time_pending_ReviewsWaitingForReviewer_days_avg:"Review Time for reviewers (days, avg)",review_time_pending_ReviewsWaitingForReviewer_days_median:"Review Time for reviewers (days, median)",review_time_pending_update_ReviewsWaitingForReviewer_days_avg:"Update time for reviewers (days, avg)",review_time_pending_update_ReviewsWaitingForReviewer_days_median:"Update time for reviewers (days, avg)",review_time_pending_days_avg:"Review time (days, avg)",review_time_pending_days_median:"Review time (days, median)",review_time_pending_update_days_avg:"Update time (days, avg)",review_time_pending_update_days_median:"Update time (days, median)"};return id_label};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .scr_info").hide();return}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().scr_url}if(this.global_data.type)$(div_id+" #scr_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #scr_url").attr("href",url);$(div_id+" #scr_name").text("SCR "+this.global_data.type)}else{$(div_id+" #scr_url").attr("href",Report.getProjectData().mls_url);$(div_id+" #scr_name").text(Report.getProjectData().scr_name);$(div_id+" #scr_type").text(Report.getProjectData().scr_type)}var company=this.getCompanyQuery();var data=this.getGlobalData();if(company){data=this.getCompaniesGlobalData()[company]}$(div_id+" #scrFirst").text(data.first_date);$(div_id+" #scrLast").text(data.last_date);$(div_id+" #scrReviews").text(data.scr_opened)};this.displayBubbles=function(divid,radius){if(false)Viz.displayBubbles(divid,"scr_opened","scr_openers",radius)};SCR.displaySCRListName=function(listinfo){var list_name_tokens=listinfo.split("_");var list_name="";if(list_name_tokens.length>1){list_name=list_name_tokens[list_name_tokens.length-1];if(list_name==="")list_name=list_name_tokens[list_name_tokens.length-2]}else{list_name=listinfo.replace("<","");list_name=list_name.replace(">","");list_name_tokens=list_name.split(".");list_name=list_name_tokens[0]}return list_name};this.getTitle=function(){return"Source Code Review"}}SCR.prototype=new DataSource("scr");function People(){this.basic_metrics={people_members:{column:"members",name:"Members",desc:"Community Members"}};this.getMainMetric=function(){return"people_members"};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .mediawiki_info").hide();return}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().mediawiki_url}if(this.global_data.type)$(div_id+" #mediawiki_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #mediawiki_url").attr("href",url);$(div_id+" #mediawiki_name").text("MediaWiki "+this.global_data.type)}else{$(div_id+" #mediawiki_url").attr("href",Report.getProjectData().mediawiki_url);$(div_id+" #mediawiki_name").text(Report.getProjectData().mediawiki_name);$(div_id+" #mediawiki_type").text(Report.getProjectData().mediawiki_type)}var data=this.getGlobalData();$(div_id+" #mediawikiFirst").text(data.first_date);$(div_id+" #mediawikiLast").text(data.last_date);$(div_id+" #mediawikiSent").text(data.mediawiki_reviews)};this.displayBubbles=function(divid,radius){if(false)Viz.displayBubbles(divid,"mediawiki_reviews","mediawiki_authors",radius)};this.getTitle=function(){return"Community Members"}}People.prototype=new DataSource("people");function Downloads(){var self=this;this.basic_metrics={downloads_downloads:{name:"Total downloads",column:"downloads"},downloads_packages:{divid:"",column:"packages",name:"Packages downloaded",desc:"",action:"downloads"},downloads_ips:{divid:"",column:"ips",name:"IP addresses",desc:"",action:"downloads"}};this.getMainMetric=function(){return"downloads_downloads"};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .irc_info").hide();return}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().irc_url}if(this.global_data.type)$(div_id+" #irc_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #irc_url").attr("href",url);$(div_id+" #irc_name").text("IRC "+this.global_data.type)}else{$(div_id+" #irc_url").attr("href",Report.getProjectData().irc_url);$(div_id+" #irc_name").text(Report.getProjectData().irc_name);$(div_id+" #irc_type").text(Report.getProjectData().irc_type)}var data=this.getGlobalData();$(div_id+" #ircFirst").text(data.first_date);$(div_id+" #ircLast").text(data.last_date);$(div_id+" #ircSent").text(data.irc_sent);$(div_id+" #ircRepositories").text(data.irc_repositories);if(data.repositories===1)$(div_id+" #ircRepositories").hide()};this.displayBubbles=function(divid,radius){if(false)Viz.displayBubbles(divid,"mediawiki_reviews","mediawiki_authors",radius)};this.getTitle=function(){return"Downloads"}}Downloads.prototype=new DataSource("downloads");function QAForums(){var self=this;this.basic_metrics={qaforums_sent:{name:"Messages posted",desc:"Number of messages posted to Q&A forums(s)",column:"sent"},qaforums_qsent:{name:"Questions posted",desc:"Number of questions posted to Q&A forums(s)",column:"qsent"},qaforums_asent:{name:"Answers posted",desc:"Number of answers posted to Q&A forums(s)",column:"asent"},qaforums_senders:{name:"Persons posting messages",desc:"Number of persons posting messages to Q&A forums(s)",column:"senders"},qaforums_asenders:{name:"Persons posting answers",desc:"Number of persons answering in Q&A forums(s)",column:"asenders"},qaforums_qsenders:{divid:"qaforums_qsenders",name:"Persons posting questions",desc:"Number of persons asking questions in Q&A forums(s)",column:"qsenders"},qaforums_participants:{name:"Participants",desc:"Number of persons posting messages",column:"participants"}};this.getMainMetric=function(){return"qaforums_qsent"};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .irc_info").hide();return}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().irc_url}if(this.global_data.type)$(div_id+" #irc_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #irc_url").attr("href",url);$(div_id+" #irc_name").text("IRC "+this.global_data.type)}else{$(div_id+" #irc_url").attr("href",Report.getProjectData().irc_url);$(div_id+" #irc_name").text(Report.getProjectData().irc_name);$(div_id+" #irc_type").text(Report.getProjectData().irc_type)}var data=this.getGlobalData();$(div_id+" #ircFirst").text(data.first_date);$(div_id+" #ircLast").text(data.last_date);$(div_id+" #ircSent").text(data.irc_sent);$(div_id+" #ircRepositories").text(data.irc_repositories);if(data.repositories===1)$(div_id+" #ircRepositories").hide()};this.displayBubbles=function(divid,radius){if(false)Viz.displayBubbles(divid,"qaforums_quetions","qaforums_authors",radius)};this.getSummaryLabels=function(){var id_label={first_date:"Start",last_date:"End",sent:"Messages posted",qsent:"Questions posted",asent:"Answers posted",senders:"Persons posting messages",asenders:"Persons posting answers",qsenders:"Persons posting questions"};return id_label};this.getTitle=function(){return"QAForums"}}QAForums.prototype=new DataSource("qaforums");function Releases(){var self=this;this.basic_metrics={releases_modules:{name:"Modules created",desc:"Number of modules created on the forge",column:"modules"}};this.getMainMetric=function(){return"releases_modules"};this.displayData=function(divid){var div_id="#"+divid;var str=this.global_data.url;if(!str||str.length===0){$(div_id+" .irc_info").hide();return}var url="";if(this.global_data.repositories===1){url=this.global_data.url}else{url=Report.getProjectData().irc_url}if(this.global_data.type)$(div_id+" #irc_type").text(this.global_data.type);if(this.global_data.url&&this.global_data.url!=="."&&this.global_data.type!==undefined){$(div_id+" #irc_url").attr("href",url);$(div_id+" #irc_name").text("IRC "+this.global_data.type)}else{$(div_id+" #irc_url").attr("href",Report.getProjectData().irc_url);$(div_id+" #irc_name").text(Report.getProjectData().irc_name);$(div_id+" #irc_type").text(Report.getProjectData().irc_type)}var data=this.getGlobalData();$(div_id+" #ircFirst").text(data.first_date);$(div_id+" #ircLast").text(data.last_date);$(div_id+" #ircSent").text(data.irc_sent);$(div_id+" #ircRepositories").text(data.irc_repositories);if(data.repositories===1)$(div_id+" #ircRepositories").hide()};this.displayBubbles=function(divid,radius){if(false)Viz.displayBubbles(divid,"releases_modules","releases_releases",radius)};this.getSummaryLabels=function(){var id_label={first_date:"Start",last_date:"End",modules:"Modules created",releases:"Module releases created",authors:"Persons creating/updating modules"};return id_label};this.getTitle=function(){return"Releases"}}Releases.prototype=new DataSource("releases");var Identity={};(function(){var unique_list="unique-sortable";function sortSelList(list_divid,list,name){var connect="";if(list_divid===unique_list)connect="";else connect=unique_list;$("#"+name).sortable({handle:".handle",connectWith:"#"+connect,start:function(e,info){info.item.siblings(".ui-selected").appendTo(info.item)},stop:function(e,info){if(info.item.parent()[0].id===unique_list)info.item.find(".handle").remove();info.item.parent().append(info.item.find("li"));info.item.parent().find("li").addClass("mjs-nestedSortable-leaf")}}).selectable().find("li").prepend("<div class='handle'></div>")}Identity.showListNested=function(list_divid,ds){list="<ol id="+unique_list+' class="nested_sortable" ';list+='style="padding: 5px; background: #eee;"></ol>';$("#"+list_divid).append(list);$("#"+unique_list).nestedSortable({forcePlaceholderSize:true,handle:"div",helper:"clone",items:"li",tolerance:"pointer",toleranceElement:"> div",maxLevels:2,isTree:true,expandOnHover:700,startCollapsed:true});$(".disclose").on("click",function(){$(this).closest("li").toggleClass("mjs-nestedSortable-collapsed").toggleClass("mjs-nestedSortable-expanded")})};function showFilter(ds,filter_data){$("#"+ds.getName()+"filter").autocomplete({source:filter_data,select:function(event,ui){$("#"+ds.getName()+"filter").val("");$("#"+ds.getName()+"_people_"+ui.item.value).addClass("ui-selected");return false}})}Identity.showList=function(list_divid,ds){var list="";var people=ds.getPeopleData();var filter_data=[];list='<ol id="'+ds.getName()+'-sortable" class="sortable">';for(var i=0;i<people.id.length;i++){var value=people.id[i];if(typeof value==="string"){value=value.replace("@","_at_").replace(".","_")}filter_data.push({value:value,label:people.name[i]});list+='<li id="'+ds.getName()+"_people_"+value+'" ';list+='class="ui-widget-content ui-selectee">';list+='<div><span class="disclose"><span></span></span>';list+=people.id[i]+" "+people.name[i];list+="</div></li>"}list+="</ol>";$("#"+list_divid).append("<input id='"+ds.getName()+"filter'>");showFilter(ds,filter_data);$("#"+list_divid).append(list);sortSelList(list_divid,list,ds.getName()+"-sortable")}})();vizjslib_git_revision="cd7e40057a007260006990d58cb098334a1893a3";vizjslib_git_tag="2.1.3-51-gcd7e400";
>>>>>>> c1bb1c5c37e8133d73923315a13b4abbc894a7d8
